!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           15 Jun 23 23:01:24 *
!**************************************************************
! User     : Full professional version
! Notebook : fluid2dsimple
! Evaluation time                 : 11 s    Mode  : Optimal
! Number of formulae              : 230     Method: Automatic
! Subroutine                      : fluid2d size: 4577
! Total size of Mathematica  code : 4577 subexpressions
! Total size of Fortran code      : 11560 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE fluid2d(v,steady,frozen,stabpress,deriv,dtime,vol,h,rho,mu,f,rno,pnew,acel,vold,vnew,xi,intforce,intstiff)
USE SMSUtility
IMPLICIT NONE
LOGICAL steady,b138
DOUBLE PRECISION v(461),frozen,stabpress,deriv,dtime,vol,h,rho,mu,f(2),rno(3,2),pnew(3),acel(3,2),vold(3,2)&
&,vnew(3,2),xi(2),intforce(9),intstiff(9,9)
v(436)=f(2)*rho
v(435)=f(1)*rho
v(430)=stabpress*vol
v(426)=vold(3,2)*xi(2)
v(425)=vold(2,2)*xi(1)
v(424)=vold(3,1)*xi(2)
v(423)=vold(2,1)*xi(1)
v(422)=pnew(3)*xi(2)
v(421)=pnew(2)*xi(1)
v(416)=1d0/rho
v(414)=(16d0*mu**2)/(h**4*rho**2)
v(413)=vnew(3,2)*xi(2)
v(412)=vnew(2,2)*xi(1)
v(411)=vnew(3,1)*xi(2)
v(410)=vnew(2,1)*xi(1)
v(398)=rno(1,2)-rno(2,2)
v(397)=(-2d0)*mu
v(394)=-rno(1,1)+rno(2,1)
v(393)=1d0/(-(rno(1,2)*rno(2,1))+rno(1,1)*rno(2,2)+rno(3,2)*v(394)+rno(3,1)*v(398))
v(392)=(-1d0)+xi(1)+xi(2)
v(391)=-(deriv*v(392))
v(390)=deriv*xi(2)
v(389)=rho*vol
v(388)=deriv*xi(1)
v(387)=v(389)*xi(1)
v(386)=rho**2
v(385)=1d0/h**2
v(415)=4d0*v(385)
v(384)=1d0-frozen
v(175)=v(384)*xi(1)
v(331)=v(389)*xi(2)
v(176)=v(384)*xi(2)
v(224)=-(v(389)*v(392))
v(174)=-(v(384)*v(392))
v(137)=-(v(393)*v(394))
v(395)=v(137)*vol
v(374)=(v(137)*v(137))
v(371)=v(395)*xi(2)
v(354)=-(v(395)*xi(1))
v(347)=v(392)*v(395)
v(339)=v(137)*v(397)
v(181)=(-0.5d0)*v(137)
v(403)=-(v(181)*vol)
v(136)=-((rno(1,1)-rno(3,1))*v(393))
v(396)=v(136)*vol
v(367)=v(396)*xi(2)
v(314)=(v(136)*v(136))
v(311)=v(396)*xi(1)
v(294)=v(392)*v(396)
v(283)=v(136)*v(397)
v(179)=(-0.5d0)*v(136)
v(134)=-(v(393)*v(398))
v(399)=v(134)*vol
v(377)=v(134)*v(397)
v(373)=(v(134)*v(134))
v(369)=v(399)*xi(2)
v(336)=-(v(399)*xi(1))
v(327)=v(392)*v(399)
v(182)=(-0.5d0)*v(134)
v(400)=v(182)*vol
v(356)=v(339)*v(400)
v(349)=v(283)*v(400)
v(133)=(rno(1,2)-rno(3,2))*v(393)
v(401)=v(133)*vol
v(365)=v(401)*xi(2)
v(313)=(v(133)*v(133))
v(309)=v(401)*xi(1)
v(298)=-(v(133)*v(397))
v(352)=-((v(137)*v(283)+v(182)*v(298))*vol)
v(333)=v(298)*v(403)
v(330)=(v(181)*v(283)+v(134)*v(298))*vol
v(278)=v(392)*v(401)
v(180)=(-0.5d0)*v(133)
v(405)=v(180)*vol
v(296)=v(283)*v(405)
v(132)=v(133)+v(134)
v(402)=-(v(132)*vol)
v(360)=v(402)*xi(2)
v(304)=v(402)*xi(1)
v(261)=(v(132)*v(132))
v(253)=-(v(392)*v(402))
v(234)=v(132)*v(397)
v(323)=v(234)*v(403)
v(274)=-(v(179)*v(234)*vol)
v(178)=v(132)/2d0
v(160)=v(132)*vnew(1,2)-v(133)*vnew(2,2)-v(134)*vnew(3,2)
v(197)=v(160)*v(176)
v(350)=v(197)*v(387)
v(343)=v(197)*v(224)
v(193)=v(160)*v(175)
v(290)=v(193)*v(224)
v(189)=v(160)*v(174)
v(159)=v(132)*vnew(1,1)-v(133)*vnew(2,1)-v(134)*vnew(3,1)
v(135)=v(136)+v(137)
v(404)=-(v(135)*vol)
v(362)=v(404)*xi(2)
v(306)=v(404)*xi(1)
v(262)=(v(135)*v(135))
v(257)=-(v(392)*v(404))
v(223)=-(v(135)*v(397))
v(345)=-((v(137)*v(223)+v(182)*v(234))*vol)
v(342)=v(223)*v(400)
v(320)=(v(181)*v(223)+v(134)*v(234))*vol
v(292)=-((v(136)*v(223)+v(180)*v(234))*vol)
v(289)=v(223)*v(405)
v(271)=(v(179)*v(223)+v(133)*v(234))*vol
v(240)=v(178)*v(223)*vol
v(163)=v(135)*vnew(1,2)-v(136)*vnew(2,2)-v(137)*vnew(3,2)
v(161)=v(135)*vnew(1,1)-v(136)*vnew(2,1)-v(137)*vnew(3,1)
v(188)=v(161)*v(176)
v(334)=v(188)*v(387)
v(324)=v(188)*v(224)
v(186)=v(161)*v(175)
v(275)=v(186)*v(224)
v(184)=v(161)*v(174)
IF(steady) THEN
 v(168)=0d0
 v(169)=0d0
 v(170)=0d0
 v(139)=0d0
 v(171)=0d0
 v(172)=0d0
 v(173)=0d0
 v(140)=0d0
ELSE
 v(409)=acel(3,2)*xi(2)
 v(408)=acel(2,2)*xi(1)
 v(407)=acel(3,1)*xi(2)
 v(406)=acel(2,1)*xi(1)
 v(168)=v(391)
 v(169)=v(388)
 v(170)=v(390)
 v(139)=-(acel(1,1)*v(392))+v(406)+v(407)
 v(171)=v(391)
 v(172)=v(388)
 v(173)=v(390)
 v(140)=-(acel(1,2)*v(392))+v(408)+v(409)
ENDIF
v(143)=v(410)+v(411)-v(392)*vnew(1,1)
v(144)=v(412)+v(413)-v(392)*vnew(1,2)
v(201)=sqrt(0.1d-5+v(143)**2+v(144)**2)
v(204)=v(414)+(v(201)*v(201))*v(415)
v(208)=-((v(201)*v(415)*v(416))/v(204)**0.15d1)
v(418)=v(208)/v(201)
v(420)=-(v(392)*v(418))
v(419)=v(418)*xi(1)
v(417)=v(418)*xi(2)
v(217)=v(144)*v(417)
v(215)=v(143)*v(417)
v(213)=v(144)*v(419)
v(211)=v(143)*v(419)
v(209)=v(144)*v(420)
v(205)=v(143)*v(420)
v(151)=-(pnew(1)*v(392))+v(421)+v(422)
v(152)=v(143)*v(384)+frozen*(v(423)+v(424)-v(392)*vold(1,1))
v(198)=-(v(134)*v(152))
v(194)=-(v(133)*v(152))
v(190)=v(132)*v(152)
v(154)=v(144)*v(384)+frozen*(v(425)+v(426)-v(392)*vold(1,2))
v(199)=-(v(137)*v(154))
v(427)=v(198)+v(199)
v(200)=v(173)+v(163)*v(176)+v(427)
v(195)=-(v(136)*v(154))
v(428)=v(194)+v(195)
v(196)=v(172)+v(163)*v(175)+v(428)
v(191)=v(135)*v(154)
v(429)=v(190)+v(191)
v(192)=v(171)+v(163)*v(174)+v(429)
v(187)=v(170)+v(159)*v(176)+v(427)
v(185)=v(169)+v(159)*v(175)+v(428)
v(183)=v(168)+v(159)*v(174)+v(429)
v(162)=(v(160)+v(161))/2d0
v(164)=v(139)+v(152)*v(159)+v(154)*v(161)
v(254)=pnew(1)*v(132)-pnew(2)*v(133)-pnew(3)*v(134)+rho*(-f(1)+v(164))
v(434)=rho*v(254)
v(165)=v(140)+v(152)*v(160)+v(154)*v(163)
v(255)=pnew(1)*v(135)-pnew(2)*v(136)-pnew(3)*v(137)+rho*(-f(2)+v(165))
v(381)=v(132)*v(254)+v(135)*v(255)
v(380)=-(v(133)*v(254))-v(136)*v(255)
v(379)=-(v(134)*v(254))-v(137)*v(255)
v(363)=v(379)*v(430)
v(307)=v(380)*v(430)
v(259)=v(381)*v(430)
v(166)=v(159)+v(163)
v(437)=v(166)*vol
v(167)=v(416)/sqrt(v(204))
v(433)=v(167)*vol
v(258)=v(167)*v(430)
v(454)=rho*v(258)
v(219)=v(254)*v(389)
v(447)=v(217)*v(219)
v(446)=v(215)*v(219)
v(445)=v(213)*v(219)
v(444)=v(211)*v(219)
v(441)=v(209)*v(219)
v(439)=v(205)*v(219)
v(431)=v(167)*v(219)
v(236)=v(176)*v(431)
v(231)=v(175)*v(431)
v(222)=v(174)*v(431)
v(220)=v(391)+v(429)
v(227)=v(220)*v(433)
v(443)=rho*v(227)
v(225)=v(227)*v(386)
v(440)=v(224)+v(225)
v(239)=v(255)*v(389)
v(453)=v(217)*v(239)
v(452)=v(215)*v(239)
v(451)=v(213)*v(239)
v(450)=v(211)*v(239)
v(449)=v(209)*v(239)
v(448)=v(205)*v(239)
v(432)=v(167)*v(239)
v(250)=v(176)*v(432)
v(246)=v(175)*v(432)
v(242)=v(174)*v(432)
v(266)=-((v(132)*v(133)+v(135)*v(136))*v(258))
v(269)=-((v(132)*v(134)+v(135)*v(137))*v(258))
v(272)=v(388)+v(428)
v(279)=v(272)*v(433)
v(438)=rho*v(279)
v(276)=v(279)*v(386)
v(455)=v(276)+v(387)
v(318)=(v(133)*v(134)+v(136)*v(137))*v(258)
v(321)=v(390)+v(427)
v(328)=v(321)*v(433)
v(442)=rho*v(328)
v(325)=v(328)*v(386)
v(456)=v(325)+v(331)
v(376)=-v(151)-v(159)*v(397)
v(378)=-v(151)-v(163)*v(397)
intforce(1)=v(164)*v(224)+v(227)*v(434)+(v(162)*v(223)+v(132)*v(376)+v(392)*v(435))*vol
intforce(2)=v(165)*v(224)+v(220)*v(432)+(-(v(162)*v(234))+v(135)*v(378)+v(392)*v(436))*vol
intforce(3)=v(258)*v(381)-v(392)*v(437)
intforce(4)=v(164)*v(387)+v(254)*v(438)+vol*(v(162)*v(283)-v(133)*v(376)-v(435)*xi(1))
intforce(5)=v(165)*v(387)+v(255)*v(438)+vol*(-(v(162)*v(298))-v(136)*v(378)-v(436)*xi(1))
intforce(6)=v(258)*v(380)+v(437)*xi(1)
intforce(7)=v(164)*v(331)+v(328)*v(434)+vol*(v(162)*v(339)-v(134)*v(376)-v(435)*xi(2))
intforce(8)=v(165)*v(331)+v(255)*v(442)+vol*(v(162)*v(377)-v(137)*v(378)-v(436)*xi(2))
intforce(9)=v(258)*v(379)+v(437)*xi(2)
intstiff(1,1)=v(132)*v(222)+v(220)*v(439)+v(183)*v(440)+((v(135)*v(223))/2d0-v(261)*v(397))*vol
intstiff(1,2)=v(135)*v(222)+v(240)+v(184)*v(440)+v(220)*v(441)
intstiff(1,3)=v(253)+v(132)*v(443)
intstiff(1,4)=v(132)*v(231)+v(271)+v(185)*v(440)+v(220)*v(444)
intstiff(1,5)=v(186)*v(225)+v(135)*v(231)+v(275)+v(289)+v(220)*v(445)
intstiff(1,6)=v(304)-v(133)*v(443)
intstiff(1,7)=v(132)*v(236)+v(320)+v(187)*v(440)+v(220)*v(446)
intstiff(1,8)=v(188)*v(225)+v(135)*v(236)+v(324)+v(342)+v(220)*v(447)
intstiff(1,9)=v(360)-v(134)*v(443)
intstiff(2,1)=v(240)+v(132)*v(242)+v(189)*v(440)+v(220)*v(448)
intstiff(2,2)=v(135)*v(242)+v(192)*v(440)+v(220)*v(449)+(-(v(178)*v(234))-v(262)*v(397))*vol
intstiff(2,3)=v(257)+v(135)*v(443)
intstiff(2,4)=v(193)*v(225)+v(132)*v(246)+v(274)+v(290)+v(220)*v(450)
intstiff(2,5)=v(135)*v(246)+v(292)+v(196)*v(440)+v(220)*v(451)
intstiff(2,6)=v(306)-v(136)*v(443)
intstiff(2,7)=v(197)*v(225)+v(132)*v(250)+v(323)+v(343)+v(220)*v(452)
intstiff(2,8)=v(135)*v(250)+v(345)+v(200)*v(440)+v(220)*v(453)
intstiff(2,9)=v(362)-v(137)*v(443)
intstiff(3,1)=-v(253)+v(205)*v(259)+(v(132)*v(183)+v(135)*v(189))*v(454)
intstiff(3,2)=-v(257)+v(209)*v(259)+(v(132)*v(184)+v(135)*v(192))*v(454)
intstiff(3,3)=v(258)*(v(261)+v(262))
intstiff(3,4)=v(211)*v(259)+v(278)+(v(132)*v(185)+v(135)*v(193))*v(454)
intstiff(3,5)=v(213)*v(259)+v(294)+(v(132)*v(186)+v(135)*v(196))*v(454)
intstiff(3,6)=v(266)
intstiff(3,7)=v(215)*v(259)+v(327)+(v(132)*v(187)+v(135)*v(197))*v(454)
intstiff(3,8)=v(217)*v(259)+v(347)+(v(132)*v(188)+v(135)*v(200))*v(454)
intstiff(3,9)=v(269)
intstiff(4,1)=-(v(133)*v(222))+v(271)+v(272)*v(439)+v(183)*v(455)
intstiff(4,2)=-(v(136)*v(222))+v(274)+v(275)+v(184)*v(276)+v(272)*v(441)
intstiff(4,3)=-v(278)+v(132)*v(438)
intstiff(4,4)=-(v(133)*v(231))+v(272)*v(444)+v(185)*v(455)+(v(179)*v(283)-v(313)*v(397))*vol
intstiff(4,5)=-(v(136)*v(231))+v(296)+v(272)*v(445)+v(186)*v(455)
intstiff(4,6)=v(309)-v(133)*v(438)
intstiff(4,7)=-(v(133)*v(236))+v(330)+v(272)*v(446)+v(187)*v(455)
intstiff(4,8)=-(v(136)*v(236))+v(188)*v(276)+v(334)+v(349)+v(272)*v(447)
intstiff(4,9)=v(365)-v(134)*v(438)
intstiff(5,1)=-(v(133)*v(242))+v(189)*v(276)+v(289)+v(290)+v(272)*v(448)
intstiff(5,2)=-(v(136)*v(242))+v(292)+v(272)*v(449)+v(192)*v(455)
intstiff(5,3)=-v(294)+v(135)*v(438)
intstiff(5,4)=-(v(133)*v(246))+v(296)+v(272)*v(450)+v(193)*v(455)
intstiff(5,5)=-(v(136)*v(246))+v(272)*v(451)+v(196)*v(455)+(-(v(180)*v(298))-v(314)*v(397))*vol
intstiff(5,6)=v(311)-v(136)*v(438)
intstiff(5,7)=-(v(133)*v(250))+v(197)*v(276)+v(333)+v(350)+v(272)*v(452)
intstiff(5,8)=-(v(136)*v(250))+v(352)+v(272)*v(453)+v(200)*v(455)
intstiff(5,9)=v(367)-v(137)*v(438)
intstiff(6,1)=-v(304)+v(205)*v(307)+(-(v(133)*v(183))-v(136)*v(189))*v(454)
intstiff(6,2)=-v(306)+v(209)*v(307)+(-(v(133)*v(184))-v(136)*v(192))*v(454)
intstiff(6,3)=v(266)
intstiff(6,4)=v(211)*v(307)-v(309)+(-(v(133)*v(185))-v(136)*v(193))*v(454)
intstiff(6,5)=v(213)*v(307)-v(311)+(-(v(133)*v(186))-v(136)*v(196))*v(454)
intstiff(6,6)=v(258)*(v(313)+v(314))
intstiff(6,7)=v(215)*v(307)+v(336)+(-(v(133)*v(187))-v(136)*v(197))*v(454)
intstiff(6,8)=v(217)*v(307)+v(354)+(-(v(133)*v(188))-v(136)*v(200))*v(454)
intstiff(6,9)=v(318)
intstiff(7,1)=-(v(134)*v(222))+v(320)+v(321)*v(439)+v(183)*v(456)
intstiff(7,2)=-(v(137)*v(222))+v(323)+v(324)+v(184)*v(325)+v(321)*v(441)
intstiff(7,3)=-v(327)+v(132)*v(442)
intstiff(7,4)=-(v(134)*v(231))+v(330)+v(321)*v(444)+v(185)*v(456)
intstiff(7,5)=-(v(137)*v(231))+v(186)*v(325)+v(333)+v(334)+v(321)*v(445)
intstiff(7,6)=-v(336)-v(133)*v(442)
intstiff(7,7)=-(v(134)*v(236))+v(321)*v(446)+v(187)*v(456)+(v(181)*v(339)-v(373)*v(397))*vol
intstiff(7,8)=-(v(137)*v(236))+v(356)+v(321)*v(447)+v(188)*v(456)
intstiff(7,9)=v(369)-v(134)*v(442)
intstiff(8,1)=-(v(134)*v(242))+v(189)*v(325)+v(342)+v(343)+v(321)*v(448)
intstiff(8,2)=-(v(137)*v(242))+v(345)+v(321)*v(449)+v(192)*v(456)
intstiff(8,3)=-v(347)+v(135)*v(442)
intstiff(8,4)=-(v(134)*v(246))+v(193)*v(325)+v(349)+v(350)+v(321)*v(450)
intstiff(8,5)=-(v(137)*v(246))+v(352)+v(321)*v(451)+v(196)*v(456)
intstiff(8,6)=-v(354)-v(136)*v(442)
intstiff(8,7)=-(v(134)*v(250))+v(356)+v(321)*v(452)+v(197)*v(456)
intstiff(8,8)=-(v(137)*v(250))+v(321)*v(453)+v(200)*v(456)+(v(182)*v(377)-v(374)*v(397))*vol
intstiff(8,9)=v(371)-v(137)*v(442)
intstiff(9,1)=-v(360)+v(205)*v(363)+(-(v(134)*v(183))-v(137)*v(189))*v(454)
intstiff(9,2)=-v(362)+v(209)*v(363)+(-(v(134)*v(184))-v(137)*v(192))*v(454)
intstiff(9,3)=v(269)
intstiff(9,4)=v(211)*v(363)-v(365)+(-(v(134)*v(185))-v(137)*v(193))*v(454)
intstiff(9,5)=v(213)*v(363)-v(367)+(-(v(134)*v(186))-v(137)*v(196))*v(454)
intstiff(9,6)=v(318)
intstiff(9,7)=v(215)*v(363)-v(369)+(-(v(134)*v(187))-v(137)*v(197))*v(454)
intstiff(9,8)=v(217)*v(363)-v(371)+(-(v(134)*v(188))-v(137)*v(200))*v(454)
intstiff(9,9)=v(258)*(v(373)+v(374))
END
