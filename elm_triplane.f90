!------------------------
!*** check for new paper
!------------------------
SUBROUTINE ELM_TRIDIFF(IELEM)
  INCLUDE 'simpar.inc'
  INTEGER,PARAMETER::MGAUS=3
  INTEGER,PARAMETER::MVTOT=3
  REAL(8)::LENGTH
  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
  REAL(8),DIMENSION(3,2)::RNA,RNB
  REAL(8),DIMENSION(3)::NONVAR,FFOR
  REAL(8),DIMENSION(2,3)::DERI
  REAL(8),DIMENSION(2,2)::JAC
  REAL(8),DIMENSION(2)::XI
  REAL(8),DIMENSION(2*MGAUS)::POSPG
  REAL(8),DIMENSION(MGAUS)::PESPG
  REAL(8),DIMENSION(MVTOT)::EFOR
  REAL(8),DIMENSION(MVTOT,MVTOT)::EMAT
!---------------
!*** GATHER DOFS
!---------------
  DO IN=1,3
    INO=ELNO(ELNI(IELEM)-1+IN)
    NONVAR(IN)=NODOF(9,INO,2)
    LNODS(IN)=INO
    LTYPS(IN)=9
    DO IDI=1,2        
      RNB(IN,IDI)=NOCO(IDI,INO)+NODOF(IDI,INO,1)
      RNA(IN,IDI)=NOCO(IDI,INO)+NODOF(IDI,INO,2)
    END DO
  ENDDO
!-----------------------------------------
!*** INITIALIZATION OF RELEVANT QUANTITIES
!-----------------------------------------
  NGAUS=3
  CALL GAUSSL(-NGAUS,PESPG,POSPG)
  CALL PCONSR(MVTOT,EFOR,0.0D00)
  CALL PCONSR(MVTOT*MVTOT,EMAT,0.0D00)
!--------------------
!*** QUADRATURE CYCLE
!--------------------
  DO IGAUSINPUT=1,NGAUS
!-----------------------------
!*** PARENT-DOMAIN COORDINATES
!-----------------------------
    XI(1)=POSPG(2*IGAUSINPUT-1)
    XI(2)=POSPG(2*IGAUSINPUT)
    FFOR(1)=1.0D00-XI(1)-XI(2)
    FFOR(2)=XI(1)
    FFOR(3)=XI(2)
    DERI(1,1)=-1.0D00
    DERI(2,1)=-1.0D00
    DERI(1,2)=1.0D00
    DERI(2,2)=0.0D00
    DERI(1,3)=0.0D00
    DERI(2,3)=1.0D00
    CALL MATRJAC(JAC,RNB,DERI,2,3)
    SQRTM=DETM23(2,JAC)
!---------------------
!*** QUADRATURE WEIGHT
!---------------------
    W=PESPG(IGAUSINPUT)
    VOL=W*ABS(SQRTM)
    VOLMESH=VOLMESH+VOL
    GAUSSVAR=GPHIST(1,1,IELEM,2)
    DAMVAR=GPHIST(2,1,IELEM,1)
!-----------------------------------------------------------------------------
    EDGEMED=0.5D00*(EDGEMIN+EDGEMAX)     
    GASH=DAMVAR*EDGEMED/SIZENL
    CL=SIZENL*(1.0D00-GASH)
    CL=MAX(CL,EDGEMIN)
    CL=ABS(MAPS(1,ELMA(IELEM)))
    ELHIST(7,IELEM,2)=DOTPROD(3,FFOR,NONVAR)*VOL
    GAUSSVAR=0.0D00     
    RHS=MAPS(1,ELMA(IELEM))
    CALL TORSION2D(VOL,RHS,RNB,XI,GAUSSVAR,NONVAR,EFOR,EMAT)
  END DO
  CALL STORE(IELEM,3,LNODS,LTYPS,EFOR,EMAT(1:3,1:3))
END SUBROUTINE ELM_TRIDIFF

!--------------------------------------
!*** TRI PLANE
!*** ELEMENTS
!*** THE BASIC TEMPLATE FOR ALL OTHERS
!*** WHICH MAY BE MUCH MORE COMPLEX
!--------------------------------------
SUBROUTINE ELM_TRIPLANE(IELEM,IELTYPEINP)
  INCLUDE 'simpar.inc'
  logical::iftotal
  INTEGER,PARAMETER::MGAUS=3
  INTEGER,PARAMETER::MVTOT=11
  REAL(8)::NEWTEMPERATURE,OLDTEMPERATURE,LENGTH,LENGTHRATIO,OLDTHICK,NEWTHICK
  LOGICAL::PLANESTRESS
  REAL(8)::LPARAM
  REAL(8),DIMENSION(2)::ALPHA,V2
  REAL(8),DIMENSION(3)::HASMASS
  REAL(8),DIMENSION(3)::PRESSN,TEMPO,TEMPN
  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
  REAL(8),DIMENSION(2)::VECLOAD
  REAL(8),DIMENSION(3,2)::RNA,RNB,RNO,VEL
  REAL(8),DIMENSION(3,2)::ACC
  REAL(8),DIMENSION(4)::FFOR
  REAL(8),DIMENSION(2)::XI
  REAL(8),DIMENSION(2*MGAUS)::POSPG
  REAL(8),DIMENSION(MGAUS)::PESPG
  REAL(8),DIMENSION(3,3)::PROPOSEDGRAD,NEWFRAME,OLDFRAME
  REAL(8),DIMENSION(MVTOT)::EFOR
  REAL(8),DIMENSION(MVTOT,MVTOT)::EMAT
  REAL(8),DIMENSION(4)::RELATIVESTRAIN,DHEATDSTRAIN,DSTRESSDTEMPERATURE,OLDSTRAIN
  REAL(8),DIMENSION(4,4)::DSTRESSDSTRAIN
  REAL(8),DIMENSION(4)::EQUILIBRIUMSTRESS
  REAL(8),DIMENSION(4,MVTOT)::DRELATIVESTRAIN
  REAL(8),DIMENSION(4,MVTOT,MVTOT)::D2RELATIVESTRAIN
!-------------------------------------------------------
!*** CALLS DIFFERENT ROUTINE IF TWO CONDITIONS ARE MET:
!*** IHOMOTOPY.EQ.2 AND PRPANAL(23).EQ.1
!-------------------------------------------------------
  IF(IHOMOTOPY.EQ.2.AND.NINT(PRPANAL(23)).EQ.1)THEN
    CALL ELM_TRIDIFF(IELEM)
    RETURN
  END IF
  IF(NINT(PRPANAL(23)).EQ.2)THEN
    CALL ELM_TRIAREA(IELEM)
    RETURN
  END IF
!----------------
!*** ELEMENT TYPE
!----------------
  IELTYPE=IELTYPEINP
  IF(IELTYPE.EQ.1.AND.NINT(MAPS(7,ELMA(IELEM))).EQ.1)THEN
    IELTYPE=2
  END IF
!-----------------------
!*** CHECK SPECIFIC TYPE
!-----------------------
  SELECT CASE(IELTYPE)
  CASE(1,3)
    PLANESTRESS=.FALSE.
  CASE(2)
    PLANESTRESS=.TRUE.
  CASE DEFAULT
    STOP "WRONG ELEMENT TYPE REQUESTED TO ELM_TRIPLANE"
  END SELECT
!----------------
!*** MASS DENSITY
!----------------
  RHO=MAPR(4,ELMA(IELEM))
!------------------
!*** LOAD PARAMETER
!------------------  
  LPARAM=EXTERNLOAD(NINT(MAPS(8,ELMA(IELEM))))
!----------------------
!*** SECTION PROPERTIES
!*** THICKNESS 
!----------------------
  IF(IELTYPE.NE.3)THEN
    THICK0=MAPS(1,ELMA(IELEM))
    IF(THICK0.LE.0.0D00)THICK0=1.0D00
  ELSE
    THICK0=1.0D00
  END IF
!-------------------
!*** LENGTH PROPERTY
!-------------------
  LENGTH=MAPS(9,ELMA(IELEM))
!----------------------
!*** SCALED VECTOR LOAD
!----------------------
  VECLOAD(1:2)=MAPS(3:2+2,ELMA(IELEM))*LPARAM  
!--------------------
!*** FLAG FOR INERTIA
!--------------------
  RACC=0.0D00
  IF(ABS(PRPANAL(14)).GT.EPSMACH())RACC=1.0D00
!---------------
!*** GATHER DOFS
!---------------
  DO IN=1,3
    INO=ELNO(ELNI(IELEM)-1+IN)
    PRESSN(IN)=NODOF(7,INO,2)
    TEMPO(IN)=NODOF(8,INO,1)
    TEMPN(IN)=NODOF(8,INO,2)
    DO IDI=1,2
      RNO(IN,IDI)=NOCO(IDI,INO)
      RNB(IN,IDI)=NOCO(IDI,INO)+NODOF(IDI,INO,1)
      RNA(IN,IDI)=NOCO(IDI,INO)+NODOF(IDI,INO,2)
      VEL(IN,IDI)=VELO(IDI,INO,2)
      ACC(IN,IDI)=RACC*ACEL(IDI,INO,2)
    END DO
  ENDDO
!-------------------------------------------------------
!*** DETERMINE ACTUAL LENGTH (AL) BY USING SMALLEST EDGE
!-------------------------------------------------------
  AL=HUGE(1.0D00)
  DO IK=ELIR(IELEM),ELIR(IELEM+1)-1
    IAR=ELAR(IK)
    AL=MIN(AL,EDGESIZE(-IAR))
  END DO
  ELHIST(7,IELEM,2)=AL
  IF(ABS(LENGTH).GT.EPSMACH())THEN
    LENGTHRATIO=EDGEMIN/LENGTH
  ELSE
    LENGTHRATIO=EDGEMIN
  END IF
!---------------------------------------------
!*** CORRECTS LENGTHRATIO IF PRPANAL(23) IS ON
!---------------------------------------------
  IF(NINT(PRPANAL(23)).EQ.1.AND.SIZENL.GT.EPSMACH())THEN
    LENGTHRATIO=SIZENL
  ELSE
    LENGTHRATIO=EDGEMIN     
  END IF
!-----------------------------------------
!*** INITIALIZATION OF RELEVANT QUANTITIES
!-----------------------------------------
  IF(IELTYPE.EQ.1)THEN
    NGAUS=3
  ELSE
    NGAUS=1
  END IF
  CALL GAUSSL(-NGAUS,PESPG,POSPG)
  CALL PCONSR(MVTOT,EFOR,0.0D00)
  CALL PCONSR(MVTOT*MVTOT,EMAT,0.0D00)
!------------------------
!*** FRAMES (OLD AND NEW)
!------------------------
  CALL FRAME2D3N(RNB,OLDFRAME)
  CALL FRAME2D3N(RNA,NEWFRAME)
  DO ID=1,3
    DO JD=1,3
      OLDFRAME(ID,JD)=DELTAK(ID,JD)
      NEWFRAME(ID,JD)=DELTAK(ID,JD)
    END DO
  END DO
!--------------------
!*** QUADRATURE CYCLE
!--------------------
  ELHIST(10,IELEM,2)=0.0D00
  DO IGAUSINPUT=1,NGAUS
!-----------------------------
!*** PARENT-DOMAIN COORDINATES
!-----------------------------
    XI(1)=POSPG(2*IGAUSINPUT-1)
    XI(2)=POSPG(2*IGAUSINPUT)
!-------------------
!*** SHAPE FUNCTIONS
!-------------------
    FFOR(1)=1.0D00-XI(1)-XI(2)
    FFOR(2)=XI(1)
    FFOR(3)=XI(2)
    FFOR(4)=FFOR(1)*FFOR(2)*FFOR(3)
!----------------------
!*** QUADRATURE WEIGHT
!----------------------
    W=PESPG(IGAUSINPUT)     
!---------------------
!*** ACTUAL THICKNESS
!---------------------
      OLDTHICK=THICK0
!---------------------------------
!*** CALCULATES STRAIN, FIRST AND
!*** SECOND DERIVATIVES
!---------------------------------
    SELECT CASE(IELTYPE)
    CASE(1)
!-----------------------
!*** MIXED PLANE STRAIN
!-----------------------
      DO ID=1,2
        ALPHA(ID)=0.0D00
      END DO
      CALL STRAIN2D3NMINI(OLDTHICK,NEWTHICK,SQRTM,OLDFRAME,XI,RNA,RNB,ALPHA,PROPOSEDGRAD,RELATIVESTRAIN,DRELATIVESTRAIN(1:4,1:8),D2RELATIVESTRAIN(1:4,1:8,1:8))
    CASE(2)
!-----------------
!*** PLANE STRESS
!-----------------
      RNB=RNO
      GPHIST(7:12,1:NMGA,IELEM,1:2)=0.0D00 
      newthick=oldthick
      CALL strain2deikonal(sqrtm,xi,rnb,rna,relativestrain(1:4),drelativestrain(1:4,1:6),d2relativestrain(1:4,1:6,1:6))
!      CALL STRAIN2D3NSTD(OLDTHICK,NEWTHICK,SQRTM,OLDFRAME,XI,RNA,RNB,PROPOSEDGRAD,RELATIVESTRAIN(1:4),DRELATIVESTRAIN(1:4,1:6),D2RELATIVESTRAIN(1:4,1:6,1:6))
      OLDSTRAIN=0.0D00
      RELATIVESTRAIN=RELATIVESTRAIN-OLDSTRAIN
      PROPOSEDGRAD=0.0D00
      DO I=1,3
        PROPOSEDGRAD(I,I)=1.0D00
      END DO
    CASE(3)
!-----------------
!*** AXISYMMETRIC
!-----------------
      CALL STRAIN2D3NAXI(SQRTM,OLDFRAME,XI,RNA,RNB,PROPOSEDGRAD,RELATIVESTRAIN,DRELATIVESTRAIN(1:4,1:6),D2RELATIVESTRAIN(1:4,1:6,1:6))
    END SELECT
!----------------------------
!*** VOLUME
!*** OF GAUSS POINT AND MESH
!----------------------------
    VOL=W*ABS(SQRTM)!*OLDTHICK
    VOLMESH=VOLMESH+VOL
    V2=0.0D00
    DO ID=1,2
      DO IN=1,3
        V2(ID)=V2(ID)+FFOR(IN)*VEL(IN,ID)
      END DO
    END DO
    KINETICENERGY=KINETICENERGY+0.5D00*(V2(1)**2+V2(2)**2)*RHO*VOL
!----------------------
!*** CONSTITUTIVE CALL
!----------------------
    OLDTEMPERATURE=DOTPROD(3,FFOR,TEMPO)
    NEWTEMPERATURE=DOTPROD(3,FFOR,TEMPN)
    IHYPER=1
    IPLAST=1
    xi3=0.0d00
    CALL NEWRIDICULOUS4(IGAUSINPUT,IELEM,IHYPER,IPLAST,XI3,NEWFRAME,1.0d00,OLDSTRAIN,RELATIVESTRAIN,PSI,EQUILIBRIUMSTRESS,DSTRESSDSTRAIN)
!--------------------------------
!*** EXTERNAL AND INTERNAL FORCES
!*** AND STIFNESS
!--------------------------------
    IF(IELTYPE.EQ.2.OR.IELTYPE.EQ.3)THEN
      CALL arrays2d3neikonal(vol,drelativestrain(1:4,1:6),d2relativestrain(1:4,1:6,1:6),equilibriumstress,dstressdstrain,efor(1:6),emat(1:6,1:6))
!!      WRITE(*,*)"VECLOAD,ffor,vol",vecload,ffor,vol
!!      CALL ARRAYS2D3NSTD(VOL,RHO,VECLOAD,ACC,DERIVATIVEACEL(),FFOR(1:3),DRELATIVESTRAIN(1:4,1:6),D2RELATIVESTRAIN(1:4,1:6,1:6),EQUILIBRIUMSTRESS,DSTRESSDSTRAIN,EFOR(1:6),EMAT(1:6,1:6))
      DO in=1,3
        DO id=1,2
          ig=in*2-2+id
!!          efor(ig)=efor(ig)-vol*ffor(in)*vecload(id)
        END DO
      END DO
    ELSE
      IF(dtime.GT.1.0d-20)THEN
        der=derivativeacel()
      ELSE
        der=0.00d00
      END IF
      CALL ARRAYS2D3NMINI(VOL,RHO,VECLOAD,ACC,der,FFOR(1:4),DRELATIVESTRAIN(1:4,1:8),D2RELATIVESTRAIN(1:4,1:8,1:8),EQUILIBRIUMSTRESS,PRESSN(1:3),DSTRESSDSTRAIN,EFOR(1:11),EMAT(1:11,1:11))
    END IF
  END DO
!  WRITE(*,*)"VECLOAD",vecload
!  READ(*,*)
!---------------------------------------------
!*** STATIC CONDENSATION FOR PLANE STRAIN CASE
!---------------------------------------------
  IF(IELTYPE.EQ.1)THEN
    CALL CONDEST(EFOR(1:11),EMAT(1:11,1:11),11,2,IERR)
  END IF
!--------------  
!*** ASSEMBLING
!--------------
  IK=0
  DO IN=1,3
    DO ID=1,2
      IK=IK+1
      LNODS(IK)=ELNO(ELNI(IELEM)-1+IN)
      LTYPS(IK)=ID
    END DO
    IF(IELTYPE.EQ.1)THEN
      IK=IK+1
      LNODS(IK)=ELNO(ELNI(IELEM)-1+IN)
      LTYPS(IK)=7
    END IF
  END DO
!---------------------------
!*** PENALTY IN AXISYMMETRIC
!---------------------------
  IF(IELTYPE.EQ.3)THEN
    DO IN=1,3
      INO=ELNO(ELNI(IELEM)-1+IN)  
      IF(ABS(NOCO(1,INO)).LE.1.0D-12)THEN
        RPEN=MAX(EMAT(1,1),EMAT(2,2),EMAT(3,3),EMAT(4,4),EMAT(5,5),EMAT(6,6))
        RPEN=1.0D3*RPEN
        EFOR(IN*2-1)=EFOR(IN*2-1)+RPEN*RNA(IN,1)
        EMAT(IN*2-1,IN*2-1)=EMAT(IN*2-1,IN*2-1)+RPEN
      END IF
    END DO
  END IF
!--------------------
!*** SENDS TO STORAGE
!--------------------
  IF(IELTYPE.EQ.1)THEN
    CALL STORE(IELEM,9,LNODS,LTYPS,EFOR,EMAT(1:9,1:9))     
  ELSE
    CALL STORE(IELEM,6,LNODS,LTYPS,EFOR,EMAT(1:6,1:6))
  END IF
END SUBROUTINE ELM_TRIPLANE

!--------------
!*** DIFF 2D
!--------------
SUBROUTINE DIFF2D(VOL,LENGTH,XNB,XI,GAUSSVAR,VAR,FORCE,STIFFNESS)
  IMPLICIT NONE
  DOUBLE PRECISION V(69),VOL,LENGTH,XNB(3,2),XI(2),GAUSSVAR,VAR(3),FORCE(3),STIFFNESS(3,3)
  V(63)=XI(1)*XI(2)
  V(57)=LENGTH**2
  V(56)=-(VAR(3)*XI(2))
  V(55)=-(VAR(2)*XI(1))
  V(54)=1D0-XI(1)-XI(2)
  V(53)=XNB(1,1)*XNB(2,2)
  V(52)=-(XNB(1,2)*XNB(2,1))
  V(39)=-XNB(1,1)+XNB(2,1)
  V(43)=XNB(1,2)-XNB(2,2)
  V(38)=XNB(1,1)-XNB(3,1)
  V(48)=V(52)+V(53)+V(43)*XNB(3,1)+V(39)*XNB(3,2)
  V(62)=V(48)*V(54)
  V(61)=-(VOL/V(48))
  V(58)=V(48)*VAR(1)
  V(42)=-XNB(1,2)+XNB(3,2)
  V(34)=GAUSSVAR+V(55)+V(56)-V(54)*VAR(1)
  V(37)=-((V(38)+V(39))/V(48))
  V(40)=(V(37)*V(58)+V(38)*VAR(2)+V(39)*VAR(3))/V(48)
  V(59)=V(40)/V(48)
  V(41)=-((V(42)+V(43))/V(48))
  V(44)=(V(41)*V(58)+V(42)*VAR(2)+V(43)*VAR(3))/V(48)
  V(60)=V(44)/V(48)
  FORCE(1)=FORCE(1)+(V(34)*V(54)-(V(37)*V(40)+V(41)*V(44))*V(57))*VOL
  FORCE(2)=FORCE(2)+VOL*(-(V(57)*(V(38)*V(59)+V(42)*V(60)))+V(34)*XI(1))
  FORCE(3)=FORCE(3)+VOL*(-(V(57)*(V(39)*V(59)+V(43)*V(60)))+V(34)*XI(2))
  V(46)=V(61)*((V(37)*V(38)+V(41)*V(42))*V(57)+V(62)*XI(1))
  V(47)=V(61)*((V(37)*V(39)+V(41)*V(43))*V(57)+V(62)*XI(2))
  V(49)=1D0/V(48)**2
  V(64)=V(49)*V(57)
  V(50)=-((V(63)+(V(38)*V(39)+V(42)*V(43))*V(64))*VOL)
  STIFFNESS(1,1)=STIFFNESS(1,1)+(-(V(54)*V(54))-((V(37)*V(37))+(V(41)*V(41)))*V(57))*VOL
  STIFFNESS(1,2)=STIFFNESS(1,2)+V(46)
  STIFFNESS(1,3)=STIFFNESS(1,3)+V(47)
  STIFFNESS(2,1)=STIFFNESS(2,1)+V(46)
  STIFFNESS(2,2)=STIFFNESS(2,2)+VOL*((-(V(38)*V(38))-(V(42)*V(42)))*V(64)-XI(1)**2)
  STIFFNESS(2,3)=STIFFNESS(2,3)+V(50)
  STIFFNESS(3,1)=STIFFNESS(3,1)+V(47)
  STIFFNESS(3,2)=STIFFNESS(3,2)+V(50)
  STIFFNESS(3,3)=STIFFNESS(3,3)+VOL*((-(V(39)*V(39))-(V(43)*V(43)))*V(64)-XI(2)**2)
END SUBROUTINE DIFF2D

!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           8 Nov 22 14:57:01  *
!**************************************************************
! User     : Full professional version
! Notebook : torsion2d
! Evaluation time                 : 5 s     Mode  : Optimal
! Number of formulae              : 22      Method: Automatic
! Subroutine                      : torsion2d size: 566
! Total size of Mathematica  code : 566 subexpressions
! Total size of Fortran code      : 1429 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE torsion2d(vol,rhs,xnb,xi,gaussvar,var,force,stiffness)
  IMPLICIT NONE
  DOUBLE PRECISION v(64),vol,rhs,xnb(3,2),xi(2),gaussvar,var(3),force(3),stiffness(3,3)
  v(54)=-xnb(1,2)+xnb(3,2)
  v(53)=xnb(1,1)*xnb(2,2)
  v(52)=-(xnb(1,2)*xnb(2,1))
  v(51)=xnb(1,1)-xnb(3,1)
  v(50)=xnb(1,2)-xnb(2,2)
  v(49)=-xnb(1,1)+xnb(2,1)
  v(45)=v(52)+v(53)+v(50)*xnb(3,1)+v(49)*xnb(3,2)
  v(58)=vol/v(45)
  v(55)=v(45)*var(1)
  v(34)=-((v(49)+v(51))/v(45))
  v(37)=(v(34)*v(55)+v(51)*var(2)+v(49)*var(3))/v(45)
  v(56)=v(37)/v(45)
  v(38)=-((v(50)+v(54))/v(45))
  v(41)=(v(38)*v(55)+v(54)*var(2)+v(50)*var(3))/v(45)
  v(57)=v(41)/v(45)
  force(1)=force(1)+vol*(v(34)*v(37)+v(38)*v(41)-rhs*(1d0-xi(1)-xi(2)))
  force(2)=force(2)+vol*(v(51)*v(56)+v(54)*v(57)-rhs*xi(1))
  force(3)=force(3)+vol*(v(49)*v(56)+v(50)*v(57)-rhs*xi(2))
  v(43)=(v(34)*v(51)+v(38)*v(54))*v(58)
  v(44)=(v(34)*v(49)+v(38)*v(50))*v(58)
  v(46)=1d0/v(45)**2
  v(59)=v(46)*vol
  v(47)=(v(49)*v(51)+v(50)*v(54))*v(59)
  stiffness(1,1)=stiffness(1,1)+((v(34)*v(34))+(v(38)*v(38)))*vol
  stiffness(1,2)=stiffness(1,2)+v(43)
  stiffness(1,3)=stiffness(1,3)+v(44)
  stiffness(2,1)=stiffness(2,1)+v(43)
  stiffness(2,2)=stiffness(2,2)+((v(51)*v(51))+(v(54)*v(54)))*v(59)
  stiffness(2,3)=stiffness(2,3)+v(47)
  stiffness(3,1)=stiffness(3,1)+v(44)
  stiffness(3,2)=stiffness(3,2)+v(47)
  stiffness(3,3)=stiffness(3,3)+((v(49)*v(49))+(v(50)*v(50)))*v(59)
END SUBROUTINE torsion2d

!-----------------
!*** UNIQUE FRAME
!*** FOR TRIANGLES
!-----------------
SUBROUTINE FRAME2D3N(RNB,RB)
  USE BASFUN  
  IMPLICIT REAL(8)(A-H,O-Z)
  REAL(8),DIMENSION(3,2)::RNB
  REAL(8),DIMENSION(3,3)::RB
  REAL(8),DIMENSION(3)::W1,W2
  W1(3)=0.0D00
  W2(3)=0.0D00
  W1(1:2)=RNB(1,1:2)-RNB(3,1:2)
  W2(1:2)=RNB(2,1:2)-RNB(3,1:2)
  CALL ORTHG(W1,W2,RB(1:3,1),RB(1:3,2),RB(1:3,3))
END SUBROUTINE FRAME2D3N

!---------------------------
!*** STRAIN FOR AXI TRIANGLE
!---------------------------
SUBROUTINE STRAIN2D3NAXI(SQRTMTRUE,OLDFRAME,XI,RNA,RNB,PROPOSEDGRAD,RELATIVESTRAIN,DRELATIVESTRAIN,D2RELATIVESTRAIN)
  IMPLICIT NONE
  DOUBLE PRECISION V(541),SQRTMTRUE,OLDFRAME(3,3),XI(2),RNA(3,2),RNB(3,2),PROPOSEDGRAD(3,3),RELATIVESTRAIN(4)&
      &,DRELATIVESTRAIN(4,6),D2RELATIVESTRAIN(4,6,6)
  V(512)=OLDFRAME(1,1)**2
  V(510)=OLDFRAME(2,1)**2
  V(508)=SQRT(1D0)
  V(514)=V(508)*V(512)
  V(509)=OLDFRAME(2,1)*V(508)
  V(506)=OLDFRAME(3,2)*OLDFRAME(3,3)
  V(505)=RNA(1,1)+RNA(2,1)+RNA(3,1)
  V(503)=RNB(1,1)+RNB(2,1)+4D0*RNB(3,1)
  V(502)=4D0*RNB(1,1)+RNB(2,1)+RNB(3,1)
  V(501)=RNB(1,1)+4D0*RNB(2,1)+RNB(3,1)
  V(500)=OLDFRAME(3,3)**2
  V(499)=OLDFRAME(3,2)**2
  V(498)=OLDFRAME(3,1)**2
  V(208)=-RNA(1,1)+RNA(2,1)
  V(209)=-RNA(1,1)+RNA(3,1)
  V(210)=-RNA(1,2)+RNA(2,2)
  V(211)=-RNA(1,2)+RNA(3,2)
  V(212)=-RNB(1,1)+RNB(2,1)
  V(213)=-RNB(1,1)+RNB(3,1)
  V(214)=-RNB(1,2)+RNB(2,2)
  V(215)=-RNB(1,2)+RNB(3,2)
  V(216)=-(V(213)*V(214))+V(212)*V(215)
  V(217)=V(215)/V(216)
  V(517)=V(217)*V(508)
  V(218)=-(V(213)/V(216))
  V(513)=V(218)*V(508)
  V(219)=-(V(214)/V(216))
  V(516)=V(219)*V(508)
  V(261)=-V(217)-V(219)
  V(518)=V(261)*V(508)
  V(220)=V(212)/V(216)
  V(511)=V(220)*V(508)
  V(262)=-V(218)-V(220)
  V(515)=V(262)*V(508)
  V(221)=V(208)*V(217)+V(209)*V(219)
  V(222)=V(208)*V(218)+V(209)*V(220)
  V(223)=V(210)*V(217)+V(211)*V(219)
  V(224)=V(210)*V(218)+V(211)*V(220)
  V(232)=0.17453292519943295D0*V(216)
  V(264)=1D0/(V(232)*(V(501)+V(502)+V(503)))
  V(265)=6D0*V(232)*V(264)
  V(504)=OLDFRAME(3,1)*V(265)
  V(364)=V(265)*V(500)
  V(348)=V(265)*V(498)
  V(310)=V(265)*V(499)
  V(270)=OLDFRAME(3,2)*V(504)
  V(269)=OLDFRAME(3,3)*V(504)
  V(268)=V(265)*V(506)
  V(235)=V(265)*V(505)
  V(507)=OLDFRAME(3,1)*V(235)
  V(250)=V(235)*V(506)
  V(249)=OLDFRAME(3,3)*V(507)
  V(241)=OLDFRAME(3,2)*V(507)
  V(332)=V(219)*V(509)
  V(330)=V(217)*V(509)
  V(328)=V(261)*V(509)
  V(352)=OLDFRAME(1,1)*V(332)+V(510)*V(511)
  V(325)=OLDFRAME(1,1)*V(511)
  V(351)=OLDFRAME(2,1)*V(325)+V(348)+V(219)*V(514)
  V(350)=OLDFRAME(1,1)*V(330)+V(510)*V(513)
  V(323)=OLDFRAME(1,1)*V(513)
  V(349)=OLDFRAME(2,1)*V(323)+V(348)+V(217)*V(514)
  V(347)=OLDFRAME(1,1)*V(328)+V(510)*V(515)
  V(321)=OLDFRAME(1,1)*V(515)
  V(346)=OLDFRAME(2,1)*V(321)+V(348)+V(261)*V(514)
  V(306)=OLDFRAME(2,2)*V(516)
  V(305)=OLDFRAME(1,2)*V(516)
  V(341)=OLDFRAME(1,1)*V(305)
  V(519)=V(270)+V(341)
  V(342)=OLDFRAME(2,2)*V(325)+V(519)
  V(304)=OLDFRAME(2,2)*V(517)
  V(303)=OLDFRAME(1,2)*V(517)
  V(337)=OLDFRAME(1,1)*V(303)
  V(520)=V(270)+V(337)
  V(338)=OLDFRAME(2,2)*V(323)+V(520)
  V(302)=OLDFRAME(2,2)*V(518)
  V(301)=OLDFRAME(1,2)*V(518)
  V(333)=OLDFRAME(1,1)*V(301)
  V(521)=V(270)+V(333)
  V(334)=OLDFRAME(2,2)*V(321)+V(521)
  V(300)=OLDFRAME(2,2)*V(511)
  V(343)=OLDFRAME(2,1)*V(300)
  V(344)=OLDFRAME(1,2)*V(332)+V(343)
  V(320)=OLDFRAME(1,1)*V(306)+V(343)
  V(314)=OLDFRAME(2,2)*V(300)+OLDFRAME(1,2)*V(306)
  V(299)=OLDFRAME(1,2)*V(511)
  V(319)=OLDFRAME(2,1)*V(299)+V(519)
  V(313)=OLDFRAME(2,2)*V(299)+OLDFRAME(1,2)*V(305)+V(310)
  V(298)=OLDFRAME(2,2)*V(513)
  V(339)=OLDFRAME(2,1)*V(298)
  V(340)=OLDFRAME(1,2)*V(330)+V(339)
  V(318)=OLDFRAME(1,1)*V(304)+V(339)
  V(312)=OLDFRAME(2,2)*V(298)+OLDFRAME(1,2)*V(304)
  V(297)=OLDFRAME(1,2)*V(513)
  V(317)=OLDFRAME(2,1)*V(297)+V(520)
  V(311)=OLDFRAME(2,2)*V(297)+OLDFRAME(1,2)*V(303)+V(310)
  V(296)=OLDFRAME(2,2)*V(515)
  V(335)=OLDFRAME(2,1)*V(296)
  V(336)=OLDFRAME(1,2)*V(328)+V(335)
  V(316)=OLDFRAME(1,1)*V(302)+V(335)
  V(309)=OLDFRAME(2,2)*V(296)+OLDFRAME(1,2)*V(302)
  V(295)=OLDFRAME(1,2)*V(515)
  V(315)=OLDFRAME(2,1)*V(295)+V(521)
  V(308)=OLDFRAME(2,2)*V(295)+OLDFRAME(1,2)*V(301)+V(310)
  V(282)=OLDFRAME(2,3)*V(516)
  V(281)=OLDFRAME(1,3)*V(516)
  V(378)=OLDFRAME(1,1)*V(281)
  V(522)=V(269)+V(378)
  V(379)=OLDFRAME(2,3)*V(325)+V(522)
  V(376)=OLDFRAME(1,2)*V(281)
  V(523)=V(268)+V(376)
  V(377)=OLDFRAME(2,3)*V(299)+V(523)
  V(280)=OLDFRAME(2,3)*V(517)
  V(279)=OLDFRAME(1,3)*V(517)
  V(368)=OLDFRAME(1,1)*V(279)
  V(524)=V(269)+V(368)
  V(369)=OLDFRAME(2,3)*V(323)+V(524)
  V(366)=OLDFRAME(1,2)*V(279)
  V(525)=V(268)+V(366)
  V(367)=OLDFRAME(2,3)*V(297)+V(525)
  V(278)=OLDFRAME(2,3)*V(518)
  V(277)=OLDFRAME(1,3)*V(518)
  V(357)=OLDFRAME(1,1)*V(277)
  V(526)=V(269)+V(357)
  V(358)=OLDFRAME(2,3)*V(321)+V(526)
  V(355)=OLDFRAME(1,2)*V(277)
  V(527)=V(268)+V(355)
  V(356)=OLDFRAME(2,3)*V(295)+V(527)
  V(276)=OLDFRAME(2,3)*V(511)
  V(383)=OLDFRAME(2,1)*V(276)
  V(384)=OLDFRAME(1,3)*V(332)+V(383)
  V(381)=OLDFRAME(2,2)*V(276)
  V(382)=OLDFRAME(1,3)*V(306)+V(381)
  V(380)=OLDFRAME(2,3)*V(276)+OLDFRAME(1,3)*V(282)
  V(294)=OLDFRAME(1,1)*V(282)+V(383)
  V(288)=OLDFRAME(1,2)*V(282)+V(381)
  V(275)=OLDFRAME(1,3)*V(511)
  V(375)=OLDFRAME(2,3)*V(275)+OLDFRAME(1,3)*V(281)+V(364)
  V(293)=OLDFRAME(2,1)*V(275)+V(522)
  V(287)=OLDFRAME(2,2)*V(275)+V(523)
  V(274)=OLDFRAME(2,3)*V(513)
  V(373)=OLDFRAME(2,1)*V(274)
  V(374)=OLDFRAME(1,3)*V(330)+V(373)
  V(371)=OLDFRAME(2,2)*V(274)
  V(372)=OLDFRAME(1,3)*V(304)+V(371)
  V(370)=OLDFRAME(2,3)*V(274)+OLDFRAME(1,3)*V(280)
  V(292)=OLDFRAME(1,1)*V(280)+V(373)
  V(286)=OLDFRAME(1,2)*V(280)+V(371)
  V(273)=OLDFRAME(1,3)*V(513)
  V(365)=OLDFRAME(2,3)*V(273)+OLDFRAME(1,3)*V(279)+V(364)
  V(291)=OLDFRAME(2,1)*V(273)+V(524)
  V(285)=OLDFRAME(2,2)*V(273)+V(525)
  V(272)=OLDFRAME(2,3)*V(515)
  V(362)=OLDFRAME(2,1)*V(272)
  V(363)=OLDFRAME(1,3)*V(328)+V(362)
  V(360)=OLDFRAME(2,2)*V(272)
  V(361)=OLDFRAME(1,3)*V(302)+V(360)
  V(359)=OLDFRAME(2,3)*V(272)+OLDFRAME(1,3)*V(278)
  V(290)=OLDFRAME(1,1)*V(278)+V(362)
  V(284)=OLDFRAME(1,2)*V(278)+V(360)
  V(271)=OLDFRAME(1,3)*V(515)
  V(354)=OLDFRAME(2,3)*V(271)+OLDFRAME(1,3)*V(277)+V(364)
  V(289)=OLDFRAME(2,1)*V(271)+V(526)
  V(283)=OLDFRAME(2,2)*V(271)+V(527)
  V(247)=(OLDFRAME(1,3)*V(222)+OLDFRAME(2,3)*V(224))*V(508)
  V(246)=(OLDFRAME(1,3)*V(221)+OLDFRAME(2,3)*V(223))*V(508)
  V(258)=OLDFRAME(1,3)*V(246)+OLDFRAME(2,3)*V(247)+V(235)*V(500)
  V(534)=2D0*V(258)
  V(254)=OLDFRAME(1,2)*V(246)+OLDFRAME(2,2)*V(247)+V(250)
  V(531)=2D0*V(254)
  V(245)=OLDFRAME(1,1)*V(246)+OLDFRAME(2,1)*V(247)+V(249)
  V(528)=2D0*V(245)
  V(244)=(OLDFRAME(1,2)*V(222)+OLDFRAME(2,2)*V(224))*V(508)
  V(243)=(OLDFRAME(1,2)*V(221)+OLDFRAME(2,2)*V(223))*V(508)
  V(257)=OLDFRAME(1,3)*V(243)+OLDFRAME(2,3)*V(244)+V(250)
  V(535)=2D0*V(257)
  V(253)=OLDFRAME(1,2)*V(243)+OLDFRAME(2,2)*V(244)+V(235)*V(499)
  V(532)=2D0*V(253)
  V(242)=V(241)+OLDFRAME(1,1)*V(243)+OLDFRAME(2,1)*V(244)
  V(529)=2D0*V(242)
  V(240)=(OLDFRAME(1,1)*V(222)+OLDFRAME(2,1)*V(224))*V(508)
  V(239)=(OLDFRAME(1,1)*V(221)+OLDFRAME(2,1)*V(223))*V(508)
  V(256)=OLDFRAME(1,3)*V(239)+OLDFRAME(2,3)*V(240)+V(249)
  V(536)=2D0*V(256)
  V(252)=OLDFRAME(1,2)*V(239)+OLDFRAME(2,2)*V(240)+V(241)
  V(533)=2D0*V(252)
  V(238)=OLDFRAME(1,1)*V(239)+OLDFRAME(2,1)*V(240)+V(235)*V(498)
  V(530)=2D0*V(238)
  V(410)=V(289)*V(290)+V(315)*V(316)+V(346)*V(347)
  V(411)=V(289)*V(291)+V(315)*V(317)+V(346)*V(349)
  V(412)=V(289)*V(292)+V(315)*V(318)+V(346)*V(350)
  V(413)=V(289)*V(293)+V(315)*V(319)+V(346)*V(351)
  V(414)=V(289)*V(294)+V(315)*V(320)+V(346)*V(352)
  V(416)=V(283)*V(284)+V(308)*V(309)+V(334)*V(336)
  V(417)=V(283)*V(285)+V(308)*V(311)+V(334)*V(338)
  V(418)=V(283)*V(286)+V(308)*V(312)+V(334)*V(340)
  V(419)=V(283)*V(287)+V(308)*V(313)+V(334)*V(342)
  V(420)=V(283)*V(288)+V(308)*V(314)+V(334)*V(344)
  V(422)=V(354)*V(359)+V(356)*V(361)+V(358)*V(363)
  V(423)=V(354)*V(365)+V(356)*V(367)+V(358)*V(369)
  V(424)=V(354)*V(370)+V(356)*V(372)+V(358)*V(374)
  V(425)=V(354)*V(375)+V(356)*V(377)+V(358)*V(379)
  V(426)=V(354)*V(380)+V(356)*V(382)+V(358)*V(384)
  V(428)=V(284)*V(289)+V(283)*V(290)+V(309)*V(315)+V(308)*V(316)+V(336)*V(346)+V(334)*V(347)
  V(429)=V(285)*V(289)+V(283)*V(291)+V(311)*V(315)+V(308)*V(317)+V(338)*V(346)+V(334)*V(349)
  V(430)=V(286)*V(289)+V(283)*V(292)+V(312)*V(315)+V(308)*V(318)+V(340)*V(346)+V(334)*V(350)
  V(431)=V(287)*V(289)+V(283)*V(293)+V(313)*V(315)+V(308)*V(319)+V(342)*V(346)+V(334)*V(351)
  V(432)=V(288)*V(289)+V(283)*V(294)+V(314)*V(315)+V(308)*V(320)+V(344)*V(346)+V(334)*V(352)
  V(434)=V(290)*V(291)+V(316)*V(317)+V(347)*V(349)
  V(435)=V(290)*V(292)+V(316)*V(318)+V(347)*V(350)
  V(436)=V(290)*V(293)+V(316)*V(319)+V(347)*V(351)
  V(437)=V(290)*V(294)+V(316)*V(320)+V(347)*V(352)
  V(439)=V(284)*V(285)+V(309)*V(311)+V(336)*V(338)
  V(440)=V(284)*V(286)+V(309)*V(312)+V(336)*V(340)
  V(441)=V(284)*V(287)+V(309)*V(313)+V(336)*V(342)
  V(442)=V(284)*V(288)+V(309)*V(314)+V(336)*V(344)
  V(444)=V(359)*V(365)+V(361)*V(367)+V(363)*V(369)
  V(445)=V(359)*V(370)+V(361)*V(372)+V(363)*V(374)
  V(446)=V(359)*V(375)+V(361)*V(377)+V(363)*V(379)
  V(447)=V(359)*V(380)+V(361)*V(382)+V(363)*V(384)
  V(449)=V(285)*V(290)+V(284)*V(291)+V(311)*V(316)+V(309)*V(317)+V(338)*V(347)+V(336)*V(349)
  V(450)=V(286)*V(290)+V(284)*V(292)+V(312)*V(316)+V(309)*V(318)+V(340)*V(347)+V(336)*V(350)
  V(451)=V(287)*V(290)+V(284)*V(293)+V(313)*V(316)+V(309)*V(319)+V(342)*V(347)+V(336)*V(351)
  V(452)=V(288)*V(290)+V(284)*V(294)+V(314)*V(316)+V(309)*V(320)+V(344)*V(347)+V(336)*V(352)
  V(454)=V(291)*V(292)+V(317)*V(318)+V(349)*V(350)
  V(455)=V(291)*V(293)+V(317)*V(319)+V(349)*V(351)
  V(456)=V(291)*V(294)+V(317)*V(320)+V(349)*V(352)
  V(458)=V(285)*V(286)+V(311)*V(312)+V(338)*V(340)
  V(459)=V(285)*V(287)+V(311)*V(313)+V(338)*V(342)
  V(460)=V(285)*V(288)+V(311)*V(314)+V(338)*V(344)
  V(462)=V(365)*V(370)+V(367)*V(372)+V(369)*V(374)
  V(463)=V(365)*V(375)+V(367)*V(377)+V(369)*V(379)
  V(464)=V(365)*V(380)+V(367)*V(382)+V(369)*V(384)
  V(466)=V(286)*V(291)+V(285)*V(292)+V(312)*V(317)+V(311)*V(318)+V(340)*V(349)+V(338)*V(350)
  V(467)=V(287)*V(291)+V(285)*V(293)+V(313)*V(317)+V(311)*V(319)+V(342)*V(349)+V(338)*V(351)
  V(468)=V(288)*V(291)+V(285)*V(294)+V(314)*V(317)+V(311)*V(320)+V(344)*V(349)+V(338)*V(352)
  V(470)=V(292)*V(293)+V(318)*V(319)+V(350)*V(351)
  V(471)=V(292)*V(294)+V(318)*V(320)+V(350)*V(352)
  V(473)=V(286)*V(287)+V(312)*V(313)+V(340)*V(342)
  V(474)=V(286)*V(288)+V(312)*V(314)+V(340)*V(344)
  V(476)=V(370)*V(375)+V(372)*V(377)+V(374)*V(379)
  V(477)=V(370)*V(380)+V(372)*V(382)+V(374)*V(384)
  V(479)=V(287)*V(292)+V(286)*V(293)+V(313)*V(318)+V(312)*V(319)+V(342)*V(350)+V(340)*V(351)
  V(480)=V(288)*V(292)+V(286)*V(294)+V(314)*V(318)+V(312)*V(320)+V(344)*V(350)+V(340)*V(352)
  V(482)=V(293)*V(294)+V(319)*V(320)+V(351)*V(352)
  V(484)=V(287)*V(288)+V(313)*V(314)+V(342)*V(344)
  V(486)=V(375)*V(380)+V(377)*V(382)+V(379)*V(384)
  V(488)=V(288)*V(293)+V(287)*V(294)+V(314)*V(319)+V(313)*V(320)+V(344)*V(351)+V(342)*V(352)
  SQRTMTRUE=36D0*V(232)*(RNB(2,1)*XI(1)+RNB(3,1)*XI(2)-RNB(1,1)*((-1D0)+XI(1)+XI(2)))
  PROPOSEDGRAD(1,1)=V(238)
  PROPOSEDGRAD(1,2)=V(252)
  PROPOSEDGRAD(1,3)=V(256)
  PROPOSEDGRAD(2,1)=V(242)
  PROPOSEDGRAD(2,2)=V(253)
  PROPOSEDGRAD(2,3)=V(257)
  PROPOSEDGRAD(3,1)=V(245)
  PROPOSEDGRAD(3,2)=V(254)
  PROPOSEDGRAD(3,3)=V(258)
  RELATIVESTRAIN(1)=((-1D0)+(V(238)*V(238))+(V(242)*V(242))+(V(245)*V(245)))/2D0
  RELATIVESTRAIN(2)=((-1D0)+(V(252)*V(252))+(V(253)*V(253))+(V(254)*V(254)))/2D0
  RELATIVESTRAIN(3)=((-1D0)+(V(256)*V(256))+(V(257)*V(257))+(V(258)*V(258)))/2D0
  RELATIVESTRAIN(4)=V(238)*V(252)+V(242)*V(253)+V(245)*V(254)
  DRELATIVESTRAIN(1,1)=(V(289)*V(528)+V(315)*V(529)+V(346)*V(530))/2D0
  DRELATIVESTRAIN(1,2)=(V(290)*V(528)+V(316)*V(529)+V(347)*V(530))/2D0
  DRELATIVESTRAIN(1,3)=(V(291)*V(528)+V(317)*V(529)+V(349)*V(530))/2D0
  DRELATIVESTRAIN(1,4)=(V(292)*V(528)+V(318)*V(529)+V(350)*V(530))/2D0
  DRELATIVESTRAIN(1,5)=(V(293)*V(528)+V(319)*V(529)+V(351)*V(530))/2D0
  DRELATIVESTRAIN(1,6)=(V(294)*V(528)+V(320)*V(529)+V(352)*V(530))/2D0
  DRELATIVESTRAIN(2,1)=(V(283)*V(531)+V(308)*V(532)+V(334)*V(533))/2D0
  DRELATIVESTRAIN(2,2)=(V(284)*V(531)+V(309)*V(532)+V(336)*V(533))/2D0
  DRELATIVESTRAIN(2,3)=(V(285)*V(531)+V(311)*V(532)+V(338)*V(533))/2D0
  DRELATIVESTRAIN(2,4)=(V(286)*V(531)+V(312)*V(532)+V(340)*V(533))/2D0
  DRELATIVESTRAIN(2,5)=(V(287)*V(531)+V(313)*V(532)+V(342)*V(533))/2D0
  DRELATIVESTRAIN(2,6)=(V(288)*V(531)+V(314)*V(532)+V(344)*V(533))/2D0
  DRELATIVESTRAIN(3,1)=(V(354)*V(534)+V(356)*V(535)+V(358)*V(536))/2D0
  DRELATIVESTRAIN(3,2)=(V(359)*V(534)+V(361)*V(535)+V(363)*V(536))/2D0
  DRELATIVESTRAIN(3,3)=(V(365)*V(534)+V(367)*V(535)+V(369)*V(536))/2D0
  DRELATIVESTRAIN(3,4)=(V(370)*V(534)+V(372)*V(535)+V(374)*V(536))/2D0
  DRELATIVESTRAIN(3,5)=(V(375)*V(534)+V(377)*V(535)+V(379)*V(536))/2D0
  DRELATIVESTRAIN(3,6)=(V(380)*V(534)+V(382)*V(535)+V(384)*V(536))/2D0
  DRELATIVESTRAIN(4,1)=V(245)*V(283)+V(254)*V(289)+V(242)*V(308)+V(253)*V(315)+V(238)*V(334)+V(252)*V(346)
  DRELATIVESTRAIN(4,2)=V(245)*V(284)+V(254)*V(290)+V(242)*V(309)+V(253)*V(316)+V(238)*V(336)+V(252)*V(347)
  DRELATIVESTRAIN(4,3)=V(245)*V(285)+V(254)*V(291)+V(242)*V(311)+V(253)*V(317)+V(238)*V(338)+V(252)*V(349)
  DRELATIVESTRAIN(4,4)=V(245)*V(286)+V(254)*V(292)+V(242)*V(312)+V(253)*V(318)+V(238)*V(340)+V(252)*V(350)
  DRELATIVESTRAIN(4,5)=V(245)*V(287)+V(254)*V(293)+V(242)*V(313)+V(253)*V(319)+V(238)*V(342)+V(252)*V(351)
  DRELATIVESTRAIN(4,6)=V(245)*V(288)+V(254)*V(294)+V(242)*V(314)+V(253)*V(320)+V(238)*V(344)+V(252)*V(352)
  D2RELATIVESTRAIN(1,1,1)=(V(289)*V(289))+(V(315)*V(315))+(V(346)*V(346))
  D2RELATIVESTRAIN(1,1,2)=V(410)
  D2RELATIVESTRAIN(1,1,3)=V(411)
  D2RELATIVESTRAIN(1,1,4)=V(412)
  D2RELATIVESTRAIN(1,1,5)=V(413)
  D2RELATIVESTRAIN(1,1,6)=V(414)
  D2RELATIVESTRAIN(1,2,1)=V(410)
  D2RELATIVESTRAIN(1,2,2)=(V(290)*V(290))+(V(316)*V(316))+(V(347)*V(347))
  D2RELATIVESTRAIN(1,2,3)=V(434)
  D2RELATIVESTRAIN(1,2,4)=V(435)
  D2RELATIVESTRAIN(1,2,5)=V(436)
  D2RELATIVESTRAIN(1,2,6)=V(437)
  D2RELATIVESTRAIN(1,3,1)=V(411)
  D2RELATIVESTRAIN(1,3,2)=V(434)
  D2RELATIVESTRAIN(1,3,3)=(V(291)*V(291))+(V(317)*V(317))+(V(349)*V(349))
  D2RELATIVESTRAIN(1,3,4)=V(454)
  D2RELATIVESTRAIN(1,3,5)=V(455)
  D2RELATIVESTRAIN(1,3,6)=V(456)
  D2RELATIVESTRAIN(1,4,1)=V(412)
  D2RELATIVESTRAIN(1,4,2)=V(435)
  D2RELATIVESTRAIN(1,4,3)=V(454)
  D2RELATIVESTRAIN(1,4,4)=(V(292)*V(292))+(V(318)*V(318))+(V(350)*V(350))
  D2RELATIVESTRAIN(1,4,5)=V(470)
  D2RELATIVESTRAIN(1,4,6)=V(471)
  D2RELATIVESTRAIN(1,5,1)=V(413)
  D2RELATIVESTRAIN(1,5,2)=V(436)
  D2RELATIVESTRAIN(1,5,3)=V(455)
  D2RELATIVESTRAIN(1,5,4)=V(470)
  D2RELATIVESTRAIN(1,5,5)=(V(293)*V(293))+(V(319)*V(319))+(V(351)*V(351))
  D2RELATIVESTRAIN(1,5,6)=V(482)
  D2RELATIVESTRAIN(1,6,1)=V(414)
  D2RELATIVESTRAIN(1,6,2)=V(437)
  D2RELATIVESTRAIN(1,6,3)=V(456)
  D2RELATIVESTRAIN(1,6,4)=V(471)
  D2RELATIVESTRAIN(1,6,5)=V(482)
  D2RELATIVESTRAIN(1,6,6)=(V(294)*V(294))+(V(320)*V(320))+(V(352)*V(352))
  D2RELATIVESTRAIN(2,1,1)=(V(283)*V(283))+(V(308)*V(308))+(V(334)*V(334))
  D2RELATIVESTRAIN(2,1,2)=V(416)
  D2RELATIVESTRAIN(2,1,3)=V(417)
  D2RELATIVESTRAIN(2,1,4)=V(418)
  D2RELATIVESTRAIN(2,1,5)=V(419)
  D2RELATIVESTRAIN(2,1,6)=V(420)
  D2RELATIVESTRAIN(2,2,1)=V(416)
  D2RELATIVESTRAIN(2,2,2)=(V(284)*V(284))+(V(309)*V(309))+(V(336)*V(336))
  D2RELATIVESTRAIN(2,2,3)=V(439)
  D2RELATIVESTRAIN(2,2,4)=V(440)
  D2RELATIVESTRAIN(2,2,5)=V(441)
  D2RELATIVESTRAIN(2,2,6)=V(442)
  D2RELATIVESTRAIN(2,3,1)=V(417)
  D2RELATIVESTRAIN(2,3,2)=V(439)
  D2RELATIVESTRAIN(2,3,3)=(V(285)*V(285))+(V(311)*V(311))+(V(338)*V(338))
  D2RELATIVESTRAIN(2,3,4)=V(458)
  D2RELATIVESTRAIN(2,3,5)=V(459)
  D2RELATIVESTRAIN(2,3,6)=V(460)
  D2RELATIVESTRAIN(2,4,1)=V(418)
  D2RELATIVESTRAIN(2,4,2)=V(440)
  D2RELATIVESTRAIN(2,4,3)=V(458)
  D2RELATIVESTRAIN(2,4,4)=(V(286)*V(286))+(V(312)*V(312))+(V(340)*V(340))
  D2RELATIVESTRAIN(2,4,5)=V(473)
  D2RELATIVESTRAIN(2,4,6)=V(474)
  D2RELATIVESTRAIN(2,5,1)=V(419)
  D2RELATIVESTRAIN(2,5,2)=V(441)
  D2RELATIVESTRAIN(2,5,3)=V(459)
  D2RELATIVESTRAIN(2,5,4)=V(473)
  D2RELATIVESTRAIN(2,5,5)=(V(287)*V(287))+(V(313)*V(313))+(V(342)*V(342))
  D2RELATIVESTRAIN(2,5,6)=V(484)
  D2RELATIVESTRAIN(2,6,1)=V(420)
  D2RELATIVESTRAIN(2,6,2)=V(442)
  D2RELATIVESTRAIN(2,6,3)=V(460)
  D2RELATIVESTRAIN(2,6,4)=V(474)
  D2RELATIVESTRAIN(2,6,5)=V(484)
  D2RELATIVESTRAIN(2,6,6)=(V(288)*V(288))+(V(314)*V(314))+(V(344)*V(344))
  D2RELATIVESTRAIN(3,1,1)=(V(354)*V(354))+(V(356)*V(356))+(V(358)*V(358))
  D2RELATIVESTRAIN(3,1,2)=V(422)
  D2RELATIVESTRAIN(3,1,3)=V(423)
  D2RELATIVESTRAIN(3,1,4)=V(424)
  D2RELATIVESTRAIN(3,1,5)=V(425)
  D2RELATIVESTRAIN(3,1,6)=V(426)
  D2RELATIVESTRAIN(3,2,1)=V(422)
  D2RELATIVESTRAIN(3,2,2)=(V(359)*V(359))+(V(361)*V(361))+(V(363)*V(363))
  D2RELATIVESTRAIN(3,2,3)=V(444)
  D2RELATIVESTRAIN(3,2,4)=V(445)
  D2RELATIVESTRAIN(3,2,5)=V(446)
  D2RELATIVESTRAIN(3,2,6)=V(447)
  D2RELATIVESTRAIN(3,3,1)=V(423)
  D2RELATIVESTRAIN(3,3,2)=V(444)
  D2RELATIVESTRAIN(3,3,3)=(V(365)*V(365))+(V(367)*V(367))+(V(369)*V(369))
  D2RELATIVESTRAIN(3,3,4)=V(462)
  D2RELATIVESTRAIN(3,3,5)=V(463)
  D2RELATIVESTRAIN(3,3,6)=V(464)
  D2RELATIVESTRAIN(3,4,1)=V(424)
  D2RELATIVESTRAIN(3,4,2)=V(445)
  D2RELATIVESTRAIN(3,4,3)=V(462)
  D2RELATIVESTRAIN(3,4,4)=(V(370)*V(370))+(V(372)*V(372))+(V(374)*V(374))
  D2RELATIVESTRAIN(3,4,5)=V(476)
  D2RELATIVESTRAIN(3,4,6)=V(477)
  D2RELATIVESTRAIN(3,5,1)=V(425)
  D2RELATIVESTRAIN(3,5,2)=V(446)
  D2RELATIVESTRAIN(3,5,3)=V(463)
  D2RELATIVESTRAIN(3,5,4)=V(476)
  D2RELATIVESTRAIN(3,5,5)=(V(375)*V(375))+(V(377)*V(377))+(V(379)*V(379))
  D2RELATIVESTRAIN(3,5,6)=V(486)
  D2RELATIVESTRAIN(3,6,1)=V(426)
  D2RELATIVESTRAIN(3,6,2)=V(447)
  D2RELATIVESTRAIN(3,6,3)=V(464)
  D2RELATIVESTRAIN(3,6,4)=V(477)
  D2RELATIVESTRAIN(3,6,5)=V(486)
  D2RELATIVESTRAIN(3,6,6)=(V(380)*V(380))+(V(382)*V(382))+(V(384)*V(384))
  D2RELATIVESTRAIN(4,1,1)=2D0*(V(283)*V(289)+V(308)*V(315)+V(334)*V(346))
  D2RELATIVESTRAIN(4,1,2)=V(428)
  D2RELATIVESTRAIN(4,1,3)=V(429)
  D2RELATIVESTRAIN(4,1,4)=V(430)
  D2RELATIVESTRAIN(4,1,5)=V(431)
  D2RELATIVESTRAIN(4,1,6)=V(432)
  D2RELATIVESTRAIN(4,2,1)=V(428)
  D2RELATIVESTRAIN(4,2,2)=2D0*(V(284)*V(290)+V(309)*V(316)+V(336)*V(347))
  D2RELATIVESTRAIN(4,2,3)=V(449)
  D2RELATIVESTRAIN(4,2,4)=V(450)
  D2RELATIVESTRAIN(4,2,5)=V(451)
  D2RELATIVESTRAIN(4,2,6)=V(452)
  D2RELATIVESTRAIN(4,3,1)=V(429)
  D2RELATIVESTRAIN(4,3,2)=V(449)
  D2RELATIVESTRAIN(4,3,3)=2D0*(V(285)*V(291)+V(311)*V(317)+V(338)*V(349))
  D2RELATIVESTRAIN(4,3,4)=V(466)
  D2RELATIVESTRAIN(4,3,5)=V(467)
  D2RELATIVESTRAIN(4,3,6)=V(468)
  D2RELATIVESTRAIN(4,4,1)=V(430)
  D2RELATIVESTRAIN(4,4,2)=V(450)
  D2RELATIVESTRAIN(4,4,3)=V(466)
  D2RELATIVESTRAIN(4,4,4)=2D0*(V(286)*V(292)+V(312)*V(318)+V(340)*V(350))
  D2RELATIVESTRAIN(4,4,5)=V(479)
  D2RELATIVESTRAIN(4,4,6)=V(480)
  D2RELATIVESTRAIN(4,5,1)=V(431)
  D2RELATIVESTRAIN(4,5,2)=V(451)
  D2RELATIVESTRAIN(4,5,3)=V(467)
  D2RELATIVESTRAIN(4,5,4)=V(479)
  D2RELATIVESTRAIN(4,5,5)=2D0*(V(287)*V(293)+V(313)*V(319)+V(342)*V(351))
  D2RELATIVESTRAIN(4,5,6)=V(488)
  D2RELATIVESTRAIN(4,6,1)=V(432)
  D2RELATIVESTRAIN(4,6,2)=V(452)
  D2RELATIVESTRAIN(4,6,3)=V(468)
  D2RELATIVESTRAIN(4,6,4)=V(480)
  D2RELATIVESTRAIN(4,6,5)=V(488)
  D2RELATIVESTRAIN(4,6,6)=2D0*(V(288)*V(294)+V(314)*V(320)+V(344)*V(352))
END SUBROUTINE STRAIN2D3NAXI

!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           21 Dec 21 21:02:44 *
!**************************************************************
! User     : Full professional version
! Notebook : strain2d3nstd
! Evaluation time                 : 7 s     Mode  : Prototype
! Number of formulae              : 282     Method: Automatic
! Subroutine                      : strain2d3nstd size: 5300
! Total size of Mathematica  code : 5300 subexpressions
! Total size of Fortran code      : 17147 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE strain2d3nstd(oldthick,newthick,sqrtm,oldframe,xi,rna,rnb,proposedgrad,relativestrain,drelativestrain&
    &,d2relativestrain)
  IMPLICIT NONE
  DOUBLE PRECISION v(473),oldthick,newthick,sqrtm,oldframe(3,3),xi(2),rna(3,2),rnb(3,2),proposedgrad(3,3)&
      &,relativestrain(4),drelativestrain(4,6),d2relativestrain(4,6,6)
  v(1)=oldthick
  v(2)=newthick
  v(4)=oldframe(1,1)
  v(5)=oldframe(1,2)
  v(6)=oldframe(1,3)
  v(7)=oldframe(2,1)
  v(8)=oldframe(2,2)
  v(9)=oldframe(2,3)
  v(10)=oldframe(3,1)
  v(11)=oldframe(3,2)
  v(227)=(v(10)*v(11)*v(2))/v(1)
  v(12)=oldframe(3,3)
  v(238)=(v(11)*v(12)*v(2))/v(1)
  v(237)=(v(10)*v(12)*v(2))/v(1)
  v(15)=rna(1,1)
  v(16)=rna(1,2)
  v(17)=rna(2,1)
  v(18)=rna(2,2)
  v(19)=rna(3,1)
  v(20)=rna(3,2)
  v(21)=rnb(1,1)
  v(22)=rnb(1,2)
  v(23)=rnb(2,1)
  v(24)=rnb(2,2)
  v(25)=rnb(3,1)
  v(26)=rnb(3,2)
  v(208)=v(15)-v(19)
  v(209)=v(17)-v(19)
  v(210)=v(16)-v(20)
  v(211)=v(18)-v(20)
  v(212)=v(21)-v(25)
  v(213)=v(23)-v(25)
  v(214)=v(22)-v(26)
  v(215)=v(24)-v(26)
  v(216)=-(v(213)*v(214))+v(212)*v(215)
  v(217)=v(215)/v(216)
  v(264)=v(217)*v(7)
  v(263)=v(217)*v(4)
  v(258)=v(217)*v(8)
  v(257)=v(217)*v(5)
  v(311)=v(257)*v(4)
  v(252)=v(217)*v(9)
  v(251)=v(217)*v(6)
  v(332)=v(251)*v(4)
  v(330)=v(251)*v(5)
  v(218)=-(v(213)/v(216))
  v(306)=v(218)*v(7)
  v(324)=v(264)*v(4)+v(306)*v(7)
  v(305)=v(218)*v(4)
  v(333)=v(332)+v(305)*v(9)
  v(323)=v(263)*v(4)+v(305)*v(7)
  v(312)=v(311)+v(305)*v(8)
  v(288)=v(218)*v(8)
  v(313)=v(288)*v(7)
  v(314)=v(313)+v(264)*v(5)
  v(300)=v(313)+v(258)*v(4)
  v(294)=v(258)*v(5)+v(288)*v(8)
  v(287)=v(218)*v(5)
  v(331)=v(330)+v(287)*v(9)
  v(299)=v(311)+v(287)*v(7)
  v(293)=v(257)*v(5)+v(287)*v(8)
  v(270)=v(218)*v(9)
  v(337)=v(270)*v(7)
  v(338)=v(337)+v(264)*v(6)
  v(335)=v(270)*v(8)
  v(336)=v(335)+v(258)*v(6)
  v(334)=v(252)*v(6)+v(270)*v(9)
  v(282)=v(337)+v(252)*v(4)
  v(276)=v(335)+v(252)*v(5)
  v(269)=v(218)*v(6)
  v(329)=v(251)*v(6)+v(269)*v(9)
  v(281)=v(332)+v(269)*v(7)
  v(275)=v(330)+v(269)*v(8)
  v(219)=-(v(214)/v(216))
  v(266)=v(219)*v(7)
  v(265)=v(219)*v(4)
  v(260)=v(219)*v(8)
  v(259)=v(219)*v(5)
  v(315)=v(259)*v(4)
  v(254)=v(219)*v(9)
  v(253)=v(219)*v(6)
  v(342)=v(253)*v(4)
  v(340)=v(253)*v(5)
  v(249)=-v(217)-v(219)
  v(268)=v(249)*v(7)
  v(267)=v(249)*v(4)
  v(262)=v(249)*v(8)
  v(261)=v(249)*v(5)
  v(319)=v(261)*v(4)
  v(256)=v(249)*v(9)
  v(255)=v(249)*v(6)
  v(352)=v(255)*v(4)
  v(350)=v(255)*v(5)
  v(220)=v(212)/v(216)
  v(308)=v(220)*v(7)
  v(326)=v(266)*v(4)+v(308)*v(7)
  v(307)=v(220)*v(4)
  v(343)=v(342)+v(307)*v(9)
  v(325)=v(265)*v(4)+v(307)*v(7)
  v(316)=v(315)+v(307)*v(8)
  v(290)=v(220)*v(8)
  v(317)=v(290)*v(7)
  v(318)=v(317)+v(266)*v(5)
  v(302)=v(317)+v(260)*v(4)
  v(296)=v(260)*v(5)+v(290)*v(8)
  v(289)=v(220)*v(5)
  v(341)=v(340)+v(289)*v(9)
  v(301)=v(315)+v(289)*v(7)
  v(295)=v(259)*v(5)+v(289)*v(8)
  v(272)=v(220)*v(9)
  v(347)=v(272)*v(7)
  v(348)=v(347)+v(266)*v(6)
  v(345)=v(272)*v(8)
  v(346)=v(345)+v(260)*v(6)
  v(344)=v(254)*v(6)+v(272)*v(9)
  v(284)=v(347)+v(254)*v(4)
  v(278)=v(345)+v(254)*v(5)
  v(271)=v(220)*v(6)
  v(339)=v(253)*v(6)+v(271)*v(9)
  v(283)=v(342)+v(271)*v(7)
  v(277)=v(340)+v(271)*v(8)
  v(250)=-v(218)-v(220)
  v(310)=v(250)*v(7)
  v(328)=v(268)*v(4)+v(310)*v(7)
  v(309)=v(250)*v(4)
  v(353)=v(352)+v(309)*v(9)
  v(327)=v(267)*v(4)+v(309)*v(7)
  v(320)=v(319)+v(309)*v(8)
  v(292)=v(250)*v(8)
  v(321)=v(292)*v(7)
  v(322)=v(321)+v(268)*v(5)
  v(304)=v(321)+v(262)*v(4)
  v(298)=v(262)*v(5)+v(292)*v(8)
  v(291)=v(250)*v(5)
  v(351)=v(350)+v(291)*v(9)
  v(303)=v(319)+v(291)*v(7)
  v(297)=v(261)*v(5)+v(291)*v(8)
  v(274)=v(250)*v(9)
  v(357)=v(274)*v(7)
  v(358)=v(357)+v(268)*v(6)
  v(355)=v(274)*v(8)
  v(356)=v(355)+v(262)*v(6)
  v(354)=v(256)*v(6)+v(274)*v(9)
  v(286)=v(357)+v(256)*v(4)
  v(280)=v(355)+v(256)*v(5)
  v(273)=v(250)*v(6)
  v(349)=v(255)*v(6)+v(273)*v(9)
  v(285)=v(352)+v(273)*v(7)
  v(279)=v(350)+v(273)*v(8)
  v(221)=v(208)*v(217)+v(209)*v(219)
  v(222)=v(208)*v(218)+v(209)*v(220)
  v(223)=v(210)*v(217)+v(211)*v(219)
  v(234)=v(221)*v(6)+v(223)*v(9)
  v(231)=v(221)*v(5)+v(223)*v(8)
  v(228)=v(221)*v(4)+v(223)*v(7)
  v(224)=v(210)*v(218)+v(211)*v(220)
  v(235)=v(222)*v(6)+v(224)*v(9)
  v(246)=((v(12)*v(12))*v(2))/v(1)+v(234)*v(6)+v(235)*v(9)
  v(242)=v(238)+v(234)*v(5)+v(235)*v(8)
  v(233)=v(237)+v(234)*v(4)+v(235)*v(7)
  v(232)=v(222)*v(5)+v(224)*v(8)
  v(245)=v(238)+v(231)*v(6)+v(232)*v(9)
  v(241)=((v(11)*v(11))*v(2))/v(1)+v(231)*v(5)+v(232)*v(8)
  v(230)=v(227)+v(231)*v(4)+v(232)*v(7)
  v(229)=v(222)*v(4)+v(224)*v(7)
  v(244)=v(237)+v(228)*v(6)+v(229)*v(9)
  v(240)=v(227)+v(228)*v(5)+v(229)*v(8)
  v(226)=((v(10)*v(10))*v(2))/v(1)+v(228)*v(4)+v(229)*v(7)
  v(225)=(v(226)*v(226))+(v(230)*v(230))+(v(233)*v(233))
  v(236)=v(226)*v(240)+v(230)*v(241)+v(233)*v(242)
  v(243)=(v(240)*v(240))+(v(241)*v(241))+(v(242)*v(242))
  v(248)=(v(244)*v(244))+(v(245)*v(245))+(v(246)*v(246))
  v(359)=v(233)*v(275)+v(242)*v(281)+v(230)*v(293)+v(241)*v(299)+v(226)*v(312)+v(240)*v(323)
  v(360)=v(233)*v(276)+v(242)*v(282)+v(230)*v(294)+v(241)*v(300)+v(226)*v(314)+v(240)*v(324)
  v(361)=v(233)*v(277)+v(242)*v(283)+v(230)*v(295)+v(241)*v(301)+v(226)*v(316)+v(240)*v(325)
  v(362)=v(233)*v(278)+v(242)*v(284)+v(230)*v(296)+v(241)*v(302)+v(226)*v(318)+v(240)*v(326)
  v(363)=v(233)*v(279)+v(242)*v(285)+v(230)*v(297)+v(241)*v(303)+v(226)*v(320)+v(240)*v(327)
  v(364)=v(233)*v(280)+v(242)*v(286)+v(230)*v(298)+v(241)*v(304)+v(226)*v(322)+v(240)*v(328)
  v(365)=(2d0*v(233)*v(281)+2d0*v(230)*v(299)+2d0*v(226)*v(323))/2d0
  v(366)=(2d0*v(233)*v(282)+2d0*v(230)*v(300)+2d0*v(226)*v(324))/2d0
  v(367)=(2d0*v(233)*v(283)+2d0*v(230)*v(301)+2d0*v(226)*v(325))/2d0
  v(368)=(2d0*v(233)*v(284)+2d0*v(230)*v(302)+2d0*v(226)*v(326))/2d0
  v(369)=(2d0*v(233)*v(285)+2d0*v(230)*v(303)+2d0*v(226)*v(327))/2d0
  v(370)=(2d0*v(233)*v(286)+2d0*v(230)*v(304)+2d0*v(226)*v(328))/2d0
  v(371)=(2d0*v(242)*v(275)+2d0*v(241)*v(293)+2d0*v(240)*v(312))/2d0
  v(372)=(2d0*v(242)*v(276)+2d0*v(241)*v(294)+2d0*v(240)*v(314))/2d0
  v(373)=(2d0*v(242)*v(277)+2d0*v(241)*v(295)+2d0*v(240)*v(316))/2d0
  v(374)=(2d0*v(242)*v(278)+2d0*v(241)*v(296)+2d0*v(240)*v(318))/2d0
  v(375)=(2d0*v(242)*v(279)+2d0*v(241)*v(297)+2d0*v(240)*v(320))/2d0
  v(376)=(2d0*v(242)*v(280)+2d0*v(241)*v(298)+2d0*v(240)*v(322))/2d0
  v(377)=(2d0*v(246)*v(329)+2d0*v(245)*v(331)+2d0*v(244)*v(333))/2d0
  v(378)=(2d0*v(246)*v(334)+2d0*v(245)*v(336)+2d0*v(244)*v(338))/2d0
  v(379)=(2d0*v(246)*v(339)+2d0*v(245)*v(341)+2d0*v(244)*v(343))/2d0
  v(380)=(2d0*v(246)*v(344)+2d0*v(245)*v(346)+2d0*v(244)*v(348))/2d0
  v(381)=(2d0*v(246)*v(349)+2d0*v(245)*v(351)+2d0*v(244)*v(353))/2d0
  v(382)=(2d0*v(246)*v(354)+2d0*v(245)*v(356)+2d0*v(244)*v(358))/2d0
  v(383)=(2d0*(v(281)*v(281))+2d0*(v(299)*v(299))+2d0*(v(323)*v(323)))/2d0
  v(384)=(2d0*v(281)*v(282)+2d0*v(299)*v(300)+2d0*v(323)*v(324))/2d0
  v(385)=(2d0*v(281)*v(283)+2d0*v(299)*v(301)+2d0*v(323)*v(325))/2d0
  v(386)=(2d0*v(281)*v(284)+2d0*v(299)*v(302)+2d0*v(323)*v(326))/2d0
  v(387)=(2d0*v(281)*v(285)+2d0*v(299)*v(303)+2d0*v(323)*v(327))/2d0
  v(388)=(2d0*v(281)*v(286)+2d0*v(299)*v(304)+2d0*v(323)*v(328))/2d0
  v(389)=(2d0*(v(275)*v(275))+2d0*(v(293)*v(293))+2d0*(v(312)*v(312)))/2d0
  v(390)=(2d0*v(275)*v(276)+2d0*v(293)*v(294)+2d0*v(312)*v(314))/2d0
  v(391)=(2d0*v(275)*v(277)+2d0*v(293)*v(295)+2d0*v(312)*v(316))/2d0
  v(392)=(2d0*v(275)*v(278)+2d0*v(293)*v(296)+2d0*v(312)*v(318))/2d0
  v(393)=(2d0*v(275)*v(279)+2d0*v(293)*v(297)+2d0*v(312)*v(320))/2d0
  v(394)=(2d0*v(275)*v(280)+2d0*v(293)*v(298)+2d0*v(312)*v(322))/2d0
  v(395)=(2d0*(v(329)*v(329))+2d0*(v(331)*v(331))+2d0*(v(333)*v(333)))/2d0
  v(396)=(2d0*v(329)*v(334)+2d0*v(331)*v(336)+2d0*v(333)*v(338))/2d0
  v(397)=(2d0*v(329)*v(339)+2d0*v(331)*v(341)+2d0*v(333)*v(343))/2d0
  v(398)=(2d0*v(329)*v(344)+2d0*v(331)*v(346)+2d0*v(333)*v(348))/2d0
  v(399)=(2d0*v(329)*v(349)+2d0*v(331)*v(351)+2d0*v(333)*v(353))/2d0
  v(400)=(2d0*v(329)*v(354)+2d0*v(331)*v(356)+2d0*v(333)*v(358))/2d0
  v(401)=2d0*v(275)*v(281)+2d0*v(293)*v(299)+2d0*v(312)*v(323)
  v(402)=v(276)*v(281)
  v(403)=v(294)*v(299)
  v(404)=v(314)*v(323)
  v(405)=2d0*v(402)+2d0*v(403)+2d0*v(404)
  v(406)=v(277)*v(281)+v(275)*v(283)+v(295)*v(299)+v(293)*v(301)+v(316)*v(323)+v(312)*v(325)
  v(407)=v(278)*v(281)+v(275)*v(284)+v(296)*v(299)+v(293)*v(302)+v(318)*v(323)+v(312)*v(326)
  v(408)=v(279)*v(281)+v(275)*v(285)+v(297)*v(299)+v(293)*v(303)+v(320)*v(323)+v(312)*v(327)
  v(409)=v(280)*v(281)+v(275)*v(286)+v(298)*v(299)+v(293)*v(304)+v(322)*v(323)+v(312)*v(328)
  v(410)=(2d0*(v(282)*v(282))+2d0*(v(300)*v(300))+2d0*(v(324)*v(324)))/2d0
  v(411)=(2d0*v(282)*v(284)+2d0*v(300)*v(302)+2d0*v(324)*v(326))/2d0
  v(412)=(2d0*v(282)*v(286)+2d0*v(300)*v(304)+2d0*v(324)*v(328))/2d0
  v(413)=(2d0*(v(276)*v(276))+2d0*(v(294)*v(294))+2d0*(v(314)*v(314)))/2d0
  v(414)=(2d0*v(276)*v(278)+2d0*v(294)*v(296)+2d0*v(314)*v(318))/2d0
  v(415)=(2d0*v(276)*v(280)+2d0*v(294)*v(298)+2d0*v(314)*v(322))/2d0
  v(416)=(2d0*(v(334)*v(334))+2d0*(v(336)*v(336))+2d0*(v(338)*v(338)))/2d0
  v(417)=(2d0*v(334)*v(344)+2d0*v(336)*v(346)+2d0*v(338)*v(348))/2d0
  v(418)=(2d0*v(334)*v(354)+2d0*v(336)*v(356)+2d0*v(338)*v(358))/2d0
  v(419)=2d0*v(276)*v(282)+2d0*v(294)*v(300)+2d0*v(314)*v(324)
  v(420)=v(278)*v(282)+v(276)*v(284)+v(296)*v(300)+v(294)*v(302)+v(318)*v(324)+v(314)*v(326)
  v(421)=v(280)*v(282)+v(276)*v(286)+v(298)*v(300)+v(294)*v(304)+v(322)*v(324)+v(314)*v(328)
  v(422)=(2d0*(v(283)*v(283))+2d0*(v(301)*v(301))+2d0*(v(325)*v(325)))/2d0
  v(423)=(2d0*v(283)*v(284)+2d0*v(301)*v(302)+2d0*v(325)*v(326))/2d0
  v(424)=(2d0*v(283)*v(285)+2d0*v(301)*v(303)+2d0*v(325)*v(327))/2d0
  v(425)=(2d0*v(283)*v(286)+2d0*v(301)*v(304)+2d0*v(325)*v(328))/2d0
  v(426)=(2d0*(v(277)*v(277))+2d0*(v(295)*v(295))+2d0*(v(316)*v(316)))/2d0
  v(427)=(2d0*v(277)*v(278)+2d0*v(295)*v(296)+2d0*v(316)*v(318))/2d0
  v(428)=(2d0*v(277)*v(279)+2d0*v(295)*v(297)+2d0*v(316)*v(320))/2d0
  v(429)=(2d0*v(277)*v(280)+2d0*v(295)*v(298)+2d0*v(316)*v(322))/2d0
  v(430)=(2d0*(v(339)*v(339))+2d0*(v(341)*v(341))+2d0*(v(343)*v(343)))/2d0
  v(431)=(2d0*v(339)*v(344)+2d0*v(341)*v(346)+2d0*v(343)*v(348))/2d0
  v(432)=(2d0*v(339)*v(349)+2d0*v(341)*v(351)+2d0*v(343)*v(353))/2d0
  v(433)=(2d0*v(339)*v(354)+2d0*v(341)*v(356)+2d0*v(343)*v(358))/2d0
  v(434)=2d0*v(277)*v(283)+2d0*v(295)*v(301)+2d0*v(316)*v(325)
  v(435)=v(278)*v(283)
  v(436)=v(296)*v(301)
  v(437)=v(318)*v(325)
  v(438)=2d0*v(435)+2d0*v(436)+2d0*v(437)
  v(439)=v(279)*v(283)+v(277)*v(285)+v(297)*v(301)+v(295)*v(303)+v(320)*v(325)+v(316)*v(327)
  v(440)=v(280)*v(283)+v(277)*v(286)+v(298)*v(301)+v(295)*v(304)+v(322)*v(325)+v(316)*v(328)
  v(441)=(2d0*(v(284)*v(284))+2d0*(v(302)*v(302))+2d0*(v(326)*v(326)))/2d0
  v(442)=(2d0*v(284)*v(286)+2d0*v(302)*v(304)+2d0*v(326)*v(328))/2d0
  v(443)=(2d0*(v(278)*v(278))+2d0*(v(296)*v(296))+2d0*(v(318)*v(318)))/2d0
  v(444)=(2d0*v(278)*v(280)+2d0*v(296)*v(298)+2d0*v(318)*v(322))/2d0
  v(445)=(2d0*(v(344)*v(344))+2d0*(v(346)*v(346))+2d0*(v(348)*v(348)))/2d0
  v(446)=(2d0*v(344)*v(354)+2d0*v(346)*v(356)+2d0*v(348)*v(358))/2d0
  v(447)=2d0*v(278)*v(284)+2d0*v(296)*v(302)+2d0*v(318)*v(326)
  v(448)=v(280)*v(284)+v(278)*v(286)+v(298)*v(302)+v(296)*v(304)+v(322)*v(326)+v(318)*v(328)
  v(449)=(2d0*(v(285)*v(285))+2d0*(v(303)*v(303))+2d0*(v(327)*v(327)))/2d0
  v(450)=(2d0*v(285)*v(286)+2d0*v(303)*v(304)+2d0*v(327)*v(328))/2d0
  v(451)=(2d0*(v(279)*v(279))+2d0*(v(297)*v(297))+2d0*(v(320)*v(320)))/2d0
  v(452)=(2d0*v(279)*v(280)+2d0*v(297)*v(298)+2d0*v(320)*v(322))/2d0
  v(453)=(2d0*(v(349)*v(349))+2d0*(v(351)*v(351))+2d0*(v(353)*v(353)))/2d0
  v(454)=(2d0*v(349)*v(354)+2d0*v(351)*v(356)+2d0*v(353)*v(358))/2d0
  v(455)=2d0*v(279)*v(285)+2d0*v(297)*v(303)+2d0*v(320)*v(327)
  v(456)=v(280)*v(285)
  v(457)=v(298)*v(303)
  v(458)=v(322)*v(327)
  v(459)=2d0*v(456)+2d0*v(457)+2d0*v(458)
  v(460)=(2d0*(v(286)*v(286))+2d0*(v(304)*v(304))+2d0*(v(328)*v(328)))/2d0
  v(461)=(2d0*(v(280)*v(280))+2d0*(v(298)*v(298))+2d0*(v(322)*v(322)))/2d0
  v(462)=(2d0*(v(354)*v(354))+2d0*(v(356)*v(356))+2d0*(v(358)*v(358)))/2d0
  v(463)=2d0*v(280)*v(286)+2d0*v(298)*v(304)+2d0*v(322)*v(328)
  sqrtm=v(216)
  proposedgrad(1,1)=v(226)
  proposedgrad(1,2)=v(240)
  proposedgrad(1,3)=v(244)
  proposedgrad(2,1)=v(230)
  proposedgrad(2,2)=v(241)
  proposedgrad(2,3)=v(245)
  proposedgrad(3,1)=v(233)
  proposedgrad(3,2)=v(242)
  proposedgrad(3,3)=v(246)
  relativestrain(1)=((-1d0)+v(225))/2.0d0
  relativestrain(2)=((-1d0)+v(243))/2.0d0
  relativestrain(3)=((-1d0)+v(248))/2.0d0
  relativestrain(4)=v(236)
  drelativestrain(1,1)=v(365)
  drelativestrain(1,2)=v(366)
  drelativestrain(1,3)=v(367)
  drelativestrain(1,4)=v(368)
  drelativestrain(1,5)=v(369)
  drelativestrain(1,6)=v(370)
  drelativestrain(2,1)=v(371)
  drelativestrain(2,2)=v(372)
  drelativestrain(2,3)=v(373)
  drelativestrain(2,4)=v(374)
  drelativestrain(2,5)=v(375)
  drelativestrain(2,6)=v(376)
  drelativestrain(3,1)=v(377)
  drelativestrain(3,2)=v(378)
  drelativestrain(3,3)=v(379)
  drelativestrain(3,4)=v(380)
  drelativestrain(3,5)=v(381)
  drelativestrain(3,6)=v(382)
  drelativestrain(4,1)=v(359)
  drelativestrain(4,2)=v(360)
  drelativestrain(4,3)=v(361)
  drelativestrain(4,4)=v(362)
  drelativestrain(4,5)=v(363)
  drelativestrain(4,6)=v(364)
  d2relativestrain(1,1,1)=v(383)
  d2relativestrain(1,1,2)=v(384)
  d2relativestrain(1,1,3)=v(385)
  d2relativestrain(1,1,4)=v(386)
  d2relativestrain(1,1,5)=v(387)
  d2relativestrain(1,1,6)=v(388)
  d2relativestrain(1,2,1)=v(384)
  d2relativestrain(1,2,2)=v(410)
  d2relativestrain(1,2,3)=v(386)
  d2relativestrain(1,2,4)=v(411)
  d2relativestrain(1,2,5)=v(388)
  d2relativestrain(1,2,6)=v(412)
  d2relativestrain(1,3,1)=v(385)
  d2relativestrain(1,3,2)=v(386)
  d2relativestrain(1,3,3)=v(422)
  d2relativestrain(1,3,4)=v(423)
  d2relativestrain(1,3,5)=v(424)
  d2relativestrain(1,3,6)=v(425)
  d2relativestrain(1,4,1)=v(386)
  d2relativestrain(1,4,2)=v(411)
  d2relativestrain(1,4,3)=v(423)
  d2relativestrain(1,4,4)=v(441)
  d2relativestrain(1,4,5)=v(425)
  d2relativestrain(1,4,6)=v(442)
  d2relativestrain(1,5,1)=v(387)
  d2relativestrain(1,5,2)=v(388)
  d2relativestrain(1,5,3)=v(424)
  d2relativestrain(1,5,4)=v(425)
  d2relativestrain(1,5,5)=v(449)
  d2relativestrain(1,5,6)=v(450)
  d2relativestrain(1,6,1)=v(388)
  d2relativestrain(1,6,2)=v(412)
  d2relativestrain(1,6,3)=v(425)
  d2relativestrain(1,6,4)=v(442)
  d2relativestrain(1,6,5)=v(450)
  d2relativestrain(1,6,6)=v(460)
  d2relativestrain(2,1,1)=v(389)
  d2relativestrain(2,1,2)=v(390)
  d2relativestrain(2,1,3)=v(391)
  d2relativestrain(2,1,4)=v(392)
  d2relativestrain(2,1,5)=v(393)
  d2relativestrain(2,1,6)=v(394)
  d2relativestrain(2,2,1)=v(390)
  d2relativestrain(2,2,2)=v(413)
  d2relativestrain(2,2,3)=v(392)
  d2relativestrain(2,2,4)=v(414)
  d2relativestrain(2,2,5)=v(394)
  d2relativestrain(2,2,6)=v(415)
  d2relativestrain(2,3,1)=v(391)
  d2relativestrain(2,3,2)=v(392)
  d2relativestrain(2,3,3)=v(426)
  d2relativestrain(2,3,4)=v(427)
  d2relativestrain(2,3,5)=v(428)
  d2relativestrain(2,3,6)=v(429)
  d2relativestrain(2,4,1)=v(392)
  d2relativestrain(2,4,2)=v(414)
  d2relativestrain(2,4,3)=v(427)
  d2relativestrain(2,4,4)=v(443)
  d2relativestrain(2,4,5)=v(429)
  d2relativestrain(2,4,6)=v(444)
  d2relativestrain(2,5,1)=v(393)
  d2relativestrain(2,5,2)=v(394)
  d2relativestrain(2,5,3)=v(428)
  d2relativestrain(2,5,4)=v(429)
  d2relativestrain(2,5,5)=v(451)
  d2relativestrain(2,5,6)=v(452)
  d2relativestrain(2,6,1)=v(394)
  d2relativestrain(2,6,2)=v(415)
  d2relativestrain(2,6,3)=v(429)
  d2relativestrain(2,6,4)=v(444)
  d2relativestrain(2,6,5)=v(452)
  d2relativestrain(2,6,6)=v(461)
  d2relativestrain(3,1,1)=v(395)
  d2relativestrain(3,1,2)=v(396)
  d2relativestrain(3,1,3)=v(397)
  d2relativestrain(3,1,4)=v(398)
  d2relativestrain(3,1,5)=v(399)
  d2relativestrain(3,1,6)=v(400)
  d2relativestrain(3,2,1)=v(396)
  d2relativestrain(3,2,2)=v(416)
  d2relativestrain(3,2,3)=v(398)
  d2relativestrain(3,2,4)=v(417)
  d2relativestrain(3,2,5)=v(400)
  d2relativestrain(3,2,6)=v(418)
  d2relativestrain(3,3,1)=v(397)
  d2relativestrain(3,3,2)=v(398)
  d2relativestrain(3,3,3)=v(430)
  d2relativestrain(3,3,4)=v(431)
  d2relativestrain(3,3,5)=v(432)
  d2relativestrain(3,3,6)=v(433)
  d2relativestrain(3,4,1)=v(398)
  d2relativestrain(3,4,2)=v(417)
  d2relativestrain(3,4,3)=v(431)
  d2relativestrain(3,4,4)=v(445)
  d2relativestrain(3,4,5)=v(433)
  d2relativestrain(3,4,6)=v(446)
  d2relativestrain(3,5,1)=v(399)
  d2relativestrain(3,5,2)=v(400)
  d2relativestrain(3,5,3)=v(432)
  d2relativestrain(3,5,4)=v(433)
  d2relativestrain(3,5,5)=v(453)
  d2relativestrain(3,5,6)=v(454)
  d2relativestrain(3,6,1)=v(400)
  d2relativestrain(3,6,2)=v(418)
  d2relativestrain(3,6,3)=v(433)
  d2relativestrain(3,6,4)=v(446)
  d2relativestrain(3,6,5)=v(454)
  d2relativestrain(3,6,6)=v(462)
  d2relativestrain(4,1,1)=v(401)
  d2relativestrain(4,1,2)=v(405)
  d2relativestrain(4,1,3)=v(406)
  d2relativestrain(4,1,4)=v(407)
  d2relativestrain(4,1,5)=v(408)
  d2relativestrain(4,1,6)=v(409)
  d2relativestrain(4,2,1)=v(405)
  d2relativestrain(4,2,2)=v(419)
  d2relativestrain(4,2,3)=v(407)
  d2relativestrain(4,2,4)=v(420)
  d2relativestrain(4,2,5)=v(409)
  d2relativestrain(4,2,6)=v(421)
  d2relativestrain(4,3,1)=v(406)
  d2relativestrain(4,3,2)=v(407)
  d2relativestrain(4,3,3)=v(434)
  d2relativestrain(4,3,4)=v(438)
  d2relativestrain(4,3,5)=v(439)
  d2relativestrain(4,3,6)=v(440)
  d2relativestrain(4,4,1)=v(407)
  d2relativestrain(4,4,2)=v(420)
  d2relativestrain(4,4,3)=v(438)
  d2relativestrain(4,4,4)=v(447)
  d2relativestrain(4,4,5)=v(440)
  d2relativestrain(4,4,6)=v(448)
  d2relativestrain(4,5,1)=v(408)
  d2relativestrain(4,5,2)=v(409)
  d2relativestrain(4,5,3)=v(439)
  d2relativestrain(4,5,4)=v(440)
  d2relativestrain(4,5,5)=v(455)
  d2relativestrain(4,5,6)=v(459)
  d2relativestrain(4,6,1)=v(409)
  d2relativestrain(4,6,2)=v(421)
  d2relativestrain(4,6,3)=v(440)
  d2relativestrain(4,6,4)=v(448)
  d2relativestrain(4,6,5)=v(459)
  d2relativestrain(4,6,6)=v(463)
END SUBROUTINE strain2d3nstd
!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           6 Jun 23 15:12:53  *
!**************************************************************
! User     : Full professional version
! Notebook : arrays2d3nstd
! Evaluation time                 : 12 s    Mode  : Optimal
! Number of formulae              : 180     Method: Automatic
! Subroutine                      : arrays2d3nstd size: 7155
! Total size of Mathematica  code : 7155 subexpressions
! Total size of Fortran code      : 22422 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE arrays2d3nstd(vol,rho,vecload,acc,dacc,ffor,drelativestrain,d2relativestrain,equilibriumstress&
    &,dstressdstrain,force,stiffness)
  IMPLICIT NONE
  DOUBLE PRECISION v(462),vol,rho,vecload(2),acc(3,2),dacc,ffor(3),drelativestrain(4,6),d2relativestrain(4,6,6)&
      &,equilibriumstress(4),dstressdstrain(4,4),force(6),stiffness(6,6)
  v(433)=(drelativestrain(1,5)*drelativestrain(1,6)*dstressdstrain(1,1)+drelativestrain(2,5)*drelativestrain(2,6&
      &)*dstressdstrain(2,2)+drelativestrain(3,5)*drelativestrain(3,6)*dstressdstrain(3,3)+drelativestrain(4,5&
      &)*drelativestrain(4,6)*dstressdstrain(4,4))*vol
  v(432)=drelativestrain(2,6)*vol
  v(431)=drelativestrain(1,6)*vol
  v(430)=drelativestrain(4,6)*vol
  v(429)=drelativestrain(3,6)*vol
  v(428)=dstressdstrain(2,1)*v(431)
  v(427)=dstressdstrain(1,4)*v(430)
  v(426)=dstressdstrain(1,3)*v(429)
  v(425)=dstressdstrain(1,2)*v(432)
  v(456)=v(425)+v(426)+v(427)
  v(424)=drelativestrain(2,5)*vol
  v(423)=drelativestrain(1,5)*vol
  v(422)=drelativestrain(4,5)*vol
  v(421)=drelativestrain(3,5)*vol
  v(420)=dstressdstrain(2,1)*v(423)
  v(419)=dstressdstrain(1,4)*v(422)
  v(418)=dstressdstrain(1,3)*v(421)
  v(417)=dstressdstrain(1,2)*v(424)
  v(452)=v(417)+v(418)+v(419)
  v(416)=drelativestrain(2,4)*vol
  v(415)=drelativestrain(1,4)*vol
  v(414)=drelativestrain(4,4)*vol
  v(413)=drelativestrain(3,4)*vol
  v(412)=dstressdstrain(2,1)*v(415)
  v(411)=dstressdstrain(1,4)*v(414)
  v(410)=dstressdstrain(1,3)*v(413)
  v(409)=dstressdstrain(1,2)*v(416)
  v(448)=v(409)+v(410)+v(411)
  v(408)=drelativestrain(2,3)*vol
  v(407)=drelativestrain(1,3)*vol
  v(406)=drelativestrain(4,3)*vol
  v(405)=drelativestrain(3,3)*vol
  v(404)=dstressdstrain(2,1)*v(407)
  v(403)=dstressdstrain(1,4)*v(406)
  v(402)=dstressdstrain(1,3)*v(405)
  v(401)=dstressdstrain(1,2)*v(408)
  v(444)=v(401)+v(402)+v(403)
  v(400)=drelativestrain(2,2)*vol
  v(399)=drelativestrain(1,2)*vol
  v(398)=drelativestrain(4,2)*vol
  v(397)=drelativestrain(3,2)*vol
  v(396)=dstressdstrain(2,1)*v(399)
  v(395)=dstressdstrain(1,4)*v(398)
  v(394)=dstressdstrain(1,3)*v(397)
  v(393)=dstressdstrain(1,2)*v(400)
  v(440)=v(393)+v(394)+v(395)
  v(392)=drelativestrain(2,1)*vol
  v(391)=drelativestrain(1,1)*vol
  v(390)=drelativestrain(4,1)*vol
  v(389)=drelativestrain(3,1)*vol
  v(388)=dstressdstrain(2,1)*v(391)
  v(387)=dstressdstrain(1,4)*v(390)
  v(386)=dstressdstrain(1,3)*v(389)
  v(385)=dstressdstrain(1,2)*v(392)
  v(436)=v(385)+v(386)+v(387)
  v(381)=ffor(3)**2
  v(380)=ffor(2)**2
  v(379)=dacc*ffor(3)
  v(378)=ffor(1)**2
  v(377)=rho*vol
  v(376)=dstressdstrain(4,4)*vol
  v(375)=drelativestrain(4,4)*v(376)
  v(374)=dstressdstrain(3,3)*vol
  v(373)=drelativestrain(3,4)*v(374)
  v(372)=dstressdstrain(2,2)*vol
  v(371)=drelativestrain(2,4)*v(372)
  v(370)=dstressdstrain(1,1)*vol
  v(369)=drelativestrain(1,4)*v(370)
  v(368)=ffor(1)*v(377)
  v(346)=v(368)*v(379)
  v(351)=drelativestrain(1,3)*v(370)
  v(340)=drelativestrain(1,2)*v(370)
  v(282)=drelativestrain(1,1)*v(370)
  v(352)=drelativestrain(2,3)*v(372)
  v(341)=drelativestrain(2,2)*v(372)
  v(283)=drelativestrain(2,1)*v(372)
  v(353)=drelativestrain(3,3)*v(374)
  v(342)=drelativestrain(3,2)*v(374)
  v(284)=drelativestrain(3,1)*v(374)
  v(354)=drelativestrain(4,3)*v(376)
  v(343)=drelativestrain(4,2)*v(376)
  v(285)=drelativestrain(4,1)*v(376)
  v(245)=acc(1,1)*v(377)
  v(383)=ffor(1)*v(245)
  v(255)=v(377)*v(378)
  v(247)=ffor(2)*v(377)
  v(384)=ffor(3)*v(247)
  v(382)=acc(2,1)*v(247)
  v(358)=v(247)*v(379)
  v(339)=dacc*ffor(1)*v(247)
  v(248)=ffor(3)*v(368)
  v(250)=acc(2,2)*v(377)
  v(251)=acc(3,2)*v(377)
  v(348)=v(377)*v(380)
  v(364)=v(377)*v(381)
  force(1)=force(1)+acc(3,1)*v(248)+v(245)*v(378)+ffor(1)*v(382)+(drelativestrain(1,1)*equilibriumstress(1)&
      &+drelativestrain(2,1)*equilibriumstress(2)+drelativestrain(3,1)*equilibriumstress(3)+drelativestrain(4,1&
      &)*equilibriumstress(4)-ffor(1)*vecload(1))*vol
  force(2)=force(2)+ffor(1)*(ffor(2)*v(250)+ffor(3)*v(251))+acc(1,2)*v(255)+(drelativestrain(1,2)*equilibriumstress(1)&
      &+drelativestrain(2,2)*equilibriumstress(2)+drelativestrain(3,2)*equilibriumstress(3)+drelativestrain(4,2&
      &)*equilibriumstress(4)-ffor(1)*vecload(2))*vol
  force(3)=force(3)+acc(2,1)*v(348)+ffor(2)*v(383)+acc(3,1)*v(384)+(drelativestrain(1,3)*equilibriumstress(1)&
      &+drelativestrain(2,3)*equilibriumstress(2)+drelativestrain(3,3)*equilibriumstress(3)+drelativestrain(4,3&
      &)*equilibriumstress(4)-ffor(2)*vecload(1))*vol
  force(4)=force(4)+acc(1,2)*ffor(2)*v(368)+v(250)*v(380)+acc(3,2)*v(384)+(drelativestrain(1,4)*equilibriumstress(1)&
      &+drelativestrain(2,4)*equilibriumstress(2)+drelativestrain(3,4)*equilibriumstress(3)+drelativestrain(4,4&
      &)*equilibriumstress(4)-ffor(2)*vecload(2))*vol
  force(5)=force(5)+acc(3,1)*v(364)+ffor(3)*(v(382)+v(383))+(drelativestrain(1,5)*equilibriumstress(1)+drelativestrain(2&
      &,5)*equilibriumstress(2)+drelativestrain(3,5)*equilibriumstress(3)+drelativestrain(4,5)*equilibriumstress(4)-ffor(3&
      &)*vecload(1))*vol
  force(6)=force(6)+acc(1,2)*v(248)+v(251)*v(381)+acc(2,2)*v(384)+(drelativestrain(1,6)*equilibriumstress(1)&
      &+drelativestrain(2,6)*equilibriumstress(2)+drelativestrain(3,6)*equilibriumstress(3)+drelativestrain(4,6&
      &)*equilibriumstress(4)-ffor(3)*vecload(2))*vol
  v(256)=dacc*v(255)
  v(261)=dstressdstrain(2,3)*v(389)
  v(262)=dstressdstrain(2,4)*v(390)
  v(437)=v(261)+v(262)+v(388)
  v(263)=dstressdstrain(3,1)*v(391)
  v(264)=dstressdstrain(3,2)*v(392)
  v(265)=dstressdstrain(3,4)*v(390)
  v(434)=v(263)+v(264)+v(265)
  v(266)=dstressdstrain(4,1)*v(391)
  v(267)=dstressdstrain(4,2)*v(392)
  v(268)=dstressdstrain(4,3)*v(389)
  v(435)=v(266)+v(267)+v(268)
  v(269)=drelativestrain(1,2)*v(282)+drelativestrain(2,2)*v(283)+drelativestrain(3,2)*v(284)+drelativestrain(4,2)*v(285)
  v(274)=dstressdstrain(2,3)*v(397)
  v(275)=dstressdstrain(2,4)*v(398)
  v(441)=v(274)+v(275)+v(396)
  v(276)=dstressdstrain(3,1)*v(399)
  v(277)=dstressdstrain(3,2)*v(400)
  v(278)=dstressdstrain(3,4)*v(398)
  v(438)=v(276)+v(277)+v(278)
  v(279)=dstressdstrain(4,1)*v(399)
  v(280)=dstressdstrain(4,2)*v(400)
  v(281)=dstressdstrain(4,3)*v(397)
  v(439)=v(279)+v(280)+v(281)
  v(286)=drelativestrain(1,3)*v(282)+drelativestrain(2,3)*v(283)+drelativestrain(3,3)*v(284)+drelativestrain(4,3)*v(285)&
      &+v(339)
  v(291)=dstressdstrain(2,3)*v(405)
  v(292)=dstressdstrain(2,4)*v(406)
  v(445)=v(291)+v(292)+v(404)
  v(293)=dstressdstrain(3,1)*v(407)
  v(294)=dstressdstrain(3,2)*v(408)
  v(295)=dstressdstrain(3,4)*v(406)
  v(442)=v(293)+v(294)+v(295)
  v(296)=dstressdstrain(4,1)*v(407)
  v(297)=dstressdstrain(4,2)*v(408)
  v(298)=dstressdstrain(4,3)*v(405)
  v(443)=v(296)+v(297)+v(298)
  v(299)=drelativestrain(1,4)*v(282)+drelativestrain(2,4)*v(283)+drelativestrain(3,4)*v(284)+drelativestrain(4,4)*v(285)
  v(304)=dstressdstrain(2,3)*v(413)
  v(305)=dstressdstrain(2,4)*v(414)
  v(449)=v(304)+v(305)+v(412)
  v(306)=dstressdstrain(3,1)*v(415)
  v(307)=dstressdstrain(3,2)*v(416)
  v(308)=dstressdstrain(3,4)*v(414)
  v(446)=v(306)+v(307)+v(308)
  v(309)=dstressdstrain(4,1)*v(415)
  v(310)=dstressdstrain(4,2)*v(416)
  v(311)=dstressdstrain(4,3)*v(413)
  v(447)=v(309)+v(310)+v(311)
  v(312)=drelativestrain(1,5)*v(282)+drelativestrain(2,5)*v(283)+drelativestrain(3,5)*v(284)+drelativestrain(4,5)*v(285)&
      &+v(346)
  v(317)=dstressdstrain(2,3)*v(421)
  v(318)=dstressdstrain(2,4)*v(422)
  v(453)=v(317)+v(318)+v(420)
  v(319)=dstressdstrain(3,1)*v(423)
  v(320)=dstressdstrain(3,2)*v(424)
  v(321)=dstressdstrain(3,4)*v(422)
  v(450)=v(319)+v(320)+v(321)
  v(322)=dstressdstrain(4,1)*v(423)
  v(323)=dstressdstrain(4,2)*v(424)
  v(324)=dstressdstrain(4,3)*v(421)
  v(451)=v(322)+v(323)+v(324)
  v(325)=drelativestrain(1,6)*v(282)+drelativestrain(2,6)*v(283)+drelativestrain(3,6)*v(284)+drelativestrain(4,6)*v(285)
  v(330)=dstressdstrain(2,3)*v(429)
  v(331)=dstressdstrain(2,4)*v(430)
  v(457)=v(330)+v(331)+v(428)
  v(332)=dstressdstrain(3,1)*v(431)
  v(333)=dstressdstrain(3,2)*v(432)
  v(334)=dstressdstrain(3,4)*v(430)
  v(454)=v(332)+v(333)+v(334)
  v(335)=dstressdstrain(4,1)*v(431)
  v(336)=dstressdstrain(4,2)*v(432)
  v(337)=dstressdstrain(4,3)*v(429)
  v(455)=v(335)+v(336)+v(337)
  v(338)=drelativestrain(1,3)*v(340)+drelativestrain(2,3)*v(341)+drelativestrain(3,3)*v(342)+drelativestrain(4,3)*v(343)
  v(344)=v(339)+drelativestrain(1,4)*v(340)+drelativestrain(2,4)*v(341)+drelativestrain(3,4)*v(342)+drelativestrain(4,4&
      &)*v(343)
  v(345)=drelativestrain(1,5)*v(340)+drelativestrain(2,5)*v(341)+drelativestrain(3,5)*v(342)+drelativestrain(4,5)*v(343)
  v(347)=drelativestrain(1,6)*v(340)+drelativestrain(2,6)*v(341)+drelativestrain(3,6)*v(342)+drelativestrain(4,6)*v(343)&
      &+v(346)
  v(349)=dacc*v(348)
  v(350)=drelativestrain(1,4)*v(351)+drelativestrain(2,4)*v(352)+drelativestrain(3,4)*v(353)+drelativestrain(4,4)*v(354)
  v(355)=drelativestrain(1,5)*v(351)+drelativestrain(2,5)*v(352)+drelativestrain(3,5)*v(353)+drelativestrain(4,5)*v(354)&
      &+v(358)
  v(356)=drelativestrain(1,6)*v(351)+drelativestrain(2,6)*v(352)+drelativestrain(3,6)*v(353)+drelativestrain(4,6)*v(354)
  v(357)=drelativestrain(1,5)*v(369)+drelativestrain(2,5)*v(371)+drelativestrain(3,5)*v(373)+drelativestrain(4,5)*v(375)
  v(363)=v(358)+drelativestrain(1,6)*v(369)+drelativestrain(2,6)*v(371)+drelativestrain(3,6)*v(373)+drelativestrain(4,6&
      &)*v(375)
  v(365)=dacc*v(364)
  stiffness(1,1)=stiffness(1,1)+v(256)+drelativestrain(3,1)*v(434)+drelativestrain(4,1)*v(435)+drelativestrain(1,1)*v(436&
      &)+drelativestrain(2,1)*v(437)+(drelativestrain(1,1)**2*dstressdstrain(1,1)+drelativestrain(2,1)**2*dstressdstrain(2,2)&
      &+drelativestrain(3,1)**2*dstressdstrain(3,3)+drelativestrain(4,1)**2*dstressdstrain(4,4)+d2relativestrain(1,1,1&
      &)*equilibriumstress(1)+d2relativestrain(2,1,1)*equilibriumstress(2)+d2relativestrain(3,1,1)*equilibriumstress(3)&
      &+d2relativestrain(4,1,1)*equilibriumstress(4))*vol
  stiffness(1,2)=stiffness(1,2)+v(269)+drelativestrain(3,1)*v(438)+drelativestrain(4,1)*v(439)+drelativestrain(1,1)*v(440&
      &)+drelativestrain(2,1)*v(441)+(d2relativestrain(1,1,2)*equilibriumstress(1)+d2relativestrain(2,1,2)*equilibriumstress(2&
      &)+d2relativestrain(3,1,2)*equilibriumstress(3)+d2relativestrain(4,1,2)*equilibriumstress(4))*vol
  stiffness(1,3)=stiffness(1,3)+v(286)+drelativestrain(3,1)*v(442)+drelativestrain(4,1)*v(443)+drelativestrain(1,1)*v(444&
      &)+drelativestrain(2,1)*v(445)+(d2relativestrain(1,1,3)*equilibriumstress(1)+d2relativestrain(2,1,3)*equilibriumstress(2&
      &)+d2relativestrain(3,1,3)*equilibriumstress(3)+d2relativestrain(4,1,3)*equilibriumstress(4))*vol
  stiffness(1,4)=stiffness(1,4)+v(299)+drelativestrain(3,1)*v(446)+drelativestrain(4,1)*v(447)+drelativestrain(1,1)*v(448&
      &)+drelativestrain(2,1)*v(449)+(d2relativestrain(1,1,4)*equilibriumstress(1)+d2relativestrain(2,1,4)*equilibriumstress(2&
      &)+d2relativestrain(3,1,4)*equilibriumstress(3)+d2relativestrain(4,1,4)*equilibriumstress(4))*vol
  stiffness(1,5)=stiffness(1,5)+v(312)+drelativestrain(3,1)*v(450)+drelativestrain(4,1)*v(451)+drelativestrain(1,1)*v(452&
      &)+drelativestrain(2,1)*v(453)+(d2relativestrain(1,1,5)*equilibriumstress(1)+d2relativestrain(2,1,5)*equilibriumstress(2&
      &)+d2relativestrain(3,1,5)*equilibriumstress(3)+d2relativestrain(4,1,5)*equilibriumstress(4))*vol
  stiffness(1,6)=stiffness(1,6)+v(325)+drelativestrain(3,1)*v(454)+drelativestrain(4,1)*v(455)+drelativestrain(1,1)*v(456&
      &)+drelativestrain(2,1)*v(457)+(d2relativestrain(1,1,6)*equilibriumstress(1)+d2relativestrain(2,1,6)*equilibriumstress(2&
      &)+d2relativestrain(3,1,6)*equilibriumstress(3)+d2relativestrain(4,1,6)*equilibriumstress(4))*vol
  stiffness(2,1)=stiffness(2,1)+v(269)+drelativestrain(3,2)*v(434)+drelativestrain(4,2)*v(435)+drelativestrain(1,2)*v(436&
      &)+drelativestrain(2,2)*v(437)+(d2relativestrain(1,2,1)*equilibriumstress(1)+d2relativestrain(2,2,1)*equilibriumstress(2&
      &)+d2relativestrain(3,2,1)*equilibriumstress(3)+d2relativestrain(4,2,1)*equilibriumstress(4))*vol
  stiffness(2,2)=stiffness(2,2)+v(256)+drelativestrain(3,2)*v(438)+drelativestrain(4,2)*v(439)+drelativestrain(1,2)*v(440&
      &)+drelativestrain(2,2)*v(441)+(drelativestrain(1,2)**2*dstressdstrain(1,1)+drelativestrain(2,2)**2*dstressdstrain(2,2)&
      &+drelativestrain(3,2)**2*dstressdstrain(3,3)+drelativestrain(4,2)**2*dstressdstrain(4,4)+d2relativestrain(1,2,2&
      &)*equilibriumstress(1)+d2relativestrain(2,2,2)*equilibriumstress(2)+d2relativestrain(3,2,2)*equilibriumstress(3)&
      &+d2relativestrain(4,2,2)*equilibriumstress(4))*vol
  stiffness(2,3)=stiffness(2,3)+v(338)+drelativestrain(3,2)*v(442)+drelativestrain(4,2)*v(443)+drelativestrain(1,2)*v(444&
      &)+drelativestrain(2,2)*v(445)+(d2relativestrain(1,2,3)*equilibriumstress(1)+d2relativestrain(2,2,3)*equilibriumstress(2&
      &)+d2relativestrain(3,2,3)*equilibriumstress(3)+d2relativestrain(4,2,3)*equilibriumstress(4))*vol
  stiffness(2,4)=stiffness(2,4)+v(344)+drelativestrain(3,2)*v(446)+drelativestrain(4,2)*v(447)+drelativestrain(1,2)*v(448&
      &)+drelativestrain(2,2)*v(449)+(d2relativestrain(1,2,4)*equilibriumstress(1)+d2relativestrain(2,2,4)*equilibriumstress(2&
      &)+d2relativestrain(3,2,4)*equilibriumstress(3)+d2relativestrain(4,2,4)*equilibriumstress(4))*vol
  stiffness(2,5)=stiffness(2,5)+v(345)+drelativestrain(3,2)*v(450)+drelativestrain(4,2)*v(451)+drelativestrain(1,2)*v(452&
      &)+drelativestrain(2,2)*v(453)+(d2relativestrain(1,2,5)*equilibriumstress(1)+d2relativestrain(2,2,5)*equilibriumstress(2&
      &)+d2relativestrain(3,2,5)*equilibriumstress(3)+d2relativestrain(4,2,5)*equilibriumstress(4))*vol
  stiffness(2,6)=stiffness(2,6)+v(347)+drelativestrain(3,2)*v(454)+drelativestrain(4,2)*v(455)+drelativestrain(1,2)*v(456&
      &)+drelativestrain(2,2)*v(457)+(d2relativestrain(1,2,6)*equilibriumstress(1)+d2relativestrain(2,2,6)*equilibriumstress(2&
      &)+d2relativestrain(3,2,6)*equilibriumstress(3)+d2relativestrain(4,2,6)*equilibriumstress(4))*vol
  stiffness(3,1)=stiffness(3,1)+v(286)+drelativestrain(3,3)*v(434)+drelativestrain(4,3)*v(435)+drelativestrain(1,3)*v(436&
      &)+drelativestrain(2,3)*v(437)+(d2relativestrain(1,3,1)*equilibriumstress(1)+d2relativestrain(2,3,1)*equilibriumstress(2&
      &)+d2relativestrain(3,3,1)*equilibriumstress(3)+d2relativestrain(4,3,1)*equilibriumstress(4))*vol
  stiffness(3,2)=stiffness(3,2)+v(338)+drelativestrain(3,3)*v(438)+drelativestrain(4,3)*v(439)+drelativestrain(1,3)*v(440&
      &)+drelativestrain(2,3)*v(441)+(d2relativestrain(1,3,2)*equilibriumstress(1)+d2relativestrain(2,3,2)*equilibriumstress(2&
      &)+d2relativestrain(3,3,2)*equilibriumstress(3)+d2relativestrain(4,3,2)*equilibriumstress(4))*vol
  stiffness(3,3)=stiffness(3,3)+v(349)+drelativestrain(3,3)*v(442)+drelativestrain(4,3)*v(443)+drelativestrain(1,3)*v(444&
      &)+drelativestrain(2,3)*v(445)+(drelativestrain(1,3)**2*dstressdstrain(1,1)+drelativestrain(2,3)**2*dstressdstrain(2,2)&
      &+drelativestrain(3,3)**2*dstressdstrain(3,3)+drelativestrain(4,3)**2*dstressdstrain(4,4)+d2relativestrain(1,3,3&
      &)*equilibriumstress(1)+d2relativestrain(2,3,3)*equilibriumstress(2)+d2relativestrain(3,3,3)*equilibriumstress(3)&
      &+d2relativestrain(4,3,3)*equilibriumstress(4))*vol
  stiffness(3,4)=stiffness(3,4)+v(350)+drelativestrain(3,3)*v(446)+drelativestrain(4,3)*v(447)+drelativestrain(1,3)*v(448&
      &)+drelativestrain(2,3)*v(449)+(d2relativestrain(1,3,4)*equilibriumstress(1)+d2relativestrain(2,3,4)*equilibriumstress(2&
      &)+d2relativestrain(3,3,4)*equilibriumstress(3)+d2relativestrain(4,3,4)*equilibriumstress(4))*vol
  stiffness(3,5)=stiffness(3,5)+v(355)+drelativestrain(3,3)*v(450)+drelativestrain(4,3)*v(451)+drelativestrain(1,3)*v(452&
      &)+drelativestrain(2,3)*v(453)+(d2relativestrain(1,3,5)*equilibriumstress(1)+d2relativestrain(2,3,5)*equilibriumstress(2&
      &)+d2relativestrain(3,3,5)*equilibriumstress(3)+d2relativestrain(4,3,5)*equilibriumstress(4))*vol
  stiffness(3,6)=stiffness(3,6)+v(356)+drelativestrain(3,3)*v(454)+drelativestrain(4,3)*v(455)+drelativestrain(1,3)*v(456&
      &)+drelativestrain(2,3)*v(457)+(d2relativestrain(1,3,6)*equilibriumstress(1)+d2relativestrain(2,3,6)*equilibriumstress(2&
      &)+d2relativestrain(3,3,6)*equilibriumstress(3)+d2relativestrain(4,3,6)*equilibriumstress(4))*vol
  stiffness(4,1)=stiffness(4,1)+v(299)+drelativestrain(3,4)*v(434)+drelativestrain(4,4)*v(435)+drelativestrain(1,4)*v(436&
      &)+drelativestrain(2,4)*v(437)+(d2relativestrain(1,4,1)*equilibriumstress(1)+d2relativestrain(2,4,1)*equilibriumstress(2&
      &)+d2relativestrain(3,4,1)*equilibriumstress(3)+d2relativestrain(4,4,1)*equilibriumstress(4))*vol
  stiffness(4,2)=stiffness(4,2)+v(344)+drelativestrain(3,4)*v(438)+drelativestrain(4,4)*v(439)+drelativestrain(1,4)*v(440&
      &)+drelativestrain(2,4)*v(441)+(d2relativestrain(1,4,2)*equilibriumstress(1)+d2relativestrain(2,4,2)*equilibriumstress(2&
      &)+d2relativestrain(3,4,2)*equilibriumstress(3)+d2relativestrain(4,4,2)*equilibriumstress(4))*vol
  stiffness(4,3)=stiffness(4,3)+v(350)+drelativestrain(3,4)*v(442)+drelativestrain(4,4)*v(443)+drelativestrain(1,4)*v(444&
      &)+drelativestrain(2,4)*v(445)+(d2relativestrain(1,4,3)*equilibriumstress(1)+d2relativestrain(2,4,3)*equilibriumstress(2&
      &)+d2relativestrain(3,4,3)*equilibriumstress(3)+d2relativestrain(4,4,3)*equilibriumstress(4))*vol
  stiffness(4,4)=stiffness(4,4)+v(349)+drelativestrain(3,4)*v(446)+drelativestrain(4,4)*v(447)+drelativestrain(1,4)*v(448&
      &)+drelativestrain(2,4)*v(449)+(drelativestrain(1,4)**2*dstressdstrain(1,1)+drelativestrain(2,4)**2*dstressdstrain(2,2)&
      &+drelativestrain(3,4)**2*dstressdstrain(3,3)+drelativestrain(4,4)**2*dstressdstrain(4,4)+d2relativestrain(1,4,4&
      &)*equilibriumstress(1)+d2relativestrain(2,4,4)*equilibriumstress(2)+d2relativestrain(3,4,4)*equilibriumstress(3)&
      &+d2relativestrain(4,4,4)*equilibriumstress(4))*vol
  stiffness(4,5)=stiffness(4,5)+v(357)+drelativestrain(3,4)*v(450)+drelativestrain(4,4)*v(451)+drelativestrain(1,4)*v(452&
      &)+drelativestrain(2,4)*v(453)+(d2relativestrain(1,4,5)*equilibriumstress(1)+d2relativestrain(2,4,5)*equilibriumstress(2&
      &)+d2relativestrain(3,4,5)*equilibriumstress(3)+d2relativestrain(4,4,5)*equilibriumstress(4))*vol
  stiffness(4,6)=stiffness(4,6)+v(363)+drelativestrain(3,4)*v(454)+drelativestrain(4,4)*v(455)+drelativestrain(1,4)*v(456&
      &)+drelativestrain(2,4)*v(457)+(d2relativestrain(1,4,6)*equilibriumstress(1)+d2relativestrain(2,4,6)*equilibriumstress(2&
      &)+d2relativestrain(3,4,6)*equilibriumstress(3)+d2relativestrain(4,4,6)*equilibriumstress(4))*vol
  stiffness(5,1)=stiffness(5,1)+v(312)+drelativestrain(3,5)*v(434)+drelativestrain(4,5)*v(435)+drelativestrain(1,5)*v(436&
      &)+drelativestrain(2,5)*v(437)+(d2relativestrain(1,5,1)*equilibriumstress(1)+d2relativestrain(2,5,1)*equilibriumstress(2&
      &)+d2relativestrain(3,5,1)*equilibriumstress(3)+d2relativestrain(4,5,1)*equilibriumstress(4))*vol
  stiffness(5,2)=stiffness(5,2)+v(345)+drelativestrain(3,5)*v(438)+drelativestrain(4,5)*v(439)+drelativestrain(1,5)*v(440&
      &)+drelativestrain(2,5)*v(441)+(d2relativestrain(1,5,2)*equilibriumstress(1)+d2relativestrain(2,5,2)*equilibriumstress(2&
      &)+d2relativestrain(3,5,2)*equilibriumstress(3)+d2relativestrain(4,5,2)*equilibriumstress(4))*vol
  stiffness(5,3)=stiffness(5,3)+v(355)+drelativestrain(3,5)*v(442)+drelativestrain(4,5)*v(443)+drelativestrain(1,5)*v(444&
      &)+drelativestrain(2,5)*v(445)+(d2relativestrain(1,5,3)*equilibriumstress(1)+d2relativestrain(2,5,3)*equilibriumstress(2&
      &)+d2relativestrain(3,5,3)*equilibriumstress(3)+d2relativestrain(4,5,3)*equilibriumstress(4))*vol
  stiffness(5,4)=stiffness(5,4)+v(357)+drelativestrain(3,5)*v(446)+drelativestrain(4,5)*v(447)+drelativestrain(1,5)*v(448&
      &)+drelativestrain(2,5)*v(449)+(d2relativestrain(1,5,4)*equilibriumstress(1)+d2relativestrain(2,5,4)*equilibriumstress(2&
      &)+d2relativestrain(3,5,4)*equilibriumstress(3)+d2relativestrain(4,5,4)*equilibriumstress(4))*vol
  stiffness(5,5)=stiffness(5,5)+v(365)+drelativestrain(3,5)*v(450)+drelativestrain(4,5)*v(451)+drelativestrain(1,5)*v(452&
      &)+drelativestrain(2,5)*v(453)+(drelativestrain(1,5)**2*dstressdstrain(1,1)+drelativestrain(2,5)**2*dstressdstrain(2,2)&
      &+drelativestrain(3,5)**2*dstressdstrain(3,3)+drelativestrain(4,5)**2*dstressdstrain(4,4)+d2relativestrain(1,5,5&
      &)*equilibriumstress(1)+d2relativestrain(2,5,5)*equilibriumstress(2)+d2relativestrain(3,5,5)*equilibriumstress(3)&
      &+d2relativestrain(4,5,5)*equilibriumstress(4))*vol
  stiffness(5,6)=stiffness(5,6)+v(433)+drelativestrain(3,5)*v(454)+drelativestrain(4,5)*v(455)+drelativestrain(1,5)*v(456&
      &)+drelativestrain(2,5)*v(457)+(d2relativestrain(1,5,6)*equilibriumstress(1)+d2relativestrain(2,5,6)*equilibriumstress(2&
      &)+d2relativestrain(3,5,6)*equilibriumstress(3)+d2relativestrain(4,5,6)*equilibriumstress(4))*vol
  stiffness(6,1)=stiffness(6,1)+v(325)+drelativestrain(3,6)*v(434)+drelativestrain(4,6)*v(435)+drelativestrain(1,6)*v(436&
      &)+drelativestrain(2,6)*v(437)+(d2relativestrain(1,6,1)*equilibriumstress(1)+d2relativestrain(2,6,1)*equilibriumstress(2&
      &)+d2relativestrain(3,6,1)*equilibriumstress(3)+d2relativestrain(4,6,1)*equilibriumstress(4))*vol
  stiffness(6,2)=stiffness(6,2)+v(347)+drelativestrain(3,6)*v(438)+drelativestrain(4,6)*v(439)+drelativestrain(1,6)*v(440&
      &)+drelativestrain(2,6)*v(441)+(d2relativestrain(1,6,2)*equilibriumstress(1)+d2relativestrain(2,6,2)*equilibriumstress(2&
      &)+d2relativestrain(3,6,2)*equilibriumstress(3)+d2relativestrain(4,6,2)*equilibriumstress(4))*vol
  stiffness(6,3)=stiffness(6,3)+v(356)+drelativestrain(3,6)*v(442)+drelativestrain(4,6)*v(443)+drelativestrain(1,6)*v(444&
      &)+drelativestrain(2,6)*v(445)+(d2relativestrain(1,6,3)*equilibriumstress(1)+d2relativestrain(2,6,3)*equilibriumstress(2&
      &)+d2relativestrain(3,6,3)*equilibriumstress(3)+d2relativestrain(4,6,3)*equilibriumstress(4))*vol
  stiffness(6,4)=stiffness(6,4)+v(363)+drelativestrain(3,6)*v(446)+drelativestrain(4,6)*v(447)+drelativestrain(1,6)*v(448&
      &)+drelativestrain(2,6)*v(449)+(d2relativestrain(1,6,4)*equilibriumstress(1)+d2relativestrain(2,6,4)*equilibriumstress(2&
      &)+d2relativestrain(3,6,4)*equilibriumstress(3)+d2relativestrain(4,6,4)*equilibriumstress(4))*vol
  stiffness(6,5)=stiffness(6,5)+v(433)+drelativestrain(3,6)*v(450)+drelativestrain(4,6)*v(451)+drelativestrain(1,6)*v(452&
      &)+drelativestrain(2,6)*v(453)+(d2relativestrain(1,6,5)*equilibriumstress(1)+d2relativestrain(2,6,5)*equilibriumstress(2&
      &)+d2relativestrain(3,6,5)*equilibriumstress(3)+d2relativestrain(4,6,5)*equilibriumstress(4))*vol
  stiffness(6,6)=stiffness(6,6)+v(365)+drelativestrain(3,6)*v(454)+drelativestrain(4,6)*v(455)+drelativestrain(1,6)*v(456&
      &)+drelativestrain(2,6)*v(457)+(drelativestrain(1,6)**2*dstressdstrain(1,1)+drelativestrain(2,6)**2*dstressdstrain(2,2)&
      &+drelativestrain(3,6)**2*dstressdstrain(3,3)+drelativestrain(4,6)**2*dstressdstrain(4,4)+d2relativestrain(1,6,6&
      &)*equilibriumstress(1)+d2relativestrain(2,6,6)*equilibriumstress(2)+d2relativestrain(3,6,6)*equilibriumstress(3)&
      &+d2relativestrain(4,6,6)*equilibriumstress(4))*vol
END SUBROUTINE arrays2d3nstd


!**************************************************************
!* AceGen    5.003 Linux (11 Apr 13)                          *
!*           Co. J. Korelc  2007            17 Feb 15 22:42:16*
!**************************************************************
! User     : Full professional version
! Notebook : strain2d3nmini.nb
! Evaluation time                 : 13 s    Mode  : Prototype
! Number of formulae              : 389     Method: Automatic
! Subroutine                      : strain2d3nmini size :7934
! Total size of Mathematica  code : 7934 subexpressions
! Total size of Fortran code      : 26158 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE strain2d3nmini(oldthick,newthick,sqrtm,oldframe,xi,rna,rnb,alpha,proposedgrad,relativestrain&
    &,drelativestrain,d2relativestrain)
  IMPLICIT NONE
  DOUBLE PRECISION v(698),oldthick,newthick,sqrtm,oldframe(3,3),xi(2),rna(3,2),rnb(3,2),alpha(2),proposedgrad(3&
      &,3),relativestrain(4),drelativestrain(4,8),d2relativestrain(4,8,8)
  v(1)=oldthick
  v(2)=newthick
  v(4)=oldframe(1,1)
  v(5)=oldframe(1,2)
  v(6)=oldframe(1,3)
  v(7)=oldframe(2,1)
  v(8)=oldframe(2,2)
  v(9)=oldframe(2,3)
  v(10)=oldframe(3,1)
  v(11)=oldframe(3,2)
  v(352)=(v(10)*v(11)*v(2))/v(1)
  v(12)=oldframe(3,3)
  v(363)=(v(11)*v(12)*v(2))/v(1)
  v(362)=(v(10)*v(12)*v(2))/v(1)
  v(13)=xi(1)
  v(14)=xi(2)
  v(374)=-(v(13)*v(14))
  v(331)=1d0-v(13)-v(14)
  v(376)=v(13)*v(331)+v(374)
  v(375)=v(14)*v(331)+v(374)
  v(15)=rna(1,1)
  v(16)=rna(1,2)
  v(17)=rna(2,1)
  v(18)=rna(2,2)
  v(19)=rna(3,1)
  v(20)=rna(3,2)
  v(21)=rnb(1,1)
  v(22)=rnb(1,2)
  v(23)=rnb(2,1)
  v(24)=rnb(2,2)
  v(25)=rnb(3,1)
  v(26)=rnb(3,2)
  v(27)=alpha(1)
  v(332)=-(v(13)*v(14)*v(27))
  v(28)=alpha(2)
  v(335)=-(v(13)*v(14)*v(28))
  v(330)=v(15)-v(19)+v(14)*v(27)*v(331)+v(332)
  v(333)=v(17)-v(19)+v(13)*v(27)*v(331)+v(332)
  v(334)=v(16)-v(20)+v(14)*v(28)*v(331)+v(335)
  v(336)=v(18)-v(20)+v(13)*v(28)*v(331)+v(335)
  v(337)=v(21)-v(25)
  v(338)=v(23)-v(25)
  v(339)=v(22)-v(26)
  v(340)=v(24)-v(26)
  v(341)=-(v(338)*v(339))+v(337)*v(340)
  v(342)=v(340)/v(341)
  v(398)=v(342)*v(7)
  v(397)=v(342)*v(4)
  v(390)=v(342)*v(8)
  v(389)=v(342)*v(5)
  v(461)=v(389)*v(4)
  v(382)=v(342)*v(9)
  v(381)=v(342)*v(6)
  v(488)=v(381)*v(4)
  v(486)=v(381)*v(5)
  v(343)=-(v(338)/v(341))
  v(454)=v(343)*v(7)
  v(478)=v(398)*v(4)+v(454)*v(7)
  v(453)=v(343)*v(4)
  v(489)=v(488)+v(453)*v(9)
  v(477)=v(397)*v(4)+v(453)*v(7)
  v(462)=v(461)+v(453)*v(8)
  v(430)=v(343)*v(8)
  v(463)=v(430)*v(7)
  v(464)=v(463)+v(398)*v(5)
  v(446)=v(390)*v(4)+v(463)
  v(438)=v(390)*v(5)+v(430)*v(8)
  v(429)=v(343)*v(5)
  v(487)=v(486)+v(429)*v(9)
  v(445)=v(461)+v(429)*v(7)
  v(437)=v(389)*v(5)+v(429)*v(8)
  v(406)=v(343)*v(9)
  v(493)=v(406)*v(7)
  v(494)=v(493)+v(398)*v(6)
  v(491)=v(406)*v(8)
  v(492)=v(491)+v(390)*v(6)
  v(490)=v(382)*v(6)+v(406)*v(9)
  v(422)=v(382)*v(4)+v(493)
  v(414)=v(491)+v(382)*v(5)
  v(405)=v(343)*v(6)
  v(485)=v(381)*v(6)+v(405)*v(9)
  v(421)=v(488)+v(405)*v(7)
  v(413)=v(486)+v(405)*v(8)
  v(344)=-(v(339)/v(341))
  v(400)=v(344)*v(7)
  v(399)=v(344)*v(4)
  v(392)=v(344)*v(8)
  v(391)=v(344)*v(5)
  v(465)=v(391)*v(4)
  v(384)=v(344)*v(9)
  v(383)=v(344)*v(6)
  v(498)=v(383)*v(4)
  v(496)=v(383)*v(5)
  v(378)=v(342)*v(375)+v(344)*v(376)
  v(404)=v(378)*v(7)
  v(403)=v(378)*v(4)
  v(396)=v(378)*v(8)
  v(395)=v(378)*v(5)
  v(473)=v(395)*v(4)
  v(388)=v(378)*v(9)
  v(387)=v(378)*v(6)
  v(518)=v(387)*v(4)
  v(516)=v(387)*v(5)
  v(377)=-v(342)-v(344)
  v(402)=v(377)*v(7)
  v(401)=v(377)*v(4)
  v(394)=v(377)*v(8)
  v(393)=v(377)*v(5)
  v(469)=v(393)*v(4)
  v(386)=v(377)*v(9)
  v(385)=v(377)*v(6)
  v(508)=v(385)*v(4)
  v(506)=v(385)*v(5)
  v(345)=v(337)/v(341)
  v(456)=v(345)*v(7)
  v(480)=v(4)*v(400)+v(456)*v(7)
  v(455)=v(345)*v(4)
  v(499)=v(498)+v(455)*v(9)
  v(479)=v(399)*v(4)+v(455)*v(7)
  v(466)=v(465)+v(455)*v(8)
  v(432)=v(345)*v(8)
  v(467)=v(432)*v(7)
  v(468)=v(467)+v(400)*v(5)
  v(448)=v(392)*v(4)+v(467)
  v(440)=v(392)*v(5)+v(432)*v(8)
  v(431)=v(345)*v(5)
  v(497)=v(496)+v(431)*v(9)
  v(447)=v(465)+v(431)*v(7)
  v(439)=v(391)*v(5)+v(431)*v(8)
  v(408)=v(345)*v(9)
  v(503)=v(408)*v(7)
  v(504)=v(503)+v(400)*v(6)
  v(501)=v(408)*v(8)
  v(502)=v(501)+v(392)*v(6)
  v(500)=v(384)*v(6)+v(408)*v(9)
  v(424)=v(384)*v(4)+v(503)
  v(416)=v(384)*v(5)+v(501)
  v(407)=v(345)*v(6)
  v(495)=v(383)*v(6)+v(407)*v(9)
  v(423)=v(498)+v(407)*v(7)
  v(415)=v(496)+v(407)*v(8)
  v(380)=v(343)*v(375)+v(345)*v(376)
  v(460)=v(380)*v(7)
  v(484)=v(4)*v(404)+v(460)*v(7)
  v(459)=v(380)*v(4)
  v(519)=v(518)+v(459)*v(9)
  v(483)=v(4)*v(403)+v(459)*v(7)
  v(474)=v(473)+v(459)*v(8)
  v(436)=v(380)*v(8)
  v(475)=v(436)*v(7)
  v(476)=v(475)+v(404)*v(5)
  v(452)=v(396)*v(4)+v(475)
  v(444)=v(396)*v(5)+v(436)*v(8)
  v(435)=v(380)*v(5)
  v(517)=v(516)+v(435)*v(9)
  v(451)=v(473)+v(435)*v(7)
  v(443)=v(395)*v(5)+v(435)*v(8)
  v(412)=v(380)*v(9)
  v(523)=v(412)*v(7)
  v(524)=v(523)+v(404)*v(6)
  v(521)=v(412)*v(8)
  v(522)=v(521)+v(396)*v(6)
  v(520)=v(388)*v(6)+v(412)*v(9)
  v(428)=v(388)*v(4)+v(523)
  v(420)=v(388)*v(5)+v(521)
  v(411)=v(380)*v(6)
  v(515)=v(387)*v(6)+v(411)*v(9)
  v(427)=v(518)+v(411)*v(7)
  v(419)=v(516)+v(411)*v(8)
  v(379)=-v(343)-v(345)
  v(458)=v(379)*v(7)
  v(482)=v(4)*v(402)+v(458)*v(7)
  v(457)=v(379)*v(4)
  v(509)=v(508)+v(457)*v(9)
  v(481)=v(4)*v(401)+v(457)*v(7)
  v(470)=v(469)+v(457)*v(8)
  v(434)=v(379)*v(8)
  v(471)=v(434)*v(7)
  v(472)=v(471)+v(402)*v(5)
  v(450)=v(394)*v(4)+v(471)
  v(442)=v(394)*v(5)+v(434)*v(8)
  v(433)=v(379)*v(5)
  v(507)=v(506)+v(433)*v(9)
  v(449)=v(469)+v(433)*v(7)
  v(441)=v(393)*v(5)+v(433)*v(8)
  v(410)=v(379)*v(9)
  v(513)=v(410)*v(7)
  v(514)=v(513)+v(402)*v(6)
  v(511)=v(410)*v(8)
  v(512)=v(511)+v(394)*v(6)
  v(510)=v(386)*v(6)+v(410)*v(9)
  v(426)=v(386)*v(4)+v(513)
  v(418)=v(386)*v(5)+v(511)
  v(409)=v(379)*v(6)
  v(505)=v(385)*v(6)+v(409)*v(9)
  v(425)=v(508)+v(409)*v(7)
  v(417)=v(506)+v(409)*v(8)
  v(346)=v(330)*v(342)+v(333)*v(344)
  v(347)=v(330)*v(343)+v(333)*v(345)
  v(348)=v(334)*v(342)+v(336)*v(344)
  v(359)=v(346)*v(6)+v(348)*v(9)
  v(356)=v(346)*v(5)+v(348)*v(8)
  v(353)=v(346)*v(4)+v(348)*v(7)
  v(349)=v(334)*v(343)+v(336)*v(345)
  v(360)=v(347)*v(6)+v(349)*v(9)
  v(371)=((v(12)*v(12))*v(2))/v(1)+v(359)*v(6)+v(360)*v(9)
  v(367)=v(363)+v(359)*v(5)+v(360)*v(8)
  v(358)=v(362)+v(359)*v(4)+v(360)*v(7)
  v(357)=v(347)*v(5)+v(349)*v(8)
  v(370)=v(363)+v(356)*v(6)+v(357)*v(9)
  v(366)=((v(11)*v(11))*v(2))/v(1)+v(356)*v(5)+v(357)*v(8)
  v(355)=v(352)+v(356)*v(4)+v(357)*v(7)
  v(354)=v(347)*v(4)+v(349)*v(7)
  v(369)=v(362)+v(353)*v(6)+v(354)*v(9)
  v(365)=v(352)+v(353)*v(5)+v(354)*v(8)
  v(351)=((v(10)*v(10))*v(2))/v(1)+v(353)*v(4)+v(354)*v(7)
  v(350)=(v(351)*v(351))+(v(355)*v(355))+(v(358)*v(358))
  v(361)=v(351)*v(365)+v(355)*v(366)+v(358)*v(367)
  v(368)=(v(365)*v(365))+(v(366)*v(366))+(v(367)*v(367))
  v(373)=(v(369)*v(369))+(v(370)*v(370))+(v(371)*v(371))
  v(525)=v(358)*v(413)+v(367)*v(421)+v(355)*v(437)+v(366)*v(445)+v(351)*v(462)+v(365)*v(477)
  v(526)=v(358)*v(414)+v(367)*v(422)+v(355)*v(438)+v(366)*v(446)+v(351)*v(464)+v(365)*v(478)
  v(527)=v(358)*v(415)+v(367)*v(423)+v(355)*v(439)+v(366)*v(447)+v(351)*v(466)+v(365)*v(479)
  v(528)=v(358)*v(416)+v(367)*v(424)+v(355)*v(440)+v(366)*v(448)+v(351)*v(468)+v(365)*v(480)
  v(529)=v(358)*v(417)+v(367)*v(425)+v(355)*v(441)+v(366)*v(449)+v(351)*v(470)+v(365)*v(481)
  v(530)=v(358)*v(418)+v(367)*v(426)+v(355)*v(442)+v(366)*v(450)+v(351)*v(472)+v(365)*v(482)
  v(531)=v(358)*v(419)+v(367)*v(427)+v(355)*v(443)+v(366)*v(451)+v(351)*v(474)+v(365)*v(483)
  v(532)=v(358)*v(420)+v(367)*v(428)+v(355)*v(444)+v(366)*v(452)+v(351)*v(476)+v(365)*v(484)
  v(533)=(2d0*v(358)*v(421)+2d0*v(355)*v(445)+2d0*v(351)*v(477))/2d0
  v(534)=(2d0*v(358)*v(422)+2d0*v(355)*v(446)+2d0*v(351)*v(478))/2d0
  v(535)=(2d0*v(358)*v(423)+2d0*v(355)*v(447)+2d0*v(351)*v(479))/2d0
  v(536)=(2d0*v(358)*v(424)+2d0*v(355)*v(448)+2d0*v(351)*v(480))/2d0
  v(537)=(2d0*v(358)*v(425)+2d0*v(355)*v(449)+2d0*v(351)*v(481))/2d0
  v(538)=(2d0*v(358)*v(426)+2d0*v(355)*v(450)+2d0*v(351)*v(482))/2d0
  v(539)=(2d0*v(358)*v(427)+2d0*v(355)*v(451)+2d0*v(351)*v(483))/2d0
  v(540)=(2d0*v(358)*v(428)+2d0*v(355)*v(452)+2d0*v(351)*v(484))/2d0
  v(541)=(2d0*v(367)*v(413)+2d0*v(366)*v(437)+2d0*v(365)*v(462))/2d0
  v(542)=(2d0*v(367)*v(414)+2d0*v(366)*v(438)+2d0*v(365)*v(464))/2d0
  v(543)=(2d0*v(367)*v(415)+2d0*v(366)*v(439)+2d0*v(365)*v(466))/2d0
  v(544)=(2d0*v(367)*v(416)+2d0*v(366)*v(440)+2d0*v(365)*v(468))/2d0
  v(545)=(2d0*v(367)*v(417)+2d0*v(366)*v(441)+2d0*v(365)*v(470))/2d0
  v(546)=(2d0*v(367)*v(418)+2d0*v(366)*v(442)+2d0*v(365)*v(472))/2d0
  v(547)=(2d0*v(367)*v(419)+2d0*v(366)*v(443)+2d0*v(365)*v(474))/2d0
  v(548)=(2d0*v(367)*v(420)+2d0*v(366)*v(444)+2d0*v(365)*v(476))/2d0
  v(549)=(2d0*v(371)*v(485)+2d0*v(370)*v(487)+2d0*v(369)*v(489))/2d0
  v(550)=(2d0*v(371)*v(490)+2d0*v(370)*v(492)+2d0*v(369)*v(494))/2d0
  v(551)=(2d0*v(371)*v(495)+2d0*v(370)*v(497)+2d0*v(369)*v(499))/2d0
  v(552)=(2d0*v(371)*v(500)+2d0*v(370)*v(502)+2d0*v(369)*v(504))/2d0
  v(553)=(2d0*v(371)*v(505)+2d0*v(370)*v(507)+2d0*v(369)*v(509))/2d0
  v(554)=(2d0*v(371)*v(510)+2d0*v(370)*v(512)+2d0*v(369)*v(514))/2d0
  v(555)=(2d0*v(371)*v(515)+2d0*v(370)*v(517)+2d0*v(369)*v(519))/2d0
  v(556)=(2d0*v(371)*v(520)+2d0*v(370)*v(522)+2d0*v(369)*v(524))/2d0
  v(557)=(2d0*(v(421)*v(421))+2d0*(v(445)*v(445))+2d0*(v(477)*v(477)))/2d0
  v(558)=(2d0*v(421)*v(422)+2d0*v(445)*v(446)+2d0*v(477)*v(478))/2d0
  v(559)=(2d0*v(421)*v(423)+2d0*v(445)*v(447)+2d0*v(477)*v(479))/2d0
  v(560)=(2d0*v(421)*v(424)+2d0*v(445)*v(448)+2d0*v(477)*v(480))/2d0
  v(561)=(2d0*v(421)*v(425)+2d0*v(445)*v(449)+2d0*v(477)*v(481))/2d0
  v(562)=(2d0*v(421)*v(426)+2d0*v(445)*v(450)+2d0*v(477)*v(482))/2d0
  v(563)=(2d0*v(421)*v(427)+2d0*v(445)*v(451)+2d0*v(477)*v(483))/2d0
  v(564)=(2d0*v(421)*v(428)+2d0*v(445)*v(452)+2d0*v(477)*v(484))/2d0
  v(565)=(2d0*(v(413)*v(413))+2d0*(v(437)*v(437))+2d0*(v(462)*v(462)))/2d0
  v(566)=(2d0*v(413)*v(414)+2d0*v(437)*v(438)+2d0*v(462)*v(464))/2d0
  v(567)=(2d0*v(413)*v(415)+2d0*v(437)*v(439)+2d0*v(462)*v(466))/2d0
  v(568)=(2d0*v(413)*v(416)+2d0*v(437)*v(440)+2d0*v(462)*v(468))/2d0
  v(569)=(2d0*v(413)*v(417)+2d0*v(437)*v(441)+2d0*v(462)*v(470))/2d0
  v(570)=(2d0*v(413)*v(418)+2d0*v(437)*v(442)+2d0*v(462)*v(472))/2d0
  v(571)=(2d0*v(413)*v(419)+2d0*v(437)*v(443)+2d0*v(462)*v(474))/2d0
  v(572)=(2d0*v(413)*v(420)+2d0*v(437)*v(444)+2d0*v(462)*v(476))/2d0
  v(573)=(2d0*(v(485)*v(485))+2d0*(v(487)*v(487))+2d0*(v(489)*v(489)))/2d0
  v(574)=(2d0*v(485)*v(490)+2d0*v(487)*v(492)+2d0*v(489)*v(494))/2d0
  v(575)=(2d0*v(485)*v(495)+2d0*v(487)*v(497)+2d0*v(489)*v(499))/2d0
  v(576)=(2d0*v(485)*v(500)+2d0*v(487)*v(502)+2d0*v(489)*v(504))/2d0
  v(577)=(2d0*v(485)*v(505)+2d0*v(487)*v(507)+2d0*v(489)*v(509))/2d0
  v(578)=(2d0*v(485)*v(510)+2d0*v(487)*v(512)+2d0*v(489)*v(514))/2d0
  v(579)=(2d0*v(485)*v(515)+2d0*v(487)*v(517)+2d0*v(489)*v(519))/2d0
  v(580)=(2d0*v(485)*v(520)+2d0*v(487)*v(522)+2d0*v(489)*v(524))/2d0
  v(581)=2d0*v(413)*v(421)+2d0*v(437)*v(445)+2d0*v(462)*v(477)
  v(582)=v(414)*v(421)
  v(583)=v(438)*v(445)
  v(584)=v(464)*v(477)
  v(585)=2d0*v(582)+2d0*v(583)+2d0*v(584)
  v(586)=v(415)*v(421)+v(413)*v(423)+v(439)*v(445)+v(437)*v(447)+v(466)*v(477)+v(462)*v(479)
  v(587)=v(416)*v(421)+v(413)*v(424)+v(440)*v(445)+v(437)*v(448)+v(468)*v(477)+v(462)*v(480)
  v(588)=v(417)*v(421)+v(413)*v(425)+v(441)*v(445)+v(437)*v(449)+v(470)*v(477)+v(462)*v(481)
  v(589)=v(418)*v(421)+v(413)*v(426)+v(442)*v(445)+v(437)*v(450)+v(472)*v(477)+v(462)*v(482)
  v(590)=v(419)*v(421)+v(413)*v(427)+v(443)*v(445)+v(437)*v(451)+v(474)*v(477)+v(462)*v(483)
  v(591)=v(420)*v(421)+v(413)*v(428)+v(444)*v(445)+v(437)*v(452)+v(476)*v(477)+v(462)*v(484)
  v(592)=(2d0*(v(422)*v(422))+2d0*(v(446)*v(446))+2d0*(v(478)*v(478)))/2d0
  v(593)=(2d0*v(422)*v(424)+2d0*v(446)*v(448)+2d0*v(478)*v(480))/2d0
  v(594)=(2d0*v(422)*v(426)+2d0*v(446)*v(450)+2d0*v(478)*v(482))/2d0
  v(595)=(2d0*v(422)*v(428)+2d0*v(446)*v(452)+2d0*v(478)*v(484))/2d0
  v(596)=(2d0*(v(414)*v(414))+2d0*(v(438)*v(438))+2d0*(v(464)*v(464)))/2d0
  v(597)=(2d0*v(414)*v(416)+2d0*v(438)*v(440)+2d0*v(464)*v(468))/2d0
  v(598)=(2d0*v(414)*v(418)+2d0*v(438)*v(442)+2d0*v(464)*v(472))/2d0
  v(599)=(2d0*v(414)*v(420)+2d0*v(438)*v(444)+2d0*v(464)*v(476))/2d0
  v(600)=(2d0*(v(490)*v(490))+2d0*(v(492)*v(492))+2d0*(v(494)*v(494)))/2d0
  v(601)=(2d0*v(490)*v(500)+2d0*v(492)*v(502)+2d0*v(494)*v(504))/2d0
  v(602)=(2d0*v(490)*v(510)+2d0*v(492)*v(512)+2d0*v(494)*v(514))/2d0
  v(603)=(2d0*v(490)*v(520)+2d0*v(492)*v(522)+2d0*v(494)*v(524))/2d0
  v(604)=2d0*v(414)*v(422)+2d0*v(438)*v(446)+2d0*v(464)*v(478)
  v(605)=v(416)*v(422)+v(414)*v(424)+v(440)*v(446)+v(438)*v(448)+v(468)*v(478)+v(464)*v(480)
  v(606)=v(418)*v(422)+v(414)*v(426)+v(442)*v(446)+v(438)*v(450)+v(472)*v(478)+v(464)*v(482)
  v(607)=v(420)*v(422)+v(414)*v(428)+v(444)*v(446)+v(438)*v(452)+v(476)*v(478)+v(464)*v(484)
  v(608)=(2d0*(v(423)*v(423))+2d0*(v(447)*v(447))+2d0*(v(479)*v(479)))/2d0
  v(609)=(2d0*v(423)*v(424)+2d0*v(447)*v(448)+2d0*v(479)*v(480))/2d0
  v(610)=(2d0*v(423)*v(425)+2d0*v(447)*v(449)+2d0*v(479)*v(481))/2d0
  v(611)=(2d0*v(423)*v(426)+2d0*v(447)*v(450)+2d0*v(479)*v(482))/2d0
  v(612)=(2d0*v(423)*v(427)+2d0*v(447)*v(451)+2d0*v(479)*v(483))/2d0
  v(613)=(2d0*v(423)*v(428)+2d0*v(447)*v(452)+2d0*v(479)*v(484))/2d0
  v(614)=(2d0*(v(415)*v(415))+2d0*(v(439)*v(439))+2d0*(v(466)*v(466)))/2d0
  v(615)=(2d0*v(415)*v(416)+2d0*v(439)*v(440)+2d0*v(466)*v(468))/2d0
  v(616)=(2d0*v(415)*v(417)+2d0*v(439)*v(441)+2d0*v(466)*v(470))/2d0
  v(617)=(2d0*v(415)*v(418)+2d0*v(439)*v(442)+2d0*v(466)*v(472))/2d0
  v(618)=(2d0*v(415)*v(419)+2d0*v(439)*v(443)+2d0*v(466)*v(474))/2d0
  v(619)=(2d0*v(415)*v(420)+2d0*v(439)*v(444)+2d0*v(466)*v(476))/2d0
  v(620)=(2d0*(v(495)*v(495))+2d0*(v(497)*v(497))+2d0*(v(499)*v(499)))/2d0
  v(621)=(2d0*v(495)*v(500)+2d0*v(497)*v(502)+2d0*v(499)*v(504))/2d0
  v(622)=(2d0*v(495)*v(505)+2d0*v(497)*v(507)+2d0*v(499)*v(509))/2d0
  v(623)=(2d0*v(495)*v(510)+2d0*v(497)*v(512)+2d0*v(499)*v(514))/2d0
  v(624)=(2d0*v(495)*v(515)+2d0*v(497)*v(517)+2d0*v(499)*v(519))/2d0
  v(625)=(2d0*v(495)*v(520)+2d0*v(497)*v(522)+2d0*v(499)*v(524))/2d0
  v(626)=2d0*v(415)*v(423)+2d0*v(439)*v(447)+2d0*v(466)*v(479)
  v(627)=v(416)*v(423)
  v(628)=v(440)*v(447)
  v(629)=v(468)*v(479)
  v(630)=2d0*v(627)+2d0*v(628)+2d0*v(629)
  v(631)=v(417)*v(423)+v(415)*v(425)+v(441)*v(447)+v(439)*v(449)+v(470)*v(479)+v(466)*v(481)
  v(632)=v(418)*v(423)+v(415)*v(426)+v(442)*v(447)+v(439)*v(450)+v(472)*v(479)+v(466)*v(482)
  v(633)=v(419)*v(423)+v(415)*v(427)+v(443)*v(447)+v(439)*v(451)+v(474)*v(479)+v(466)*v(483)
  v(634)=v(420)*v(423)+v(415)*v(428)+v(444)*v(447)+v(439)*v(452)+v(476)*v(479)+v(466)*v(484)
  v(635)=(2d0*(v(424)*v(424))+2d0*(v(448)*v(448))+2d0*(v(480)*v(480)))/2d0
  v(636)=(2d0*v(424)*v(426)+2d0*v(448)*v(450)+2d0*v(480)*v(482))/2d0
  v(637)=(2d0*v(424)*v(428)+2d0*v(448)*v(452)+2d0*v(480)*v(484))/2d0
  v(638)=(2d0*(v(416)*v(416))+2d0*(v(440)*v(440))+2d0*(v(468)*v(468)))/2d0
  v(639)=(2d0*v(416)*v(418)+2d0*v(440)*v(442)+2d0*v(468)*v(472))/2d0
  v(640)=(2d0*v(416)*v(420)+2d0*v(440)*v(444)+2d0*v(468)*v(476))/2d0
  v(641)=(2d0*(v(500)*v(500))+2d0*(v(502)*v(502))+2d0*(v(504)*v(504)))/2d0
  v(642)=(2d0*v(500)*v(510)+2d0*v(502)*v(512)+2d0*v(504)*v(514))/2d0
  v(643)=(2d0*v(500)*v(520)+2d0*v(502)*v(522)+2d0*v(504)*v(524))/2d0
  v(644)=2d0*v(416)*v(424)+2d0*v(440)*v(448)+2d0*v(468)*v(480)
  v(645)=v(418)*v(424)+v(416)*v(426)+v(442)*v(448)+v(440)*v(450)+v(472)*v(480)+v(468)*v(482)
  v(646)=v(420)*v(424)+v(416)*v(428)+v(444)*v(448)+v(440)*v(452)+v(476)*v(480)+v(468)*v(484)
  v(647)=(2d0*(v(425)*v(425))+2d0*(v(449)*v(449))+2d0*(v(481)*v(481)))/2d0
  v(648)=(2d0*v(425)*v(426)+2d0*v(449)*v(450)+2d0*v(481)*v(482))/2d0
  v(649)=(2d0*v(425)*v(427)+2d0*v(449)*v(451)+2d0*v(481)*v(483))/2d0
  v(650)=(2d0*v(425)*v(428)+2d0*v(449)*v(452)+2d0*v(481)*v(484))/2d0
  v(651)=(2d0*(v(417)*v(417))+2d0*(v(441)*v(441))+2d0*(v(470)*v(470)))/2d0
  v(652)=(2d0*v(417)*v(418)+2d0*v(441)*v(442)+2d0*v(470)*v(472))/2d0
  v(653)=(2d0*v(417)*v(419)+2d0*v(441)*v(443)+2d0*v(470)*v(474))/2d0
  v(654)=(2d0*v(417)*v(420)+2d0*v(441)*v(444)+2d0*v(470)*v(476))/2d0
  v(655)=(2d0*(v(505)*v(505))+2d0*(v(507)*v(507))+2d0*(v(509)*v(509)))/2d0
  v(656)=(2d0*v(505)*v(510)+2d0*v(507)*v(512)+2d0*v(509)*v(514))/2d0
  v(657)=(2d0*v(505)*v(515)+2d0*v(507)*v(517)+2d0*v(509)*v(519))/2d0
  v(658)=(2d0*v(505)*v(520)+2d0*v(507)*v(522)+2d0*v(509)*v(524))/2d0
  v(659)=2d0*v(417)*v(425)+2d0*v(441)*v(449)+2d0*v(470)*v(481)
  v(660)=v(418)*v(425)
  v(661)=v(442)*v(449)
  v(662)=v(472)*v(481)
  v(663)=2d0*v(660)+2d0*v(661)+2d0*v(662)
  v(664)=v(419)*v(425)+v(417)*v(427)+v(443)*v(449)+v(441)*v(451)+v(474)*v(481)+v(470)*v(483)
  v(665)=v(420)*v(425)+v(417)*v(428)+v(444)*v(449)+v(441)*v(452)+v(476)*v(481)+v(470)*v(484)
  v(666)=(2d0*(v(426)*v(426))+2d0*(v(450)*v(450))+2d0*(v(482)*v(482)))/2d0
  v(667)=(2d0*v(426)*v(428)+2d0*v(450)*v(452)+2d0*v(482)*v(484))/2d0
  v(668)=(2d0*(v(418)*v(418))+2d0*(v(442)*v(442))+2d0*(v(472)*v(472)))/2d0
  v(669)=(2d0*v(418)*v(420)+2d0*v(442)*v(444)+2d0*v(472)*v(476))/2d0
  v(670)=(2d0*(v(510)*v(510))+2d0*(v(512)*v(512))+2d0*(v(514)*v(514)))/2d0
  v(671)=(2d0*v(510)*v(520)+2d0*v(512)*v(522)+2d0*v(514)*v(524))/2d0
  v(672)=2d0*v(418)*v(426)+2d0*v(442)*v(450)+2d0*v(472)*v(482)
  v(673)=v(420)*v(426)+v(418)*v(428)+v(444)*v(450)+v(442)*v(452)+v(476)*v(482)+v(472)*v(484)
  v(674)=(2d0*(v(427)*v(427))+2d0*(v(451)*v(451))+2d0*(v(483)*v(483)))/2d0
  v(675)=(2d0*v(427)*v(428)+2d0*v(451)*v(452)+2d0*v(483)*v(484))/2d0
  v(676)=(2d0*(v(419)*v(419))+2d0*(v(443)*v(443))+2d0*(v(474)*v(474)))/2d0
  v(677)=(2d0*v(419)*v(420)+2d0*v(443)*v(444)+2d0*v(474)*v(476))/2d0
  v(678)=(2d0*(v(515)*v(515))+2d0*(v(517)*v(517))+2d0*(v(519)*v(519)))/2d0
  v(679)=(2d0*v(515)*v(520)+2d0*v(517)*v(522)+2d0*v(519)*v(524))/2d0
  v(680)=2d0*v(419)*v(427)+2d0*v(443)*v(451)+2d0*v(474)*v(483)
  v(681)=v(420)*v(427)
  v(682)=v(444)*v(451)
  v(683)=v(476)*v(483)
  v(684)=2d0*v(681)+2d0*v(682)+2d0*v(683)
  v(685)=(2d0*(v(428)*v(428))+2d0*(v(452)*v(452))+2d0*(v(484)*v(484)))/2d0
  v(686)=(2d0*(v(420)*v(420))+2d0*(v(444)*v(444))+2d0*(v(476)*v(476)))/2d0
  v(687)=(2d0*(v(520)*v(520))+2d0*(v(522)*v(522))+2d0*(v(524)*v(524)))/2d0
  v(688)=2d0*v(420)*v(428)+2d0*v(444)*v(452)+2d0*v(476)*v(484)
  sqrtm=v(341)
  proposedgrad(1,1)=v(351)
  proposedgrad(1,2)=v(365)
  proposedgrad(1,3)=v(369)
  proposedgrad(2,1)=v(355)
  proposedgrad(2,2)=v(366)
  proposedgrad(2,3)=v(370)
  proposedgrad(3,1)=v(358)
  proposedgrad(3,2)=v(367)
  proposedgrad(3,3)=v(371)
  relativestrain(1)=((-1d0)+v(350))/2d0
  relativestrain(2)=((-1d0)+v(368))/2d0
  relativestrain(3)=((-1d0)+v(373))/2d0
  relativestrain(4)=v(361)
  drelativestrain(1,1)=v(533)
  drelativestrain(1,2)=v(534)
  drelativestrain(1,3)=v(535)
  drelativestrain(1,4)=v(536)
  drelativestrain(1,5)=v(537)
  drelativestrain(1,6)=v(538)
  drelativestrain(1,7)=v(539)
  drelativestrain(1,8)=v(540)
  drelativestrain(2,1)=v(541)
  drelativestrain(2,2)=v(542)
  drelativestrain(2,3)=v(543)
  drelativestrain(2,4)=v(544)
  drelativestrain(2,5)=v(545)
  drelativestrain(2,6)=v(546)
  drelativestrain(2,7)=v(547)
  drelativestrain(2,8)=v(548)
  drelativestrain(3,1)=v(549)
  drelativestrain(3,2)=v(550)
  drelativestrain(3,3)=v(551)
  drelativestrain(3,4)=v(552)
  drelativestrain(3,5)=v(553)
  drelativestrain(3,6)=v(554)
  drelativestrain(3,7)=v(555)
  drelativestrain(3,8)=v(556)
  drelativestrain(4,1)=v(525)
  drelativestrain(4,2)=v(526)
  drelativestrain(4,3)=v(527)
  drelativestrain(4,4)=v(528)
  drelativestrain(4,5)=v(529)
  drelativestrain(4,6)=v(530)
  drelativestrain(4,7)=v(531)
  drelativestrain(4,8)=v(532)
  d2relativestrain(1,1,1)=v(557)
  d2relativestrain(1,1,2)=v(558)
  d2relativestrain(1,1,3)=v(559)
  d2relativestrain(1,1,4)=v(560)
  d2relativestrain(1,1,5)=v(561)
  d2relativestrain(1,1,6)=v(562)
  d2relativestrain(1,1,7)=v(563)
  d2relativestrain(1,1,8)=v(564)
  d2relativestrain(1,2,1)=v(558)
  d2relativestrain(1,2,2)=v(592)
  d2relativestrain(1,2,3)=v(560)
  d2relativestrain(1,2,4)=v(593)
  d2relativestrain(1,2,5)=v(562)
  d2relativestrain(1,2,6)=v(594)
  d2relativestrain(1,2,7)=v(564)
  d2relativestrain(1,2,8)=v(595)
  d2relativestrain(1,3,1)=v(559)
  d2relativestrain(1,3,2)=v(560)
  d2relativestrain(1,3,3)=v(608)
  d2relativestrain(1,3,4)=v(609)
  d2relativestrain(1,3,5)=v(610)
  d2relativestrain(1,3,6)=v(611)
  d2relativestrain(1,3,7)=v(612)
  d2relativestrain(1,3,8)=v(613)
  d2relativestrain(1,4,1)=v(560)
  d2relativestrain(1,4,2)=v(593)
  d2relativestrain(1,4,3)=v(609)
  d2relativestrain(1,4,4)=v(635)
  d2relativestrain(1,4,5)=v(611)
  d2relativestrain(1,4,6)=v(636)
  d2relativestrain(1,4,7)=v(613)
  d2relativestrain(1,4,8)=v(637)
  d2relativestrain(1,5,1)=v(561)
  d2relativestrain(1,5,2)=v(562)
  d2relativestrain(1,5,3)=v(610)
  d2relativestrain(1,5,4)=v(611)
  d2relativestrain(1,5,5)=v(647)
  d2relativestrain(1,5,6)=v(648)
  d2relativestrain(1,5,7)=v(649)
  d2relativestrain(1,5,8)=v(650)
  d2relativestrain(1,6,1)=v(562)
  d2relativestrain(1,6,2)=v(594)
  d2relativestrain(1,6,3)=v(611)
  d2relativestrain(1,6,4)=v(636)
  d2relativestrain(1,6,5)=v(648)
  d2relativestrain(1,6,6)=v(666)
  d2relativestrain(1,6,7)=v(650)
  d2relativestrain(1,6,8)=v(667)
  d2relativestrain(1,7,1)=v(563)
  d2relativestrain(1,7,2)=v(564)
  d2relativestrain(1,7,3)=v(612)
  d2relativestrain(1,7,4)=v(613)
  d2relativestrain(1,7,5)=v(649)
  d2relativestrain(1,7,6)=v(650)
  d2relativestrain(1,7,7)=v(674)
  d2relativestrain(1,7,8)=v(675)
  d2relativestrain(1,8,1)=v(564)
  d2relativestrain(1,8,2)=v(595)
  d2relativestrain(1,8,3)=v(613)
  d2relativestrain(1,8,4)=v(637)
  d2relativestrain(1,8,5)=v(650)
  d2relativestrain(1,8,6)=v(667)
  d2relativestrain(1,8,7)=v(675)
  d2relativestrain(1,8,8)=v(685)
  d2relativestrain(2,1,1)=v(565)
  d2relativestrain(2,1,2)=v(566)
  d2relativestrain(2,1,3)=v(567)
  d2relativestrain(2,1,4)=v(568)
  d2relativestrain(2,1,5)=v(569)
  d2relativestrain(2,1,6)=v(570)
  d2relativestrain(2,1,7)=v(571)
  d2relativestrain(2,1,8)=v(572)
  d2relativestrain(2,2,1)=v(566)
  d2relativestrain(2,2,2)=v(596)
  d2relativestrain(2,2,3)=v(568)
  d2relativestrain(2,2,4)=v(597)
  d2relativestrain(2,2,5)=v(570)
  d2relativestrain(2,2,6)=v(598)
  d2relativestrain(2,2,7)=v(572)
  d2relativestrain(2,2,8)=v(599)
  d2relativestrain(2,3,1)=v(567)
  d2relativestrain(2,3,2)=v(568)
  d2relativestrain(2,3,3)=v(614)
  d2relativestrain(2,3,4)=v(615)
  d2relativestrain(2,3,5)=v(616)
  d2relativestrain(2,3,6)=v(617)
  d2relativestrain(2,3,7)=v(618)
  d2relativestrain(2,3,8)=v(619)
  d2relativestrain(2,4,1)=v(568)
  d2relativestrain(2,4,2)=v(597)
  d2relativestrain(2,4,3)=v(615)
  d2relativestrain(2,4,4)=v(638)
  d2relativestrain(2,4,5)=v(617)
  d2relativestrain(2,4,6)=v(639)
  d2relativestrain(2,4,7)=v(619)
  d2relativestrain(2,4,8)=v(640)
  d2relativestrain(2,5,1)=v(569)
  d2relativestrain(2,5,2)=v(570)
  d2relativestrain(2,5,3)=v(616)
  d2relativestrain(2,5,4)=v(617)
  d2relativestrain(2,5,5)=v(651)
  d2relativestrain(2,5,6)=v(652)
  d2relativestrain(2,5,7)=v(653)
  d2relativestrain(2,5,8)=v(654)
  d2relativestrain(2,6,1)=v(570)
  d2relativestrain(2,6,2)=v(598)
  d2relativestrain(2,6,3)=v(617)
  d2relativestrain(2,6,4)=v(639)
  d2relativestrain(2,6,5)=v(652)
  d2relativestrain(2,6,6)=v(668)
  d2relativestrain(2,6,7)=v(654)
  d2relativestrain(2,6,8)=v(669)
  d2relativestrain(2,7,1)=v(571)
  d2relativestrain(2,7,2)=v(572)
  d2relativestrain(2,7,3)=v(618)
  d2relativestrain(2,7,4)=v(619)
  d2relativestrain(2,7,5)=v(653)
  d2relativestrain(2,7,6)=v(654)
  d2relativestrain(2,7,7)=v(676)
  d2relativestrain(2,7,8)=v(677)
  d2relativestrain(2,8,1)=v(572)
  d2relativestrain(2,8,2)=v(599)
  d2relativestrain(2,8,3)=v(619)
  d2relativestrain(2,8,4)=v(640)
  d2relativestrain(2,8,5)=v(654)
  d2relativestrain(2,8,6)=v(669)
  d2relativestrain(2,8,7)=v(677)
  d2relativestrain(2,8,8)=v(686)
  d2relativestrain(3,1,1)=v(573)
  d2relativestrain(3,1,2)=v(574)
  d2relativestrain(3,1,3)=v(575)
  d2relativestrain(3,1,4)=v(576)
  d2relativestrain(3,1,5)=v(577)
  d2relativestrain(3,1,6)=v(578)
  d2relativestrain(3,1,7)=v(579)
  d2relativestrain(3,1,8)=v(580)
  d2relativestrain(3,2,1)=v(574)
  d2relativestrain(3,2,2)=v(600)
  d2relativestrain(3,2,3)=v(576)
  d2relativestrain(3,2,4)=v(601)
  d2relativestrain(3,2,5)=v(578)
  d2relativestrain(3,2,6)=v(602)
  d2relativestrain(3,2,7)=v(580)
  d2relativestrain(3,2,8)=v(603)
  d2relativestrain(3,3,1)=v(575)
  d2relativestrain(3,3,2)=v(576)
  d2relativestrain(3,3,3)=v(620)
  d2relativestrain(3,3,4)=v(621)
  d2relativestrain(3,3,5)=v(622)
  d2relativestrain(3,3,6)=v(623)
  d2relativestrain(3,3,7)=v(624)
  d2relativestrain(3,3,8)=v(625)
  d2relativestrain(3,4,1)=v(576)
  d2relativestrain(3,4,2)=v(601)
  d2relativestrain(3,4,3)=v(621)
  d2relativestrain(3,4,4)=v(641)
  d2relativestrain(3,4,5)=v(623)
  d2relativestrain(3,4,6)=v(642)
  d2relativestrain(3,4,7)=v(625)
  d2relativestrain(3,4,8)=v(643)
  d2relativestrain(3,5,1)=v(577)
  d2relativestrain(3,5,2)=v(578)
  d2relativestrain(3,5,3)=v(622)
  d2relativestrain(3,5,4)=v(623)
  d2relativestrain(3,5,5)=v(655)
  d2relativestrain(3,5,6)=v(656)
  d2relativestrain(3,5,7)=v(657)
  d2relativestrain(3,5,8)=v(658)
  d2relativestrain(3,6,1)=v(578)
  d2relativestrain(3,6,2)=v(602)
  d2relativestrain(3,6,3)=v(623)
  d2relativestrain(3,6,4)=v(642)
  d2relativestrain(3,6,5)=v(656)
  d2relativestrain(3,6,6)=v(670)
  d2relativestrain(3,6,7)=v(658)
  d2relativestrain(3,6,8)=v(671)
  d2relativestrain(3,7,1)=v(579)
  d2relativestrain(3,7,2)=v(580)
  d2relativestrain(3,7,3)=v(624)
  d2relativestrain(3,7,4)=v(625)
  d2relativestrain(3,7,5)=v(657)
  d2relativestrain(3,7,6)=v(658)
  d2relativestrain(3,7,7)=v(678)
  d2relativestrain(3,7,8)=v(679)
  d2relativestrain(3,8,1)=v(580)
  d2relativestrain(3,8,2)=v(603)
  d2relativestrain(3,8,3)=v(625)
  d2relativestrain(3,8,4)=v(643)
  d2relativestrain(3,8,5)=v(658)
  d2relativestrain(3,8,6)=v(671)
  d2relativestrain(3,8,7)=v(679)
  d2relativestrain(3,8,8)=v(687)
  d2relativestrain(4,1,1)=v(581)
  d2relativestrain(4,1,2)=v(585)
  d2relativestrain(4,1,3)=v(586)
  d2relativestrain(4,1,4)=v(587)
  d2relativestrain(4,1,5)=v(588)
  d2relativestrain(4,1,6)=v(589)
  d2relativestrain(4,1,7)=v(590)
  d2relativestrain(4,1,8)=v(591)
  d2relativestrain(4,2,1)=v(585)
  d2relativestrain(4,2,2)=v(604)
  d2relativestrain(4,2,3)=v(587)
  d2relativestrain(4,2,4)=v(605)
  d2relativestrain(4,2,5)=v(589)
  d2relativestrain(4,2,6)=v(606)
  d2relativestrain(4,2,7)=v(591)
  d2relativestrain(4,2,8)=v(607)
  d2relativestrain(4,3,1)=v(586)
  d2relativestrain(4,3,2)=v(587)
  d2relativestrain(4,3,3)=v(626)
  d2relativestrain(4,3,4)=v(630)
  d2relativestrain(4,3,5)=v(631)
  d2relativestrain(4,3,6)=v(632)
  d2relativestrain(4,3,7)=v(633)
  d2relativestrain(4,3,8)=v(634)
  d2relativestrain(4,4,1)=v(587)
  d2relativestrain(4,4,2)=v(605)
  d2relativestrain(4,4,3)=v(630)
  d2relativestrain(4,4,4)=v(644)
  d2relativestrain(4,4,5)=v(632)
  d2relativestrain(4,4,6)=v(645)
  d2relativestrain(4,4,7)=v(634)
  d2relativestrain(4,4,8)=v(646)
  d2relativestrain(4,5,1)=v(588)
  d2relativestrain(4,5,2)=v(589)
  d2relativestrain(4,5,3)=v(631)
  d2relativestrain(4,5,4)=v(632)
  d2relativestrain(4,5,5)=v(659)
  d2relativestrain(4,5,6)=v(663)
  d2relativestrain(4,5,7)=v(664)
  d2relativestrain(4,5,8)=v(665)
  d2relativestrain(4,6,1)=v(589)
  d2relativestrain(4,6,2)=v(606)
  d2relativestrain(4,6,3)=v(632)
  d2relativestrain(4,6,4)=v(645)
  d2relativestrain(4,6,5)=v(663)
  d2relativestrain(4,6,6)=v(672)
  d2relativestrain(4,6,7)=v(665)
  d2relativestrain(4,6,8)=v(673)
  d2relativestrain(4,7,1)=v(590)
  d2relativestrain(4,7,2)=v(591)
  d2relativestrain(4,7,3)=v(633)
  d2relativestrain(4,7,4)=v(634)
  d2relativestrain(4,7,5)=v(664)
  d2relativestrain(4,7,6)=v(665)
  d2relativestrain(4,7,7)=v(680)
  d2relativestrain(4,7,8)=v(684)
  d2relativestrain(4,8,1)=v(591)
  d2relativestrain(4,8,2)=v(607)
  d2relativestrain(4,8,3)=v(634)
  d2relativestrain(4,8,4)=v(646)
  d2relativestrain(4,8,5)=v(665)
  d2relativestrain(4,8,6)=v(673)
  d2relativestrain(4,8,7)=v(684)
  d2relativestrain(4,8,8)=v(688)
END SUBROUTINE strain2d3nmini

SUBROUTINE ARRAYS2D3NMINI(VOL,RHO,VECLOAD,ACC,DACC,FFOR,DRELATIVESTRAIN,D2RELATIVESTRAIN,EQUILIBRIUMSTRESS,PRESSN,DSTRESSDSTRAIN,FORCE,STIFFNESS)
  IMPLICIT NONE
  DOUBLE PRECISION V(855),VOL,RHO,VECLOAD(2),ACC(3,2),DACC,FFOR(4),DRELATIVESTRAIN(4,8),D2RELATIVESTRAIN(4,8,8)&
      &,EQUILIBRIUMSTRESS(4),PRESSN(3),DSTRESSDSTRAIN(4,4),FORCE(11),STIFFNESS(11,11)
  V(850)=DRELATIVESTRAIN(1,8)+DRELATIVESTRAIN(2,8)+DRELATIVESTRAIN(3,8)
  V(849)=DRELATIVESTRAIN(1,7)+DRELATIVESTRAIN(2,7)+DRELATIVESTRAIN(3,7)
  V(848)=DRELATIVESTRAIN(1,6)+DRELATIVESTRAIN(2,6)+DRELATIVESTRAIN(3,6)
  V(847)=DRELATIVESTRAIN(1,5)+DRELATIVESTRAIN(2,5)+DRELATIVESTRAIN(3,5)
  V(839)=DRELATIVESTRAIN(1,4)+DRELATIVESTRAIN(2,4)+DRELATIVESTRAIN(3,4)
  V(838)=DRELATIVESTRAIN(1,3)+DRELATIVESTRAIN(2,3)+DRELATIVESTRAIN(3,3)
  V(837)=V(838)*VOL
  V(836)=FFOR(3)*VOL
  V(792)=DRELATIVESTRAIN(4,7)*DRELATIVESTRAIN(4,8)*DSTRESSDSTRAIN(4,4)
  V(791)=-(FFOR(2)*V(836))
  V(790)=-(FFOR(1)*VOL)
  V(789)=FFOR(2)*V(790)
  V(788)=VOL/3D0
  V(787)=DSTRESSDSTRAIN(1,3)+DSTRESSDSTRAIN(2,3)+DSTRESSDSTRAIN(3,3)
  V(828)=V(787)/3D0
  V(786)=DSTRESSDSTRAIN(1,2)+DSTRESSDSTRAIN(2,2)+DSTRESSDSTRAIN(3,2)
  V(827)=V(786)/3D0
  V(785)=DSTRESSDSTRAIN(1,1)+DSTRESSDSTRAIN(2,1)+DSTRESSDSTRAIN(3,1)
  V(826)=V(785)/3D0
  V(784)=DRELATIVESTRAIN(4,8)*VOL
  V(783)=DRELATIVESTRAIN(3,8)*VOL
  V(782)=DRELATIVESTRAIN(2,8)*VOL
  V(781)=DRELATIVESTRAIN(1,8)*VOL
  V(780)=DRELATIVESTRAIN(4,7)*VOL
  V(779)=DRELATIVESTRAIN(3,7)*VOL
  V(778)=DRELATIVESTRAIN(2,7)*VOL
  V(777)=DRELATIVESTRAIN(1,7)*VOL
  V(776)=DRELATIVESTRAIN(4,6)*VOL
  V(775)=DRELATIVESTRAIN(3,6)*VOL
  V(774)=DRELATIVESTRAIN(2,6)*VOL
  V(773)=DRELATIVESTRAIN(1,6)*VOL
  V(772)=DRELATIVESTRAIN(4,5)*VOL
  V(771)=DRELATIVESTRAIN(3,5)*VOL
  V(770)=DRELATIVESTRAIN(2,5)*VOL
  V(769)=DRELATIVESTRAIN(1,5)*VOL
  V(768)=DRELATIVESTRAIN(4,4)*VOL
  V(767)=DRELATIVESTRAIN(3,4)*VOL
  V(766)=DRELATIVESTRAIN(2,4)*VOL
  V(765)=DRELATIVESTRAIN(1,4)*VOL
  V(764)=DRELATIVESTRAIN(4,3)*VOL
  V(763)=DRELATIVESTRAIN(3,3)*VOL
  V(762)=DRELATIVESTRAIN(2,3)*VOL
  V(761)=DRELATIVESTRAIN(1,3)*VOL
  V(760)=DRELATIVESTRAIN(4,2)*VOL
  V(759)=DRELATIVESTRAIN(3,2)*VOL
  V(758)=DRELATIVESTRAIN(2,2)*VOL
  V(757)=DRELATIVESTRAIN(1,2)*VOL
  V(756)=DRELATIVESTRAIN(4,1)*VOL
  V(754)=(2D0/3D0)*DSTRESSDSTRAIN(3,3)
  V(753)=DRELATIVESTRAIN(3,1)*VOL
  V(752)=DRELATIVESTRAIN(2,1)*VOL
  V(750)=(2D0/3D0)*DSTRESSDSTRAIN(2,2)
  V(749)=DRELATIVESTRAIN(1,1)*VOL
  V(747)=(2D0/3D0)*DSTRESSDSTRAIN(1,1)
  V(742)=FFOR(3)**2
  V(741)=FFOR(2)**2
  V(740)=(2D0/3D0)*EQUILIBRIUMSTRESS(3)
  V(739)=(2D0/3D0)*EQUILIBRIUMSTRESS(2)
  V(738)=(2D0/3D0)*EQUILIBRIUMSTRESS(1)
  V(737)=DACC*FFOR(3)
  V(736)=FFOR(1)**2
  V(735)=RHO*VOL
  V(734)=DSTRESSDSTRAIN(4,4)*VOL
  V(733)=DRELATIVESTRAIN(4,6)*V(734)
  V(732)=(2D0/3D0)*DSTRESSDSTRAIN(1,4)
  V(731)=(2D0/3D0)*DSTRESSDSTRAIN(2,4)
  V(730)=-DSTRESSDSTRAIN(3,4)/3D0
  V(729)=(2D0/3D0)*DSTRESSDSTRAIN(3,4)
  V(728)=DSTRESSDSTRAIN(1,4)+DSTRESSDSTRAIN(2,4)+DSTRESSDSTRAIN(3,4)
  V(727)=(2D0/3D0)*DSTRESSDSTRAIN(1,3)
  V(726)=(2D0/3D0)*DSTRESSDSTRAIN(2,3)
  V(725)=-DSTRESSDSTRAIN(3,3)/3D0
  V(724)=(2D0/3D0)*DSTRESSDSTRAIN(1,2)
  V(723)=-DSTRESSDSTRAIN(3,2)/3D0
  V(722)=(2D0/3D0)*DSTRESSDSTRAIN(3,2)
  V(721)=(2D0/3D0)*DSTRESSDSTRAIN(2,1)
  V(720)=-DSTRESSDSTRAIN(3,1)/3D0
  V(719)=(2D0/3D0)*DSTRESSDSTRAIN(3,1)
  V(718)=-DSTRESSDSTRAIN(2,4)/3D0
  V(717)=-DSTRESSDSTRAIN(2,3)/3D0
  V(716)=-DSTRESSDSTRAIN(2,2)/3D0
  V(715)=-DSTRESSDSTRAIN(2,1)/3D0
  V(714)=-DSTRESSDSTRAIN(1,4)/3D0
  V(713)=-DSTRESSDSTRAIN(1,3)/3D0
  V(712)=-DSTRESSDSTRAIN(1,2)/3D0
  V(711)=-DSTRESSDSTRAIN(1,1)/3D0
  V(710)=-EQUILIBRIUMSTRESS(3)/3D0
  V(709)=FFOR(3)*PRESSN(3)
  V(708)=FFOR(2)*PRESSN(2)
  V(707)=FFOR(1)*PRESSN(1)
  V(706)=-EQUILIBRIUMSTRESS(2)/3D0
  V(705)=-EQUILIBRIUMSTRESS(1)/3D0
  V(704)=FFOR(1)*V(735)
  V(636)=V(704)*V(737)
  V(466)=V(707)+V(708)+V(709)
  V(464)=V(466)+V(710)
  V(512)=V(711)+V(715)+V(719)
  V(510)=V(711)+V(720)+V(721)
  V(516)=V(712)+V(716)+V(722)
  V(514)=V(716)+V(723)+V(724)
  V(520)=V(713)+V(725)+V(726)
  V(518)=V(717)+V(725)+V(727)
  V(526)=V(714)+V(718)+V(729)
  V(524)=V(714)+V(730)+V(731)
  V(522)=V(718)+V(730)+V(732)
  V(693)=DRELATIVESTRAIN(4,5)*V(734)
  V(670)=DRELATIVESTRAIN(4,4)*V(734)
  V(660)=DRELATIVESTRAIN(4,3)*V(734)
  V(630)=DRELATIVESTRAIN(4,2)*V(734)
  V(537)=DRELATIVESTRAIN(4,1)*V(734)
  V(459)=ACC(1,1)*V(735)
  V(745)=FFOR(1)*V(459)
  V(480)=V(735)*V(736)
  V(461)=FFOR(2)*V(735)
  V(746)=FFOR(3)*V(461)
  V(743)=ACC(2,1)*V(461)
  V(666)=V(461)*V(737)
  V(626)=DACC*FFOR(1)*V(461)
  V(462)=FFOR(3)*V(704)
  V(463)=V(464)+V(706)+V(738)
  V(465)=V(464)+V(705)+V(739)
  V(469)=V(466)+V(705)+V(706)+V(740)
  V(471)=ACC(2,2)*V(735)
  V(472)=ACC(3,2)*V(735)
  V(476)=(EQUILIBRIUMSTRESS(1)+EQUILIBRIUMSTRESS(2)+EQUILIBRIUMSTRESS(3)-3D0*V(707)-3D0*V(708)-3D0*V(709))/3D0
  V(744)=V(476)*VOL
  V(654)=V(735)*V(741)
  V(687)=V(735)*V(742)
  FORCE(1)=FORCE(1)+ACC(3,1)*V(462)+V(459)*V(736)+FFOR(1)*V(743)+(DRELATIVESTRAIN(4,1)*EQUILIBRIUMSTRESS(4)&
      &+DRELATIVESTRAIN(1,1)*V(463)+DRELATIVESTRAIN(2,1)*V(465)+DRELATIVESTRAIN(3,1)*V(469)-FFOR(1)*VECLOAD(1))*VOL
  FORCE(2)=FORCE(2)+FFOR(1)*(FFOR(2)*V(471)+FFOR(3)*V(472))+ACC(1,2)*V(480)+(DRELATIVESTRAIN(4,2)*EQUILIBRIUMSTRESS(4)&
      &+DRELATIVESTRAIN(1,2)*V(463)+DRELATIVESTRAIN(2,2)*V(465)+DRELATIVESTRAIN(3,2)*V(469)-FFOR(1)*VECLOAD(2))*VOL
  FORCE(3)=FORCE(3)+FFOR(1)*V(744)
  FORCE(4)=FORCE(4)+ACC(2,1)*V(654)+FFOR(2)*V(745)+ACC(3,1)*V(746)+(DRELATIVESTRAIN(4,3)*EQUILIBRIUMSTRESS(4)&
      &+DRELATIVESTRAIN(1,3)*V(463)+DRELATIVESTRAIN(2,3)*V(465)+DRELATIVESTRAIN(3,3)*V(469)-FFOR(2)*VECLOAD(1))*VOL
  FORCE(5)=FORCE(5)+ACC(1,2)*FFOR(2)*V(704)+V(471)*V(741)+ACC(3,2)*V(746)+(DRELATIVESTRAIN(4,4)*EQUILIBRIUMSTRESS(4)&
      &+DRELATIVESTRAIN(1,4)*V(463)+DRELATIVESTRAIN(2,4)*V(465)+DRELATIVESTRAIN(3,4)*V(469)-FFOR(2)*VECLOAD(2))*VOL
  FORCE(6)=FORCE(6)+FFOR(2)*V(744)
  FORCE(7)=FORCE(7)+ACC(3,1)*V(687)+FFOR(3)*(V(743)+V(745))+(DRELATIVESTRAIN(4,5)*EQUILIBRIUMSTRESS(4)+DRELATIVESTRAIN(1&
      &,5)*V(463)+DRELATIVESTRAIN(2,5)*V(465)+DRELATIVESTRAIN(3,5)*V(469)-FFOR(3)*VECLOAD(1))*VOL
  FORCE(8)=FORCE(8)+ACC(1,2)*V(462)+V(472)*V(742)+ACC(2,2)*V(746)+(DRELATIVESTRAIN(4,6)*EQUILIBRIUMSTRESS(4)&
      &+DRELATIVESTRAIN(1,6)*V(463)+DRELATIVESTRAIN(2,6)*V(465)+DRELATIVESTRAIN(3,6)*V(469)-FFOR(3)*VECLOAD(2))*VOL
  FORCE(9)=FORCE(9)+FFOR(3)*V(744)
  FORCE(10)=FORCE(10)+(DRELATIVESTRAIN(4,7)*EQUILIBRIUMSTRESS(4)+DRELATIVESTRAIN(1,7)*V(463)+DRELATIVESTRAIN(2,7)*V(465)&
      &+DRELATIVESTRAIN(3,7)*V(469))*VOL
  FORCE(11)=FORCE(11)+(DRELATIVESTRAIN(4,8)*EQUILIBRIUMSTRESS(4)+DRELATIVESTRAIN(1,8)*V(463)+DRELATIVESTRAIN(2,8)*V(465)&
      &+DRELATIVESTRAIN(3,8)*V(469))*VOL
  V(481)=DACC*V(480)
  V(482)=V(715)+V(720)+V(747)
  V(748)=V(482)*VOL
  V(698)=DRELATIVESTRAIN(1,6)*V(748)
  V(690)=DRELATIVESTRAIN(1,5)*V(748)
  V(667)=DRELATIVESTRAIN(1,4)*V(748)
  V(657)=DRELATIVESTRAIN(1,3)*V(748)
  V(627)=DRELATIVESTRAIN(1,2)*V(748)
  V(534)=DRELATIVESTRAIN(1,1)*V(748)
  V(484)=V(510)*V(749)
  V(487)=V(512)*V(749)
  V(488)=V(514)*V(752)
  V(490)=V(712)+V(723)+V(750)
  V(751)=V(490)*VOL
  V(699)=DRELATIVESTRAIN(2,6)*V(751)
  V(691)=DRELATIVESTRAIN(2,5)*V(751)
  V(668)=DRELATIVESTRAIN(2,4)*V(751)
  V(658)=DRELATIVESTRAIN(2,3)*V(751)
  V(628)=DRELATIVESTRAIN(2,2)*V(751)
  V(535)=DRELATIVESTRAIN(2,1)*V(751)
  V(493)=V(516)*V(752)
  V(494)=V(518)*V(753)
  V(496)=V(520)*V(753)
  V(499)=V(713)+V(717)+V(754)
  V(755)=V(499)*VOL
  V(700)=DRELATIVESTRAIN(3,6)*V(755)
  V(692)=DRELATIVESTRAIN(3,5)*V(755)
  V(669)=DRELATIVESTRAIN(3,4)*V(755)
  V(659)=DRELATIVESTRAIN(3,3)*V(755)
  V(629)=DRELATIVESTRAIN(3,2)*V(755)
  V(536)=DRELATIVESTRAIN(3,1)*V(755)
  V(500)=V(522)*V(756)
  V(793)=V(488)+V(494)+V(500)
  V(502)=V(524)*V(756)
  V(794)=V(484)+V(496)+V(502)
  V(505)=V(526)*V(756)
  V(795)=V(487)+V(493)+V(505)
  V(506)=DSTRESSDSTRAIN(4,1)*V(749)
  V(507)=DSTRESSDSTRAIN(4,2)*V(752)
  V(508)=DSTRESSDSTRAIN(4,3)*V(753)
  V(796)=V(506)+V(507)+V(508)
  V(509)=DRELATIVESTRAIN(1,2)*V(534)+DRELATIVESTRAIN(2,2)*V(535)+DRELATIVESTRAIN(3,2)*V(536)+DRELATIVESTRAIN(4,2)*V(537)
  V(511)=V(510)*V(757)
  V(513)=V(512)*V(757)
  V(515)=V(514)*V(758)
  V(517)=V(516)*V(758)
  V(519)=V(518)*V(759)
  V(521)=V(520)*V(759)
  V(523)=V(522)*V(760)
  V(797)=V(515)+V(519)+V(523)
  V(525)=V(524)*V(760)
  V(798)=V(511)+V(521)+V(525)
  V(527)=V(526)*V(760)
  V(799)=V(513)+V(517)+V(527)
  V(528)=DSTRESSDSTRAIN(4,1)*V(757)
  V(529)=DSTRESSDSTRAIN(4,2)*V(758)
  V(530)=DSTRESSDSTRAIN(4,3)*V(759)
  V(800)=V(528)+V(529)+V(530)
  V(531)=FFOR(1)*V(749)
  V(532)=FFOR(1)*V(752)
  V(533)=FFOR(1)*V(753)
  V(538)=DRELATIVESTRAIN(1,3)*V(534)+DRELATIVESTRAIN(2,3)*V(535)+DRELATIVESTRAIN(3,3)*V(536)+DRELATIVESTRAIN(4,3)*V(537)&
      &+V(626)
  V(539)=V(510)*V(761)
  V(540)=V(512)*V(761)
  V(541)=V(514)*V(762)
  V(542)=V(516)*V(762)
  V(543)=V(518)*V(763)
  V(544)=V(520)*V(763)
  V(545)=V(522)*V(764)
  V(801)=V(541)+V(543)+V(545)
  V(546)=V(524)*V(764)
  V(802)=V(539)+V(544)+V(546)
  V(547)=V(526)*V(764)
  V(803)=V(540)+V(542)+V(547)
  V(548)=DSTRESSDSTRAIN(4,1)*V(761)
  V(549)=DSTRESSDSTRAIN(4,2)*V(762)
  V(550)=DSTRESSDSTRAIN(4,3)*V(763)
  V(804)=V(548)+V(549)+V(550)
  V(551)=DRELATIVESTRAIN(1,4)*V(534)+DRELATIVESTRAIN(2,4)*V(535)+DRELATIVESTRAIN(3,4)*V(536)+DRELATIVESTRAIN(4,4)*V(537)
  V(552)=V(510)*V(765)
  V(553)=V(512)*V(765)
  V(554)=V(514)*V(766)
  V(555)=V(516)*V(766)
  V(556)=V(518)*V(767)
  V(557)=V(520)*V(767)
  V(558)=V(522)*V(768)
  V(805)=V(554)+V(556)+V(558)
  V(559)=V(524)*V(768)
  V(806)=V(552)+V(557)+V(559)
  V(560)=V(526)*V(768)
  V(807)=V(553)+V(555)+V(560)
  V(561)=DSTRESSDSTRAIN(4,1)*V(765)
  V(562)=DSTRESSDSTRAIN(4,2)*V(766)
  V(563)=DSTRESSDSTRAIN(4,3)*V(767)
  V(808)=V(561)+V(562)+V(563)
  V(564)=FFOR(2)*V(749)
  V(565)=FFOR(2)*V(752)
  V(566)=FFOR(2)*V(753)
  V(567)=DRELATIVESTRAIN(1,5)*V(534)+DRELATIVESTRAIN(2,5)*V(535)+DRELATIVESTRAIN(3,5)*V(536)+DRELATIVESTRAIN(4,5)*V(537)&
      &+V(636)
  V(568)=V(510)*V(769)
  V(569)=V(512)*V(769)
  V(570)=V(514)*V(770)
  V(571)=V(516)*V(770)
  V(572)=V(518)*V(771)
  V(573)=V(520)*V(771)
  V(574)=V(522)*V(772)
  V(809)=V(570)+V(572)+V(574)
  V(575)=V(524)*V(772)
  V(810)=V(568)+V(573)+V(575)
  V(576)=V(526)*V(772)
  V(811)=V(569)+V(571)+V(576)
  V(577)=DSTRESSDSTRAIN(4,1)*V(769)
  V(578)=DSTRESSDSTRAIN(4,2)*V(770)
  V(579)=DSTRESSDSTRAIN(4,3)*V(771)
  V(812)=V(577)+V(578)+V(579)
  V(580)=DRELATIVESTRAIN(1,6)*V(534)+DRELATIVESTRAIN(2,6)*V(535)+DRELATIVESTRAIN(3,6)*V(536)+DRELATIVESTRAIN(4,6)*V(537)
  V(581)=V(510)*V(773)
  V(582)=V(512)*V(773)
  V(583)=V(514)*V(774)
  V(584)=V(516)*V(774)
  V(585)=V(518)*V(775)
  V(586)=V(520)*V(775)
  V(587)=V(522)*V(776)
  V(813)=V(583)+V(585)+V(587)
  V(588)=V(524)*V(776)
  V(814)=V(581)+V(586)+V(588)
  V(589)=V(526)*V(776)
  V(815)=V(582)+V(584)+V(589)
  V(590)=DSTRESSDSTRAIN(4,1)*V(773)
  V(591)=DSTRESSDSTRAIN(4,2)*V(774)
  V(592)=DSTRESSDSTRAIN(4,3)*V(775)
  V(816)=V(590)+V(591)+V(592)
  V(593)=FFOR(3)*V(749)
  V(594)=FFOR(3)*V(752)
  V(595)=FFOR(3)*V(753)
  V(596)=DRELATIVESTRAIN(1,7)*V(534)+DRELATIVESTRAIN(2,7)*V(535)+DRELATIVESTRAIN(3,7)*V(536)+DRELATIVESTRAIN(4,7)*V(537)
  V(597)=V(510)*V(777)
  V(598)=V(512)*V(777)
  V(599)=V(514)*V(778)
  V(600)=V(516)*V(778)
  V(601)=V(518)*V(779)
  V(602)=V(520)*V(779)
  V(603)=V(522)*V(780)
  V(817)=V(599)+V(601)+V(603)
  V(604)=V(524)*V(780)
  V(818)=V(597)+V(602)+V(604)
  V(605)=V(526)*V(780)
  V(819)=V(598)+V(600)+V(605)
  V(606)=DSTRESSDSTRAIN(4,1)*V(777)
  V(607)=DSTRESSDSTRAIN(4,2)*V(778)
  V(608)=DSTRESSDSTRAIN(4,3)*V(779)
  V(820)=V(606)+V(607)+V(608)
  V(609)=DRELATIVESTRAIN(1,8)*V(534)+DRELATIVESTRAIN(2,8)*V(535)+DRELATIVESTRAIN(3,8)*V(536)+DRELATIVESTRAIN(4,8)*V(537)
  V(610)=V(510)*V(781)
  V(611)=V(512)*V(781)
  V(612)=V(514)*V(782)
  V(613)=V(516)*V(782)
  V(614)=V(518)*V(783)
  V(615)=V(520)*V(783)
  V(616)=V(522)*V(784)
  V(821)=V(612)+V(614)+V(616)
  V(617)=V(524)*V(784)
  V(822)=V(610)+V(615)+V(617)
  V(618)=V(526)*V(784)
  V(823)=V(611)+V(613)+V(618)
  V(619)=DSTRESSDSTRAIN(4,1)*V(781)
  V(620)=DSTRESSDSTRAIN(4,2)*V(782)
  V(621)=DSTRESSDSTRAIN(4,3)*V(783)
  V(824)=V(619)+V(620)+V(621)
  V(622)=FFOR(1)*V(757)
  V(623)=FFOR(1)*V(758)
  V(624)=FFOR(1)*V(759)
  V(625)=DRELATIVESTRAIN(1,3)*V(627)+DRELATIVESTRAIN(2,3)*V(628)+DRELATIVESTRAIN(3,3)*V(629)+DRELATIVESTRAIN(4,3)*V(630)
  V(631)=V(626)+DRELATIVESTRAIN(1,4)*V(627)+DRELATIVESTRAIN(2,4)*V(628)+DRELATIVESTRAIN(3,4)*V(629)+DRELATIVESTRAIN(4,4&
      &)*V(630)
  V(632)=FFOR(2)*V(757)
  V(633)=FFOR(2)*V(758)
  V(634)=FFOR(2)*V(759)
  V(635)=DRELATIVESTRAIN(1,5)*V(627)+DRELATIVESTRAIN(2,5)*V(628)+DRELATIVESTRAIN(3,5)*V(629)+DRELATIVESTRAIN(4,5)*V(630)
  V(637)=DRELATIVESTRAIN(1,6)*V(627)+DRELATIVESTRAIN(2,6)*V(628)+DRELATIVESTRAIN(3,6)*V(629)+DRELATIVESTRAIN(4,6)*V(630)&
      &+V(636)
  V(638)=FFOR(3)*V(757)
  V(639)=FFOR(3)*V(758)
  V(640)=FFOR(3)*V(759)
  V(641)=DRELATIVESTRAIN(1,7)*V(627)+DRELATIVESTRAIN(2,7)*V(628)+DRELATIVESTRAIN(3,7)*V(629)+DRELATIVESTRAIN(4,7)*V(630)
  V(642)=DRELATIVESTRAIN(1,8)*V(627)+DRELATIVESTRAIN(2,8)*V(628)+DRELATIVESTRAIN(3,8)*V(629)+DRELATIVESTRAIN(4,8)*V(630)
  V(646)=V(728)*V(788)
  V(846)=DRELATIVESTRAIN(4,6)*V(646)
  V(845)=DRELATIVESTRAIN(4,5)*V(646)
  V(842)=DRELATIVESTRAIN(4,2)*V(646)
  V(841)=FFOR(2)*V(646)
  V(840)=DRELATIVESTRAIN(4,8)*V(646)
  V(825)=DRELATIVESTRAIN(4,1)*V(646)
  V(647)=FFOR(1)*V(788)
  V(829)=V(647)*V(728)
  V(649)=V(785)*V(788)
  V(650)=V(786)*V(788)
  V(835)=DRELATIVESTRAIN(1,8)*V(649)+DRELATIVESTRAIN(2,8)*V(650)+V(840)
  V(651)=V(787)*V(788)
  V(834)=DRELATIVESTRAIN(1,7)*V(649)+DRELATIVESTRAIN(2,7)*V(650)+DRELATIVESTRAIN(3,7)*V(651)
  V(833)=DRELATIVESTRAIN(1,6)*V(649)+DRELATIVESTRAIN(2,6)*V(650)+DRELATIVESTRAIN(3,6)*V(651)
  V(832)=DRELATIVESTRAIN(1,5)*V(649)+DRELATIVESTRAIN(2,5)*V(650)+DRELATIVESTRAIN(3,5)*V(651)
  V(831)=DRELATIVESTRAIN(1,4)*V(649)+DRELATIVESTRAIN(2,4)*V(650)+DRELATIVESTRAIN(3,4)*V(651)
  V(844)=DRELATIVESTRAIN(4,4)*V(646)+V(831)
  V(830)=DRELATIVESTRAIN(1,3)*V(649)+DRELATIVESTRAIN(2,3)*V(650)+DRELATIVESTRAIN(3,3)*V(651)
  V(843)=DRELATIVESTRAIN(4,3)*V(646)+V(830)
  V(653)=FFOR(3)*V(790)
  V(655)=DACC*V(654)
  V(656)=DRELATIVESTRAIN(1,4)*V(657)+DRELATIVESTRAIN(2,4)*V(658)+DRELATIVESTRAIN(3,4)*V(659)+DRELATIVESTRAIN(4,4)*V(660)
  V(661)=DRELATIVESTRAIN(1,5)*V(657)+DRELATIVESTRAIN(2,5)*V(658)+DRELATIVESTRAIN(3,5)*V(659)+DRELATIVESTRAIN(4,5)*V(660)&
      &+V(666)
  V(662)=DRELATIVESTRAIN(1,6)*V(657)+DRELATIVESTRAIN(2,6)*V(658)+DRELATIVESTRAIN(3,6)*V(659)+DRELATIVESTRAIN(4,6)*V(660)
  V(663)=DRELATIVESTRAIN(1,7)*V(657)+DRELATIVESTRAIN(2,7)*V(658)+DRELATIVESTRAIN(3,7)*V(659)+DRELATIVESTRAIN(4,7)*V(660)
  V(664)=DRELATIVESTRAIN(1,8)*V(657)+DRELATIVESTRAIN(2,8)*V(658)+DRELATIVESTRAIN(3,8)*V(659)+DRELATIVESTRAIN(4,8)*V(660)
  V(665)=DRELATIVESTRAIN(1,5)*V(667)+DRELATIVESTRAIN(2,5)*V(668)+DRELATIVESTRAIN(3,5)*V(669)+DRELATIVESTRAIN(4,5)*V(670)
  V(671)=V(666)+DRELATIVESTRAIN(1,6)*V(667)+DRELATIVESTRAIN(2,6)*V(668)+DRELATIVESTRAIN(3,6)*V(669)+DRELATIVESTRAIN(4,6&
      &)*V(670)
  V(672)=DRELATIVESTRAIN(1,7)*V(667)+DRELATIVESTRAIN(2,7)*V(668)+DRELATIVESTRAIN(3,7)*V(669)+DRELATIVESTRAIN(4,7)*V(670)
  V(673)=DRELATIVESTRAIN(1,8)*V(667)+DRELATIVESTRAIN(2,8)*V(668)+DRELATIVESTRAIN(3,8)*V(669)+DRELATIVESTRAIN(4,8)*V(670)
  V(674)=FFOR(2)*V(769)
  V(675)=FFOR(2)*V(770)
  V(676)=FFOR(2)*V(771)
  V(677)=FFOR(2)*V(773)
  V(678)=FFOR(2)*V(774)
  V(679)=FFOR(2)*V(775)
  V(681)=FFOR(2)*V(777)
  V(682)=FFOR(2)*V(778)
  V(683)=FFOR(2)*V(779)
  V(684)=FFOR(2)*V(781)
  V(685)=FFOR(2)*V(782)
  V(686)=FFOR(2)*V(783)
  V(688)=DACC*V(687)
  V(689)=DRELATIVESTRAIN(1,6)*V(690)+DRELATIVESTRAIN(2,6)*V(691)+DRELATIVESTRAIN(3,6)*V(692)+DRELATIVESTRAIN(4,6)*V(693)
  V(694)=DRELATIVESTRAIN(1,7)*V(690)+DRELATIVESTRAIN(2,7)*V(691)+DRELATIVESTRAIN(3,7)*V(692)+DRELATIVESTRAIN(4,7)*V(693)
  V(695)=DRELATIVESTRAIN(1,8)*V(690)+DRELATIVESTRAIN(2,8)*V(691)+DRELATIVESTRAIN(3,8)*V(692)+DRELATIVESTRAIN(4,8)*V(693)
  V(696)=DRELATIVESTRAIN(1,7)*V(698)+DRELATIVESTRAIN(2,7)*V(699)+DRELATIVESTRAIN(3,7)*V(700)+DRELATIVESTRAIN(4,7)*V(733)
  V(701)=DRELATIVESTRAIN(1,8)*V(698)+DRELATIVESTRAIN(2,8)*V(699)+DRELATIVESTRAIN(3,8)*V(700)+DRELATIVESTRAIN(4,8)*V(733)
  V(702)=(DRELATIVESTRAIN(1,7)*DRELATIVESTRAIN(1,8)*V(482)+DRELATIVESTRAIN(2,7)*DRELATIVESTRAIN(2,8)*V(490)&
      &+DRELATIVESTRAIN(3,7)*DRELATIVESTRAIN(3,8)*V(499)+V(792))*VOL
  STIFFNESS(1,1)=STIFFNESS(1,1)+V(481)+DRELATIVESTRAIN(1,1)*V(793)+DRELATIVESTRAIN(2,1)*V(794)+DRELATIVESTRAIN(3,1)*V(795&
      &)+DRELATIVESTRAIN(4,1)*V(796)+(DRELATIVESTRAIN(4,1)**2*DSTRESSDSTRAIN(4,4)+D2RELATIVESTRAIN(4,1,1)*EQUILIBRIUMSTRESS(4)&
      &+D2RELATIVESTRAIN(1,1,1)*V(463)+D2RELATIVESTRAIN(2,1,1)*V(465)+D2RELATIVESTRAIN(3,1,1)*V(469)+DRELATIVESTRAIN(1,1)**2*V&
      &(482)+DRELATIVESTRAIN(2,1)**2*V(490)+DRELATIVESTRAIN(3,1)**2*V(499))*VOL
  STIFFNESS(1,2)=STIFFNESS(1,2)+V(509)+DRELATIVESTRAIN(1,1)*V(797)+DRELATIVESTRAIN(2,1)*V(798)+DRELATIVESTRAIN(3,1)*V(799&
      &)+DRELATIVESTRAIN(4,1)*V(800)+(D2RELATIVESTRAIN(4,1,2)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,1,2)*V(463)&
      &+D2RELATIVESTRAIN(2,1,2)*V(465)+D2RELATIVESTRAIN(3,1,2)*V(469))*VOL
  STIFFNESS(1,3)=STIFFNESS(1,3)+V(531)+V(532)+V(533)
  STIFFNESS(1,4)=STIFFNESS(1,4)+V(538)+DRELATIVESTRAIN(1,1)*V(801)+DRELATIVESTRAIN(2,1)*V(802)+DRELATIVESTRAIN(3,1)*V(803&
      &)+DRELATIVESTRAIN(4,1)*V(804)+(D2RELATIVESTRAIN(4,1,3)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,1,3)*V(463)&
      &+D2RELATIVESTRAIN(2,1,3)*V(465)+D2RELATIVESTRAIN(3,1,3)*V(469))*VOL
  STIFFNESS(1,5)=STIFFNESS(1,5)+V(551)+DRELATIVESTRAIN(1,1)*V(805)+DRELATIVESTRAIN(2,1)*V(806)+DRELATIVESTRAIN(3,1)*V(807&
      &)+DRELATIVESTRAIN(4,1)*V(808)+(D2RELATIVESTRAIN(4,1,4)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,1,4)*V(463)&
      &+D2RELATIVESTRAIN(2,1,4)*V(465)+D2RELATIVESTRAIN(3,1,4)*V(469))*VOL
  STIFFNESS(1,6)=STIFFNESS(1,6)+V(564)+V(565)+V(566)
  STIFFNESS(1,7)=STIFFNESS(1,7)+V(567)+DRELATIVESTRAIN(1,1)*V(809)+DRELATIVESTRAIN(2,1)*V(810)+DRELATIVESTRAIN(3,1)*V(811&
      &)+DRELATIVESTRAIN(4,1)*V(812)+(D2RELATIVESTRAIN(4,1,5)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,1,5)*V(463)&
      &+D2RELATIVESTRAIN(2,1,5)*V(465)+D2RELATIVESTRAIN(3,1,5)*V(469))*VOL
  STIFFNESS(1,8)=STIFFNESS(1,8)+V(580)+DRELATIVESTRAIN(1,1)*V(813)+DRELATIVESTRAIN(2,1)*V(814)+DRELATIVESTRAIN(3,1)*V(815&
      &)+DRELATIVESTRAIN(4,1)*V(816)+(D2RELATIVESTRAIN(4,1,6)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,1,6)*V(463)&
      &+D2RELATIVESTRAIN(2,1,6)*V(465)+D2RELATIVESTRAIN(3,1,6)*V(469))*VOL
  STIFFNESS(1,9)=STIFFNESS(1,9)+V(593)+V(594)+V(595)
  STIFFNESS(1,10)=STIFFNESS(1,10)+V(596)+DRELATIVESTRAIN(1,1)*V(817)+DRELATIVESTRAIN(2,1)*V(818)+DRELATIVESTRAIN(3,1)*V&
      &(819)+DRELATIVESTRAIN(4,1)*V(820)+(D2RELATIVESTRAIN(4,1,7)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,1,7)*V(463)&
      &+D2RELATIVESTRAIN(2,1,7)*V(465)+D2RELATIVESTRAIN(3,1,7)*V(469))*VOL
  STIFFNESS(1,11)=STIFFNESS(1,11)+V(609)+DRELATIVESTRAIN(1,1)*V(821)+DRELATIVESTRAIN(2,1)*V(822)+DRELATIVESTRAIN(3,1)*V&
      &(823)+DRELATIVESTRAIN(4,1)*V(824)+(D2RELATIVESTRAIN(4,1,8)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,1,8)*V(463)&
      &+D2RELATIVESTRAIN(2,1,8)*V(465)+D2RELATIVESTRAIN(3,1,8)*V(469))*VOL
  STIFFNESS(2,1)=STIFFNESS(2,1)+V(509)+DRELATIVESTRAIN(1,2)*V(793)+DRELATIVESTRAIN(2,2)*V(794)+DRELATIVESTRAIN(3,2)*V(795&
      &)+DRELATIVESTRAIN(4,2)*V(796)+(D2RELATIVESTRAIN(4,2,1)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,2,1)*V(463)&
      &+D2RELATIVESTRAIN(2,2,1)*V(465)+D2RELATIVESTRAIN(3,2,1)*V(469))*VOL
  STIFFNESS(2,2)=STIFFNESS(2,2)+V(481)+DRELATIVESTRAIN(1,2)*V(797)+DRELATIVESTRAIN(2,2)*V(798)+DRELATIVESTRAIN(3,2)*V(799&
      &)+DRELATIVESTRAIN(4,2)*V(800)+(DRELATIVESTRAIN(4,2)**2*DSTRESSDSTRAIN(4,4)+D2RELATIVESTRAIN(4,2,2)*EQUILIBRIUMSTRESS(4)&
      &+D2RELATIVESTRAIN(1,2,2)*V(463)+D2RELATIVESTRAIN(2,2,2)*V(465)+D2RELATIVESTRAIN(3,2,2)*V(469)+DRELATIVESTRAIN(1,2)**2*V&
      &(482)+DRELATIVESTRAIN(2,2)**2*V(490)+DRELATIVESTRAIN(3,2)**2*V(499))*VOL
  STIFFNESS(2,3)=STIFFNESS(2,3)+V(622)+V(623)+V(624)
  STIFFNESS(2,4)=STIFFNESS(2,4)+V(625)+DRELATIVESTRAIN(1,2)*V(801)+DRELATIVESTRAIN(2,2)*V(802)+DRELATIVESTRAIN(3,2)*V(803&
      &)+DRELATIVESTRAIN(4,2)*V(804)+(D2RELATIVESTRAIN(4,2,3)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,2,3)*V(463)&
      &+D2RELATIVESTRAIN(2,2,3)*V(465)+D2RELATIVESTRAIN(3,2,3)*V(469))*VOL
  STIFFNESS(2,5)=STIFFNESS(2,5)+V(631)+DRELATIVESTRAIN(1,2)*V(805)+DRELATIVESTRAIN(2,2)*V(806)+DRELATIVESTRAIN(3,2)*V(807&
      &)+DRELATIVESTRAIN(4,2)*V(808)+(D2RELATIVESTRAIN(4,2,4)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,2,4)*V(463)&
      &+D2RELATIVESTRAIN(2,2,4)*V(465)+D2RELATIVESTRAIN(3,2,4)*V(469))*VOL
  STIFFNESS(2,6)=STIFFNESS(2,6)+V(632)+V(633)+V(634)
  STIFFNESS(2,7)=STIFFNESS(2,7)+V(635)+DRELATIVESTRAIN(1,2)*V(809)+DRELATIVESTRAIN(2,2)*V(810)+DRELATIVESTRAIN(3,2)*V(811&
      &)+DRELATIVESTRAIN(4,2)*V(812)+(D2RELATIVESTRAIN(4,2,5)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,2,5)*V(463)&
      &+D2RELATIVESTRAIN(2,2,5)*V(465)+D2RELATIVESTRAIN(3,2,5)*V(469))*VOL
  STIFFNESS(2,8)=STIFFNESS(2,8)+V(637)+DRELATIVESTRAIN(1,2)*V(813)+DRELATIVESTRAIN(2,2)*V(814)+DRELATIVESTRAIN(3,2)*V(815&
      &)+DRELATIVESTRAIN(4,2)*V(816)+(D2RELATIVESTRAIN(4,2,6)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,2,6)*V(463)&
      &+D2RELATIVESTRAIN(2,2,6)*V(465)+D2RELATIVESTRAIN(3,2,6)*V(469))*VOL
  STIFFNESS(2,9)=STIFFNESS(2,9)+V(638)+V(639)+V(640)
  STIFFNESS(2,10)=STIFFNESS(2,10)+V(641)+DRELATIVESTRAIN(1,2)*V(817)+DRELATIVESTRAIN(2,2)*V(818)+DRELATIVESTRAIN(3,2)*V&
      &(819)+DRELATIVESTRAIN(4,2)*V(820)+(D2RELATIVESTRAIN(4,2,7)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,2,7)*V(463)&
      &+D2RELATIVESTRAIN(2,2,7)*V(465)+D2RELATIVESTRAIN(3,2,7)*V(469))*VOL
  STIFFNESS(2,11)=STIFFNESS(2,11)+V(642)+DRELATIVESTRAIN(1,2)*V(821)+DRELATIVESTRAIN(2,2)*V(822)+DRELATIVESTRAIN(3,2)*V&
      &(823)+DRELATIVESTRAIN(4,2)*V(824)+(D2RELATIVESTRAIN(4,2,8)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,2,8)*V(463)&
      &+D2RELATIVESTRAIN(2,2,8)*V(465)+D2RELATIVESTRAIN(3,2,8)*V(469))*VOL
  STIFFNESS(3,1)=STIFFNESS(3,1)+FFOR(1)*V(825)+V(531)*V(826)+V(532)*V(827)+V(533)*V(828)
  STIFFNESS(3,2)=STIFFNESS(3,2)+V(622)*V(826)+V(623)*V(827)+V(624)*V(828)+DRELATIVESTRAIN(4,2)*V(829)
  STIFFNESS(3,3)=STIFFNESS(3,3)-V(736)*VOL
  STIFFNESS(3,4)=STIFFNESS(3,4)+DRELATIVESTRAIN(4,3)*V(829)+FFOR(1)*V(830)
  STIFFNESS(3,5)=STIFFNESS(3,5)+DRELATIVESTRAIN(4,4)*V(829)+FFOR(1)*V(831)
  STIFFNESS(3,6)=STIFFNESS(3,6)+V(789)
  STIFFNESS(3,7)=STIFFNESS(3,7)+DRELATIVESTRAIN(4,5)*V(829)+FFOR(1)*V(832)
  STIFFNESS(3,8)=STIFFNESS(3,8)+DRELATIVESTRAIN(4,6)*V(829)+FFOR(1)*V(833)
  STIFFNESS(3,9)=STIFFNESS(3,9)+V(653)
  STIFFNESS(3,10)=STIFFNESS(3,10)+DRELATIVESTRAIN(4,7)*V(829)+FFOR(1)*V(834)
  STIFFNESS(3,11)=STIFFNESS(3,11)+DRELATIVESTRAIN(3,8)*V(647)*V(787)+FFOR(1)*V(835)
  STIFFNESS(4,1)=STIFFNESS(4,1)+V(538)+DRELATIVESTRAIN(1,3)*V(793)+DRELATIVESTRAIN(2,3)*V(794)+DRELATIVESTRAIN(3,3)*V(795&
      &)+DRELATIVESTRAIN(4,3)*V(796)+(D2RELATIVESTRAIN(4,3,1)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,3,1)*V(463)&
      &+D2RELATIVESTRAIN(2,3,1)*V(465)+D2RELATIVESTRAIN(3,3,1)*V(469))*VOL
  STIFFNESS(4,2)=STIFFNESS(4,2)+V(625)+DRELATIVESTRAIN(1,3)*V(797)+DRELATIVESTRAIN(2,3)*V(798)+DRELATIVESTRAIN(3,3)*V(799&
      &)+DRELATIVESTRAIN(4,3)*V(800)+(D2RELATIVESTRAIN(4,3,2)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,3,2)*V(463)&
      &+D2RELATIVESTRAIN(2,3,2)*V(465)+D2RELATIVESTRAIN(3,3,2)*V(469))*VOL
  STIFFNESS(4,3)=STIFFNESS(4,3)+FFOR(1)*V(837)
  STIFFNESS(4,4)=STIFFNESS(4,4)+V(655)+DRELATIVESTRAIN(1,3)*V(801)+DRELATIVESTRAIN(2,3)*V(802)+DRELATIVESTRAIN(3,3)*V(803&
      &)+DRELATIVESTRAIN(4,3)*V(804)+(DRELATIVESTRAIN(4,3)**2*DSTRESSDSTRAIN(4,4)+D2RELATIVESTRAIN(4,3,3)*EQUILIBRIUMSTRESS(4)&
      &+D2RELATIVESTRAIN(1,3,3)*V(463)+D2RELATIVESTRAIN(2,3,3)*V(465)+D2RELATIVESTRAIN(3,3,3)*V(469)+DRELATIVESTRAIN(1,3)**2*V&
      &(482)+DRELATIVESTRAIN(2,3)**2*V(490)+DRELATIVESTRAIN(3,3)**2*V(499))*VOL
  STIFFNESS(4,5)=STIFFNESS(4,5)+V(656)+DRELATIVESTRAIN(1,3)*V(805)+DRELATIVESTRAIN(2,3)*V(806)+DRELATIVESTRAIN(3,3)*V(807&
      &)+DRELATIVESTRAIN(4,3)*V(808)+(D2RELATIVESTRAIN(4,3,4)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,3,4)*V(463)&
      &+D2RELATIVESTRAIN(2,3,4)*V(465)+D2RELATIVESTRAIN(3,3,4)*V(469))*VOL
  STIFFNESS(4,6)=STIFFNESS(4,6)+FFOR(2)*V(837)
  STIFFNESS(4,7)=STIFFNESS(4,7)+V(661)+DRELATIVESTRAIN(1,3)*V(809)+DRELATIVESTRAIN(2,3)*V(810)+DRELATIVESTRAIN(3,3)*V(811&
      &)+DRELATIVESTRAIN(4,3)*V(812)+(D2RELATIVESTRAIN(4,3,5)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,3,5)*V(463)&
      &+D2RELATIVESTRAIN(2,3,5)*V(465)+D2RELATIVESTRAIN(3,3,5)*V(469))*VOL
  STIFFNESS(4,8)=STIFFNESS(4,8)+V(662)+DRELATIVESTRAIN(1,3)*V(813)+DRELATIVESTRAIN(2,3)*V(814)+DRELATIVESTRAIN(3,3)*V(815&
      &)+DRELATIVESTRAIN(4,3)*V(816)+(D2RELATIVESTRAIN(4,3,6)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,3,6)*V(463)&
      &+D2RELATIVESTRAIN(2,3,6)*V(465)+D2RELATIVESTRAIN(3,3,6)*V(469))*VOL
  STIFFNESS(4,9)=STIFFNESS(4,9)+V(836)*V(838)
  STIFFNESS(4,10)=STIFFNESS(4,10)+V(663)+DRELATIVESTRAIN(1,3)*V(817)+DRELATIVESTRAIN(2,3)*V(818)+DRELATIVESTRAIN(3,3)*V&
      &(819)+DRELATIVESTRAIN(4,3)*V(820)+(D2RELATIVESTRAIN(4,3,7)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,3,7)*V(463)&
      &+D2RELATIVESTRAIN(2,3,7)*V(465)+D2RELATIVESTRAIN(3,3,7)*V(469))*VOL
  STIFFNESS(4,11)=STIFFNESS(4,11)+V(664)+DRELATIVESTRAIN(1,3)*V(821)+DRELATIVESTRAIN(2,3)*V(822)+DRELATIVESTRAIN(3,3)*V&
      &(823)+DRELATIVESTRAIN(4,3)*V(824)+(D2RELATIVESTRAIN(4,3,8)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,3,8)*V(463)&
      &+D2RELATIVESTRAIN(2,3,8)*V(465)+D2RELATIVESTRAIN(3,3,8)*V(469))*VOL
  STIFFNESS(5,1)=STIFFNESS(5,1)+V(551)+DRELATIVESTRAIN(1,4)*V(793)+DRELATIVESTRAIN(2,4)*V(794)+DRELATIVESTRAIN(3,4)*V(795&
      &)+DRELATIVESTRAIN(4,4)*V(796)+(D2RELATIVESTRAIN(4,4,1)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,4,1)*V(463)&
      &+D2RELATIVESTRAIN(2,4,1)*V(465)+D2RELATIVESTRAIN(3,4,1)*V(469))*VOL
  STIFFNESS(5,2)=STIFFNESS(5,2)+V(631)+DRELATIVESTRAIN(1,4)*V(797)+DRELATIVESTRAIN(2,4)*V(798)+DRELATIVESTRAIN(3,4)*V(799&
      &)+DRELATIVESTRAIN(4,4)*V(800)+(D2RELATIVESTRAIN(4,4,2)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,4,2)*V(463)&
      &+D2RELATIVESTRAIN(2,4,2)*V(465)+D2RELATIVESTRAIN(3,4,2)*V(469))*VOL
  STIFFNESS(5,3)=STIFFNESS(5,3)-V(790)*V(839)
  STIFFNESS(5,4)=STIFFNESS(5,4)+V(656)+DRELATIVESTRAIN(1,4)*V(801)+DRELATIVESTRAIN(2,4)*V(802)+DRELATIVESTRAIN(3,4)*V(803&
      &)+DRELATIVESTRAIN(4,4)*V(804)+(D2RELATIVESTRAIN(4,4,3)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,4,3)*V(463)&
      &+D2RELATIVESTRAIN(2,4,3)*V(465)+D2RELATIVESTRAIN(3,4,3)*V(469))*VOL
  STIFFNESS(5,5)=STIFFNESS(5,5)+V(655)+DRELATIVESTRAIN(1,4)*V(805)+DRELATIVESTRAIN(2,4)*V(806)+DRELATIVESTRAIN(3,4)*V(807&
      &)+DRELATIVESTRAIN(4,4)*V(808)+(DRELATIVESTRAIN(4,4)**2*DSTRESSDSTRAIN(4,4)+D2RELATIVESTRAIN(4,4,4)*EQUILIBRIUMSTRESS(4)&
      &+D2RELATIVESTRAIN(1,4,4)*V(463)+D2RELATIVESTRAIN(2,4,4)*V(465)+D2RELATIVESTRAIN(3,4,4)*V(469)+DRELATIVESTRAIN(1,4)**2*V&
      &(482)+DRELATIVESTRAIN(2,4)**2*V(490)+DRELATIVESTRAIN(3,4)**2*V(499))*VOL
  STIFFNESS(5,6)=STIFFNESS(5,6)+FFOR(2)*V(839)*VOL
  STIFFNESS(5,7)=STIFFNESS(5,7)+V(665)+DRELATIVESTRAIN(1,4)*V(809)+DRELATIVESTRAIN(2,4)*V(810)+DRELATIVESTRAIN(3,4)*V(811&
      &)+DRELATIVESTRAIN(4,4)*V(812)+(D2RELATIVESTRAIN(4,4,5)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,4,5)*V(463)&
      &+D2RELATIVESTRAIN(2,4,5)*V(465)+D2RELATIVESTRAIN(3,4,5)*V(469))*VOL
  STIFFNESS(5,8)=STIFFNESS(5,8)+V(671)+DRELATIVESTRAIN(1,4)*V(813)+DRELATIVESTRAIN(2,4)*V(814)+DRELATIVESTRAIN(3,4)*V(815&
      &)+DRELATIVESTRAIN(4,4)*V(816)+(D2RELATIVESTRAIN(4,4,6)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,4,6)*V(463)&
      &+D2RELATIVESTRAIN(2,4,6)*V(465)+D2RELATIVESTRAIN(3,4,6)*V(469))*VOL
  STIFFNESS(5,9)=STIFFNESS(5,9)+V(836)*V(839)
  STIFFNESS(5,10)=STIFFNESS(5,10)+V(672)+DRELATIVESTRAIN(1,4)*V(817)+DRELATIVESTRAIN(2,4)*V(818)+DRELATIVESTRAIN(3,4)*V&
      &(819)+DRELATIVESTRAIN(4,4)*V(820)+(D2RELATIVESTRAIN(4,4,7)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,4,7)*V(463)&
      &+D2RELATIVESTRAIN(2,4,7)*V(465)+D2RELATIVESTRAIN(3,4,7)*V(469))*VOL
  STIFFNESS(5,11)=STIFFNESS(5,11)+V(673)+DRELATIVESTRAIN(1,4)*V(821)+DRELATIVESTRAIN(2,4)*V(822)+DRELATIVESTRAIN(3,4)*V&
      &(823)+DRELATIVESTRAIN(4,4)*V(824)+(D2RELATIVESTRAIN(4,4,8)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,4,8)*V(463)&
      &+D2RELATIVESTRAIN(2,4,8)*V(465)+D2RELATIVESTRAIN(3,4,8)*V(469))*VOL
  STIFFNESS(6,1)=STIFFNESS(6,1)+V(564)*V(826)+V(565)*V(827)+V(566)*V(828)+DRELATIVESTRAIN(4,1)*V(841)
  STIFFNESS(6,2)=STIFFNESS(6,2)+V(632)*V(826)+V(633)*V(827)+V(634)*V(828)+FFOR(2)*V(842)
  STIFFNESS(6,3)=STIFFNESS(6,3)+V(789)
  STIFFNESS(6,4)=STIFFNESS(6,4)+FFOR(2)*V(843)
  STIFFNESS(6,5)=STIFFNESS(6,5)+FFOR(2)*V(844)
  STIFFNESS(6,6)=STIFFNESS(6,6)-V(741)*VOL
  STIFFNESS(6,7)=STIFFNESS(6,7)+V(674)*V(826)+V(675)*V(827)+V(676)*V(828)+FFOR(2)*V(845)
  STIFFNESS(6,8)=STIFFNESS(6,8)+V(677)*V(826)+V(678)*V(827)+V(679)*V(828)+FFOR(2)*V(846)
  STIFFNESS(6,9)=STIFFNESS(6,9)+V(791)
  STIFFNESS(6,10)=STIFFNESS(6,10)+V(681)*V(826)+V(682)*V(827)+V(683)*V(828)+DRELATIVESTRAIN(4,7)*V(841)
  STIFFNESS(6,11)=STIFFNESS(6,11)+V(684)*V(826)+V(685)*V(827)+V(686)*V(828)+FFOR(2)*V(840)
  STIFFNESS(7,1)=STIFFNESS(7,1)+V(567)+DRELATIVESTRAIN(1,5)*V(793)+DRELATIVESTRAIN(2,5)*V(794)+DRELATIVESTRAIN(3,5)*V(795&
      &)+DRELATIVESTRAIN(4,5)*V(796)+(D2RELATIVESTRAIN(4,5,1)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,5,1)*V(463)&
      &+D2RELATIVESTRAIN(2,5,1)*V(465)+D2RELATIVESTRAIN(3,5,1)*V(469))*VOL
  STIFFNESS(7,2)=STIFFNESS(7,2)+V(635)+DRELATIVESTRAIN(1,5)*V(797)+DRELATIVESTRAIN(2,5)*V(798)+DRELATIVESTRAIN(3,5)*V(799&
      &)+DRELATIVESTRAIN(4,5)*V(800)+(D2RELATIVESTRAIN(4,5,2)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,5,2)*V(463)&
      &+D2RELATIVESTRAIN(2,5,2)*V(465)+D2RELATIVESTRAIN(3,5,2)*V(469))*VOL
  STIFFNESS(7,3)=STIFFNESS(7,3)-V(790)*V(847)
  STIFFNESS(7,4)=STIFFNESS(7,4)+V(661)+DRELATIVESTRAIN(1,5)*V(801)+DRELATIVESTRAIN(2,5)*V(802)+DRELATIVESTRAIN(3,5)*V(803&
      &)+DRELATIVESTRAIN(4,5)*V(804)+(D2RELATIVESTRAIN(4,5,3)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,5,3)*V(463)&
      &+D2RELATIVESTRAIN(2,5,3)*V(465)+D2RELATIVESTRAIN(3,5,3)*V(469))*VOL
  STIFFNESS(7,5)=STIFFNESS(7,5)+V(665)+DRELATIVESTRAIN(1,5)*V(805)+DRELATIVESTRAIN(2,5)*V(806)+DRELATIVESTRAIN(3,5)*V(807&
      &)+DRELATIVESTRAIN(4,5)*V(808)+(D2RELATIVESTRAIN(4,5,4)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,5,4)*V(463)&
      &+D2RELATIVESTRAIN(2,5,4)*V(465)+D2RELATIVESTRAIN(3,5,4)*V(469))*VOL
  STIFFNESS(7,6)=STIFFNESS(7,6)+V(674)+V(675)+V(676)
  STIFFNESS(7,7)=STIFFNESS(7,7)+V(688)+DRELATIVESTRAIN(1,5)*V(809)+DRELATIVESTRAIN(2,5)*V(810)+DRELATIVESTRAIN(3,5)*V(811&
      &)+DRELATIVESTRAIN(4,5)*V(812)+(DRELATIVESTRAIN(4,5)**2*DSTRESSDSTRAIN(4,4)+D2RELATIVESTRAIN(4,5,5)*EQUILIBRIUMSTRESS(4)&
      &+D2RELATIVESTRAIN(1,5,5)*V(463)+D2RELATIVESTRAIN(2,5,5)*V(465)+D2RELATIVESTRAIN(3,5,5)*V(469)+DRELATIVESTRAIN(1,5)**2*V&
      &(482)+DRELATIVESTRAIN(2,5)**2*V(490)+DRELATIVESTRAIN(3,5)**2*V(499))*VOL
  STIFFNESS(7,8)=STIFFNESS(7,8)+V(689)+DRELATIVESTRAIN(1,5)*V(813)+DRELATIVESTRAIN(2,5)*V(814)+DRELATIVESTRAIN(3,5)*V(815&
      &)+DRELATIVESTRAIN(4,5)*V(816)+(D2RELATIVESTRAIN(4,5,6)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,5,6)*V(463)&
      &+D2RELATIVESTRAIN(2,5,6)*V(465)+D2RELATIVESTRAIN(3,5,6)*V(469))*VOL
  STIFFNESS(7,9)=STIFFNESS(7,9)+V(836)*V(847)
  STIFFNESS(7,10)=STIFFNESS(7,10)+V(694)+DRELATIVESTRAIN(1,5)*V(817)+DRELATIVESTRAIN(2,5)*V(818)+DRELATIVESTRAIN(3,5)*V&
      &(819)+DRELATIVESTRAIN(4,5)*V(820)+(D2RELATIVESTRAIN(4,5,7)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,5,7)*V(463)&
      &+D2RELATIVESTRAIN(2,5,7)*V(465)+D2RELATIVESTRAIN(3,5,7)*V(469))*VOL
  STIFFNESS(7,11)=STIFFNESS(7,11)+V(695)+DRELATIVESTRAIN(1,5)*V(821)+DRELATIVESTRAIN(2,5)*V(822)+DRELATIVESTRAIN(3,5)*V&
      &(823)+DRELATIVESTRAIN(4,5)*V(824)+(D2RELATIVESTRAIN(4,5,8)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,5,8)*V(463)&
      &+D2RELATIVESTRAIN(2,5,8)*V(465)+D2RELATIVESTRAIN(3,5,8)*V(469))*VOL
  STIFFNESS(8,1)=STIFFNESS(8,1)+V(580)+DRELATIVESTRAIN(1,6)*V(793)+DRELATIVESTRAIN(2,6)*V(794)+DRELATIVESTRAIN(3,6)*V(795&
      &)+DRELATIVESTRAIN(4,6)*V(796)+(D2RELATIVESTRAIN(4,6,1)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,6,1)*V(463)&
      &+D2RELATIVESTRAIN(2,6,1)*V(465)+D2RELATIVESTRAIN(3,6,1)*V(469))*VOL
  STIFFNESS(8,2)=STIFFNESS(8,2)+V(637)+DRELATIVESTRAIN(1,6)*V(797)+DRELATIVESTRAIN(2,6)*V(798)+DRELATIVESTRAIN(3,6)*V(799&
      &)+DRELATIVESTRAIN(4,6)*V(800)+(D2RELATIVESTRAIN(4,6,2)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,6,2)*V(463)&
      &+D2RELATIVESTRAIN(2,6,2)*V(465)+D2RELATIVESTRAIN(3,6,2)*V(469))*VOL
  STIFFNESS(8,3)=STIFFNESS(8,3)-V(790)*V(848)
  STIFFNESS(8,4)=STIFFNESS(8,4)+V(662)+DRELATIVESTRAIN(1,6)*V(801)+DRELATIVESTRAIN(2,6)*V(802)+DRELATIVESTRAIN(3,6)*V(803&
      &)+DRELATIVESTRAIN(4,6)*V(804)+(D2RELATIVESTRAIN(4,6,3)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,6,3)*V(463)&
      &+D2RELATIVESTRAIN(2,6,3)*V(465)+D2RELATIVESTRAIN(3,6,3)*V(469))*VOL
  STIFFNESS(8,5)=STIFFNESS(8,5)+V(671)+DRELATIVESTRAIN(1,6)*V(805)+DRELATIVESTRAIN(2,6)*V(806)+DRELATIVESTRAIN(3,6)*V(807&
      &)+DRELATIVESTRAIN(4,6)*V(808)+(D2RELATIVESTRAIN(4,6,4)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,6,4)*V(463)&
      &+D2RELATIVESTRAIN(2,6,4)*V(465)+D2RELATIVESTRAIN(3,6,4)*V(469))*VOL
  STIFFNESS(8,6)=STIFFNESS(8,6)+V(677)+V(678)+V(679)
  STIFFNESS(8,7)=STIFFNESS(8,7)+V(689)+DRELATIVESTRAIN(1,6)*V(809)+DRELATIVESTRAIN(2,6)*V(810)+DRELATIVESTRAIN(3,6)*V(811&
      &)+DRELATIVESTRAIN(4,6)*V(812)+(D2RELATIVESTRAIN(4,6,5)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,6,5)*V(463)&
      &+D2RELATIVESTRAIN(2,6,5)*V(465)+D2RELATIVESTRAIN(3,6,5)*V(469))*VOL
  STIFFNESS(8,8)=STIFFNESS(8,8)+V(688)+DRELATIVESTRAIN(1,6)*V(813)+DRELATIVESTRAIN(2,6)*V(814)+DRELATIVESTRAIN(3,6)*V(815&
      &)+DRELATIVESTRAIN(4,6)*V(816)+(DRELATIVESTRAIN(4,6)**2*DSTRESSDSTRAIN(4,4)+D2RELATIVESTRAIN(4,6,6)*EQUILIBRIUMSTRESS(4)&
      &+D2RELATIVESTRAIN(1,6,6)*V(463)+D2RELATIVESTRAIN(2,6,6)*V(465)+D2RELATIVESTRAIN(3,6,6)*V(469)+DRELATIVESTRAIN(1,6)**2*V&
      &(482)+DRELATIVESTRAIN(2,6)**2*V(490)+DRELATIVESTRAIN(3,6)**2*V(499))*VOL
  STIFFNESS(8,9)=STIFFNESS(8,9)+V(836)*V(848)
  STIFFNESS(8,10)=STIFFNESS(8,10)+V(696)+DRELATIVESTRAIN(1,6)*V(817)+DRELATIVESTRAIN(2,6)*V(818)+DRELATIVESTRAIN(3,6)*V&
      &(819)+DRELATIVESTRAIN(4,6)*V(820)+(D2RELATIVESTRAIN(4,6,7)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,6,7)*V(463)&
      &+D2RELATIVESTRAIN(2,6,7)*V(465)+D2RELATIVESTRAIN(3,6,7)*V(469))*VOL
  STIFFNESS(8,11)=STIFFNESS(8,11)+V(701)+DRELATIVESTRAIN(1,6)*V(821)+DRELATIVESTRAIN(2,6)*V(822)+DRELATIVESTRAIN(3,6)*V&
      &(823)+DRELATIVESTRAIN(4,6)*V(824)+(D2RELATIVESTRAIN(4,6,8)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,6,8)*V(463)&
      &+D2RELATIVESTRAIN(2,6,8)*V(465)+D2RELATIVESTRAIN(3,6,8)*V(469))*VOL
  STIFFNESS(9,1)=STIFFNESS(9,1)+FFOR(3)*V(825)+V(593)*V(826)+V(594)*V(827)+V(595)*V(828)
  STIFFNESS(9,2)=STIFFNESS(9,2)+V(638)*V(826)+V(639)*V(827)+V(640)*V(828)+FFOR(3)*V(842)
  STIFFNESS(9,3)=STIFFNESS(9,3)+V(653)
  STIFFNESS(9,4)=STIFFNESS(9,4)+FFOR(3)*V(843)
  STIFFNESS(9,5)=STIFFNESS(9,5)+FFOR(3)*V(844)
  STIFFNESS(9,6)=STIFFNESS(9,6)+V(791)
  STIFFNESS(9,7)=STIFFNESS(9,7)+FFOR(3)*(V(832)+V(845))
  STIFFNESS(9,8)=STIFFNESS(9,8)+FFOR(3)*(V(833)+V(846))
  STIFFNESS(9,9)=STIFFNESS(9,9)-V(742)*VOL
  STIFFNESS(9,10)=STIFFNESS(9,10)+FFOR(3)*(DRELATIVESTRAIN(4,7)*V(646)+V(834))
  STIFFNESS(9,11)=STIFFNESS(9,11)+FFOR(3)*(DRELATIVESTRAIN(3,8)*V(651)+V(835))
  STIFFNESS(10,1)=STIFFNESS(10,1)+V(596)+DRELATIVESTRAIN(1,7)*V(793)+DRELATIVESTRAIN(2,7)*V(794)+DRELATIVESTRAIN(3,7)*V&
      &(795)+DRELATIVESTRAIN(4,7)*V(796)+(D2RELATIVESTRAIN(4,7,1)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,7,1)*V(463)&
      &+D2RELATIVESTRAIN(2,7,1)*V(465)+D2RELATIVESTRAIN(3,7,1)*V(469))*VOL
  STIFFNESS(10,2)=STIFFNESS(10,2)+V(641)+DRELATIVESTRAIN(1,7)*V(797)+DRELATIVESTRAIN(2,7)*V(798)+DRELATIVESTRAIN(3,7)*V&
      &(799)+DRELATIVESTRAIN(4,7)*V(800)+(D2RELATIVESTRAIN(4,7,2)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,7,2)*V(463)&
      &+D2RELATIVESTRAIN(2,7,2)*V(465)+D2RELATIVESTRAIN(3,7,2)*V(469))*VOL
  STIFFNESS(10,3)=STIFFNESS(10,3)-V(790)*V(849)
  STIFFNESS(10,4)=STIFFNESS(10,4)+V(663)+DRELATIVESTRAIN(1,7)*V(801)+DRELATIVESTRAIN(2,7)*V(802)+DRELATIVESTRAIN(3,7)*V&
      &(803)+DRELATIVESTRAIN(4,7)*V(804)+(D2RELATIVESTRAIN(4,7,3)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,7,3)*V(463)&
      &+D2RELATIVESTRAIN(2,7,3)*V(465)+D2RELATIVESTRAIN(3,7,3)*V(469))*VOL
  STIFFNESS(10,5)=STIFFNESS(10,5)+V(672)+DRELATIVESTRAIN(1,7)*V(805)+DRELATIVESTRAIN(2,7)*V(806)+DRELATIVESTRAIN(3,7)*V&
      &(807)+DRELATIVESTRAIN(4,7)*V(808)+(D2RELATIVESTRAIN(4,7,4)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,7,4)*V(463)&
      &+D2RELATIVESTRAIN(2,7,4)*V(465)+D2RELATIVESTRAIN(3,7,4)*V(469))*VOL
  STIFFNESS(10,6)=STIFFNESS(10,6)+V(681)+V(682)+V(683)
  STIFFNESS(10,7)=STIFFNESS(10,7)+V(694)+DRELATIVESTRAIN(1,7)*V(809)+DRELATIVESTRAIN(2,7)*V(810)+DRELATIVESTRAIN(3,7)*V&
      &(811)+DRELATIVESTRAIN(4,7)*V(812)+(D2RELATIVESTRAIN(4,7,5)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,7,5)*V(463)&
      &+D2RELATIVESTRAIN(2,7,5)*V(465)+D2RELATIVESTRAIN(3,7,5)*V(469))*VOL
  STIFFNESS(10,8)=STIFFNESS(10,8)+V(696)+DRELATIVESTRAIN(1,7)*V(813)+DRELATIVESTRAIN(2,7)*V(814)+DRELATIVESTRAIN(3,7)*V&
      &(815)+DRELATIVESTRAIN(4,7)*V(816)+(D2RELATIVESTRAIN(4,7,6)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,7,6)*V(463)&
      &+D2RELATIVESTRAIN(2,7,6)*V(465)+D2RELATIVESTRAIN(3,7,6)*V(469))*VOL
  STIFFNESS(10,9)=STIFFNESS(10,9)+V(836)*V(849)
  STIFFNESS(10,10)=STIFFNESS(10,10)+DRELATIVESTRAIN(1,7)*V(817)+DRELATIVESTRAIN(2,7)*V(818)+DRELATIVESTRAIN(3,7)*V(819)&
      &+DRELATIVESTRAIN(4,7)*V(820)+(DRELATIVESTRAIN(4,7)**2*DSTRESSDSTRAIN(4,4)+D2RELATIVESTRAIN(4,7,7)*EQUILIBRIUMSTRESS(4)&
      &+D2RELATIVESTRAIN(1,7,7)*V(463)+D2RELATIVESTRAIN(2,7,7)*V(465)+D2RELATIVESTRAIN(3,7,7)*V(469)+DRELATIVESTRAIN(1,7)**2*V&
      &(482)+DRELATIVESTRAIN(2,7)**2*V(490)+DRELATIVESTRAIN(3,7)**2*V(499))*VOL
  STIFFNESS(10,11)=STIFFNESS(10,11)+V(702)+DRELATIVESTRAIN(1,7)*V(821)+DRELATIVESTRAIN(2,7)*V(822)+DRELATIVESTRAIN(3,7)*V&
      &(823)+DRELATIVESTRAIN(4,7)*V(824)+(D2RELATIVESTRAIN(4,7,8)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,7,8)*V(463)&
      &+D2RELATIVESTRAIN(2,7,8)*V(465)+D2RELATIVESTRAIN(3,7,8)*V(469))*VOL
  STIFFNESS(11,1)=STIFFNESS(11,1)+V(609)+DRELATIVESTRAIN(1,8)*V(793)+DRELATIVESTRAIN(2,8)*V(794)+DRELATIVESTRAIN(3,8)*V&
      &(795)+DRELATIVESTRAIN(4,8)*V(796)+(D2RELATIVESTRAIN(4,8,1)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,8,1)*V(463)&
      &+D2RELATIVESTRAIN(2,8,1)*V(465)+D2RELATIVESTRAIN(3,8,1)*V(469))*VOL
  STIFFNESS(11,2)=STIFFNESS(11,2)+V(642)+DRELATIVESTRAIN(1,8)*V(797)+DRELATIVESTRAIN(2,8)*V(798)+DRELATIVESTRAIN(3,8)*V&
      &(799)+DRELATIVESTRAIN(4,8)*V(800)+(D2RELATIVESTRAIN(4,8,2)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,8,2)*V(463)&
      &+D2RELATIVESTRAIN(2,8,2)*V(465)+D2RELATIVESTRAIN(3,8,2)*V(469))*VOL
  STIFFNESS(11,3)=STIFFNESS(11,3)-V(790)*V(850)
  STIFFNESS(11,4)=STIFFNESS(11,4)+V(664)+DRELATIVESTRAIN(1,8)*V(801)+DRELATIVESTRAIN(2,8)*V(802)+DRELATIVESTRAIN(3,8)*V&
      &(803)+DRELATIVESTRAIN(4,8)*V(804)+(D2RELATIVESTRAIN(4,8,3)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,8,3)*V(463)&
      &+D2RELATIVESTRAIN(2,8,3)*V(465)+D2RELATIVESTRAIN(3,8,3)*V(469))*VOL
  STIFFNESS(11,5)=STIFFNESS(11,5)+V(673)+DRELATIVESTRAIN(1,8)*V(805)+DRELATIVESTRAIN(2,8)*V(806)+DRELATIVESTRAIN(3,8)*V&
      &(807)+DRELATIVESTRAIN(4,8)*V(808)+(D2RELATIVESTRAIN(4,8,4)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,8,4)*V(463)&
      &+D2RELATIVESTRAIN(2,8,4)*V(465)+D2RELATIVESTRAIN(3,8,4)*V(469))*VOL
  STIFFNESS(11,6)=STIFFNESS(11,6)+V(684)+V(685)+V(686)
  STIFFNESS(11,7)=STIFFNESS(11,7)+V(695)+DRELATIVESTRAIN(1,8)*V(809)+DRELATIVESTRAIN(2,8)*V(810)+DRELATIVESTRAIN(3,8)*V&
      &(811)+DRELATIVESTRAIN(4,8)*V(812)+(D2RELATIVESTRAIN(4,8,5)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,8,5)*V(463)&
      &+D2RELATIVESTRAIN(2,8,5)*V(465)+D2RELATIVESTRAIN(3,8,5)*V(469))*VOL
  STIFFNESS(11,8)=STIFFNESS(11,8)+V(701)+DRELATIVESTRAIN(1,8)*V(813)+DRELATIVESTRAIN(2,8)*V(814)+DRELATIVESTRAIN(3,8)*V&
      &(815)+DRELATIVESTRAIN(4,8)*V(816)+(D2RELATIVESTRAIN(4,8,6)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,8,6)*V(463)&
      &+D2RELATIVESTRAIN(2,8,6)*V(465)+D2RELATIVESTRAIN(3,8,6)*V(469))*VOL
  STIFFNESS(11,9)=STIFFNESS(11,9)+V(836)*V(850)
  STIFFNESS(11,10)=STIFFNESS(11,10)+V(702)+DRELATIVESTRAIN(1,8)*V(817)+DRELATIVESTRAIN(2,8)*V(818)+DRELATIVESTRAIN(3,8)*V&
      &(819)+DRELATIVESTRAIN(4,8)*V(820)+(D2RELATIVESTRAIN(4,8,7)*EQUILIBRIUMSTRESS(4)+D2RELATIVESTRAIN(1,8,7)*V(463)&
      &+D2RELATIVESTRAIN(2,8,7)*V(465)+D2RELATIVESTRAIN(3,8,7)*V(469))*VOL
  STIFFNESS(11,11)=STIFFNESS(11,11)+DRELATIVESTRAIN(1,8)*V(821)+DRELATIVESTRAIN(2,8)*V(822)+DRELATIVESTRAIN(3,8)*V(823)&
      &+DRELATIVESTRAIN(4,8)*V(824)+(DRELATIVESTRAIN(4,8)**2*DSTRESSDSTRAIN(4,4)+D2RELATIVESTRAIN(4,8,8)*EQUILIBRIUMSTRESS(4)&
      &+D2RELATIVESTRAIN(1,8,8)*V(463)+D2RELATIVESTRAIN(2,8,8)*V(465)+D2RELATIVESTRAIN(3,8,8)*V(469)+DRELATIVESTRAIN(1,8)**2*V&
      &(482)+DRELATIVESTRAIN(2,8)**2*V(490)+DRELATIVESTRAIN(3,8)**2*V(499))*VOL
END SUBROUTINE ARRAYS2D3NMINI

!------------------------
!*** check for new paper
!------------------------
SUBROUTINE ELM_TRIPLASMA(IELEM)
  INCLUDE 'simpar.inc'
!!$  E=MAPS(2,ELMA(IELEM))
!!$  ZD=MAPS(3,ELMA(IELEM))
!!$  MD=MAPS(4,ELMA(IELEM))
!!$  KB=MAPS(5,ELMA(IELEM))
!!$  E0=MAPS(6,ELMA(IELEM))
!!$  NI0=MAPS(7,ELMA(IELEM))
!!$  NE0=MAPS(8,ELMA(IELEM))
!!$  ND0=MAPS(9,ELMA(IELEM))
!!$  TI=MAPS(10,ELMA(IELEM))
!!$  TE=MAPS(11,ELMA(IELEM))
  REAL(8)::E,ZD,MD,KB,E0,NI0,NE0,ND0,TI,TE
  INTEGER,PARAMETER::MGAUS=3
  INTEGER,PARAMETER::MVTOT=12
  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
  REAL(8),DIMENSION(12)::VAR,VAROLD
  REAL(8),DIMENSION(3,2)::RNA,RNB
  REAL(8),DIMENSION(3)::FFOR
  REAL(8),DIMENSION(2,3)::DERI
  REAL(8),DIMENSION(2,2)::JAC
  REAL(8),DIMENSION(2)::XI
  REAL(8),DIMENSION(12)::FORCE
  REAL(8),DIMENSION(12,12)::STIFFNESS,stiffness2
  REAL(8),DIMENSION(2*MGAUS)::POSPG
  REAL(8),DIMENSION(MGAUS)::PESPG
  REAL(8),DIMENSION(MVTOT)::EFOR
  REAL(8),DIMENSION(MVTOT,MVTOT)::EMAT
!--------------------
!*** gather dofs
!*** local: 1:2 is u 
!***        3 is n
!***        4 is phi
!*** 
!*** global: 1:2 is u
!***         4 is n
!***         5 is phi
!--------------------
  DO IN=1,3
    INO=ELNO(ELNI(IELEM)-1+IN)
    DO id=1,2
      ITEMP=IN*4-4+ID
      JTEMP=ID
      VAROLD(ITEMP)=NODOF(JTEMP,INO,1)
      VAR(ITEMP)=NODOF(JTEMP,INO,2)
      LNODS(ITEMP)=INO
      LTYPS(ITEMP)=JTEMP
    END DO
    VAROLD(IN*4-1)=NODOF(4,INO,1)!3 local, 4 global
    VAR(IN*4-1)=NODOF(4,INO,2)
    LNODS(IN*4-1)=INO
    LTYPS(IN*4-1)=4
    VAROLD(IN*4)=NODOF(5,INO,1)!4 local,  5 global
    VAR(IN*4)=NODOF(5,INO,2)
    LNODS(IN*4)=INO
    LTYPS(IN*4)=5
    DO IDI=1,2        
      RNB(IN,IDI)=NOCO(IDI,INO)!+NODOF(IDI,INO,1)
      RNA(IN,IDI)=NOCO(IDI,INO)!+NODOF(IDI,INO,2)
    END DO
  ENDDO
  FORCE=0.0D00
  STIFFNESS=0.0D00
  STIFFNESS2=0.0D00
  E=MAPS(2,ELMA(IELEM))
  ZD=MAPS(3,ELMA(IELEM))
  MD=MAPS(4,ELMA(IELEM))
  KB=MAPS(5,ELMA(IELEM))
  E0=MAPS(6,ELMA(IELEM))
  NI0=MAPS(7,ELMA(IELEM))
  NE0=MAPS(8,ELMA(IELEM))
  ND0=MAPS(9,ELMA(IELEM))
  TI=MAPS(10,ELMA(IELEM))
  TE=MAPS(11,ELMA(IELEM))
!-----------------------------------------
!*** INITIALIZATION OF RELEVANT QUANTITIES
!-----------------------------------------
  NGAUS=3
  CALL GAUSSL(-NGAUS,PESPG,POSPG)
  CALL PCONSR(MVTOT,EFOR,0.0D00)
  CALL PCONSR(MVTOT*MVTOT,EMAT,0.0D00)
!--------------------
!*** QUADRATURE CYCLE
!--------------------
  DO IGAUSINPUT=1,NGAUS
!-----------------------------
!*** PARENT-DOMAIN COORDINATES
!-----------------------------
    XI(1)=POSPG(2*IGAUSINPUT-1)
    XI(2)=POSPG(2*IGAUSINPUT)
    FFOR(1)=1.0D00-XI(1)-XI(2)
    FFOR(2)=XI(1)
    FFOR(3)=XI(2)
    DERI(1,1)=-1.0D00
    DERI(2,1)=-1.0D00
    DERI(1,2)=1.0D00
    DERI(2,2)=0.0D00
    DERI(1,3)=0.0D00
    DERI(2,3)=1.0D00
    CALL MATRJAC(JAC,RNB,DERI,2,3)
    SQRTM=DETM23(2,JAC)
!---------------------
!*** QUADRATURE WEIGHT
!---------------------
    W=PESPG(IGAUSINPUT)
    VOL=W*ABS(SQRTM)
    VOLMESH=VOLMESH+VOL
    CALL PLASMA2DTRIANG(E,ZD,MD,KB,E0,NI0,NE0,ND0,TI,TE,DTIME,VOL,RNB,XI,VAROLD,VAR,FORCE,STIFFNESS,STIFFNESS2)
    efor=efor+force
    emat=emat+stiffness2
  END DO
  GOTO 123  
  efor(1)=efor(1)*1.0d3
  efor(5)=efor(5)*1.0d3
  efor(9)=efor(9)*1.0d3
  emat(1,1:12)=emat(1,1:12)*1.0d3
  emat(5,1:12)=emat(5,1:12)*1.0d3  
  emat(9,1:12)=emat(9,1:12)*1.0d3
123 CONTINUE
!!  IF(ielem.EQ.1)THEN
!!  WRITE(*,*)"Efor=",efor
!!  DO i=1,12
!!    WRITE(*,*)"Ematii",i,emat(i,i)
!!  END DO
!!  READ(*,*)
!!  END IF
  CALL STORE(IELEM,12,LNODS,LTYPS,EFOR,EMAT(1:12,1:12))
END SUBROUTINE ELM_TRIPLASMA

!------------------------
!*** check for new paper
!------------------------
SUBROUTINE ELM_TRIFLUID(IELEM)
  INCLUDE 'simpar.inc'
  REAL(8)::MU,H,RHO,MUREAL
  LOGICAL::STEADYSTATE
  INTEGER,PARAMETER::MGAUS=6
  INTEGER,PARAMETER::MVTOT=15
  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
  REAL(8),DIMENSION(3,2)::RNO
  REAL(8),DIMENSION(4,2)::VNEW,VOLD,VMIXED,ACC
  REAL(8),DIMENSION(3,3)::MIXED
  REAL(8),DIMENSION(3)::FFOR,PNEW,DIST,NUNEW,LAGR,LAGROLD,POLD
  REAL(8),DIMENSION(2,3)::DERI
  REAL(8),DIMENSION(2,2)::JAC
  REAL(8),DIMENSION(2)::XI,F
  REAL(8),DIMENSION(MVTOT)::INTFORCE,INTFORCE0
  REAL(8),DIMENSION(MVTOT,MVTOT)::INTSTIFF
  REAL(8),DIMENSION(2*MGAUS)::POSPG
  REAL(8),DIMENSION(MGAUS)::PESPG
  REAL(8),DIMENSION(MVTOT)::EFOR
  REAL(8),DIMENSION(MVTOT,MVTOT)::EMAT
  INTEGER,PARAMETER::IPRESS=7
  INTEGER::INVISCID=0
  REAL(8)::FROZEN=0.0d00
!  CALL   ELM_TRIFLUIDEXPL(IELEM)
!  RETURN
!----------------------------------------------------
  IF(IHOMOTOPY.EQ.1.AND.NHOMOTOPY.GT.1)THEN
    CALL ELM_EIKDIFF(IELEM,.FALSE.)
    RETURN
  END IF
  IF((IHOMOTOPY.EQ.2.AND.NHOMOTOPY.GT.2).AND.maps(4,elma(ielem)).GT.1.0d-20)THEN
    CALL ELM_EIKTURBULENCE(IELEM)
    RETURN
  END IF
  DEN=(NHOMOTOPY-2.0D00)
  STEADYSTATE=.FALSE.
  IF(MAPS(2,ELMA(IELEM)).GT.0.5D00)STEADYSTATE=.TRUE.
  IF((.NOT.STEADYSTATE).AND.(ABS(DEN-1.0D00).GT.1.0D-20))STOP "DEN NOT 1"  
  DV=DERIVATIVEVELO()*DEN
  DT=DTMAX/DEN
!  IF((IHOMOTOPY.EQ.NHOMOTOPY))INVISCID=0
  CL=MAPS(1,ELMA(IELEM))
!  H=AVERAGEMESHLENGTH()
  h=0.5d00*SQRT(AREAFACE(ELFA(ELFI(IELEM))))
  RHO=MAPS(3,ELMA(IELEM))
  MU=MAPS(4,ELMA(IELEM))
  F(1)=MAPS(5,ELMA(IELEM))
  F(2)=MAPS(6,ELMA(IELEM))
  FROZEN=MAPS(7,ELMA(IELEM))
  uinf=1.38462d00
  ITEMP=0
  DO IN=1,3
    INO=ELNO(ELNI(IELEM)-1+IN)
    DO ID=1,2
      ITEMP=ITEMP+1
      ACC(IN,ID)=VELO(ID,INO,2)*DEN
      VOLD(IN,ID)=NODOF(ID,INO,1)
      VNEW(IN,ID)=NODOF(ID,INO,2)
      LNODS(ITEMP)=INO
      LTYPS(ITEMP)=ID
    END DO
    IF(inviscid.NE.2)THEN
      ITEMP=ITEMP+1
      POLD(IN)=NODOF(IPRESS,INO,1)
      PNEW(IN)=NODOF(IPRESS,INO,2)
    END IF
    LAGROLD(IN)=NODOF(6,INO,1)
    LAGR(IN)=NODOF(6,INO,2)
    VMIXED(IN,1:2)=NODOF(4:5,INO,2)
    MIXED(IN,1:3)=NODOF(4:6,INO,2)
    NUNEW(IN)=NODOF(8,INO,2)
    DIST(IN)=abs(-CL*LOG(MAX(1.0d-3,NODOF(9,INO,2))))
    LNODS(ITEMP)=INO
    LTYPS(ITEMP)=IPRESS
    IF(INVISCID.EQ.1)THEN
      ITEMP=ITEMP+1
      LNODS(ITEMP)=INO
      LTYPS(ITEMP)=6
    ELSE IF(INVISCID.EQ.2)THEN
      DO ID=1,3
        ITEMP=ITEMP+1
        LNODS(ITEMP)=INO
        LTYPS(ITEMP)=3+ID
      END DO
    END IF
    DO IDI=1,2        
      RNO(IN,IDI)=NOCO(IDI,INO)
    END DO
 ENDDO
 noi=nint(elhist(1,ielem,2))
 if(noi.le.0)stop "no inner node"
 noi=noi+nno
 LNODS(10)=NOI
 LNODS(11)=NOI
 LTYPS(10)=1
 LTYPS(11)=2
 VNEW(4,1:2)=NODOF(1:2,NOI,2)
 VOLD(4,1:2)=NODOF(1:2,NOI,1)
 acc(4,1:2)=(vnew(4,1:2)-vold(4,1:2))/dt
!-----------------------------------------
!*** INITIALIZATION OF RELEVANT QUANTITIES
!-----------------------------------------
  NGAUS=3!
  CALL GAUSSL(-NGAUS,PESPG,POSPG)
  EFOR=0.0D00
  EMAT=0.0D00
!--------------------
!*** QUADRATURE CYCLE
!--------------------
  DO IGAUSINPUT=1,NGAUS
!-----------------------------
!*** PARENT-DOMAIN COORDINATES
!-----------------------------
    XI(1)=POSPG(2*IGAUSINPUT-1)
    XI(2)=POSPG(2*IGAUSINPUT)
    FFOR(1)=1.0D00-XI(1)-XI(2)
    FFOR(2)=XI(1)
    FFOR(3)=XI(2)
    DS=ABS(DOTPROD(3,FFOR,DIST))
    DERI(1,1)=-1.0D00
    DERI(2,1)=-1.0D00
    DERI(1,2)=1.0D00
    DERI(2,2)=0.0D00
    DERI(1,3)=0.0D00
    DERI(2,3)=1.0D00
    CALL MATRJAC(JAC,RNO,DERI,2,3)
    SQRTM=DETM23(2,JAC)
!---------------------
!*** QUADRATURE WEIGHT
!---------------------
    W=PESPG(IGAUSINPUT)
    VOL=W*ABS(SQRTM)
    VOLMESH=VOLMESH+VOL
    INTFORCE=0.0D00
    INTFORCE0=0.0D00
    INTSTIFF=0.0D00
    RNU=MU/RHO
    RNUT=DOTPROD(3,FFOR,NUNEW)
    CHI=RNUT/RNU
    CV1=7.1D00
    FV1=(CHI**3)/(CHI**3+CV1**3)
    IF(NHOMOTOPY.GT.2)THEN
      MUREAL=MAX(0.0D00,MU+RHO*RNUT*FV1)
    ELSE
      MUREAL=MU
    END IF
    aml=averagemeshlength()
    IF(DS.GT.5.0D00*AML)MUREAL=MU
    IF(INVISCID.EQ.0)THEN
!!!       h=2.0d-3
       ngl=9
      stabpress=0.05d00!7500d00!175d0!750d00!0.075d00!0.100d00!75d00!0750d00!750d00!75d00!850d00!75d0
!!      h=1.0d-2!5.0d-2!1.0d-3! 1.1d-2
      !!      CALL FLUID2DNONDIM(STEADYSTATE,FROZEN,stabpress,UINF,DV,DT,VOL,H,RHO,MU,F,RNO,PNEW(1:3),ACC(1:3,1:2),VOLD(1:3,1:2),VNEW(1:3,1:2),XI,INTFORCE(1:9),INTSTIFF(1:9,1:9))
      rmuentrance=mureal
!!!      call fluid2dbubble(steadystate,frozen,stabpress,dv,dt,vol,h,rho,rmuentrance,f,rno(1:3,1:2),pnew,acc(1:4,1:2),vold(1:4,1:2),vnew(1:4,1:2),xi,intforce(1:ngl),intstiff(1:ngl,1:ngl))
      CALL FLUID2Dsimple(STEADYSTATE,FROZEN,STABPRESS,DV,DT,VOL,H,RHO,rMUentrance,F,RNO,PNEW,ACC(1:3,1:2),VOLD(1:3,1:2),VNEW(1:3,1:2),XI,INTFORCE(1:9),INTSTIFF(1:9,1:9))      
      EFOR(1:9)=EFOR(1:9)+INTFORCE(1:9)
      EMAT(1:9,1:9)=EMAT(1:9,1:9)+INTSTIFF(1:9,1:9)
    ELSEIF(INVISCID.EQ.1)THEN
      CALL FLUID2DINVISCID(STEADYSTATE,DV,DT,VOL,H,RHO,MUREAL,F,RNO,POLD(1:3),PNEW(1:3),ACC,VOLD,VNEW,XI,LAGROLD(1:3),LAGR(1:3),INTFORCE(1:12),INTSTIFF(1:12,1:12))
      EFOR(1:12)=EFOR(1:12)+INTFORCE(1:12)
      EMAT(1:12,1:12)=EMAT(1:12,1:12)+INTSTIFF(1:12,1:12)
    ELSEIF(INVISCID.EQ.2)THEN
      bulk=mureal*100.0d00
      p2=1.0d2
      p3=1.0d2
      CALL FLUID2DLEASTSQUARES(STEADYSTATE,DV,DT,VOL,H,RHO,MUREAL,BULK,F,RNO,ACC,VNEW,XI,MIXED,INTFORCE(1:15),INTSTIFF(1:15,1:15),p2,p3)
      EFOR(1:15)=EFOR(1:15)+INTFORCE(1:15)
      EMAT(1:15,1:15)=EMAT(1:15,1:15)+INTSTIFF(1:15,1:15)
    END IF
  END DO
  GPHIST(1,1:2,IELEM,2)=MUREAL
  IF(INVISCID.EQ.2)THEN
    CALL STORE(IELEM,15,LNODS,LTYPS,EFOR(1:15),EMAT(1:15,1:15))
  ELSEIF(INVISCID.EQ.1)THEN
    CALL STORE(IELEM,12,LNODS,LTYPS,EFOR(1:12),EMAT(1:12,1:12))
  ELSEIF(INVISCID.EQ.0)THEN
    CALL STORE(IELEM,ngl,LNODS,LTYPS,EFOR(1:ngl),EMAT(1:ngl,1:ngl))
  END IF
END SUBROUTINE ELM_TRIFLUID

SUBROUTINE ELM_EIKTURBULENCE(IELEM)
  INCLUDE 'simpar.inc'
  INTEGER,PARAMETER::MGAUS=3
  INTEGER,PARAMETER::MVTOT=3
  REAL(8)::LENGTH,MU,H
  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
  REAL(8),DIMENSION(3)::DIST
  REAL(8),DIMENSION(3,2)::RNO,VNEW
  REAL(8),DIMENSION(3)::NUNEW,NUOLD,FFOR,PNEW
  REAL(8),DIMENSION(2,3)::DERI,DER
  REAL(8),DIMENSION(2,2)::JAC
  REAL(8),DIMENSION(2)::XI
  REAL(8),DIMENSION(2*MGAUS)::POSPG
  REAL(8),DIMENSION(MGAUS)::PESPG
  REAL(8),DIMENSION(MVTOT)::EFOR
  REAL(8),DIMENSION(MVTOT,MVTOT)::EMAT
!-----------------
!*** length scale
!-----------------
  CL=MAPS(1,ELMA(IELEM))
  STEADYSTATE=.FALSE.
  IF(MAPS(2,ELMA(IELEM)).GT.0.5D00)THEN
    STEADYSTATE=.TRUE.
  END IF
  H=AVERAGEMESHLENGTH()
  dt=dtmax
  h=SQRT(AREAFACE(ELFA(ELFI(IELEM))))*0.5d00
  RHO=MAPS(3,ELMA(IELEM))
  MU=MAPS(4,ELMA(IELEM))
!---------------
!*** GATHER DOFS
!---------------
  DO IN=1,3
    INO=ELNO(ELNI(IELEM)-1+IN)
    LTYPS(IN)=8
    NUOLD(IN)=NODOF(LTYPS(IN),INO,1)
    NUNEW(IN)=NODOF(LTYPS(IN),INO,2)
    PNEW(IN)=NODOF(7,INO,2)
    DIST(IN)=abs(-CL*LOG(MAX(1.0d-3,NODOF(9,INO,2))))
    VNEW(IN,1:2)=NODOF(1:2,INO,2)
    LNODS(IN)=INO
    DO IDI=1,2        
      RNO(IN,IDI)=NOCO(IDI,INO)
    END DO
  ENDDO
!-----------------------------------------
!*** INITIALIZATION OF RELEVANT QUANTITIES
!-----------------------------------------
  NGAUS=3
  CALL GAUSSL(-NGAUS,PESPG,POSPG)
  CALL PCONSR(MVTOT,EFOR,0.0D00)
  CALL PCONSR(MVTOT*MVTOT,EMAT,0.0D00)
!--------------------
!*** QUADRATURE CYCLE
!--------------------
  DO IGAUSINPUT=1,NGAUS
!-----------------------------
!*** PARENT-DOMAIN COORDINATES
!-----------------------------
    XI(1)=POSPG(2*IGAUSINPUT-1)
    XI(2)=POSPG(2*IGAUSINPUT)
    FFOR(1)=1.0D00-XI(1)-XI(2)
    FFOR(2)=XI(1)
    FFOR(3)=XI(2)
    DERI(1,1)=-1.0D00
    DERI(2,1)=-1.0D00
    DERI(1,2)=1.0D00
    DERI(2,2)=0.0D00
    DERI(1,3)=0.0D00
    DERI(2,3)=1.0D00
    CALL MATRJAC(JAC,RNO,DERI,2,3)
    SQRTM=DETM23(2,JAC)
    X1=RNO(1,1)
    X2=RNO(2,1)
    X3=RNO(3,1)
    Y1=RNO(1,2)
    Y2=RNO(2,2)
    Y3=RNO(3,2)
!---------------------
!*** QUADRATURE WEIGHT
!---------------------
    W=PESPG(IGAUSINPUT)
    VOL=W*ABS(SQRTM)
    VOLMESH=VOLMESH+VOL
    D=DOTPROD(3,FFOR,DIST)+1.0d-9
    IF(D.GT.5.0D00*H)D=1.0D20
    CALL TURBULENCE2D(DT,VOL,H,D,RHO,MU,RNO,PNEW,VNEW,XI,NUOLD,NUNEW,EFOR,EMAT)
  END DO
  CALL STORE(IELEM,3,LNODS,LTYPS,EFOR,EMAT(1:3,1:3))
END SUBROUTINE ELM_EIKTURBULENCE

SUBROUTINE ELM_TRIAREA(IELEM)
  INCLUDE 'simpar.inc'
  INTEGER,PARAMETER::MVTOT=6
  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
  REAL(8),DIMENSION(MVTOT)::VAR,VAROLD
  REAL(8),DIMENSION(3,2)::RNA,RNB
  REAL(8),DIMENSION(MVTOT)::EFOR
  REAL(8),DIMENSION(MVTOT,MVTOT)::EMAT
  DO IN=1,3
    INO=ELNO(ELNI(IELEM)-1+IN)
    DO ID=1,2
      ITEMP=IN*2-2+ID
      JTEMP=ID+3
      VAROLD(ITEMP)=NODOF(JTEMP,INO,1)
      VAR(ITEMP)=NODOF(JTEMP,INO,2)
      LNODS(ITEMP)=INO
      LTYPS(ITEMP)=JTEMP
    END DO
    DO IDI=1,2        
      RNB(IN,IDI)=NOCO(IDI,INO)!+NODOF(IDI,INO,1)
      RNA(IN,IDI)=NOCO(IDI,INO)+NODOF(IDI+3,INO,2)
    END DO
  ENDDO
  WEIGHT=MAX(1.0d-1,GPHIST(2,1,IELEM,2),GPHIST(2,2,IELEM,2))
!-----------------------------------------
!*** INITIALIZATION OF RELEVANT QUANTITIES
!-----------------------------------------
  CALL PCONSR(MVTOT,EFOR,0.0D00)
  CALL PCONSR(MVTOT*MVTOT,EMAT,0.0D00)
  CALL AREATRI2(RNA,VOL,EFOR,EMAT)
  EFOR=EFOR*WEIGHT
  EMAT=EMAT*WEIGHT
!-----------
!*** penalty
!-----------
  pen=1.0d9
  DO IN=1,3
    INO=ELNO(ELNI(IELEM)-1+IN)
    IF(IFOUTERNODE(INO))THEN
      DO id=1,2
        efor(in*2-2+id)=0.0d00
        emat(in*2-2+id,in*2-2+id)=pen
      END DO
    END IF
  END DO
  CALL STORE(IELEM,MVTOT,LNODS,LTYPS,EFOR,EMAT(1:MVTOT,1:MVTOT))
END SUBROUTINE ELM_TRIAREA

!*****************************************
!*** e ->   Electron charge
!*** zd ->  Dust charge number
!*** md ->  Mass of dust particle
!*** kb ->  Boltzmann constant
!*** e0 ->  Permitivity
!*** ni0 -> Initial ion number density 
!*** ne0 -> Initial electron number density
!*** ti ->  Ion temperature 
!*** te ->  Electron temperature
!*****************************************
!**************************************************************
!* AceGen    5.003 Linux (11 Apr 13)                          *
!*           Co. J. Korelc  2007            17 Jan 17 20:24:14*
!**************************************************************
! User     : Full professional version
! Notebook : ultrasound2dtriang.nb
! Evaluation time                 : 1 s     Mode  : Optimal
! Number of formulae              : 27      Method: Automatic
! Subroutine                      : ultrasound2dtriang size :555
! Total size of Mathematica  code : 555 subexpressions
! Total size of Fortran code      : 1472 bytes

!******************* S U B R O U T I N E **********************
!ULTRASOUND2DTRIANG(CL,RHOL,N,DTIME,VOL,EXT,RNB,XI,VAR,VEL,ACC,DACEL,FORCE,STIFFNESS)
SUBROUTINE ultrasound2dtriang(cl,rhol,n,dtime,vol,ext,xnb,xi,var,velo,acel,dacel,force,stiffness)
  IMPLICIT NONE
  DOUBLE PRECISION v(97),cl,rhol,n,dtime,vol,ext,xnb(3,2),xi(2),var(3),velo(3),acel(3),dacel,force(3),stiffness(3,3)
  v(90)=acel(3)*xi(2)
  v(89)=acel(2)*xi(1)
  v(88)=1d0-xi(1)-xi(2)
  v(87)=1d0/cl**2
  v(91)=dacel*v(87)
  v(60)=acel(1)*v(88)+v(89)+v(90)
  v(92)=-ext+v(60)*v(87)
  v(75)=v(91)*xi(2)
  v(73)=v(91)*xi(1)
  v(43)=-xnb(1,1)+xnb(2,1)
  v(44)=-xnb(1,1)+xnb(3,1)
  v(45)=-xnb(1,2)+xnb(2,2)
  v(46)=-xnb(1,2)+xnb(3,2)
  v(47)=1d0/(-(v(44)*v(45))+v(43)*v(46))
  v(53)=-(v(43)*v(47))
  v(52)=v(45)*v(47)
  v(51)=v(44)*v(47)
  v(50)=-(v(46)*v(47))
  v(48)=v(50)+v(52)
  v(57)=v(48)*var(1)-v(50)*var(2)-v(52)*var(3)
  v(49)=v(51)+v(53)
  v(58)=v(49)*var(1)-v(51)*var(2)-v(53)*var(3)
  force(1)=(v(48)*v(57)+v(49)*v(58)+v(88)*v(92))*vol
  force(2)=vol*(-(v(50)*v(57))-v(51)*v(58)+v(92)*xi(1))
  force(3)=vol*(-(v(52)*v(57))-v(53)*v(58)+v(92)*xi(2))
  v(83)=(-(v(48)*v(50))-v(49)*v(51)+v(73)*v(88))*vol
  v(84)=(-(v(48)*v(52))-v(49)*v(53)+v(75)*v(88))*vol
  v(85)=vol*(v(50)*v(52)+v(51)*v(53)+v(75)*xi(1))
  stiffness(1,1)=((v(48)*v(48))+(v(49)*v(49))+(v(88)*v(88))*v(91))*vol
  stiffness(1,2)=v(83)
  stiffness(1,3)=v(84)
  stiffness(2,1)=v(83)
  stiffness(2,2)=vol*((v(50)*v(50))+(v(51)*v(51))+v(73)*xi(1))
  stiffness(2,3)=v(85)
  stiffness(3,1)=v(84)
  stiffness(3,2)=v(85)
  stiffness(3,3)=vol*((v(52)*v(52))+(v(53)*v(53))+v(75)*xi(2))
END SUBROUTINE ultrasound2dtriang
!------------------------
!*** check for new paper
!------------------------
!!$SUBROUTINE ELM_TRISOUND(IELEM)
!!$  INCLUDE 'simpar.inc'
!!$  REAL(8)::cl,rhol,n,r0,pi,ext
!!$  INTEGER,PARAMETER::MGAUS=3
!!$  INTEGER,PARAMETER::MVTOT=3
!!$  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
!!$  REAL(8),DIMENSION(MVTOT)::VAR,VAROLD,VEL,ACC
!!$  REAL(8),DIMENSION(3,2)::RNA,RNB
!!$  REAL(8),DIMENSION(3)::FFOR
!!$  REAL(8),DIMENSION(2,3)::DERI
!!$  REAL(8),DIMENSION(2,2)::JAC
!!$  REAL(8),DIMENSION(2)::XI
!!$  REAL(8),DIMENSION(MVTOT)::FORCE
!!$  REAL(8),DIMENSION(MVTOT,MVTOT)::STIFFNESS
!!$  REAL(8),DIMENSION(2*MGAUS)::POSPG
!!$  REAL(8),DIMENSION(MGAUS)::PESPG
!!$  REAL(8),DIMENSION(MVTOT)::EFOR
!!$  REAL(8),DIMENSION(MVTOT,MVTOT)::EMAT
!!$  DO IN=1,3
!!$     INO=ELNO(ELNI(IELEM)-1+IN)
!!$     DO ID=1,1
!!$        ITEMP=IN*1-1+ID
!!$        VAROLD(ITEMP)=NODOF(1,INO,1)
!!$        VAR(ITEMP)=NODOF(1,INO,2)
!!$        VEL(ITEMP)=VELO(1,INO,2)
!!$        ACC(ITEMP)=ACEL(1,INO,2)
!!$        LNODS(ITEMP)=INO
!!$        LTYPS(ITEMP)=1
!!$     END DO
!!$     DO IDI=1,2        
!!$        RNB(IN,IDI)=NOCO(IDI,INO)
!!$        RNA(IN,IDI)=NOCO(IDI,INO)
!!$     END DO
!!$  ENDDO
!!$  FORCE=0.0D00
!!$  STIFFNESS=0.0D00
!!$!*** PROPS
!!$  CL=MAPS(2,ELMA(IELEM))
!!$  RHOL=MAPS(3,ELMA(IELEM))
!!$  N=MAPS(4,ELMA(IELEM))
!!$  R0=MAPS(5,ELMA(IELEM))
!!$  P0=MAPS(6,ELMA(IELEM))
!!$  A=MAPS(7,ELMA(IELEM))
!!$  W=MAPS(8,ELMA(IELEM))
!!$  RPI=4.0D00*ATAN(1.0D00)
!!$  PI=P0*(1.0D00+A*SIN(W*TIME))-(var(1)+var(2)+var(3))/3.0d00
!!$!*** HISTORY  
!!$  RO=ELHIST(9,IELEM,1)
!!$  DRO=ELHIST(10,IELEM,1)
!!$  IF(ABS(RO).LE.EPSMACH())THEN  
!!$     RO=R0*1.01d00
!!$  END IF
!!$  DRN=0.0d00!DRO
!!$  NIT=100
!!$!  DO IT=1,NIT
!!$!  radic=(8.0D00*DRO*DTIME*RHOL+2.0D00*RHOL*RO)**2.0D00-20.0D00*DTIME**2*RHOL*(2.0D00*PI+3.0D00*DRO**2.0D00*RHOL)
!!$!  DDRN=(-8.0D00*DRO*DTIME*RHOL-2.0D00*RO*RHOL+SQRT((8.0D00*DRO*DTIME*RHOL+2.0D00*RHOL*RO)**2.0D00-20.0D00*DTIME**2*RHOL*(2.0D00*PI+3.0D00*DRO**2.0D00*RHOL)))/(10.0d00*dtime**2*rhol)
!!$!  DRN=DRO+DTIME*DDRN
!!$!  RN=RO+DTIME*DRN
!!$
!!$
!!$!  rn=1.0d000*(var(1)+var(2)+var(3))+pi
!!$
!!$
!!$  DO it=1,nit
!!$
!!$
!!$     EQ=3.0D00*RHOL*DRN**2.0D00-2.0D00*PI*((R0**3.0D00/(DRN*DTIME+R0)**3.0d00)-1.0d00)
!!$     DEQ=6.0D00*RHOL*(DRN+((3.0D00*DTIME*PI*R0**3.0D00)/((DRN*DTIME+R0)**4.0D00)))
!!$     DRN=DRN-EQ/DEQ
!!$
!!$     IF(it.EQ.1)THEN
!!$        WRITE(*,*)"eq",eq
!!$!     WRITE(*,*)"radic=",radic
!!$!     READ(*,*)
!!$     END IF
!!$  END DO
!!$  WRITE(*,*)"ielem,pi,rn,drn",ielem,pi,rn,drn
!!$  RN=RO+DTIME*DRN
!!$  DDRN=-((3.0d00/2.0d00)*DRN**2.0D00)/RN-PI/(RHOL*RN)
!!$  EXT=(4.0D00*RPI*RHOL*N/3.0D00)*(6.0D00*RN*DRN**2.0D00+3.0D00*RN**2.0D00*DDRN)
!!$  ELHIST(9,IELEM,2)=RN
!!$  ELHIST(10,IELEM,2)=DRN
!!$
!!$
!!$!  ext=0.0d00!1.0d-12
!!$
!!$
!!$
!!$!----------------------------------------------------  
!!$!  WRITE(*,*)"rn1,drn1,ddrn1,ext=",rn1,drn1,ddrn1,ext
!!$!  READ(*,*)
!!$!----------------------------------------------------
!!$!-----------------------------------------
!!$!*** INITIALIZATION OF RELEVANT QUANTITIES
!!$!-----------------------------------------
!!$  NGAUS=3
!!$  CALL GAUSSL(-NGAUS,PESPG,POSPG)
!!$  CALL PCONSR(MVTOT,EFOR,0.0D00)
!!$  CALL PCONSR(MVTOT*MVTOT,EMAT,0.0D00)
!!$!--------------------
!!$!*** QUADRATURE CYCLE
!!$!--------------------
!!$  DO IGAUSINPUT=1,NGAUS
!!$!-----------------------------
!!$!*** PARENT-DOMAIN COORDINATES
!!$!-----------------------------
!!$     XI(1)=POSPG(2*IGAUSINPUT-1)
!!$     XI(2)=POSPG(2*IGAUSINPUT)
!!$     FFOR(1)=1.0D00-XI(1)-XI(2)
!!$     FFOR(2)=XI(1)
!!$     FFOR(3)=XI(2)
!!$     DERI(1,1)=-1.0D00
!!$     DERI(2,1)=-1.0D00
!!$     DERI(1,2)=1.0D00
!!$     DERI(2,2)=0.0D00
!!$     DERI(1,3)=0.0D00
!!$     DERI(2,3)=1.0D00
!!$     CALL MATRJAC(JAC,RNB,DERI,2,3)
!!$     SQRTM=DETM23(2,JAC)
!!$!---------------------
!!$!*** QUADRATURE WEIGHT
!!$!---------------------
!!$     W=PESPG(IGAUSINPUT)
!!$     VOL=W*ABS(SQRTM)
!!$     VOLMESH=VOLMESH+VOL
!!$     DACEL=DERIVATIVEACEL()
!!$!     WRITE(*,*)"Dacel=",dacel
!!$!     READ(*,*)
!!$!SUBROUTINE ultrasound2dtriang(cl,rhol,n,dtime,vol,ext,xnb,xi,var,velo,acel,dacel,force,stiffness)
!!$     CALL ULTRASOUND2DTRIANG(CL,RHOL,N,DTIME,VOL,EXT,RNB,XI,VAR,VEL,ACC,DACEL,FORCE,STIFFNESS)
!!$     efor=efor+force
!!$     emat=emat+stiffness
!!$  END DO
!!$  CALL STORE(IELEM,MVTOT,LNODS,LTYPS,EFOR,EMAT(1:MVTOT,1:MVTOT))
!!$END SUBROUTINE ELM_TRISOUND

!**************************************************************
!* AceGen    5.003 Linux (11 Apr 13)                          *
!*           Co. J. Korelc  2007            18 Jan 17 14:01:24*
!**************************************************************
! User     : Full professional version
! Notebook : plasma2dtriang.nb
! Evaluation time                 : 17 s    Mode  : Optimal
! Number of formulae              : 227     Method: Automatic
! Subroutine                      : plasma2dtriang size :3442
! Total size of Mathematica  code : 3442 subexpressions
! Total size of Fortran code      : 13189 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE plasma2dtriang(e,zd,md,kb,e0,ni0,ne0,nd0,ti,te,dtime,vol,xnb,xi,varold,var,force,stiffness,stiffness2)
  IMPLICIT NONE
  DOUBLE PRECISION v(900),e,zd,md,kb,e0,ni0,ne0,nd0,ti,te,dtime,vol,xnb(3,2),xi(2),varold(12),var(12),force(12)&
      &,stiffness(12,12),stiffness2(12,12)
  v(890)=vol*xi(2)
  v(884)=vol*xi(1)
  v(876)=-(varold(10)*xi(2))
  v(875)=-(varold(6)*xi(1))
  v(874)=-(varold(9)*xi(2))
  v(873)=-(varold(5)*xi(1))
  v(872)=-((e*zd)/md)
  v(871)=var(10)*xi(2)
  v(870)=var(6)*xi(1)
  v(869)=var(9)*xi(2)
  v(868)=var(5)*xi(1)
  v(866)=1d0/ti
  v(865)=1d0/te
  v(864)=var(12)*xi(2)
  v(863)=var(8)*xi(1)
  v(862)=-(varold(11)*xi(2))
  v(861)=-(varold(7)*xi(1))
  v(860)=var(11)*xi(2)
  v(859)=var(7)*xi(1)
  v(857)=1d0-xi(1)-xi(2)
  v(880)=v(857)*vol
  v(858)=e*v(857)
  v(856)=e*xi(2)
  v(855)=1d0/dtime
  v(854)=-(nd0*zd)
  v(853)=1d0/kb
  v(852)=1d0/e0
  v(851)=e*xi(1)
  v(850)=v(855)*xi(1)
  v(849)=v(854)*xi(1)
  v(848)=v(851)*v(853)
  v(464)=v(851)*v(852)
  v(889)=v(464)*vol
  v(730)=v(850)*xi(2)
  v(598)=v(853)*v(856)
  v(595)=v(854)*xi(2)
  v(530)=v(855)*xi(2)
  v(473)=v(852)*v(856)
  v(720)=v(530)*v(857)
  v(649)=v(850)*v(857)
  v(580)=v(853)*v(858)
  v(510)=v(855)*v(857)
  v(454)=v(852)*v(858)
  v(883)=v(454)*vol
  v(393)=-xnb(1,1)+xnb(2,1)
  v(394)=-xnb(1,1)+xnb(3,1)
  v(395)=-xnb(1,2)+xnb(2,2)
  v(396)=-xnb(1,2)+xnb(3,2)
  v(397)=1d0/(-(v(394)*v(395))+v(393)*v(396))
  v(403)=-(v(393)*v(397))
  v(402)=v(395)*v(397)
  v(401)=v(394)*v(397)
  v(400)=-(v(396)*v(397))
  v(398)=v(400)+v(402)
  v(439)=-(v(402)*var(11))+v(398)*var(3)-v(400)*var(7)
  v(564)=v(439)*xi(2)
  v(724)=v(564)*xi(1)
  v(714)=v(564)*v(857)
  v(553)=v(439)*xi(1)
  v(643)=v(553)*v(857)
  v(432)=-(v(402)*var(10))+v(398)*var(2)-v(400)*var(6)
  v(399)=v(401)+v(403)
  v(440)=-(v(403)*var(11))+v(399)*var(3)-v(401)*var(7)
  v(567)=v(440)*xi(2)
  v(727)=v(567)*xi(1)
  v(717)=v(567)*v(857)
  v(556)=v(440)*xi(1)
  v(646)=v(556)*v(857)
  v(437)=v(399)*var(1)-v(401)*var(5)-v(403)*var(9)
  v(404)=v(859)+v(860)+v(857)*var(3)
  v(450)=v(404)+v(861)+v(862)-v(857)*varold(3)
  v(409)=e*v(853)*(v(863)+v(864)+v(857)*var(4))
  v(879)=ni0*dexp(-(v(409)*v(866)))
  v(878)=-(ne0*dexp(v(409)*v(865)))
  v(867)=v(865)*v(878)-v(866)*v(879)
  v(601)=v(598)*v(867)
  v(592)=v(848)*v(867)
  v(418)=-(v(402)*var(12))+v(398)*var(4)-v(400)*var(8)
  v(419)=v(868)+v(869)+v(857)*var(1)
  v(570)=-(v(402)*v(419))
  v(559)=-(v(400)*v(419))
  v(547)=v(398)*v(419)
  v(527)=-(v(403)*v(419))+v(437)*xi(2)
  v(517)=-(v(401)*v(419))+v(437)*xi(1)
  v(507)=v(399)*v(419)+v(437)*v(857)
  v(420)=v(398)*var(1)-v(400)*var(5)-v(402)*var(9)
  v(496)=v(530)+v(570)+v(420)*xi(2)
  v(487)=v(559)+v(850)+v(420)*xi(1)
  v(478)=v(510)+v(547)+v(420)*v(857)
  v(421)=v(870)+v(871)+v(857)*var(2)
  v(571)=-(v(403)*v(421))
  v(572)=v(570)+v(571)
  v(560)=-(v(401)*v(421))
  v(561)=v(559)+v(560)
  v(548)=v(399)*v(421)
  v(549)=v(547)+v(548)
  v(499)=-(v(402)*v(421))+v(432)*xi(2)
  v(490)=-(v(400)*v(421))+v(432)*xi(1)
  v(481)=v(398)*v(421)+v(432)*v(857)
  v(451)=v(419)*v(439)+v(421)*v(440)
  v(534)=-(v(403)*v(872))
  v(524)=-(v(401)*v(872))
  v(514)=v(399)*v(872)
  v(502)=-(v(402)*v(872))
  v(493)=-(v(400)*v(872))
  v(484)=v(398)*v(872)
  v(444)=v(419)*v(420)+v(421)*v(432)+v(418)*v(872)+v(855)*(v(419)+v(873)+v(874)-v(857)*varold(1))
  v(423)=-(v(403)*var(12))+v(399)*var(4)-v(401)*var(8)
  v(424)=-(v(403)*var(10))+v(399)*var(2)-v(401)*var(6)
  v(531)=v(530)+v(571)+v(424)*xi(2)
  v(521)=v(560)+v(850)+v(424)*xi(1)
  v(511)=v(510)+v(548)+v(424)*v(857)
  v(447)=v(421)*v(424)+v(419)*v(437)+v(423)*v(872)+v(855)*(v(421)+v(875)+v(876)-v(857)*varold(2))
  v(441)=v(420)+v(424)
  v(881)=v(441)*v(857)
  v(877)=v(441)*xi(2)
  v(731)=v(877)*xi(1)
  v(894)=v(730)+v(731)
  v(721)=v(857)*v(877)
  v(891)=v(720)+v(721)
  v(650)=v(881)*xi(1)
  v(887)=v(649)+v(650)
  v(425)=1d0+v(404)
  v(895)=v(425)*v(441)+v(451)+v(450)*v(855)
  v(893)=-(v(401)*v(425))
  v(892)=-(v(400)*v(425))
  v(888)=-(v(425)*xi(1))
  v(886)=v(399)*v(425)
  v(885)=v(398)*v(425)
  v(882)=-(v(425)*v(857))
  v(455)=v(425)*v(854)+v(878)+v(879)
  v(480)=v(478)*v(880)
  v(483)=v(481)*v(880)
  v(486)=v(484)*v(880)
  v(489)=v(487)*v(880)
  v(492)=v(490)*v(880)
  v(495)=v(493)*v(880)
  v(498)=v(496)*v(880)
  v(501)=v(499)*v(880)
  v(504)=v(502)*v(880)
  v(509)=v(507)*v(880)
  v(513)=v(511)*v(880)
  v(516)=v(514)*v(880)
  v(519)=v(517)*v(880)
  v(523)=v(521)*v(880)
  v(526)=v(524)*v(880)
  v(529)=v(527)*v(880)
  v(533)=v(531)*v(880)
  v(536)=v(534)*v(880)
  v(543)=v(880)*(v(439)*v(857)+v(885))
  v(546)=v(880)*(v(440)*v(857)+v(886))
  v(552)=v(880)*(v(510)+v(549)+v(881))
  v(555)=(v(643)+v(400)*v(882))*vol
  v(558)=(v(646)+v(401)*v(882))*vol
  v(563)=(v(561)*v(857)+v(887))*vol
  v(566)=(v(714)+v(402)*v(882))*vol
  v(569)=(v(717)+v(403)*v(882))*vol
  v(574)=(v(572)*v(857)+v(891))*vol
  v(579)=v(454)*v(854)*v(880)
  v(585)=(-(v(398)*v(398))-(v(399)*v(399))+v(454)*v(580)*v(867))*vol
  v(588)=v(849)*v(883)
  v(594)=(v(398)*v(400)+v(399)*v(401)+v(454)*v(592))*vol
  v(597)=v(595)*v(883)
  v(603)=(v(398)*v(402)+v(399)*v(403)+v(454)*v(601))*vol
  v(606)=v(478)*v(884)
  v(608)=v(481)*v(884)
  v(610)=v(484)*v(884)
  v(612)=v(487)*v(884)
  v(614)=v(490)*v(884)
  v(616)=v(493)*v(884)
  v(618)=v(496)*v(884)
  v(620)=v(499)*v(884)
  v(622)=v(502)*v(884)
  v(625)=v(507)*v(884)
  v(627)=v(511)*v(884)
  v(629)=v(514)*v(884)
  v(631)=v(517)*v(884)
  v(633)=v(521)*v(884)
  v(635)=v(524)*v(884)
  v(637)=v(527)*v(884)
  v(639)=v(531)*v(884)
  v(641)=v(534)*v(884)
  v(645)=vol*(v(643)+v(885)*xi(1))
  v(648)=vol*(v(646)+v(886)*xi(1))
  v(652)=vol*(v(887)+v(549)*xi(1))
  v(654)=v(884)*(v(553)+v(892))
  v(656)=v(884)*(v(556)+v(893))
  v(659)=v(884)*(v(561)+v(850)+v(441)*xi(1))
  v(661)=(v(724)+v(402)*v(888))*vol
  v(663)=(v(727)+v(403)*v(888))*vol
  v(665)=vol*(v(894)+v(572)*xi(1))
  v(668)=v(849)*v(889)
  v(670)=-(((v(400)*v(400))+(v(401)*v(401))-v(464)*v(592))*vol)
  v(672)=v(595)*v(889)
  v(674)=(-(v(400)*v(402))-v(401)*v(403)+v(464)*v(601))*vol
  v(677)=v(478)*v(890)
  v(679)=v(481)*v(890)
  v(681)=v(484)*v(890)
  v(683)=v(487)*v(890)
  v(685)=v(490)*v(890)
  v(687)=v(493)*v(890)
  v(689)=v(496)*v(890)
  v(691)=v(499)*v(890)
  v(693)=v(502)*v(890)
  v(696)=v(507)*v(890)
  v(698)=v(511)*v(890)
  v(700)=v(514)*v(890)
  v(702)=v(517)*v(890)
  v(704)=v(521)*v(890)
  v(706)=v(524)*v(890)
  v(708)=v(527)*v(890)
  v(710)=v(531)*v(890)
  v(712)=v(534)*v(890)
  v(716)=vol*(v(714)+v(885)*xi(2))
  v(719)=vol*(v(717)+v(886)*xi(2))
  v(723)=vol*(v(891)+v(549)*xi(2))
  v(726)=vol*(v(724)+v(892)*xi(2))
  v(729)=vol*(v(727)+v(893)*xi(2))
  v(733)=vol*(v(894)+v(561)*xi(2))
  v(735)=(-(v(402)*v(425))+v(564))*v(890)
  v(737)=(-(v(403)*v(425))+v(567))*v(890)
  v(740)=(v(530)+v(572)+v(877))*v(890)
  v(743)=v(473)*v(595)*vol
  v(745)=-(((v(402)*v(402))+(v(403)*v(403))-v(473)*v(601))*vol)
  force(1)=v(444)*v(880)
  force(2)=v(447)*v(880)
  force(3)=v(880)*v(895)
  force(4)=(-(v(398)*v(418))-v(399)*v(423)+v(454)*v(455))*vol
  force(5)=v(444)*v(884)
  force(6)=v(447)*v(884)
  force(7)=v(884)*v(895)
  force(8)=(v(400)*v(418)+v(401)*v(423)+v(455)*v(464))*vol
  force(9)=v(444)*v(890)
  force(10)=v(447)*v(890)
  force(11)=v(890)*v(895)
  force(12)=(v(402)*v(418)+v(403)*v(423)+v(455)*v(473))*vol
  stiffness(1,1)=v(480)
  stiffness(1,2)=v(483)
  stiffness(1,3)=0d0
  stiffness(1,4)=v(486)
  stiffness(1,5)=v(489)
  stiffness(1,6)=v(492)
  stiffness(1,7)=0d0
  stiffness(1,8)=v(495)
  stiffness(1,9)=v(498)
  stiffness(1,10)=v(501)
  stiffness(1,11)=0d0
  stiffness(1,12)=v(504)
  stiffness(2,1)=v(509)
  stiffness(2,2)=v(513)
  stiffness(2,3)=0d0
  stiffness(2,4)=v(516)
  stiffness(2,5)=v(519)
  stiffness(2,6)=v(523)
  stiffness(2,7)=0d0
  stiffness(2,8)=v(526)
  stiffness(2,9)=v(529)
  stiffness(2,10)=v(533)
  stiffness(2,11)=0d0
  stiffness(2,12)=v(536)
  stiffness(3,1)=v(543)
  stiffness(3,2)=v(546)
  stiffness(3,3)=v(552)
  stiffness(3,4)=0d0
  stiffness(3,5)=v(555)
  stiffness(3,6)=v(558)
  stiffness(3,7)=v(563)
  stiffness(3,8)=0d0
  stiffness(3,9)=v(566)
  stiffness(3,10)=v(569)
  stiffness(3,11)=v(574)
  stiffness(3,12)=0d0
  stiffness(4,1)=0d0
  stiffness(4,2)=0d0
  stiffness(4,3)=v(579)
  stiffness(4,4)=v(585)
  stiffness(4,5)=0d0
  stiffness(4,6)=0d0
  stiffness(4,7)=v(588)
  stiffness(4,8)=v(594)
  stiffness(4,9)=0d0
  stiffness(4,10)=0d0
  stiffness(4,11)=v(597)
  stiffness(4,12)=v(603)
  stiffness(5,1)=v(606)
  stiffness(5,2)=v(608)
  stiffness(5,3)=0d0
  stiffness(5,4)=v(610)
  stiffness(5,5)=v(612)
  stiffness(5,6)=v(614)
  stiffness(5,7)=0d0
  stiffness(5,8)=v(616)
  stiffness(5,9)=v(618)
  stiffness(5,10)=v(620)
  stiffness(5,11)=0d0
  stiffness(5,12)=v(622)
  stiffness(6,1)=v(625)
  stiffness(6,2)=v(627)
  stiffness(6,3)=0d0
  stiffness(6,4)=v(629)
  stiffness(6,5)=v(631)
  stiffness(6,6)=v(633)
  stiffness(6,7)=0d0
  stiffness(6,8)=v(635)
  stiffness(6,9)=v(637)
  stiffness(6,10)=v(639)
  stiffness(6,11)=0d0
  stiffness(6,12)=v(641)
  stiffness(7,1)=v(645)
  stiffness(7,2)=v(648)
  stiffness(7,3)=v(652)
  stiffness(7,4)=0d0
  stiffness(7,5)=v(654)
  stiffness(7,6)=v(656)
  stiffness(7,7)=v(659)
  stiffness(7,8)=0d0
  stiffness(7,9)=v(661)
  stiffness(7,10)=v(663)
  stiffness(7,11)=v(665)
  stiffness(7,12)=0d0
  stiffness(8,1)=0d0
  stiffness(8,2)=0d0
  stiffness(8,3)=v(588)
  stiffness(8,4)=v(594)
  stiffness(8,5)=0d0
  stiffness(8,6)=0d0
  stiffness(8,7)=v(668)
  stiffness(8,8)=v(670)
  stiffness(8,9)=0d0
  stiffness(8,10)=0d0
  stiffness(8,11)=v(672)
  stiffness(8,12)=v(674)
  stiffness(9,1)=v(677)
  stiffness(9,2)=v(679)
  stiffness(9,3)=0d0
  stiffness(9,4)=v(681)
  stiffness(9,5)=v(683)
  stiffness(9,6)=v(685)
  stiffness(9,7)=0d0
  stiffness(9,8)=v(687)
  stiffness(9,9)=v(689)
  stiffness(9,10)=v(691)
  stiffness(9,11)=0d0
  stiffness(9,12)=v(693)
  stiffness(10,1)=v(696)
  stiffness(10,2)=v(698)
  stiffness(10,3)=0d0
  stiffness(10,4)=v(700)
  stiffness(10,5)=v(702)
  stiffness(10,6)=v(704)
  stiffness(10,7)=0d0
  stiffness(10,8)=v(706)
  stiffness(10,9)=v(708)
  stiffness(10,10)=v(710)
  stiffness(10,11)=0d0
  stiffness(10,12)=v(712)
  stiffness(11,1)=v(716)
  stiffness(11,2)=v(719)
  stiffness(11,3)=v(723)
  stiffness(11,4)=0d0
  stiffness(11,5)=v(726)
  stiffness(11,6)=v(729)
  stiffness(11,7)=v(733)
  stiffness(11,8)=0d0
  stiffness(11,9)=v(735)
  stiffness(11,10)=v(737)
  stiffness(11,11)=v(740)
  stiffness(11,12)=0d0
  stiffness(12,1)=0d0
  stiffness(12,2)=0d0
  stiffness(12,3)=v(597)
  stiffness(12,4)=v(603)
  stiffness(12,5)=0d0
  stiffness(12,6)=0d0
  stiffness(12,7)=v(672)
  stiffness(12,8)=v(674)
  stiffness(12,9)=0d0
  stiffness(12,10)=0d0
  stiffness(12,11)=v(743)
  stiffness(12,12)=v(745)
  stiffness2(1,1)=v(480)
  stiffness2(1,2)=v(483)
  stiffness2(1,3)=0d0
  stiffness2(1,4)=v(486)
  stiffness2(1,5)=v(489)
  stiffness2(1,6)=v(492)
  stiffness2(1,7)=0d0
  stiffness2(1,8)=v(495)
  stiffness2(1,9)=v(498)
  stiffness2(1,10)=v(501)
  stiffness2(1,11)=0d0
  stiffness2(1,12)=v(504)
  stiffness2(2,1)=v(509)
  stiffness2(2,2)=v(513)
  stiffness2(2,3)=0d0
  stiffness2(2,4)=v(516)
  stiffness2(2,5)=v(519)
  stiffness2(2,6)=v(523)
  stiffness2(2,7)=0d0
  stiffness2(2,8)=v(526)
  stiffness2(2,9)=v(529)
  stiffness2(2,10)=v(533)
  stiffness2(2,11)=0d0
  stiffness2(2,12)=v(536)
  stiffness2(3,1)=v(543)
  stiffness2(3,2)=v(546)
  stiffness2(3,3)=v(552)
  stiffness2(3,4)=0d0
  stiffness2(3,5)=v(555)
  stiffness2(3,6)=v(558)
  stiffness2(3,7)=v(563)
  stiffness2(3,8)=0d0
  stiffness2(3,9)=v(566)
  stiffness2(3,10)=v(569)
  stiffness2(3,11)=v(574)
  stiffness2(3,12)=0d0
  stiffness2(4,1)=0d0
  stiffness2(4,2)=0d0
  stiffness2(4,3)=v(579)
  stiffness2(4,4)=v(585)
  stiffness2(4,5)=0d0
  stiffness2(4,6)=0d0
  stiffness2(4,7)=v(588)
  stiffness2(4,8)=v(594)
  stiffness2(4,9)=0d0
  stiffness2(4,10)=0d0
  stiffness2(4,11)=v(597)
  stiffness2(4,12)=v(603)
  stiffness2(5,1)=v(606)
  stiffness2(5,2)=v(608)
  stiffness2(5,3)=0d0
  stiffness2(5,4)=v(610)
  stiffness2(5,5)=v(612)
  stiffness2(5,6)=v(614)
  stiffness2(5,7)=0d0
  stiffness2(5,8)=v(616)
  stiffness2(5,9)=v(618)
  stiffness2(5,10)=v(620)
  stiffness2(5,11)=0d0
  stiffness2(5,12)=v(622)
  stiffness2(6,1)=v(625)
  stiffness2(6,2)=v(627)
  stiffness2(6,3)=0d0
  stiffness2(6,4)=v(629)
  stiffness2(6,5)=v(631)
  stiffness2(6,6)=v(633)
  stiffness2(6,7)=0d0
  stiffness2(6,8)=v(635)
  stiffness2(6,9)=v(637)
  stiffness2(6,10)=v(639)
  stiffness2(6,11)=0d0
  stiffness2(6,12)=v(641)
  stiffness2(7,1)=v(645)
  stiffness2(7,2)=v(648)
  stiffness2(7,3)=v(652)
  stiffness2(7,4)=0d0
  stiffness2(7,5)=v(654)
  stiffness2(7,6)=v(656)
  stiffness2(7,7)=v(659)
  stiffness2(7,8)=0d0
  stiffness2(7,9)=v(661)
  stiffness2(7,10)=v(663)
  stiffness2(7,11)=v(665)
  stiffness2(7,12)=0d0
  stiffness2(8,1)=0d0
  stiffness2(8,2)=0d0
  stiffness2(8,3)=v(588)
  stiffness2(8,4)=v(594)
  stiffness2(8,5)=0d0
  stiffness2(8,6)=0d0
  stiffness2(8,7)=v(668)
  stiffness2(8,8)=v(670)
  stiffness2(8,9)=0d0
  stiffness2(8,10)=0d0
  stiffness2(8,11)=v(672)
  stiffness2(8,12)=v(674)
  stiffness2(9,1)=v(677)
  stiffness2(9,2)=v(679)
  stiffness2(9,3)=0d0
  stiffness2(9,4)=v(681)
  stiffness2(9,5)=v(683)
  stiffness2(9,6)=v(685)
  stiffness2(9,7)=0d0
  stiffness2(9,8)=v(687)
  stiffness2(9,9)=v(689)
  stiffness2(9,10)=v(691)
  stiffness2(9,11)=0d0
  stiffness2(9,12)=v(693)
  stiffness2(10,1)=v(696)
  stiffness2(10,2)=v(698)
  stiffness2(10,3)=0d0
  stiffness2(10,4)=v(700)
  stiffness2(10,5)=v(702)
  stiffness2(10,6)=v(704)
  stiffness2(10,7)=0d0
  stiffness2(10,8)=v(706)
  stiffness2(10,9)=v(708)
  stiffness2(10,10)=v(710)
  stiffness2(10,11)=0d0
  stiffness2(10,12)=v(712)
  stiffness2(11,1)=v(716)
  stiffness2(11,2)=v(719)
  stiffness2(11,3)=v(723)
  stiffness2(11,4)=0d0
  stiffness2(11,5)=v(726)
  stiffness2(11,6)=v(729)
  stiffness2(11,7)=v(733)
  stiffness2(11,8)=0d0
  stiffness2(11,9)=v(735)
  stiffness2(11,10)=v(737)
  stiffness2(11,11)=v(740)
  stiffness2(11,12)=0d0
  stiffness2(12,1)=0d0
  stiffness2(12,2)=0d0
  stiffness2(12,3)=v(597)
  stiffness2(12,4)=v(603)
  stiffness2(12,5)=0d0
  stiffness2(12,6)=0d0
  stiffness2(12,7)=v(672)
  stiffness2(12,8)=v(674)
  stiffness2(12,9)=0d0
  stiffness2(12,10)=0d0
  stiffness2(12,11)=v(743)
  stiffness2(12,12)=v(745)
END SUBROUTINE plasma2dtriang


SUBROUTINE ELM_TRIMLS(IELEM)
  INCLUDE 'simpar.inc'  
!------------------------------------------
  INTEGER,PARAMETER::NDI=2
  INTEGER,PARAMETER::NNODES=3
  INTEGER,PARAMETER::MGAUS=4
  INTEGER,PARAMETER::MN=120
!------------------------------------------
  INTEGER,PARAMETER::NVOIGT=NDI*(NDI+1)/2
  INTEGER,PARAMETER::NVOIGT1=NVOIGT+1
  INTEGER,PARAMETER::MVTOT=NDI*MN
!------------------------------------------
  REAL(8)::LENGTH
  REAL(8),DIMENSION(NDI)::XC,XG0,XG1
  REAL(8),DIMENSION(NDI)::XI1,XI0
  REAL(8),DIMENSION(NNODES)::FFOR1,FFOR0
  REAL(8),DIMENSION(NDI,NDI)::ORIFRAME
  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
  REAL(8),DIMENSION(NNODES,NDI)::RNO
  REAL(8),DIMENSION(NDI*MGAUS*3)::POSPG
  REAL(8),DIMENSION(MGAUS*4)::PESPG
  REAL(8),DIMENSION(MVTOT)::EFOR
  REAL(8),DIMENSION(MVTOT,MVTOT)::EMAT
  REAL(8),DIMENSION(NVOIGT)::STRESS,STRAIN,OLDSTRAIN,CAUCHYGREEN,CAUCHYGREEN0,CAUCHYGREEN1
  REAL(8),DIMENSION(NVOIGT)::ACTIVE
  REAL(8),DIMENSION(NVOIGT,NVOIGT)::DS
  REAL(8),DIMENSION(NVOIGT,NDI)::DCK,DCL,DCK0,DCL0,DCK1,DCL1
  REAL(8),DIMENSION(NVOIGT,NDI,NDI)::D2C,D2C0,D2C1
  INTEGER,DIMENSION(:),ALLOCATABLE::LISTN    
  REAL(8),DIMENSION(:,:),ALLOCATABLE::DFF,XTOT,DFF0,DFF1
  REAL(8),DIMENSION(:,:,:),ALLOCATABLE::DFF20,DFF21
  REAL(8),DIMENSION(:),ALLOCATABLE::FF0,FF1
  REAL(8),DIMENSION(:,:),ALLOCATABLE::XDEF
  REAL(8),DIMENSION(NDI,NDI)::F0,F1
  REAL(8),DIMENSION(NDI)::NUCLEUS
  REAL(8),DIMENSION(NDI,NDI)::KERNEL

!-------------------------------------
!*** GATHER PRISTINE ELEMENT POSITIONS
!-------------------------------------
  DO IN=1,NNODES
    INO=ELNO(ELNI(IELEM)-1+IN)
    DO ID=1,NDI
      RNO(IN,ID)=NOCO(ID,INO)
    END DO
  ENDDO

!----------
!*** VOLUME
!----------
  SQRTM=2.0d00*AREATRIANGULO2D(RNO(1,1:2),RNO(2,1:2),RNO(3,1:2))

!------------
!*** ORIFRAME
!------------
  DO JD=1,NDI
    DO ID=1,NDI
      ORIFRAME(ID,JD)=DELTAK(ID,JD)
    END DO
  END DO

  NTOT=NVISIBLE(IELEM)

  IF(NTOT.GT.MN)THEN
    WRITE(*,*)"PROBLEMS WITH MAX NODES,NTOT"
    STOP
  END IF

  ALLOCATE(LISTN(NTOT),DFF21(NDI,NDI,NTOT),DFF20(NDI,NDI,NTOT),DFF1(NDI,NTOT),DFF0(NDI,NTOT), &
      XTOT(NDI,NTOT),XDEF(NDI,NTOT),FF1(NTOT),FF0(NTOT))

  N=NTOT
  DO IK=1,NVISIBLE(IELEM)
    LISTN(IK)=MLSVISIBLE(IELEM,IK)
  END DO

!------------------------
!*** SETS LNODS AND LTYPS
!*** N*NDI
!------------------------
  DO IN=1,N
    INO=LISTN(IN)
    DO ID=1,NDI
      LNODS(NDI*IN-NDI+ID)=INO
      LTYPS(NDI*IN-NDI+ID)=ID
    END DO
  END DO

  DO IN=1,N     
    INO=LISTN(IN)
    DO ID=1,NDI
      XTOT(ID,IN)=NOCO(ID,INO)
      XDEF(ID,IN)=NOCO(ID,INO)+NODOF(ID,INO,2)
    END DO
  END DO

!-----------------------------------------
!*** INITIALIZATION OF RELEVANT QUANTITIES
!-----------------------------------------

  NGAUS0=1
  NGAUS1=3

  IMESHLESS0=-3
  IMESHLESS1=-2



  NGAUS=NGAUS1

  CALL GAUSSL(-NGAUS,PESPG,POSPG)

  EFOR(1:N*NDI)=0.0D00

  EMAT(1:N*NDI,1:N*NDI)=0.0D00

!----------------
!*** CENTROID
!*** COORDINATES
!----------------
  DO ID=1,NDI
    XC(ID)=0.0D00
    DO IN=1,NNODES
      XC(ID)=XC(ID)+RNO(IN,ID)*0.33333d00
    END DO
  END DO

!---------------------
!*** QUADRATURE CYCLE
!---------------------
  DO IGAUSINPUT=1,NGAUS
!----------------------
!*** QUADRATURE WEIGHT
!----------------------

    W=PESPG(IGAUSINPUT)     
    XI1(1)=POSPG(2*IGAUSINPUT-1)
    XI1(2)=POSPG(2*IGAUSINPUT)

    IF(NGAUS0.EQ.1)THEN
      XI0(1)=0.3333D00
      XI0(2)=0.3333D00
    ELSE
      XI0=XI1
    END IF

    FFOR1(1)=1.0D00-XI1(1)-XI1(2)
    FFOR1(2)=XI1(1)
    FFOR1(3)=XI1(2)

    FFOR0(1)=1.0D00-XI0(1)-XI0(2)
    FFOR0(2)=XI0(1)
    FFOR0(3)=XI0(2)

    DO ID=1,NDI
      XG1(ID)=DOTPROD(NNODES,FFOR1,RNO(1:NNODES,ID))
      XG0(ID)=DOTPROD(NNODES,FFOR0,RNO(1:NNODES,ID))
    END DO

    CALL RBF_GAUSSLEVELSHAPEFUNCTIONS(-IMESHLESS1,DSUPPORT(IELEM),NDI,XG1,XC,NTOT,XTOT,FF1,DFF1,DFF21)
    CALL RBF_GAUSSLEVELSHAPEFUNCTIONS(-IMESHLESS0,DSUPPORT(IELEM),NDI,XG0,XC,NTOT,XTOT,FF0,DFF0,DFF20)

    CALL MLS_CAUCHYGREEN(NDI,NTOT,XTOT(1:NDI,1:NTOT),XDEF(1:NDI,1:NTOT),DFF1(1:NDI,1:NTOT),F1(1:NDI,1:NDI),CAUCHYGREEN1)
    CALL MLS_CAUCHYGREEN(NDI,NTOT,XTOT(1:NDI,1:NTOT),XDEF(1:NDI,1:NTOT),DFF0(1:NDI,1:NTOT),F0(1:NDI,1:NDI),CAUCHYGREEN0)

    CALL MLS_COMBINEDFBAR0_2D(CAUCHYGREEN1,CAUCHYGREEN0,CAUCHYGREEN)
!*** up to here is ok

    STRAIN(1)=0.5D00*(CAUCHYGREEN(1)-1.0D00)
    STRAIN(2)=0.5D00*(CAUCHYGREEN(2)-1.0D00)
    STRAIN(3)=CAUCHYGREEN(3)

    VOL=W*ABS(SQRTM)

    VOLMESH=VOLMESH+VOL

    IHYPER=1

    IPLAST=1

    XI3=0.0D00

    LENGTH=1.0D00

    ACTIVE=1.0D00

    OLDSTRAIN=0.0D00

!----------------------
!*** CONSTITUTIVE CALL
!----------------------
    CALL NEWRIDICULOUS3(IGAUSINPUT,IELEM,IHYPER,IPLAST,XI3,ORIFRAME,LENGTH,OLDSTRAIN,STRAIN,PSI,STRESS,DS)

!---------------------------------
!*** EXTERNAL AND INTERNAL FORCES
!---------------------------------     
    DO IN=1,N
      CALL MLS_CLASSICALDC_2D(DFF1(1:NDI,IN),F1(1:NDI,1:NDI),DCK1)
      CALL MLS_CLASSICALDC_2D(DFF0(1:NDI,IN),F0(1:NDI,1:NDI),DCK0)
      CALL MLS_COMBINEDFBAR1_2D(CAUCHYGREEN1,CAUCHYGREEN0,DCK1,DCK0,DCK)
      CALL MLS_FBARFORCE_2D(DCK,STRESS,NUCLEUS)        
      DO ID=1,NDI
        ITEMP=IN*NDI-NDI+ID
        EFOR(ITEMP)=EFOR(ITEMP)+VOL*NUCLEUS(ID)
      END DO
    END DO

!-------------
!*** STIFNESS
!-------------
    DO IN=1,N
      CALL MLS_CLASSICALDC_2D(DFF1(1:NDI,IN),F1(1:NDI,1:NDI),DCK1)
      CALL MLS_CLASSICALDC_2D(DFF0(1:NDI,IN),F0(1:NDI,1:NDI),DCK0)
      CALL MLS_COMBINEDFBAR1_2D(CAUCHYGREEN1,CAUCHYGREEN0,DCK1,DCK0,DCK)
      DO JN=1,N
        CALL MLS_CLASSICALDC_2D(DFF1(1:NDI,JN),F1(1:NDI,1:NDI),DCL1)
        CALL MLS_CLASSICALDC_2D(DFF0(1:NDI,JN),F0(1:NDI,1:NDI),DCL0)
        CALL MLS_COMBINEDFBAR1_2D(CAUCHYGREEN1,CAUCHYGREEN0,DCL1,DCL0,DCL)

        CALL MLS_CLASSICALDC2_2D(DFF1(1:NDI,IN),DFF1(1:NDI,JN),D2C1)
        CALL MLS_CLASSICALDC2_2D(DFF0(1:NDI,IN),DFF0(1:NDI,JN),D2C0)

        CALL MLS_COMBINEDFBAR2_2D(CAUCHYGREEN1,CAUCHYGREEN0,DCK1,DCL1,DCK0,DCL0,D2C1,D2C0,D2C)

        CALL MLS_FBAR_2D(DCK,DCL,D2C,STRESS,DS,KERNEL)

        DO ID=1,NDI
          ITEMP=IN*NDI-NDI+ID
          DO JD=1,NDI
            JTEMP=JN*NDI-NDI+JD                 
            EMAT(ITEMP,JTEMP)=EMAT(ITEMP,JTEMP)+VOL*KERNEL(ID,JD)
          END DO
        END DO
      END DO
    END DO
  END DO
!--------------  
!*** ASSEMBLING
!--------------
!--------------------
!*** SENDS TO STORAGE
!--------------------
  CALL STORE(IELEM,NDI*N,LNODS,LTYPS,EFOR(1:NDI*N),EMAT(1:NDI*N,1:NDI*N))
END SUBROUTINE ELM_TRIMLS


SUBROUTINE ELM_TRIMLSfluid(IELEM)
  INCLUDE 'simpar.inc'  
!------------------------------------------
  INTEGER,PARAMETER::NDI=2
  INTEGER,PARAMETER::NNODES=3
  INTEGER,PARAMETER::MGAUS=4
  INTEGER,PARAMETER::MN=120
!------------------------------------------
  INTEGER,PARAMETER::NVOIGT=NDI*(NDI+1)/2
  INTEGER,PARAMETER::NVOIGT1=NVOIGT+1
  INTEGER,PARAMETER::MVTOT=NDI*MN
!------------------------------------------
  REAL(8)::LENGTH
  REAL(8),DIMENSION(NDI)::XC,XG0,XG1
  REAL(8),DIMENSION(NDI)::XI1,XI0
  REAL(8),DIMENSION(NNODES)::FFOR1,FFOR0
  REAL(8),DIMENSION(NDI,NDI)::ORIFRAME
  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
  REAL(8),DIMENSION(NNODES,NDI)::RNO
  REAL(8),DIMENSION(NDI*MGAUS*3)::POSPG
  REAL(8),DIMENSION(MGAUS*4)::PESPG
  REAL(8),DIMENSION(MVTOT)::EFOR
  REAL(8),DIMENSION(MVTOT,MVTOT)::EMAT
  REAL(8),DIMENSION(NVOIGT)::STRESS,STRAIN,OLDSTRAIN,CAUCHYGREEN,CAUCHYGREEN0,CAUCHYGREEN1
  REAL(8),DIMENSION(NVOIGT)::ACTIVE
  REAL(8),DIMENSION(NVOIGT,NVOIGT)::DS
  REAL(8),DIMENSION(NVOIGT,NDI)::DCK,DCL,DCK0,DCL0,DCK1,DCL1
  REAL(8),DIMENSION(NVOIGT,NDI,NDI)::D2C,D2C0,D2C1
  INTEGER,DIMENSION(:),ALLOCATABLE::LISTN    
  REAL(8),DIMENSION(:,:),ALLOCATABLE::DFF,XTOT,DFF0,DFF1
  REAL(8),DIMENSION(:,:,:),ALLOCATABLE::DFF20,DFF21,DFF2
  REAL(8),DIMENSION(:),ALLOCATABLE::FF0,FF1,FF
  REAL(8),DIMENSION(MN)::PNEW
  REAL(8),DIMENSION(MN,2)::ACC,VNEW,VOLD
  REAL(8),DIMENSION(NDI,NDI)::F0,F1
  REAL(8),DIMENSION(NDI)::NUCLEUS
  REAL(8),DIMENSION(NDI,NDI)::KERNEL
  REAL(8),DIMENSION(MVTOT)::INTFORCE
  REAL(8),DIMENSION(MVTOT,MVTOT)::INTSTIFF
  LOGICAL::STEADYSTATE=.FALSE.
  REAL(8),DIMENSION(2)::F
  REAL(8)::MU
  IF(NINT(MAPS(9,ELMA(IELEM))).NE.12)THEN
    STOP "WRONG REQUEST TO TRIMLSFLUID"
  END IF
  H=AVERAGEMESHLENGTH()
  CL=MAPS(1,ELMA(IELEM))
  IF(MAPS(2,ELMA(IELEM)).GT.0.5D00)STEADYSTATE=.TRUE.
  RHO=MAPS(3,ELMA(IELEM))
  MU=MAPS(4,ELMA(IELEM))
  F(1)=MAPS(5,ELMA(IELEM))
  F(2)=MAPS(6,ELMA(IELEM))
  DEN=(NHOMOTOPY-2.0D00)
  IF((.NOT.steadystate).AND.(ABS(DEN-1.0D00).GT.1.0D-20))STOP "DEN NOT 1"
  DV=DERIVATIVEVELO()*DEN
  DT=DTIME/DEN
!-------------------------------------
!*** GATHER PRISTINE ELEMENT POSITIONS
!-------------------------------------
  DO IN=1,NNODES
    INO=ELNO(ELNI(IELEM)-1+IN)
    DO ID=1,NDI
      RNO(IN,ID)=NOCO(ID,INO)
    END DO
  ENDDO
!----------
!*** VOLUME
!----------
  SQRTM=2.0d00*AREATRIANGULO2D(RNO(1,1:2),RNO(2,1:2),RNO(3,1:2))

  NTOT=NVISIBLE(IELEM)

  IF(NTOT.NE.12)THEN
    WRITE(*,*)"PROBLEMS WITH MAX NODES,NTOT"
    STOP
  END IF

  ALLOCATE(LISTN(NTOT),DFF2(NDI,NDI,NTOT),DFF(NDI,NTOT),XTOT(NDI,NTOT),FF(NTOT))

  N=NTOT
  DO IK=1,NVISIBLE(IELEM)
    LISTN(IK)=MLSVISIBLE(IELEM,IK)
  END DO

!------------------------
!*** SETS LNODS AND LTYPS
!*** N*NDI
!  pnew,acel,vold,vnew,xi,intforce,intstiff)
!------------------------

  DO IN=1,N
    INO=LISTN(IN)
    DO ID=1,NDI
      LNODS((NDI+1)*IN-NDI-1+ID)=INO
      LTYPS((NDI+1)*IN-NDI-1+ID)=ID
    END DO
    PNEW(IN)=NODOF(7,INO,2)
    LNODS((NDI+1)*IN)=INO
    LTYPS((NDI+1)*IN)=7
  END DO

  DO IN=1,N     
    INO=LISTN(IN)
    DO ID=1,NDI
      ACC(IN,ID)=VELO(ID,INO,2)*DEN
      VOLD(IN,ID)=NODOF(ID,INO,1)
      VNEW(IN,ID)=NODOF(ID,INO,2)
      XTOT(ID,IN)=NOCO(ID,INO)
    END DO
  END DO

!-----------------------------------------
!*** INITIALIZATION OF RELEVANT QUANTITIES
!-----------------------------------------

  NGAUS0=1
  NGAUS1=1

  IMESHLESS0=2
  IMESHLESS1=2

  NGAUS=NGAUS1

  CALL GAUSSL(-NGAUS,PESPG,POSPG)

  EFOR(1:N*3)=0.0D00

  EMAT(1:N*3,1:N*3)=0.0D00

!----------------
!*** CENTROID
!*** COORDINATES
!----------------
  DO ID=1,NDI
    XC(ID)=0.0D00
    DO IN=1,NNODES
      XC(ID)=XC(ID)+RNO(IN,ID)*0.33333d00
    END DO
  END DO
  INTFORCE(1:N*3)=0.0D00
  INTSTIFF(1:N*3,1:N*3)=0.0D00
!---------------------
!*** QUADRATURE CYCLE
!---------------------
  DO IGAUSINPUT=1,NGAUS
!----------------------
!*** QUADRATURE WEIGHT
!----------------------
    W=PESPG(IGAUSINPUT)     
    XI1(1)=POSPG(2*IGAUSINPUT-1)
    XI1(2)=POSPG(2*IGAUSINPUT)
    XI0=XI1

    FFOR1(1)=1.0D00-XI1(1)-XI1(2)
    FFOR1(2)=XI1(1)
    FFOR1(3)=XI1(2)
    FFOR0(1)=1.0D00-XI0(1)-XI0(2)
    FFOR0(2)=XI0(1)
    FFOR0(3)=XI0(2)

    DO ID=1,NDI
      XG1(ID)=DOTPROD(NNODES,FFOR1,RNO(1:NNODES,ID))
      XG0(ID)=DOTPROD(NNODES,FFOR0,RNO(1:NNODES,ID))
    END DO

    CALL RBF_GAUSSLEVELSHAPEFUNCTIONS(IMESHLESS1,DSUPPORT(IELEM),NDI,XG1,XC,NTOT,XTOT,FF,DFF,DFF2)

    DFF2=0.0D00
    VOL=W*ABS(SQRTM)

    VOLMESH=VOLMESH+VOL

    LENGTH=1.0D00
    WRITE(*,*)"dv,dt,vol,h,rho,mu",dv,dt,vol,h,rho,mu
    CALL FLUID2DMESHLESS(STEADYSTATE,.TRUE.,DV,DT,VOL,H,RHO,MU,F,FF,DFF,DFF2,PNEW,ACC,VOLD,VNEW,XI0,INTFORCE(1:N*3),INTSTIFF(1:N*3,1:N*3))

    EFOR(1:3*N)=EFOR(1:3*N)+INTFORCE(1:3*N)
    EMAT(1:3*N,1:3*N)=EMAT(1:3*N,1:3*N)+INTSTIFF(1:3*N,1:3*N)
  END DO
!--------------  
!*** ASSEMBLING
!--------------
!--------------------
!*** SENDS TO STORAGE
!--------------------
  CALL STORE(IELEM,3*N,LNODS,LTYPS,EFOR(1:3*N),EMAT(1:3*N,1:3*N))
END SUBROUTINE ELM_TRIMLSFLUID

SUBROUTINE ELM_TRIGRADIENT(IELEM)
  INCLUDE 'simpar.inc'
!------------------------------------------
  INTEGER,PARAMETER::NDI=2
  INTEGER,PARAMETER::NNODES=3
  INTEGER,PARAMETER::MGAUS=4
  INTEGER,PARAMETER::MN=120
!------------------------------------------
  INTEGER,PARAMETER::NVOIGT=NDI*(NDI+1)/2
  INTEGER,PARAMETER::NVOIGT1=NVOIGT+1
  INTEGER,PARAMETER::MVTOT=NDI*MN
!------------------------------------------
  REAL(8)::LENGTH
  REAL(8),DIMENSION(NDI)::XC,XG0,XG1
  REAL(8),DIMENSION(NDI)::XI1,XI0
  REAL(8),DIMENSION(NNODES)::FFOR1,FFOR0
  REAL(8),DIMENSION(NDI,NDI)::ORIFRAME
  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
  REAL(8),DIMENSION(NNODES,NDI)::RNO
  REAL(8),DIMENSION(NDI*MGAUS*3)::POSPG
  REAL(8),DIMENSION(MGAUS*4)::PESPG
  REAL(8),DIMENSION(MVTOT)::EFOR
  REAL(8),DIMENSION(MVTOT,MVTOT)::EMAT
  REAL(8),DIMENSION(NVOIGT)::STRESS,STRAIN,OLDSTRAIN,CAUCHYGREEN,CAUCHYGREEN0,CAUCHYGREEN1
  REAL(8),DIMENSION(NVOIGT)::ACTIVE
  REAL(8),DIMENSION(NVOIGT,NVOIGT)::DS
  REAL(8),DIMENSION(NVOIGT,NDI)::DCK,DCL,DCK0,DCL0,DCK1,DCL1
  REAL(8),DIMENSION(NVOIGT,NDI,NDI)::D2C,D2C0,D2C1
  INTEGER,DIMENSION(:),ALLOCATABLE::LISTN    
  REAL(8),DIMENSION(:,:),ALLOCATABLE::DFF,XTOT,DFF0,DFF1
  REAL(8),DIMENSION(:,:,:),ALLOCATABLE::DFF20,DFF21
  REAL(8),DIMENSION(:),ALLOCATABLE::FF0,FF1
  REAL(8),DIMENSION(:,:),ALLOCATABLE::XDEF
  REAL(8),DIMENSION(NDI,NDI)::F0,F1
  REAL(8),DIMENSION(NDI)::NUCLEUS
  REAL(8),DIMENSION(NDI,NDI)::KERNEL

!-------------------------------------
!*** GATHER PRISTINE ELEMENT POSITIONS
!-------------------------------------
  DO IN=1,NNODES
    INO=ELNO(ELNI(IELEM)-1+IN)
    DO ID=1,NDI
      RNO(IN,ID)=NOCO(ID,INO)
    END DO
  ENDDO

!----------
!*** VOLUME
!----------
  SQRTM=2.0d00*AREATRIANGULO2D(RNO(1,1:2),RNO(2,1:2),RNO(3,1:2))

!------------
!*** ORIFRAME
!------------
  DO JD=1,NDI
    DO ID=1,NDI
      ORIFRAME(ID,JD)=DELTAK(ID,JD)
    END DO
  END DO

  NTOT=NVISIBLE(IELEM)

  IF(NTOT.GT.MN)THEN
    WRITE(*,*)"PROBLEMS WITH MAX NODES,NTOT"
    STOP
  END IF

  ALLOCATE(LISTN(NTOT),DFF21(NDI,NDI,NTOT),DFF20(NDI,NDI,NTOT),DFF1(NDI,NTOT),DFF0(NDI,NTOT), &
      XTOT(NDI,NTOT),XDEF(NDI,NTOT),FF1(NTOT),FF0(NTOT))

  N=NTOT
  DO IK=1,NVISIBLE(IELEM)
    LISTN(IK)=MLSVISIBLE(IELEM,IK)
  END DO

!------------------------
!*** SETS LNODS AND LTYPS
!*** N*NDI
!------------------------
  DO IN=1,N
    INO=LISTN(IN)
    DO ID=1,NDI
      LNODS(NDI*IN-NDI+ID)=INO
      LTYPS(NDI*IN-NDI+ID)=ID
    END DO
  END DO

  DO IN=1,N     
    INO=LISTN(IN)
    DO ID=1,NDI
      XTOT(ID,IN)=NOCO(ID,INO)
      XDEF(ID,IN)=NOCO(ID,INO)+NODOF(ID,INO,2)
    END DO
  END DO

!-----------------------------------------
!*** INITIALIZATION OF RELEVANT QUANTITIES
!-----------------------------------------
  NGAUS1=1
  NGAUS0=1

  IMESHLESS1=-3
  IMESHLESS0=-3

  NGAUS=NGAUS1

  CALL GAUSSL(-NGAUS,PESPG,POSPG)

  EFOR(1:N*NDI)=0.0D00

  EMAT(1:N*NDI,1:N*NDI)=0.0D00

!----------------
!*** CENTROID
!*** COORDINATES
!----------------
  DO ID=1,NDI
    XC(ID)=0.0D00
    DO IN=1,NNODES
      XC(ID)=XC(ID)+RNO(IN,ID)*0.33333d00
    END DO
  END DO

!---------------------
!*** QUADRATURE CYCLE
!---------------------
  DO IGAUSINPUT=1,NGAUS
!----------------------
!*** QUADRATURE WEIGHT
!----------------------

    W=PESPG(IGAUSINPUT)     
    XI1(1)=POSPG(2*IGAUSINPUT-1)
    XI1(2)=POSPG(2*IGAUSINPUT)

    IF(NGAUS0.EQ.1)THEN
      XI0(1)=0.3333D00
      XI0(2)=0.3333D00
    ELSE
      XI0=XI1
    END IF

    FFOR1(1)=1.0D00-XI1(1)-XI1(2)
    FFOR1(2)=XI1(1)
    FFOR1(3)=XI1(2)

    FFOR0(1)=1.0D00-XI0(1)-XI0(2)
    FFOR0(2)=XI0(1)
    FFOR0(3)=XI0(2)

    DO ID=1,NDI
      XG1(ID)=DOTPROD(NNODES,FFOR1,RNO(1:NNODES,ID))
      XG0(ID)=DOTPROD(NNODES,FFOR0,RNO(1:NNODES,ID))
    END DO

    CALL RBF_GAUSSLEVELSHAPEFUNCTIONS(-IMESHLESS1,DSUPPORT(IELEM),NDI,XG1,XC,NTOT,XTOT,FF1,DFF1,DFF21)
    CALL RBF_GAUSSLEVELSHAPEFUNCTIONS(-IMESHLESS0,DSUPPORT(IELEM),NDI,XG0,XC,NTOT,XTOT,FF0,DFF0,DFF20)

    CALL MLS_CAUCHYGREEN(NDI,NTOT,XTOT(1:NDI,1:NTOT),XDEF(1:NDI,1:NTOT),DFF1(1:NDI,1:NTOT),F1(1:NDI,1:NDI),CAUCHYGREEN1)
    CALL MLS_CAUCHYGREEN(NDI,NTOT,XTOT(1:NDI,1:NTOT),XDEF(1:NDI,1:NTOT),DFF0(1:NDI,1:NTOT),F0(1:NDI,1:NDI),CAUCHYGREEN0)

    CALL MLS_COMBINEDFBAR0_2D(CAUCHYGREEN1,CAUCHYGREEN0,CAUCHYGREEN)
!*** up to here is ok

    STRAIN(1)=0.5D00*(CAUCHYGREEN(1)-1.0D00)
    STRAIN(2)=0.5D00*(CAUCHYGREEN(2)-1.0D00)
    STRAIN(3)=CAUCHYGREEN(3)

    VOL=W*ABS(SQRTM)

    VOLMESH=VOLMESH+VOL

    IHYPER=1

    IPLAST=1

    XI3=0.0D00

    LENGTH=1.0D00

    ACTIVE=1.0D00

    OLDSTRAIN=0.0D00

!----------------------
!*** CONSTITUTIVE CALL
!----------------------
    CALL NEWRIDICULOUS3(IGAUSINPUT,IELEM,IHYPER,IPLAST,XI3,ORIFRAME,LENGTH,OLDSTRAIN,STRAIN,PSI,STRESS,DS)

!---------------------------------
!*** EXTERNAL AND INTERNAL FORCES
!---------------------------------     
    DO IN=1,N
      CALL MLS_CLASSICALDC_2D(DFF1(1:NDI,IN),F1(1:NDI,1:NDI),DCK1)
      CALL MLS_CLASSICALDC_2D(DFF0(1:NDI,IN),F0(1:NDI,1:NDI),DCK0)
      CALL MLS_COMBINEDFBAR1_2D(CAUCHYGREEN1,CAUCHYGREEN0,DCK1,DCK0,DCK)
      CALL MLS_FBARFORCE_2D(DCK,STRESS,NUCLEUS)        
      DO ID=1,NDI
        ITEMP=IN*NDI-NDI+ID
        EFOR(ITEMP)=EFOR(ITEMP)+VOL*NUCLEUS(ID)
      END DO
    END DO

!-------------
!*** STIFNESS
!-------------
    DO IN=1,N
      CALL MLS_CLASSICALDC_2D(DFF1(1:NDI,IN),F1(1:NDI,1:NDI),DCK1)
      CALL MLS_CLASSICALDC_2D(DFF0(1:NDI,IN),F0(1:NDI,1:NDI),DCK0)
      CALL MLS_COMBINEDFBAR1_2D(CAUCHYGREEN1,CAUCHYGREEN0,DCK1,DCK0,DCK)
      DO JN=1,N
        CALL MLS_CLASSICALDC_2D(DFF1(1:NDI,JN),F1(1:NDI,1:NDI),DCL1)
        CALL MLS_CLASSICALDC_2D(DFF0(1:NDI,JN),F0(1:NDI,1:NDI),DCL0)
        CALL MLS_COMBINEDFBAR1_2D(CAUCHYGREEN1,CAUCHYGREEN0,DCL1,DCL0,DCL)

        CALL MLS_CLASSICALDC2_2D(DFF1(1:NDI,IN),DFF1(1:NDI,JN),D2C1)
        CALL MLS_CLASSICALDC2_2D(DFF0(1:NDI,IN),DFF0(1:NDI,JN),D2C0)

        CALL MLS_COMBINEDFBAR2_2D(CAUCHYGREEN1,CAUCHYGREEN0,DCK1,DCL1,DCK0,DCL0,D2C1,D2C0,D2C)

        CALL MLS_FBAR_2D(DCK,DCL,D2C,STRESS,DS,KERNEL)

        DO ID=1,NDI
          ITEMP=IN*NDI-NDI+ID
          DO JD=1,NDI
            JTEMP=JN*NDI-NDI+JD                 
            EMAT(ITEMP,JTEMP)=EMAT(ITEMP,JTEMP)+VOL*KERNEL(ID,JD)
          END DO
        END DO
      END DO
    END DO
  END DO
!--------------  
!*** ASSEMBLING
!--------------
!--------------------
!*** SENDS TO STORAGE
!--------------------
  CALL STORE(IELEM,NDI*N,LNODS,LTYPS,EFOR(1:NDI*N),EMAT(1:NDI*N,1:NDI*N))
END SUBROUTINE ELM_TRIGRADIENT

!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           15 Jun 23 23:02:58 *
!**************************************************************
! User     : Full professional version
! Notebook : fluid2dsimple
! Evaluation time                 : 10 s    Mode  : Optimal
! Number of formulae              : 230     Method: Automatic
! Subroutine                      : fluid2dsimple size: 4577
! Total size of Mathematica  code : 4577 subexpressions
! Total size of Fortran code      : 11569 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE fluid2dsimple(steady,frozen,stabpress,deriv,dtime,vol,h,rho,mu,f,rno,pnew,acel,vold,vnew,xi,intforce,intstiff)
IMPLICIT NONE
LOGICAL steady,b138
DOUBLE PRECISION v(461),frozen,stabpress,deriv,dtime,vol,h,rho,mu,f(2),rno(3,2),pnew(3),acel(3,2),vold(3,2)&
&,vnew(3,2),xi(2),intforce(9),intstiff(9,9)
v(436)=f(2)*rho
v(435)=f(1)*rho
v(430)=stabpress*vol
v(426)=vold(3,2)*xi(2)
v(425)=vold(2,2)*xi(1)
v(424)=vold(3,1)*xi(2)
v(423)=vold(2,1)*xi(1)
v(422)=pnew(3)*xi(2)
v(421)=pnew(2)*xi(1)
v(416)=1d0/rho
v(414)=(16d0*mu**2)/(h**4*rho**2)
v(413)=vnew(3,2)*xi(2)
v(412)=vnew(2,2)*xi(1)
v(411)=vnew(3,1)*xi(2)
v(410)=vnew(2,1)*xi(1)
v(398)=rno(1,2)-rno(2,2)
v(397)=(-2d0)*mu
v(394)=-rno(1,1)+rno(2,1)
v(393)=1d0/(-(rno(1,2)*rno(2,1))+rno(1,1)*rno(2,2)+rno(3,2)*v(394)+rno(3,1)*v(398))
v(392)=(-1d0)+xi(1)+xi(2)
v(391)=-(deriv*v(392))
v(390)=deriv*xi(2)
v(389)=rho*vol
v(388)=deriv*xi(1)
v(387)=v(389)*xi(1)
v(386)=rho**2
v(385)=1d0/h**2
v(415)=4d0*v(385)
v(384)=1d0-frozen
v(175)=v(384)*xi(1)
v(331)=v(389)*xi(2)
v(176)=v(384)*xi(2)
v(224)=-(v(389)*v(392))
v(174)=-(v(384)*v(392))
v(137)=-(v(393)*v(394))
v(395)=v(137)*vol
v(374)=(v(137)*v(137))
v(371)=v(395)*xi(2)
v(354)=-(v(395)*xi(1))
v(347)=v(392)*v(395)
v(339)=v(137)*v(397)
v(181)=(-0.5d0)*v(137)
v(403)=-(v(181)*vol)
v(136)=-((rno(1,1)-rno(3,1))*v(393))
v(396)=v(136)*vol
v(367)=v(396)*xi(2)
v(314)=(v(136)*v(136))
v(311)=v(396)*xi(1)
v(294)=v(392)*v(396)
v(283)=v(136)*v(397)
v(179)=(-0.5d0)*v(136)
v(134)=-(v(393)*v(398))
v(399)=v(134)*vol
v(377)=v(134)*v(397)
v(373)=(v(134)*v(134))
v(369)=v(399)*xi(2)
v(336)=-(v(399)*xi(1))
v(327)=v(392)*v(399)
v(182)=(-0.5d0)*v(134)
v(400)=v(182)*vol
v(356)=v(339)*v(400)
v(349)=v(283)*v(400)
v(133)=(rno(1,2)-rno(3,2))*v(393)
v(401)=v(133)*vol
v(365)=v(401)*xi(2)
v(313)=(v(133)*v(133))
v(309)=v(401)*xi(1)
v(298)=-(v(133)*v(397))
v(352)=-((v(137)*v(283)+v(182)*v(298))*vol)
v(333)=v(298)*v(403)
v(330)=(v(181)*v(283)+v(134)*v(298))*vol
v(278)=v(392)*v(401)
v(180)=(-0.5d0)*v(133)
v(405)=v(180)*vol
v(296)=v(283)*v(405)
v(132)=v(133)+v(134)
v(402)=-(v(132)*vol)
v(360)=v(402)*xi(2)
v(304)=v(402)*xi(1)
v(261)=(v(132)*v(132))
v(253)=-(v(392)*v(402))
v(234)=v(132)*v(397)
v(323)=v(234)*v(403)
v(274)=-(v(179)*v(234)*vol)
v(178)=v(132)/2d0
v(160)=v(132)*vnew(1,2)-v(133)*vnew(2,2)-v(134)*vnew(3,2)
v(197)=v(160)*v(176)
v(350)=v(197)*v(387)
v(343)=v(197)*v(224)
v(193)=v(160)*v(175)
v(290)=v(193)*v(224)
v(189)=v(160)*v(174)
v(159)=v(132)*vnew(1,1)-v(133)*vnew(2,1)-v(134)*vnew(3,1)
v(135)=v(136)+v(137)
v(404)=-(v(135)*vol)
v(362)=v(404)*xi(2)
v(306)=v(404)*xi(1)
v(262)=(v(135)*v(135))
v(257)=-(v(392)*v(404))
v(223)=-(v(135)*v(397))
v(345)=-((v(137)*v(223)+v(182)*v(234))*vol)
v(342)=v(223)*v(400)
v(320)=(v(181)*v(223)+v(134)*v(234))*vol
v(292)=-((v(136)*v(223)+v(180)*v(234))*vol)
v(289)=v(223)*v(405)
v(271)=(v(179)*v(223)+v(133)*v(234))*vol
v(240)=v(178)*v(223)*vol
v(163)=v(135)*vnew(1,2)-v(136)*vnew(2,2)-v(137)*vnew(3,2)
v(161)=v(135)*vnew(1,1)-v(136)*vnew(2,1)-v(137)*vnew(3,1)
v(188)=v(161)*v(176)
v(334)=v(188)*v(387)
v(324)=v(188)*v(224)
v(186)=v(161)*v(175)
v(275)=v(186)*v(224)
v(184)=v(161)*v(174)
IF(steady) THEN
 v(168)=0d0
 v(169)=0d0
 v(170)=0d0
 v(139)=0d0
 v(171)=0d0
 v(172)=0d0
 v(173)=0d0
 v(140)=0d0
ELSE
 v(409)=acel(3,2)*xi(2)
 v(408)=acel(2,2)*xi(1)
 v(407)=acel(3,1)*xi(2)
 v(406)=acel(2,1)*xi(1)
 v(168)=v(391)
 v(169)=v(388)
 v(170)=v(390)
 v(139)=-(acel(1,1)*v(392))+v(406)+v(407)
 v(171)=v(391)
 v(172)=v(388)
 v(173)=v(390)
 v(140)=-(acel(1,2)*v(392))+v(408)+v(409)
ENDIF
v(143)=v(410)+v(411)-v(392)*vnew(1,1)
v(144)=v(412)+v(413)-v(392)*vnew(1,2)
v(201)=sqrt(0.1d-5+v(143)**2+v(144)**2)
v(204)=v(414)+(v(201)*v(201))*v(415)
v(208)=-((v(201)*v(415)*v(416))/v(204)**0.15d1)
v(418)=v(208)/v(201)
v(420)=-(v(392)*v(418))
v(419)=v(418)*xi(1)
v(417)=v(418)*xi(2)
v(217)=v(144)*v(417)
v(215)=v(143)*v(417)
v(213)=v(144)*v(419)
v(211)=v(143)*v(419)
v(209)=v(144)*v(420)
v(205)=v(143)*v(420)
v(151)=-(pnew(1)*v(392))+v(421)+v(422)
v(152)=v(143)*v(384)+frozen*(v(423)+v(424)-v(392)*vold(1,1))
v(198)=-(v(134)*v(152))
v(194)=-(v(133)*v(152))
v(190)=v(132)*v(152)
v(154)=v(144)*v(384)+frozen*(v(425)+v(426)-v(392)*vold(1,2))
v(199)=-(v(137)*v(154))
v(427)=v(198)+v(199)
v(200)=v(173)+v(163)*v(176)+v(427)
v(195)=-(v(136)*v(154))
v(428)=v(194)+v(195)
v(196)=v(172)+v(163)*v(175)+v(428)
v(191)=v(135)*v(154)
v(429)=v(190)+v(191)
v(192)=v(171)+v(163)*v(174)+v(429)
v(187)=v(170)+v(159)*v(176)+v(427)
v(185)=v(169)+v(159)*v(175)+v(428)
v(183)=v(168)+v(159)*v(174)+v(429)
v(162)=(v(160)+v(161))/2d0
v(164)=v(139)+v(152)*v(159)+v(154)*v(161)
v(254)=pnew(1)*v(132)-pnew(2)*v(133)-pnew(3)*v(134)+rho*(-f(1)+v(164))
v(434)=rho*v(254)
v(165)=v(140)+v(152)*v(160)+v(154)*v(163)
v(255)=pnew(1)*v(135)-pnew(2)*v(136)-pnew(3)*v(137)+rho*(-f(2)+v(165))
v(381)=v(132)*v(254)+v(135)*v(255)
v(380)=-(v(133)*v(254))-v(136)*v(255)
v(379)=-(v(134)*v(254))-v(137)*v(255)
v(363)=v(379)*v(430)
v(307)=v(380)*v(430)
v(259)=v(381)*v(430)
v(166)=v(159)+v(163)
v(437)=v(166)*vol
v(167)=v(416)/sqrt(v(204))
v(433)=v(167)*vol
v(258)=v(167)*v(430)
v(454)=rho*v(258)
v(219)=v(254)*v(389)
v(447)=v(217)*v(219)
v(446)=v(215)*v(219)
v(445)=v(213)*v(219)
v(444)=v(211)*v(219)
v(441)=v(209)*v(219)
v(439)=v(205)*v(219)
v(431)=v(167)*v(219)
v(236)=v(176)*v(431)
v(231)=v(175)*v(431)
v(222)=v(174)*v(431)
v(220)=v(391)+v(429)
v(227)=v(220)*v(433)
v(443)=rho*v(227)
v(225)=v(227)*v(386)
v(440)=v(224)+v(225)
v(239)=v(255)*v(389)
v(453)=v(217)*v(239)
v(452)=v(215)*v(239)
v(451)=v(213)*v(239)
v(450)=v(211)*v(239)
v(449)=v(209)*v(239)
v(448)=v(205)*v(239)
v(432)=v(167)*v(239)
v(250)=v(176)*v(432)
v(246)=v(175)*v(432)
v(242)=v(174)*v(432)
v(266)=-((v(132)*v(133)+v(135)*v(136))*v(258))
v(269)=-((v(132)*v(134)+v(135)*v(137))*v(258))
v(272)=v(388)+v(428)
v(279)=v(272)*v(433)
v(438)=rho*v(279)
v(276)=v(279)*v(386)
v(455)=v(276)+v(387)
v(318)=(v(133)*v(134)+v(136)*v(137))*v(258)
v(321)=v(390)+v(427)
v(328)=v(321)*v(433)
v(442)=rho*v(328)
v(325)=v(328)*v(386)
v(456)=v(325)+v(331)
v(376)=-v(151)-v(159)*v(397)
v(378)=-v(151)-v(163)*v(397)
intforce(1)=v(164)*v(224)+v(227)*v(434)+(v(162)*v(223)+v(132)*v(376)+v(392)*v(435))*vol
intforce(2)=v(165)*v(224)+v(220)*v(432)+(-(v(162)*v(234))+v(135)*v(378)+v(392)*v(436))*vol
intforce(3)=v(258)*v(381)-v(392)*v(437)
intforce(4)=v(164)*v(387)+v(254)*v(438)+vol*(v(162)*v(283)-v(133)*v(376)-v(435)*xi(1))
intforce(5)=v(165)*v(387)+v(255)*v(438)+vol*(-(v(162)*v(298))-v(136)*v(378)-v(436)*xi(1))
intforce(6)=v(258)*v(380)+v(437)*xi(1)
intforce(7)=v(164)*v(331)+v(328)*v(434)+vol*(v(162)*v(339)-v(134)*v(376)-v(435)*xi(2))
intforce(8)=v(165)*v(331)+v(255)*v(442)+vol*(v(162)*v(377)-v(137)*v(378)-v(436)*xi(2))
intforce(9)=v(258)*v(379)+v(437)*xi(2)
intstiff(1,1)=v(132)*v(222)+v(220)*v(439)+v(183)*v(440)+((v(135)*v(223))/2d0-v(261)*v(397))*vol
intstiff(1,2)=v(135)*v(222)+v(240)+v(184)*v(440)+v(220)*v(441)
intstiff(1,3)=v(253)+v(132)*v(443)
intstiff(1,4)=v(132)*v(231)+v(271)+v(185)*v(440)+v(220)*v(444)
intstiff(1,5)=v(186)*v(225)+v(135)*v(231)+v(275)+v(289)+v(220)*v(445)
intstiff(1,6)=v(304)-v(133)*v(443)
intstiff(1,7)=v(132)*v(236)+v(320)+v(187)*v(440)+v(220)*v(446)
intstiff(1,8)=v(188)*v(225)+v(135)*v(236)+v(324)+v(342)+v(220)*v(447)
intstiff(1,9)=v(360)-v(134)*v(443)
intstiff(2,1)=v(240)+v(132)*v(242)+v(189)*v(440)+v(220)*v(448)
intstiff(2,2)=v(135)*v(242)+v(192)*v(440)+v(220)*v(449)+(-(v(178)*v(234))-v(262)*v(397))*vol
intstiff(2,3)=v(257)+v(135)*v(443)
intstiff(2,4)=v(193)*v(225)+v(132)*v(246)+v(274)+v(290)+v(220)*v(450)
intstiff(2,5)=v(135)*v(246)+v(292)+v(196)*v(440)+v(220)*v(451)
intstiff(2,6)=v(306)-v(136)*v(443)
intstiff(2,7)=v(197)*v(225)+v(132)*v(250)+v(323)+v(343)+v(220)*v(452)
intstiff(2,8)=v(135)*v(250)+v(345)+v(200)*v(440)+v(220)*v(453)
intstiff(2,9)=v(362)-v(137)*v(443)
intstiff(3,1)=-v(253)+v(205)*v(259)+(v(132)*v(183)+v(135)*v(189))*v(454)
intstiff(3,2)=-v(257)+v(209)*v(259)+(v(132)*v(184)+v(135)*v(192))*v(454)
intstiff(3,3)=v(258)*(v(261)+v(262))
intstiff(3,4)=v(211)*v(259)+v(278)+(v(132)*v(185)+v(135)*v(193))*v(454)
intstiff(3,5)=v(213)*v(259)+v(294)+(v(132)*v(186)+v(135)*v(196))*v(454)
intstiff(3,6)=v(266)
intstiff(3,7)=v(215)*v(259)+v(327)+(v(132)*v(187)+v(135)*v(197))*v(454)
intstiff(3,8)=v(217)*v(259)+v(347)+(v(132)*v(188)+v(135)*v(200))*v(454)
intstiff(3,9)=v(269)
intstiff(4,1)=-(v(133)*v(222))+v(271)+v(272)*v(439)+v(183)*v(455)
intstiff(4,2)=-(v(136)*v(222))+v(274)+v(275)+v(184)*v(276)+v(272)*v(441)
intstiff(4,3)=-v(278)+v(132)*v(438)
intstiff(4,4)=-(v(133)*v(231))+v(272)*v(444)+v(185)*v(455)+(v(179)*v(283)-v(313)*v(397))*vol
intstiff(4,5)=-(v(136)*v(231))+v(296)+v(272)*v(445)+v(186)*v(455)
intstiff(4,6)=v(309)-v(133)*v(438)
intstiff(4,7)=-(v(133)*v(236))+v(330)+v(272)*v(446)+v(187)*v(455)
intstiff(4,8)=-(v(136)*v(236))+v(188)*v(276)+v(334)+v(349)+v(272)*v(447)
intstiff(4,9)=v(365)-v(134)*v(438)
intstiff(5,1)=-(v(133)*v(242))+v(189)*v(276)+v(289)+v(290)+v(272)*v(448)
intstiff(5,2)=-(v(136)*v(242))+v(292)+v(272)*v(449)+v(192)*v(455)
intstiff(5,3)=-v(294)+v(135)*v(438)
intstiff(5,4)=-(v(133)*v(246))+v(296)+v(272)*v(450)+v(193)*v(455)
intstiff(5,5)=-(v(136)*v(246))+v(272)*v(451)+v(196)*v(455)+(-(v(180)*v(298))-v(314)*v(397))*vol
intstiff(5,6)=v(311)-v(136)*v(438)
intstiff(5,7)=-(v(133)*v(250))+v(197)*v(276)+v(333)+v(350)+v(272)*v(452)
intstiff(5,8)=-(v(136)*v(250))+v(352)+v(272)*v(453)+v(200)*v(455)
intstiff(5,9)=v(367)-v(137)*v(438)
intstiff(6,1)=-v(304)+v(205)*v(307)+(-(v(133)*v(183))-v(136)*v(189))*v(454)
intstiff(6,2)=-v(306)+v(209)*v(307)+(-(v(133)*v(184))-v(136)*v(192))*v(454)
intstiff(6,3)=v(266)
intstiff(6,4)=v(211)*v(307)-v(309)+(-(v(133)*v(185))-v(136)*v(193))*v(454)
intstiff(6,5)=v(213)*v(307)-v(311)+(-(v(133)*v(186))-v(136)*v(196))*v(454)
intstiff(6,6)=v(258)*(v(313)+v(314))
intstiff(6,7)=v(215)*v(307)+v(336)+(-(v(133)*v(187))-v(136)*v(197))*v(454)
intstiff(6,8)=v(217)*v(307)+v(354)+(-(v(133)*v(188))-v(136)*v(200))*v(454)
intstiff(6,9)=v(318)
intstiff(7,1)=-(v(134)*v(222))+v(320)+v(321)*v(439)+v(183)*v(456)
intstiff(7,2)=-(v(137)*v(222))+v(323)+v(324)+v(184)*v(325)+v(321)*v(441)
intstiff(7,3)=-v(327)+v(132)*v(442)
intstiff(7,4)=-(v(134)*v(231))+v(330)+v(321)*v(444)+v(185)*v(456)
intstiff(7,5)=-(v(137)*v(231))+v(186)*v(325)+v(333)+v(334)+v(321)*v(445)
intstiff(7,6)=-v(336)-v(133)*v(442)
intstiff(7,7)=-(v(134)*v(236))+v(321)*v(446)+v(187)*v(456)+(v(181)*v(339)-v(373)*v(397))*vol
intstiff(7,8)=-(v(137)*v(236))+v(356)+v(321)*v(447)+v(188)*v(456)
intstiff(7,9)=v(369)-v(134)*v(442)
intstiff(8,1)=-(v(134)*v(242))+v(189)*v(325)+v(342)+v(343)+v(321)*v(448)
intstiff(8,2)=-(v(137)*v(242))+v(345)+v(321)*v(449)+v(192)*v(456)
intstiff(8,3)=-v(347)+v(135)*v(442)
intstiff(8,4)=-(v(134)*v(246))+v(193)*v(325)+v(349)+v(350)+v(321)*v(450)
intstiff(8,5)=-(v(137)*v(246))+v(352)+v(321)*v(451)+v(196)*v(456)
intstiff(8,6)=-v(354)-v(136)*v(442)
intstiff(8,7)=-(v(134)*v(250))+v(356)+v(321)*v(452)+v(197)*v(456)
intstiff(8,8)=-(v(137)*v(250))+v(321)*v(453)+v(200)*v(456)+(v(182)*v(377)-v(374)*v(397))*vol
intstiff(8,9)=v(371)-v(137)*v(442)
intstiff(9,1)=-v(360)+v(205)*v(363)+(-(v(134)*v(183))-v(137)*v(189))*v(454)
intstiff(9,2)=-v(362)+v(209)*v(363)+(-(v(134)*v(184))-v(137)*v(192))*v(454)
intstiff(9,3)=v(269)
intstiff(9,4)=v(211)*v(363)-v(365)+(-(v(134)*v(185))-v(137)*v(193))*v(454)
intstiff(9,5)=v(213)*v(363)-v(367)+(-(v(134)*v(186))-v(137)*v(196))*v(454)
intstiff(9,6)=v(318)
intstiff(9,7)=v(215)*v(363)-v(369)+(-(v(134)*v(187))-v(137)*v(197))*v(454)
intstiff(9,8)=v(217)*v(363)-v(371)+(-(v(134)*v(188))-v(137)*v(200))*v(454)
intstiff(9,9)=v(258)*(v(373)+v(374))
END SUBROUTINE fluid2dsimple

!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           24 May 23 19:02:56 *
!**************************************************************
! User     : Full professional version
! Notebook : fluid2dnondim
! Evaluation time                 : 10 s    Mode  : Optimal
! Number of formulae              : 210     Method: Automatic
! Subroutine                      : fluid2dnondim size: 4595
! Total size of Mathematica  code : 4595 subexpressions
! Total size of Fortran code      : 11504 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE fluid2dnondim(steady,frozen,stabpress,uinf,deriv,dtime,vol,h,rho,mu,f,rno,pnew,acel,vold,vnew,xi,intforce&
    &,intstiff)
  IMPLICIT NONE
  LOGICAL steady,b139
  DOUBLE PRECISION v(439),frozen,stabpress,uinf,deriv,dtime,vol,h,rho,mu,f(2),rno(3,2),pnew(3),acel(3,2),vold(3&
      &,2),vnew(3,2),xi(2),intforce(9),intstiff(9,9)
  v(420)=-(stabpress*vol)
  v(417)=1d0/uinf
  v(411)=1d0/rho
  v(410)=(4d0*mu**2)/(h**4*rho**2)
  v(409)=1d0/dtime**2
  v(402)=vold(3,2)*xi(2)
  v(401)=vold(2,2)*xi(1)
  v(400)=vnew(3,2)*xi(2)
  v(399)=vnew(2,2)*xi(1)
  v(398)=vold(3,1)*xi(2)
  v(397)=vold(2,1)*xi(1)
  v(396)=vnew(3,1)*xi(2)
  v(395)=vnew(2,1)*xi(1)
  v(394)=pnew(3)*xi(2)
  v(393)=pnew(2)*xi(1)
  v(384)=rno(1,2)-rno(2,2)
  v(381)=-rno(1,1)+rno(2,1)
  v(380)=1d0/(-(rno(1,2)*rno(2,1))+rno(1,1)*rno(2,2)+rno(3,2)*v(381)+rno(3,1)*v(384))
  v(379)=1d0-xi(1)-xi(2)
  v(405)=v(379)*vol
  v(378)=deriv*xi(2)
  v(377)=deriv*xi(1)
  v(376)=1d0/h**2
  v(375)=1d0-frozen
  v(175)=v(375)*xi(1)
  v(176)=v(375)*xi(2)
  v(226)=deriv*v(379)
  v(174)=v(375)*v(379)
  v(138)=-(v(380)*v(381))
  v(382)=v(138)*vol
  v(367)=v(382)*xi(2)
  v(350)=-(v(382)*xi(1))
  v(343)=-(v(379)*v(382))
  v(182)=-(v(138)*v(375))
  v(187)=v(182)/2d0
  v(137)=-((rno(1,1)-rno(3,1))*v(380))
  v(383)=v(137)*vol
  v(363)=v(383)*xi(2)
  v(310)=v(383)*xi(1)
  v(294)=-(v(379)*v(383))
  v(181)=-(v(137)*v(375))
  v(185)=v(181)/2d0
  v(135)=-(v(380)*v(384))
  v(385)=v(135)*vol
  v(365)=v(385)*xi(2)
  v(332)=-(v(385)*xi(1))
  v(325)=-(v(379)*v(385))
  v(179)=-(v(135)*v(375))
  v(188)=v(179)/2d0
  v(134)=(rno(1,2)-rno(3,2))*v(380)
  v(386)=v(134)*vol
  v(361)=v(386)*xi(2)
  v(308)=v(386)*xi(1)
  v(279)=-(v(379)*v(386))
  v(178)=-(v(134)*v(375))
  v(186)=v(178)/2d0
  v(133)=v(134)+v(135)
  v(387)=-(v(133)*vol)
  v(356)=v(387)*xi(2)
  v(303)=v(387)*xi(1)
  v(257)=v(379)*v(387)
  v(177)=v(133)*v(375)
  v(184)=v(177)/2d0
  v(165)=v(133)*vnew(1,1)-v(134)*vnew(2,1)-v(135)*vnew(3,1)
  v(136)=v(137)+v(138)
  v(430)=v(136)*v(176)
  v(428)=v(136)*v(175)
  v(388)=-(v(136)*vol)
  v(358)=v(388)*xi(2)
  v(305)=v(388)*xi(1)
  v(259)=v(379)*v(388)
  v(180)=v(136)*v(375)
  v(425)=v(136)*v(180)
  v(164)=v(136)*vnew(1,2)-v(137)*vnew(2,2)-v(138)*vnew(3,2)
  IF(steady) THEN
    v(168)=0d0
    v(169)=0d0
    v(170)=0d0
    v(140)=0d0
    v(171)=0d0
    v(172)=0d0
    v(173)=0d0
    v(141)=0d0
  ELSE
    v(392)=acel(3,2)*xi(2)
    v(391)=acel(2,2)*xi(1)
    v(390)=acel(3,1)*xi(2)
    v(389)=acel(2,1)*xi(1)
    v(168)=v(226)
    v(169)=v(377)
    v(170)=v(378)
    v(140)=acel(1,1)*v(379)+v(389)+v(390)
    v(171)=v(226)
    v(172)=v(377)
    v(173)=v(378)
    v(141)=acel(1,2)*v(379)+v(391)+v(392)
  ENDIF
  v(152)=pnew(1)*v(379)+v(393)+v(394)
  v(153)=v(375)*(v(395)+v(396)+v(379)*vnew(1,1))+frozen*(v(397)+v(398)+v(379)*vold(1,1))
  v(204)=v(153)*v(179)
  v(200)=v(153)*v(178)
  v(196)=v(153)*v(177)
  v(155)=v(375)*(v(399)+v(400)+v(379)*vnew(1,2))+frozen*(v(401)+v(402)+v(379)*vold(1,2))
  v(207)=sqrt(0.1d-7+v(153)**2+v(155)**2)
  v(205)=v(155)*v(182)
  v(406)=v(204)+v(205)
  v(201)=v(155)*v(181)
  v(407)=v(200)+v(201)
  v(197)=v(155)*v(180)
  v(408)=v(196)+v(197)
  v(156)=v(165)*v(375)+frozen*(v(133)*vold(1,1)-v(134)*vold(2,1)-v(135)*vold(3,1))
  v(193)=v(170)+v(156)*v(176)+v(406)
  v(191)=v(169)+v(156)*v(175)+v(407)
  v(189)=v(168)+v(156)*v(174)+v(408)
  v(157)=v(375)*(v(136)*vnew(1,1)-v(137)*vnew(2,1)-v(138)*vnew(3,1))+frozen*(v(136)*vold(1,1)-v(137)*vold(2,1)-v(138&
      &)*vold(3,1))
  v(194)=v(157)*v(176)
  v(403)=v(194)*vol
  v(330)=v(403)*xi(1)
  v(321)=v(379)*v(403)
  v(192)=v(157)*v(175)
  v(275)=v(192)*v(405)
  v(190)=v(157)*v(174)
  v(158)=v(375)*(v(133)*vnew(1,2)-v(134)*vnew(2,2)-v(135)*vnew(3,2))+frozen*(v(133)*vold(1,2)-v(134)*vold(2,2)-v(135&
      &)*vold(3,2))
  v(203)=v(158)*v(176)
  v(404)=v(203)*vol
  v(346)=v(404)*xi(1)
  v(338)=v(379)*v(404)
  v(199)=v(158)*v(175)
  v(289)=v(199)*v(405)
  v(195)=v(158)*v(174)
  v(159)=v(164)*v(375)+frozen*(v(136)*vold(1,2)-v(137)*vold(2,2)-v(138)*vold(3,2))
  v(206)=v(173)+v(159)*v(176)+v(406)
  v(202)=v(172)+v(159)*v(175)+v(407)
  v(198)=v(171)+v(159)*v(174)+v(408)
  v(210)=4d0*((v(207)*v(207))*v(376)+v(409)+v(410))
  v(214)=((-4d0)*v(207)*v(376)*v(411))/v(210)**0.15d1
  v(413)=v(214)/v(207)
  v(415)=v(174)*v(413)
  v(414)=v(175)*v(413)
  v(412)=v(176)*v(413)
  v(223)=v(155)*v(412)
  v(221)=v(153)*v(412)
  v(219)=v(155)*v(414)
  v(217)=v(153)*v(414)
  v(215)=v(155)*v(415)
  v(211)=v(153)*v(415)
  v(161)=(v(157)+v(158))/2d0
  v(162)=v(140)+v(153)*v(156)+v(155)*v(157)
  v(163)=v(141)+v(153)*v(158)+v(155)*v(159)
  v(166)=v(164)+v(165)
  v(424)=v(166)*vol
  v(167)=v(411)/sqrt(v(210))
  v(416)=v(167)*vol
  v(260)=stabpress*v(416)
  v(224)=pnew(1)*v(133)-pnew(2)*v(134)-pnew(3)*v(135)+v(162)
  v(234)=v(224)*v(416)
  v(429)=v(176)*v(234)
  v(427)=v(175)*v(234)
  v(229)=v(174)*v(234)
  v(225)=2d0*mu*v(411)*v(417)
  v(423)=v(161)*v(225)
  v(418)=v(225)*vol
  v(352)=-(v(188)*v(225)*v(382))
  v(348)=(-(v(137)*v(182))-v(134)*v(188))*v(418)
  v(340)=(v(136)*v(182)+v(133)*v(188))*v(418)
  v(329)=-(v(134)*v(187)*v(418))
  v(327)=(-(v(134)*v(179))-v(137)*v(187))*v(418)
  v(316)=(v(133)*v(179)+v(136)*v(187))*v(418)
  v(291)=(v(136)*v(181)+v(133)*v(186))*v(418)
  v(285)=-(v(137)*v(418))
  v(345)=v(188)*v(285)
  v(296)=v(186)*v(285)
  v(270)=(v(133)*v(178)+v(136)*v(185))*v(418)
  v(253)=v(133)*v(418)
  v(320)=v(187)*v(253)
  v(274)=v(185)*v(253)
  v(236)=v(136)*v(418)
  v(337)=v(188)*v(236)
  v(288)=v(186)*v(236)
  v(243)=v(184)*v(236)
  v(227)=v(133)*v(153)+v(136)*v(155)+v(226)
  v(419)=v(227)*vol
  v(231)=v(224)*v(419)
  v(230)=v(167)*v(419)
  v(426)=v(230)+v(405)
  v(242)=pnew(1)*v(136)-pnew(2)*v(137)-pnew(3)*v(138)+v(163)
  v(359)=(v(135)*v(224)+v(138)*v(242))*v(420)
  v(306)=(v(134)*v(224)+v(137)*v(242))*v(420)
  v(261)=-((v(133)*v(224)+v(136)*v(242))*v(420))
  v(249)=v(242)*v(416)
  v(432)=v(176)*v(249)
  v(431)=v(175)*v(249)
  v(246)=v(242)*v(419)
  v(245)=v(174)*v(249)
  v(266)=-((v(133)*v(134)+v(136)*v(137))*v(260))
  v(269)=-((v(133)*v(135)+v(136)*v(138))*v(260))
  v(272)=-(v(134)*v(153))-v(137)*v(155)+v(377)
  v(421)=v(272)*vol
  v(292)=v(242)*v(421)
  v(277)=v(224)*v(421)
  v(276)=v(167)*v(421)
  v(433)=v(276)+vol*xi(1)
  v(315)=(v(134)*v(135)+v(137)*v(138))*v(260)
  v(318)=-(v(135)*v(153))-v(138)*v(155)+v(378)
  v(422)=v(318)*vol
  v(341)=v(242)*v(422)
  v(323)=v(224)*v(422)
  v(322)=v(167)*v(422)
  v(434)=v(322)+vol*xi(2)
  v(370)=-v(152)+v(156)*v(225)
  v(372)=-v(152)+v(159)*v(225)
  intforce(1)=v(224)*v(230)+(v(133)*v(370)+v(162)*v(379)+v(136)*v(423))*vol
  intforce(2)=v(167)*v(246)+(v(136)*v(372)+v(163)*v(379)+v(133)*v(423))*vol
  intforce(3)=v(167)*v(261)+v(379)*v(424)
  intforce(4)=v(224)*v(276)+vol*(-(v(134)*v(370))-v(137)*v(423)+v(162)*xi(1))
  intforce(5)=v(242)*v(276)+vol*(-(v(137)*v(372))-v(134)*v(423)+v(163)*xi(1))
  intforce(6)=v(167)*v(306)+v(424)*xi(1)
  intforce(7)=v(224)*v(322)+vol*(-(v(135)*v(370))-v(138)*v(423)+v(162)*xi(2))
  intforce(8)=v(242)*v(322)+vol*(-(v(138)*v(372))-v(135)*v(423)+v(163)*xi(2))
  intforce(9)=v(167)*v(359)+v(424)*xi(2)
  intstiff(1,1)=v(133)*v(229)+v(211)*v(231)+v(418)*(v(133)*v(177)+v(425)/2d0)+v(189)*v(426)
  intstiff(1,2)=v(136)*v(229)+v(215)*v(231)+v(243)+v(190)*v(426)
  intstiff(1,3)=v(133)*v(230)+v(257)
  intstiff(1,4)=v(217)*v(231)+v(270)+v(191)*v(426)+v(133)*v(427)
  intstiff(1,5)=v(192)*v(230)+v(219)*v(231)+v(275)+v(288)+v(234)*v(428)
  intstiff(1,6)=-(v(134)*v(230))+v(303)
  intstiff(1,7)=v(221)*v(231)+v(316)+v(193)*v(426)+v(133)*v(429)
  intstiff(1,8)=v(194)*v(230)+v(223)*v(231)+v(321)+v(337)+v(234)*v(430)
  intstiff(1,9)=-(v(135)*v(230))+v(356)
  intstiff(2,1)=v(243)+v(133)*v(245)+v(211)*v(246)+v(195)*v(426)
  intstiff(2,2)=v(136)*v(245)+v(215)*v(246)+v(418)*(v(133)*v(184)+v(425))+v(198)*v(426)
  intstiff(2,3)=v(136)*v(230)+v(259)
  intstiff(2,4)=v(199)*v(230)+v(217)*v(246)+v(274)+v(289)+v(133)*v(431)
  intstiff(2,5)=v(219)*v(246)+v(291)+v(202)*v(426)+v(249)*v(428)
  intstiff(2,6)=-(v(137)*v(230))+v(305)
  intstiff(2,7)=v(203)*v(230)+v(221)*v(246)+v(320)+v(338)+v(133)*v(432)
  intstiff(2,8)=v(223)*v(246)+v(340)+v(206)*v(426)+v(249)*v(430)
  intstiff(2,9)=-(v(138)*v(230))+v(358)
  intstiff(3,1)=-v(257)+(v(133)*v(189)+v(136)*v(195))*v(260)+v(211)*v(261)
  intstiff(3,2)=-v(259)+(v(133)*v(190)+v(136)*v(198))*v(260)+v(215)*v(261)
  intstiff(3,3)=((v(133)*v(133))+(v(136)*v(136)))*v(260)
  intstiff(3,4)=(v(133)*v(191)+v(136)*v(199))*v(260)+v(217)*v(261)+v(279)
  intstiff(3,5)=(v(133)*v(192)+v(136)*v(202))*v(260)+v(219)*v(261)+v(294)
  intstiff(3,6)=v(266)
  intstiff(3,7)=(v(133)*v(193)+v(136)*v(203))*v(260)+v(221)*v(261)+v(325)
  intstiff(3,8)=(v(133)*v(194)+v(136)*v(206))*v(260)+v(223)*v(261)+v(343)
  intstiff(3,9)=v(269)
  intstiff(4,1)=-(v(134)*v(229))+v(270)+v(211)*v(277)+v(189)*v(433)
  intstiff(4,2)=-(v(137)*v(229))+v(274)+v(275)+v(190)*v(276)+v(215)*v(277)
  intstiff(4,3)=v(133)*v(276)-v(279)
  intstiff(4,4)=v(217)*v(277)+(-(v(134)*v(178))-v(137)*v(185))*v(418)-v(134)*v(427)+v(191)*v(433)
  intstiff(4,5)=v(219)*v(277)+v(296)-v(137)*v(427)+v(192)*v(433)
  intstiff(4,6)=-(v(134)*v(276))+v(308)
  intstiff(4,7)=v(221)*v(277)+v(327)-v(134)*v(429)+v(193)*v(433)
  intstiff(4,8)=v(194)*v(276)+v(223)*v(277)+v(330)+v(345)-v(137)*v(429)
  intstiff(4,9)=-(v(135)*v(276))+v(361)
  intstiff(5,1)=-(v(134)*v(245))+v(195)*v(276)+v(288)+v(289)+v(211)*v(292)
  intstiff(5,2)=-(v(137)*v(245))+v(291)+v(215)*v(292)+v(198)*v(433)
  intstiff(5,3)=v(136)*v(276)-v(294)
  intstiff(5,4)=v(217)*v(292)+v(296)-v(134)*v(431)+v(199)*v(433)
  intstiff(5,5)=v(219)*v(292)+(-(v(137)*v(181))-v(134)*v(186))*v(418)-v(137)*v(431)+v(202)*v(433)
  intstiff(5,6)=-(v(137)*v(276))+v(310)
  intstiff(5,7)=v(203)*v(276)+v(221)*v(292)+v(329)+v(346)-v(134)*v(432)
  intstiff(5,8)=v(223)*v(292)+v(348)-v(137)*v(432)+v(206)*v(433)
  intstiff(5,9)=-(v(138)*v(276))+v(363)
  intstiff(6,1)=(-(v(134)*v(189))-v(137)*v(195))*v(260)-v(303)+v(211)*v(306)
  intstiff(6,2)=(-(v(134)*v(190))-v(137)*v(198))*v(260)-v(305)+v(215)*v(306)
  intstiff(6,3)=v(266)
  intstiff(6,4)=(-(v(134)*v(191))-v(137)*v(199))*v(260)+v(217)*v(306)-v(308)
  intstiff(6,5)=(-(v(134)*v(192))-v(137)*v(202))*v(260)+v(219)*v(306)-v(310)
  intstiff(6,6)=((v(134)*v(134))+(v(137)*v(137)))*v(260)
  intstiff(6,7)=(-(v(134)*v(193))-v(137)*v(203))*v(260)+v(221)*v(306)+v(332)
  intstiff(6,8)=(-(v(134)*v(194))-v(137)*v(206))*v(260)+v(223)*v(306)+v(350)
  intstiff(6,9)=v(315)
  intstiff(7,1)=-(v(135)*v(229))+v(316)+v(211)*v(323)+v(189)*v(434)
  intstiff(7,2)=-(v(138)*v(229))+v(320)+v(321)+v(190)*v(322)+v(215)*v(323)
  intstiff(7,3)=v(133)*v(322)-v(325)
  intstiff(7,4)=v(217)*v(323)+v(327)-v(135)*v(427)+v(191)*v(434)
  intstiff(7,5)=v(192)*v(322)+v(219)*v(323)+v(329)+v(330)-v(138)*v(427)
  intstiff(7,6)=-(v(134)*v(322))-v(332)
  intstiff(7,7)=v(221)*v(323)+(-(v(135)*v(179))-v(138)*v(187))*v(418)-v(135)*v(429)+v(193)*v(434)
  intstiff(7,8)=v(223)*v(323)+v(352)-v(138)*v(429)+v(194)*v(434)
  intstiff(7,9)=-(v(135)*v(322))+v(365)
  intstiff(8,1)=-(v(135)*v(245))+v(195)*v(322)+v(337)+v(338)+v(211)*v(341)
  intstiff(8,2)=-(v(138)*v(245))+v(340)+v(215)*v(341)+v(198)*v(434)
  intstiff(8,3)=v(136)*v(322)-v(343)
  intstiff(8,4)=v(199)*v(322)+v(217)*v(341)+v(345)+v(346)-v(135)*v(431)
  intstiff(8,5)=v(219)*v(341)+v(348)-v(138)*v(431)+v(202)*v(434)
  intstiff(8,6)=-(v(137)*v(322))-v(350)
  intstiff(8,7)=v(221)*v(341)+v(352)-v(135)*v(432)+v(203)*v(434)
  intstiff(8,8)=v(223)*v(341)+(-(v(138)*v(182))-v(135)*v(188))*v(418)-v(138)*v(432)+v(206)*v(434)
  intstiff(8,9)=-(v(138)*v(322))+v(367)
  intstiff(9,1)=(-(v(135)*v(189))-v(138)*v(195))*v(260)-v(356)+v(211)*v(359)
  intstiff(9,2)=(-(v(135)*v(190))-v(138)*v(198))*v(260)-v(358)+v(215)*v(359)
  intstiff(9,3)=v(269)
  intstiff(9,4)=(-(v(135)*v(191))-v(138)*v(199))*v(260)+v(217)*v(359)-v(361)
  intstiff(9,5)=(-(v(135)*v(192))-v(138)*v(202))*v(260)+v(219)*v(359)-v(363)
  intstiff(9,6)=v(315)
  intstiff(9,7)=(-(v(135)*v(193))-v(138)*v(203))*v(260)+v(221)*v(359)-v(365)
  intstiff(9,8)=(-(v(135)*v(194))-v(138)*v(206))*v(260)+v(223)*v(359)-v(367)
  intstiff(9,9)=((v(135)*v(135))+(v(138)*v(138)))*v(260)
END SUBROUTINE fluid2dnondim

!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           14 Apr 23 18:03:38 *
!**************************************************************
! User     : Full professional version
! Notebook : fluid2dinviscid
! Evaluation time                 : 25 s    Mode  : Optimal
! Number of formulae              : 320     Method: Automatic
! Subroutine                      : fluid2dinviscid size: 5252
! Total size of Mathematica  code : 5252 subexpressions
! Total size of Fortran code      : 14598 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE fluid2dinviscid(steady,deriv,dtime,vol,h,rho,mu,f,rno,pold,pnew,acel,vold,vnew,xi,lagrangeold,lagrange&
    &,intforce,intstiff)
  IMPLICIT NONE
  LOGICAL steady,b211,b243
  DOUBLE PRECISION v(581),deriv,dtime,vol,h,rho,mu,f(2),rno(3,2),pold(3),pnew(3),acel(3,2),vold(3,2),vnew(3,2)&
      &,xi(2),lagrangeold(3),lagrange(3),intforce(12),intstiff(12,12)
  v(563)=vol*xi(2)
  v(560)=lagrange(3)*xi(2)
  v(559)=lagrange(2)*xi(1)
  v(555)=vnew(3,2)*xi(2)
  v(554)=vnew(2,2)*xi(1)
  v(553)=vnew(3,1)*xi(2)
  v(552)=vnew(2,1)*xi(1)
  v(543)=(-2d0)*vol
  v(542)=rno(1,2)-rno(2,2)
  v(541)=-(rho*vol)
  v(540)=-rno(1,1)+rno(2,1)
  v(539)=1d0/(-(rno(1,2)*rno(2,1))+rno(1,1)*rno(2,2)+rno(3,2)*v(540)+rno(3,1)*v(542))
  v(538)=1d0-xi(1)-xi(2)
  v(537)=vol*xi(1)
  v(270)=v(538)*vol
  v(210)=-(v(539)*v(540))
  v(329)=v(210)*v(541)
  v(209)=-((rno(1,1)-rno(3,1))*v(539))
  v(326)=v(209)*v(541)
  v(317)=v(209)*v(543)
  v(207)=-(v(539)*v(542))
  v(338)=v(207)*v(541)
  v(206)=(rno(1,2)-rno(3,2))*v(539)
  v(335)=v(206)*v(541)
  v(290)=v(206)*v(543)
  v(205)=v(206)+v(207)
  v(332)=-(v(205)*v(541))
  v(287)=-(v(205)*v(543))
  v(239)=v(205)*vnew(1,2)-v(206)*vnew(2,2)-v(207)*vnew(3,2)
  v(544)=rho*v(239)
  v(307)=v(544)*xi(2)
  v(327)=-(v(307)*v(541))
  v(318)=-(v(307)*v(543))
  v(301)=v(544)*xi(1)
  v(324)=-(v(301)*v(541))
  v(315)=-(v(301)*v(543))
  v(295)=v(538)*v(544)
  v(321)=-(v(295)*v(541))
  v(312)=-(v(295)*v(543))
  v(225)=v(205)*vnew(1,1)-v(206)*vnew(2,1)-v(207)*vnew(3,1)
  v(367)=v(239)*v(329)+v(225)*v(338)
  v(364)=v(239)*v(326)+v(225)*v(335)
  v(208)=v(209)+v(210)
  v(323)=-(v(208)*v(541))
  v(361)=v(239)*v(323)+v(225)*v(332)
  v(314)=-(v(208)*v(543))
  v(237)=v(208)*vnew(1,1)-v(209)*vnew(2,1)-v(210)*vnew(3,1)
  v(545)=rho*v(237)
  v(284)=v(545)*xi(2)
  v(337)=-(v(284)*v(541))
  v(292)=-(v(284)*v(543))
  v(280)=v(545)*xi(1)
  v(334)=-(v(280)*v(541))
  v(289)=-(v(280)*v(543))
  v(276)=v(538)*v(545)
  v(331)=-(v(276)*v(541))
  v(286)=-(v(276)*v(543))
  v(224)=v(208)*vnew(1,2)-v(209)*vnew(2,2)-v(210)*vnew(3,2)
  v(358)=v(224)*v(329)+v(237)*v(338)
  v(355)=v(224)*v(326)+v(237)*v(335)
  v(352)=v(224)*v(323)+v(237)*v(332)
  IF(steady) THEN
    v(264)=0d0
    v(265)=0d0
    v(266)=0d0
    v(212)=0d0
    v(267)=0d0
    v(268)=0d0
    v(269)=0d0
    v(213)=0d0
  ELSE
    v(551)=acel(3,2)*xi(2)
    v(550)=acel(2,2)*xi(1)
    v(549)=acel(3,1)*xi(2)
    v(548)=acel(2,1)*xi(1)
    v(547)=deriv*xi(2)
    v(546)=deriv*xi(1)
    v(264)=deriv*v(538)
    v(265)=v(546)
    v(266)=v(547)
    v(212)=acel(1,1)*v(538)+v(548)+v(549)
    v(267)=v(264)
    v(268)=v(265)
    v(269)=v(266)
    v(213)=acel(1,2)*v(538)+v(550)+v(551)
  ENDIF
  v(216)=v(552)+v(553)+v(538)*vnew(1,1)
  v(572)=v(216)*v(321)
  v(378)=v(216)*v(338)
  v(524)=v(205)*v(378)
  v(377)=v(216)*v(337)
  v(374)=v(216)*v(335)
  v(528)=-(v(207)*v(374))
  v(492)=v(205)*v(374)
  v(373)=v(216)*v(334)
  v(369)=v(216)*v(331)
  v(308)=-(v(207)*v(216))
  v(302)=-(v(206)*v(216))
  v(296)=v(205)*v(216)
  v(217)=v(554)+v(555)+v(538)*vnew(1,2)
  v(349)=v(217)*v(329)
  v(526)=v(208)*v(349)
  v(346)=v(217)*v(327)
  v(345)=v(217)*v(326)
  v(530)=-(v(210)*v(345))
  v(494)=v(208)*v(345)
  v(342)=v(217)*v(324)
  v(339)=v(217)*v(321)
  v(309)=-(v(210)*v(217))
  v(556)=v(308)+v(309)
  v(311)=rho*(v(269)+v(556)+v(224)*xi(2))
  v(328)=-(v(311)*v(541))
  v(319)=-(v(311)*v(543))
  v(303)=-(v(209)*v(217))
  v(557)=v(302)+v(303)
  v(305)=rho*(v(268)+v(557)+v(224)*xi(1))
  v(325)=-(v(305)*v(541))
  v(316)=-(v(305)*v(543))
  v(297)=v(208)*v(217)
  v(558)=v(296)+v(297)
  v(299)=rho*(v(267)+v(224)*v(538)+v(558))
  v(322)=-(v(299)*v(541))
  v(313)=-(v(299)*v(543))
  v(282)=rho*(v(266)+v(556)+v(225)*xi(2))
  v(336)=-(v(282)*v(541))
  v(291)=-(v(282)*v(543))
  v(278)=rho*(v(265)+v(557)+v(225)*xi(1))
  v(333)=-(v(278)*v(541))
  v(288)=-(v(278)*v(543))
  v(274)=rho*(v(264)+v(225)*v(538)+v(558))
  v(330)=-(v(274)*v(541))
  v(285)=-(v(274)*v(543))
  v(241)=(lagrange(1)*v(538)+v(559)+v(560))*vol
  v(233)=pnew(1)*v(205)-pnew(2)*v(206)-pnew(3)*v(207)+rho*(-f(1)+v(212)+v(216)*v(225)+v(217)*v(237))
  v(256)=-(v(233)*v(543))
  v(231)=pnew(1)*v(208)-pnew(2)*v(209)-pnew(3)*v(210)+rho*(-f(2)+v(213)+v(217)*v(224)+v(216)*v(239))
  v(257)=-(v(231)*v(543))
  v(226)=v(224)+v(225)
  v(232)=-(v(231)*v(541))
  v(569)=v(205)*v(232)
  v(568)=-(v(206)*v(232))
  v(567)=-(v(207)*v(232))
  v(561)=v(232)*v(538)
  v(576)=-v(561)-v(572)
  v(366)=v(239)*v(328)+v(225)*v(337)+v(567)
  v(363)=v(239)*v(325)+v(225)*v(334)+v(568)
  v(360)=v(239)*v(322)+v(225)*v(331)+v(569)
  v(357)=-(v(210)*v(232))+v(224)*v(328)+v(237)*v(337)
  v(354)=-(v(209)*v(232))+v(224)*v(325)+v(237)*v(334)
  v(351)=v(208)*v(232)+v(224)*v(322)+v(237)*v(331)
  v(347)=v(232)*xi(2)
  v(574)=v(216)*v(327)+v(347)
  v(348)=v(217)*v(328)+v(347)
  v(343)=v(232)*xi(1)
  v(573)=v(216)*v(324)+v(343)
  v(344)=v(217)*v(325)+v(343)
  v(340)=v(217)*v(322)+v(561)
  v(235)=-(v(233)*v(541))
  v(566)=v(208)*v(235)
  v(565)=-(v(209)*v(235))
  v(564)=-(v(210)*v(235))
  v(562)=v(235)*v(538)
  v(575)=-(v(217)*v(331))-v(562)
  v(375)=v(235)*xi(2)
  v(571)=v(217)*v(337)+v(375)
  v(376)=v(216)*v(336)+v(375)
  v(371)=v(235)*xi(1)
  v(570)=v(217)*v(334)+v(371)
  v(372)=v(216)*v(333)+v(371)
  v(368)=v(216)*v(330)+v(562)
  v(365)=-(v(207)*v(235))+v(239)*v(327)+v(225)*v(336)
  v(362)=-(v(206)*v(235))+v(239)*v(324)+v(225)*v(333)
  v(359)=v(205)*v(235)+v(239)*v(321)+v(225)*v(330)
  v(356)=v(224)*v(327)+v(237)*v(336)+v(564)
  v(353)=v(224)*v(324)+v(237)*v(333)+v(565)
  v(350)=v(224)*v(321)+v(237)*v(330)+v(566)
  v(236)=v(217)*v(232)+v(241)
  v(238)=v(224)*v(232)+v(235)*v(237)
  v(240)=v(225)*v(235)+v(232)*v(239)
  v(242)=v(216)*v(235)+v(241)
  b243=steady
  IF(b243) THEN
    v(379)=0d0
    v(380)=0d0
    v(381)=0d0
    v(382)=0d0
    v(383)=0d0
    v(384)=0d0
    v(385)=0d0
    v(386)=0d0
    v(387)=0d0
    v(244)=0d0
    v(388)=0d0
    v(389)=0d0
    v(390)=0d0
    v(391)=0d0
    v(392)=0d0
    v(393)=0d0
    v(394)=0d0
    v(395)=0d0
    v(396)=0d0
    v(245)=0d0
    v(397)=0d0
    v(398)=0d0
    v(399)=0d0
    v(400)=0d0
    v(401)=0d0
    v(402)=0d0
    v(403)=0d0
    v(404)=0d0
    v(405)=0d0
    v(246)=0d0
    v(406)=0d0
    v(407)=0d0
    v(408)=0d0
    v(409)=0d0
    v(410)=0d0
    v(411)=0d0
    v(412)=0d0
    v(413)=0d0
    v(414)=0d0
    v(247)=0d0
    v(415)=0d0
    v(416)=0d0
    v(417)=0d0
    v(418)=0d0
    v(419)=0d0
    v(420)=0d0
    v(421)=0d0
    v(422)=0d0
    v(423)=0d0
    v(248)=0d0
    v(424)=0d0
    v(425)=0d0
    v(426)=0d0
    v(427)=0d0
    v(428)=0d0
    v(429)=0d0
    v(430)=0d0
    v(431)=0d0
    v(432)=0d0
    v(249)=0d0
  ELSE
    v(424)=v(321)*xi(2)
    v(425)=v(322)*xi(2)
    v(426)=v(323)*xi(2)
    v(427)=v(324)*xi(2)
    v(428)=v(325)*xi(2)
    v(429)=v(326)*xi(2)
    v(430)=v(327)*xi(2)
    v(431)=v(328)*xi(2)
    v(432)=v(329)*xi(2)
    v(249)=v(347)
    v(406)=v(321)*xi(1)
    v(407)=v(322)*xi(1)
    v(408)=v(323)*xi(1)
    v(409)=v(324)*xi(1)
    v(410)=v(325)*xi(1)
    v(411)=v(326)*xi(1)
    v(412)=v(427)
    v(413)=v(328)*xi(1)
    v(414)=v(329)*xi(1)
    v(247)=v(343)
    v(388)=v(321)*v(538)
    v(389)=v(322)*v(538)
    v(390)=v(323)*v(538)
    v(391)=v(406)
    v(392)=v(325)*v(538)
    v(393)=v(326)*v(538)
    v(394)=v(424)
    v(395)=v(328)*v(538)
    v(396)=v(329)*v(538)
    v(245)=v(561)
    v(415)=v(330)*xi(2)
    v(416)=v(331)*xi(2)
    v(417)=v(332)*xi(2)
    v(418)=v(333)*xi(2)
    v(419)=v(334)*xi(2)
    v(420)=v(335)*xi(2)
    v(421)=v(336)*xi(2)
    v(422)=v(337)*xi(2)
    v(423)=v(338)*xi(2)
    v(248)=v(375)
    v(397)=v(330)*xi(1)
    v(398)=v(331)*xi(1)
    v(399)=v(332)*xi(1)
    v(400)=v(333)*xi(1)
    v(401)=v(334)*xi(1)
    v(402)=v(335)*xi(1)
    v(403)=v(336)*xi(1)
    v(404)=v(419)
    v(405)=v(338)*xi(1)
    v(246)=v(371)
    v(379)=v(330)*v(538)
    v(380)=v(331)*v(538)
    v(381)=v(332)*v(538)
    v(382)=v(333)*v(538)
    v(383)=v(398)
    v(384)=v(335)*v(538)
    v(385)=v(336)*v(538)
    v(386)=v(416)
    v(387)=v(338)*v(538)
    v(244)=v(562)
  ENDIF
  v(436)=v(205)*v(270)
  v(440)=v(205)*v(537)
  v(444)=v(205)*v(563)
  v(448)=v(208)*v(270)
  v(452)=v(208)*v(537)
  v(456)=v(208)*v(563)
  v(462)=(-(v(206)*v(287))-v(209)*v(314))/2d0
  v(465)=(-(v(207)*v(287))-v(210)*v(314))/2d0
  v(466)=-(v(206)*v(270))
  v(467)=-(v(209)*v(270))
  v(468)=-(v(207)*v(270))
  v(469)=-(v(210)*v(270))
  v(476)=-(v(206)*v(537))
  v(480)=-(v(206)*v(563))
  v(487)=-(v(209)*v(537))
  v(491)=-(v(209)*v(563))
  v(501)=(-(v(207)*v(290))-v(210)*v(317))/2d0
  v(502)=-(v(207)*v(537))
  v(503)=-(v(210)*v(537))
  v(513)=-(v(207)*v(563))
  v(523)=-(v(210)*v(563))
  intforce(1)=v(205)*v(242)+deriv*v(244)+v(240)*v(538)+v(217)*v(566)
  intforce(2)=v(208)*v(236)+deriv*v(245)+v(238)*v(538)+v(216)*v(569)
  intforce(3)=(v(205)*v(256)+v(208)*v(257))/2d0
  intforce(4)=v(226)*v(270)
  intforce(5)=-(v(206)*v(242))+deriv*v(246)+v(217)*v(565)+v(240)*xi(1)
  intforce(6)=-(v(209)*v(236))+deriv*v(247)+v(216)*v(568)+v(238)*xi(1)
  intforce(7)=(-(v(206)*v(256))-v(209)*v(257))/2d0
  intforce(8)=v(226)*v(537)
  intforce(9)=-(v(207)*v(242))+deriv*v(248)+v(217)*v(564)+v(240)*xi(2)
  intforce(10)=-(v(210)*v(236))+deriv*v(249)+v(216)*v(567)+v(238)*xi(2)
  intforce(11)=(-(v(207)*v(256))-v(210)*v(257))/2d0
  intforce(12)=v(226)*v(563)
  intstiff(1,1)=v(297)*v(330)+v(205)*v(368)+deriv*v(379)+v(359)*v(538)
  intstiff(1,2)=v(297)*v(331)+v(205)*v(369)+deriv*v(380)+v(538)*(v(360)+v(566))
  intstiff(1,3)=deriv*v(381)+v(361)*v(538)+v(332)*v(558)
  intstiff(1,4)=v(436)
  intstiff(1,5)=v(297)*v(333)+v(205)*v(372)+deriv*v(382)+v(362)*v(538)
  intstiff(1,6)=v(205)*v(373)+deriv*v(383)+v(363)*v(538)+v(208)*v(570)
  intstiff(1,7)=v(297)*v(335)+deriv*v(384)+v(492)+v(364)*v(538)
  intstiff(1,8)=v(440)
  intstiff(1,9)=v(297)*v(336)+v(205)*v(376)+deriv*v(385)+v(365)*v(538)
  intstiff(1,10)=v(205)*v(377)+deriv*v(386)+v(366)*v(538)+v(208)*v(571)
  intstiff(1,11)=v(297)*v(338)+deriv*v(387)+v(524)+v(367)*v(538)
  intstiff(1,12)=v(444)
  intstiff(2,1)=v(208)*v(339)+deriv*v(388)+v(538)*(v(350)+v(569))+v(205)*v(572)
  intstiff(2,2)=v(296)*v(322)+v(208)*v(340)+deriv*v(389)+v(351)*v(538)
  intstiff(2,3)=deriv*v(390)+v(352)*v(538)+v(323)*v(558)
  intstiff(2,4)=v(448)
  intstiff(2,5)=v(208)*v(342)+deriv*v(391)+v(353)*v(538)+v(205)*v(573)
  intstiff(2,6)=v(296)*v(325)+v(208)*v(344)+deriv*v(392)+v(354)*v(538)
  intstiff(2,7)=v(296)*v(326)+deriv*v(393)+v(494)+v(355)*v(538)
  intstiff(2,8)=v(452)
  intstiff(2,9)=v(208)*v(346)+deriv*v(394)+v(356)*v(538)+v(205)*v(574)
  intstiff(2,10)=v(296)*v(328)+v(208)*v(348)+deriv*v(395)+v(357)*v(538)
  intstiff(2,11)=v(296)*v(329)+deriv*v(396)+v(526)+v(358)*v(538)
  intstiff(2,12)=v(456)
  intstiff(3,1)=(v(205)*v(285)+v(208)*v(312))/2d0
  intstiff(3,2)=(v(205)*v(286)+v(208)*v(313))/2d0
  intstiff(3,3)=(v(205)*v(287)+v(208)*v(314))/2d0
  intstiff(3,4)=0d0
  intstiff(3,5)=(v(205)*v(288)+v(208)*v(315))/2d0
  intstiff(3,6)=(v(205)*v(289)+v(208)*v(316))/2d0
  intstiff(3,7)=v(462)
  intstiff(3,8)=0d0
  intstiff(3,9)=(v(205)*v(291)+v(208)*v(318))/2d0
  intstiff(3,10)=(v(205)*v(292)+v(208)*v(319))/2d0
  intstiff(3,11)=v(465)
  intstiff(3,12)=0d0
  intstiff(4,1)=v(436)
  intstiff(4,2)=v(448)
  intstiff(4,3)=0d0
  intstiff(4,4)=0d0
  intstiff(4,5)=v(466)
  intstiff(4,6)=v(467)
  intstiff(4,7)=0d0
  intstiff(4,8)=0d0
  intstiff(4,9)=v(468)
  intstiff(4,10)=v(469)
  intstiff(4,11)=0d0
  intstiff(4,12)=0d0
  intstiff(5,1)=v(303)*v(330)-v(206)*v(368)+deriv*v(397)+v(359)*xi(1)
  intstiff(5,2)=-(v(206)*v(369))+deriv*v(398)+v(209)*v(575)+v(360)*xi(1)
  intstiff(5,3)=v(303)*v(332)+deriv*v(399)+v(492)+v(361)*xi(1)
  intstiff(5,4)=v(466)
  intstiff(5,5)=v(303)*v(333)-v(206)*v(372)+deriv*v(400)+v(362)*xi(1)
  intstiff(5,6)=-(v(206)*v(373))+deriv*v(401)-v(209)*v(570)+v(363)*xi(1)
  intstiff(5,7)=v(303)*v(335)-v(206)*v(374)+deriv*v(402)+v(364)*xi(1)
  intstiff(5,8)=v(476)
  intstiff(5,9)=v(303)*v(336)-v(206)*v(376)+deriv*v(403)+v(365)*xi(1)
  intstiff(5,10)=-(v(206)*v(377))+deriv*v(404)-v(209)*v(571)+v(366)*xi(1)
  intstiff(5,11)=v(303)*v(338)+deriv*v(405)+v(528)+v(367)*xi(1)
  intstiff(5,12)=v(480)
  intstiff(6,1)=-(v(209)*v(339))+deriv*v(406)+v(206)*v(576)+v(350)*xi(1)
  intstiff(6,2)=v(302)*v(322)-v(209)*v(340)+deriv*v(407)+v(351)*xi(1)
  intstiff(6,3)=v(302)*v(323)+deriv*v(408)+v(494)+v(352)*xi(1)
  intstiff(6,4)=v(467)
  intstiff(6,5)=-(v(209)*v(342))+deriv*v(409)-v(206)*v(573)+v(353)*xi(1)
  intstiff(6,6)=v(302)*v(325)-v(209)*v(344)+deriv*v(410)+v(354)*xi(1)
  intstiff(6,7)=v(302)*v(326)-v(209)*v(345)+deriv*v(411)+v(355)*xi(1)
  intstiff(6,8)=v(487)
  intstiff(6,9)=-(v(209)*v(346))+deriv*v(412)-v(206)*v(574)+v(356)*xi(1)
  intstiff(6,10)=v(302)*v(328)-v(209)*v(348)+deriv*v(413)+v(357)*xi(1)
  intstiff(6,11)=v(302)*v(329)+deriv*v(414)+v(530)+v(358)*xi(1)
  intstiff(6,12)=v(491)
  intstiff(7,1)=(-(v(206)*v(285))-v(209)*v(312))/2d0
  intstiff(7,2)=(-(v(206)*v(286))-v(209)*v(313))/2d0
  intstiff(7,3)=v(462)
  intstiff(7,4)=0d0
  intstiff(7,5)=(-(v(206)*v(288))-v(209)*v(315))/2d0
  intstiff(7,6)=(-(v(206)*v(289))-v(209)*v(316))/2d0
  intstiff(7,7)=(-(v(206)*v(290))-v(209)*v(317))/2d0
  intstiff(7,8)=0d0
  intstiff(7,9)=(-(v(206)*v(291))-v(209)*v(318))/2d0
  intstiff(7,10)=(-(v(206)*v(292))-v(209)*v(319))/2d0
  intstiff(7,11)=v(501)
  intstiff(7,12)=0d0
  intstiff(8,1)=v(440)
  intstiff(8,2)=v(452)
  intstiff(8,3)=0d0
  intstiff(8,4)=0d0
  intstiff(8,5)=v(476)
  intstiff(8,6)=v(487)
  intstiff(8,7)=0d0
  intstiff(8,8)=0d0
  intstiff(8,9)=v(502)
  intstiff(8,10)=v(503)
  intstiff(8,11)=0d0
  intstiff(8,12)=0d0
  intstiff(9,1)=v(309)*v(330)-v(207)*v(368)+deriv*v(415)+v(359)*xi(2)
  intstiff(9,2)=-(v(207)*v(369))+deriv*v(416)+v(210)*v(575)+v(360)*xi(2)
  intstiff(9,3)=v(309)*v(332)+deriv*v(417)+v(524)+v(361)*xi(2)
  intstiff(9,4)=v(468)
  intstiff(9,5)=v(309)*v(333)-v(207)*v(372)+deriv*v(418)+v(362)*xi(2)
  intstiff(9,6)=-(v(207)*v(373))+deriv*v(419)-v(210)*v(570)+v(363)*xi(2)
  intstiff(9,7)=v(309)*v(335)+deriv*v(420)+v(528)+v(364)*xi(2)
  intstiff(9,8)=v(502)
  intstiff(9,9)=v(309)*v(336)-v(207)*v(376)+deriv*v(421)+v(365)*xi(2)
  intstiff(9,10)=-(v(207)*v(377))+deriv*v(422)-v(210)*v(571)+v(366)*xi(2)
  intstiff(9,11)=v(309)*v(338)-v(207)*v(378)+deriv*v(423)+v(367)*xi(2)
  intstiff(9,12)=v(513)
  intstiff(10,1)=-(v(210)*v(339))+deriv*v(424)+v(207)*v(576)+v(350)*xi(2)
  intstiff(10,2)=v(308)*v(322)-v(210)*v(340)+deriv*v(425)+v(351)*xi(2)
  intstiff(10,3)=v(308)*v(323)+deriv*v(426)+v(526)+v(352)*xi(2)
  intstiff(10,4)=v(469)
  intstiff(10,5)=-(v(210)*v(342))+deriv*v(427)-v(207)*v(573)+v(353)*xi(2)
  intstiff(10,6)=v(308)*v(325)-v(210)*v(344)+deriv*v(428)+v(354)*xi(2)
  intstiff(10,7)=v(308)*v(326)+deriv*v(429)+v(530)+v(355)*xi(2)
  intstiff(10,8)=v(503)
  intstiff(10,9)=-(v(210)*v(346))+deriv*v(430)-v(207)*v(574)+v(356)*xi(2)
  intstiff(10,10)=v(308)*v(328)-v(210)*v(348)+deriv*v(431)+v(357)*xi(2)
  intstiff(10,11)=v(308)*v(329)-v(210)*v(349)+deriv*v(432)+v(358)*xi(2)
  intstiff(10,12)=v(523)
  intstiff(11,1)=(-(v(207)*v(285))-v(210)*v(312))/2d0
  intstiff(11,2)=(-(v(207)*v(286))-v(210)*v(313))/2d0
  intstiff(11,3)=v(465)
  intstiff(11,4)=0d0
  intstiff(11,5)=(-(v(207)*v(288))-v(210)*v(315))/2d0
  intstiff(11,6)=(-(v(207)*v(289))-v(210)*v(316))/2d0
  intstiff(11,7)=v(501)
  intstiff(11,8)=0d0
  intstiff(11,9)=(-(v(207)*v(291))-v(210)*v(318))/2d0
  intstiff(11,10)=(-(v(207)*v(292))-v(210)*v(319))/2d0
  intstiff(11,11)=((v(207)*v(207))+(v(210)*v(210)))*vol
  intstiff(11,12)=0d0
  intstiff(12,1)=v(444)
  intstiff(12,2)=v(456)
  intstiff(12,3)=0d0
  intstiff(12,4)=0d0
  intstiff(12,5)=v(480)
  intstiff(12,6)=v(491)
  intstiff(12,7)=0d0
  intstiff(12,8)=0d0
  intstiff(12,9)=v(513)
  intstiff(12,10)=v(523)
  intstiff(12,11)=0d0
  intstiff(12,12)=0d0
END SUBROUTINE fluid2dinviscid


!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           13 Jun 23 03:10:35 *
!**************************************************************
! User     : Full professional version
! Notebook : turbulence2d
! Evaluation time                 : 5 s     Mode  : Optimal
! Number of formulae              : 96      Method: Automatic
! Subroutine                      : turbulence2d size: 1873
! Total size of Mathematica  code : 1873 subexpressions
! Total size of Fortran code      : 4712 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE turbulence2d(dtime,vol,h,d,rho,mufixed,rno,pnew,vnew,xi,nuold,nunew,intforce,intstiff)
IMPLICIT NONE
DOUBLE PRECISION v(174),dtime,vol,h,d,rho,mufixed,rno(3,2),pnew(3),vnew(3,2),xi(2),nuold(3),nunew(3),intforce&
&(3),intstiff(3,3)
v(152)=1d0/h**2
v(151)=(16d0*mufixed**2)/(h**4*rho**2)
v(149)=d**2
v(148)=nunew(3)*xi(2)
v(147)=nunew(2)*xi(1)
v(146)=nuold(3)*xi(2)
v(145)=nuold(2)*xi(1)
v(144)=1d0/dtime
v(143)=v(144)*xi(2)
v(142)=vnew(3,2)*xi(2)
v(141)=vnew(2,2)*xi(1)
v(140)=vnew(3,1)*xi(2)
v(139)=vnew(2,1)*xi(1)
v(138)=rno(1,2)-rno(2,2)
v(137)=-rno(1,1)+rno(2,1)
v(136)=1d0/(-(rno(1,2)*rno(2,1))+rno(1,1)*rno(2,2)+rno(3,2)*v(137)+rno(3,1)*v(138))
v(135)=mufixed/rho
v(134)=1d0-xi(1)-xi(2)
v(133)=1d0/d**2
v(49)=-(v(136)*v(137))
v(48)=-((rno(1,1)-rno(3,1))*v(136))
v(46)=-(v(136)*v(138))
v(45)=(rno(1,2)-rno(3,2))*v(136)
v(44)=v(45)+v(46)
v(75)=nunew(1)*v(44)-nunew(2)*v(45)-nunew(3)*v(46)
v(158)=v(46)*v(75)
v(156)=v(45)*v(75)
v(153)=v(44)*v(75)
v(47)=v(48)+v(49)
v(76)=nunew(1)*v(47)-nunew(2)*v(48)-nunew(3)*v(49)
v(159)=v(49)*v(76)
v(157)=v(48)*v(76)
v(154)=v(47)*v(76)
v(112)=v(158)+v(159)
v(99)=v(156)+v(157)
v(83)=-v(153)-v(154)
v(50)=v(139)+v(140)+v(134)*vnew(1,1)
v(52)=v(141)+v(142)+v(134)*vnew(1,2)
v(74)=v(143)-v(46)*v(50)-v(49)*v(52)
v(72)=-(v(45)*v(50))-v(48)*v(52)+v(144)*xi(1)
v(70)=v(134)*v(144)+v(44)*v(50)+v(47)*v(52)
v(53)=nuold(1)*v(134)+v(145)+v(146)
v(54)=nunew(1)*v(134)+v(147)+v(148)
v(85)=v(135)+v(54)
v(113)=-((v(45)*v(46)+v(48)*v(49))*v(85))
v(108)=(v(44)*v(46)+v(47)*v(49))*v(85)
v(93)=(v(44)*v(45)+v(47)*v(48))*v(85)
v(56)=dabs(v(47)*vnew(1,1)-v(44)*vnew(1,2)-v(48)*vnew(2,1)+v(45)*vnew(2,2)-v(49)*vnew(3,1)+v(46)*vnew(3,2))
v(57)=v(53)/v(135)
v(58)=v(57)**3
v(62)=v(144)*(-v(53)+v(54))+v(50)*v(75)+v(52)*v(76)
v(63)=MAX(0.3d0*v(56),0.5948839976204641d1*v(133)*v(53)*(1d0-v(57)/(1d0+(v(57)*v(58))/(0.3579109999999999d3+v(58))))&
&+sqrt(2d0*v(56)**2))
v(155)=(-0.136d0)*v(63)
v(129)=v(155)*v(54)
v(64)=MIN(v(53)/(0.1d-8+0.16809999999999997d0*v(149)*v(63)),10d0)
v(66)=0.7d0*v(64)+0.3d0*v(64)**6
v(67)=0.20051747451504215d1*v(66)*(1/(64d0+v(66)**6))**0.16666666666666666d0
v(161)=v(133)*v(67)
v(86)=0.6488955344398533d1*v(161)*v(54)
v(150)=v(86)*vol
v(114)=v(150)*xi(1)*xi(2)
v(90)=v(134)*v(150)
v(109)=v(90)*xi(2)
v(94)=v(90)*xi(1)
v(68)=1d0/sqrt(v(151)+4d0*v(152)*(1.d-6+v(50)**2+v(52)**2))
v(160)=v(68)*vol
v(77)=2d0*(v(153)+v(154))
v(165)=0.622d0*v(77)
v(79)=v(134)*v(86)
v(80)=v(160)*v(70)
v(81)=v(134)*v(155)
v(97)=v(70)+v(81)
v(95)=v(79)+v(97)
v(164)=(-0.9339339339339339d0)*v(77)+v(95)
v(84)=(-2d0)*(v(156)+v(157))
v(167)=0.622d0*v(84)
v(87)=v(155)*xi(1)
v(102)=v(72)+v(87)
v(101)=v(102)+v(86)*xi(1)
v(166)=v(101)-0.9339339339339339d0*v(84)
v(89)=(-2d0)*(v(158)+v(159))
v(169)=0.622d0*v(89)
v(91)=v(155)*xi(2)
v(106)=v(74)+v(91)
v(105)=v(106)+v(86)*xi(2)
v(168)=v(105)-0.9339339339339339d0*v(89)
v(96)=v(160)*v(72)
v(110)=v(160)*v(74)
v(126)=(v(75)*v(75))+(v(76)*v(76))
v(163)=0.622d0*v(126)
v(127)=v(129)+v(62)
v(128)=0.32444776721992663d1*v(161)*(v(54)*v(54))
v(130)=v(127)+v(128)
v(162)=(-0.9339339339339339d0)*v(126)+v(130)
intforce(1)=intforce(1)+v(162)*v(80)+(v(130)*v(134)-0.15015015015015015d1*(v(134)*v(163)+v(83)*v(85)))*vol
intforce(2)=intforce(2)+v(162)*v(96)+vol*(v(130)*xi(1)-0.15015015015015015d1*(v(85)*v(99)+v(163)*xi(1)))
intforce(3)=intforce(3)+v(110)*v(162)+vol*(v(130)*xi(2)-0.15015015015015015d1*(v(112)*v(85)+v(163)*xi(2)))
intstiff(1,1)=intstiff(1,1)+v(164)*v(80)+((-0.15015015015015015d1)*(v(134)*(v(165)+v(83))+(-(v(44)*v(44))-(v(47)*v(47))&
&)*v(85))+v(134)*v(95))*vol
intstiff(1,2)=intstiff(1,2)+v(166)*v(80)+v(94)+vol*(v(102)*v(134)-0.15015015015015015d1*(v(134)*v(167)+v(93)+v(83)*xi(1&
&)))
intstiff(1,3)=intstiff(1,3)+v(109)+v(168)*v(80)+vol*(v(106)*v(134)-0.15015015015015015d1*(v(108)+v(134)*v(169)+v(83)*xi&
&(2)))
intstiff(2,1)=intstiff(2,1)+v(94)+v(164)*v(96)+vol*(v(97)*xi(1)-0.15015015015015015d1*(v(93)+v(134)*v(99)+v(165)*xi(1))&
&)
intstiff(2,2)=intstiff(2,2)+v(166)*v(96)+vol*(v(102)*xi(1)+v(86)*xi(1)**2-0.15015015015015015d1*((-(v(45)*v(45))-(v(48&
&)*v(48)))*v(85)+(v(167)+v(99))*xi(1)))
intstiff(2,3)=intstiff(2,3)+v(114)+v(168)*v(96)+vol*(v(106)*xi(1)-0.15015015015015015d1*(v(113)+v(169)*xi(1)+v(99)*xi(2&
&)))
intstiff(3,1)=intstiff(3,1)+v(109)+v(110)*v(164)+vol*(v(97)*xi(2)-0.15015015015015015d1*(v(108)+v(112)*v(134)+v(165)*xi&
&(2)))
intstiff(3,2)=intstiff(3,2)+v(114)+v(110)*v(166)+vol*(v(102)*xi(2)-0.15015015015015015d1*(v(113)+v(112)*xi(1)+v(167)*xi&
&(2)))
intstiff(3,3)=intstiff(3,3)+v(110)*v(168)+vol*(v(106)*xi(2)+v(86)*xi(2)**2-0.15015015015015015d1*((-(v(46)*v(46))-(v(49&
&)*v(49)))*v(85)+(v(112)+v(169))*xi(2)))
END SUBROUTINE turbulence2d





!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           28 Apr 23 19:13:22 *
!**************************************************************
! User     : Full professional version
! Notebook : fluid2dleastsquares
! Evaluation time                 : 20 s    Mode  : Optimal
! Number of formulae              : 555     Method: Automatic
! Subroutine                      : fluid2dleastsquares size: 9965
! Total size of Mathematica  code : 9965 subexpressions
! Total size of Fortran code      : 25750 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE fluid2dleastsquares(steady,deriv,dtime,vol,h,rho,mu,bulk,f,rno,acel,vnew,xi,mixed,intforce,intstiff&
    &,penalty2,penalty3)
  IMPLICIT NONE
  LOGICAL steady,b289,b343
  DOUBLE PRECISION v(962),deriv,dtime,vol,h,rho,mu,bulk,f(2),rno(3,2),acel(3,2),vnew(3,2),xi(2),mixed(3,3)&
      &,intforce(15),intstiff(15,15),penalty2,penalty3
  v(956)=mixed(3,3)*xi(2)
  v(955)=mixed(2,3)*xi(1)
  v(954)=mixed(3,2)*xi(2)
  v(953)=mixed(2,2)*xi(1)
  v(952)=mixed(3,1)*xi(2)
  v(951)=mixed(2,1)*xi(1)
  v(947)=vnew(3,2)*xi(2)
  v(946)=vnew(2,2)*xi(1)
  v(945)=vnew(3,1)*xi(2)
  v(944)=vnew(2,1)*xi(1)
  v(935)=rno(1,2)-rno(2,2)
  v(934)=2d0*mu
  v(933)=-rno(1,1)+rno(2,1)
  v(932)=1d0/(-(rno(1,2)*rno(2,1))+rno(1,1)*rno(2,2)+rno(3,2)*v(933)+rno(3,1)*v(935))
  v(931)=penalty3**2
  v(929)=penalty2**2
  v(930)=(-0.5d0)*v(929)
  v(928)=1d0-xi(1)-xi(2)
  v(927)=-bulk-mu
  v(404)=v(930)*xi(2)
  v(401)=v(930)*xi(1)
  v(398)=v(928)*v(930)
  v(386)=v(929)*xi(2)
  v(384)=v(929)*xi(1)
  v(382)=v(928)*v(929)
  v(408)=v(931)*xi(2)
  v(916)=(v(386)+v(408))*xi(2)
  v(407)=v(931)*xi(1)
  v(584)=v(384)+v(407)
  v(856)=v(584)*xi(2)
  v(852)=v(584)*xi(1)
  v(406)=v(928)*v(931)
  v(583)=v(382)+v(406)
  v(792)=v(583)*xi(2)
  v(787)=v(583)*xi(1)
  v(783)=v(583)*v(928)
  v(288)=-(v(932)*v(933))
  v(469)=bulk*v(288)
  v(957)=v(288)*v(469)
  v(499)=rho*v(469)
  v(429)=mu*v(288)
  v(549)=rho*v(429)
  v(470)=v(429)+v(469)
  v(500)=rho*v(470)
  v(394)=v(288)/2d0
  v(402)=v(394)*v(930)
  v(389)=v(288)*v(929)
  v(324)=-(v(288)*vnew(3,1))
  v(317)=-(v(288)*vnew(3,2))
  v(287)=-((rno(1,1)-rno(3,1))*v(932))
  v(460)=bulk*v(287)
  v(593)=v(460)*v(927)
  v(494)=rho*v(460)
  v(479)=v(460)*v(934)
  v(422)=mu*v(287)
  v(544)=rho*v(422)
  v(461)=v(422)+v(460)
  v(594)=v(461)*v(927)
  v(495)=rho*v(461)
  v(439)=v(422)*v(934)
  v(392)=v(287)/2d0
  v(399)=v(392)*v(930)
  v(388)=v(287)*v(929)
  v(323)=-(v(287)*vnew(2,1))
  v(316)=-(v(287)*vnew(2,2))
  v(285)=-(v(932)*v(935))
  v(471)=mu*v(285)
  v(501)=rho*v(471)
  v(428)=bulk*v(285)
  v(548)=rho*v(428)
  v(427)=v(428)+v(471)
  v(547)=rho*v(427)
  v(395)=v(285)/2d0
  v(403)=v(395)*v(930)
  v(385)=v(285)*v(929)
  v(321)=-(v(285)*vnew(3,2))
  v(313)=-(v(285)*vnew(3,1))
  v(284)=(rno(1,2)-rno(3,2))*v(932)
  v(462)=mu*v(284)
  v(496)=rho*v(462)
  v(481)=v(462)*v(934)
  v(421)=bulk*v(284)
  v(543)=rho*v(421)
  v(420)=v(421)+v(462)
  v(608)=v(420)*v(927)
  v(542)=rho*v(420)
  v(437)=v(420)*v(934)
  v(393)=v(284)/2d0
  v(400)=v(393)*v(930)
  v(383)=v(284)*v(929)
  v(320)=-(v(284)*vnew(2,2))
  v(312)=-(v(284)*vnew(2,1))
  v(283)=v(284)+v(285)
  v(453)=-(mu*v(283))
  v(491)=rho*v(453)
  v(476)=v(453)*v(934)
  v(414)=-(bulk*v(283))
  v(538)=rho*v(414)
  v(433)=v(414)*v(934)
  v(413)=v(414)+v(453)
  v(603)=v(413)*v(927)
  v(537)=rho*v(413)
  v(432)=v(413)*v(934)
  v(391)=(-0.5d0)*v(283)
  v(397)=v(391)*v(930)
  v(381)=-(v(283)*v(929))
  v(319)=v(283)*vnew(1,2)
  v(341)=v(319)+v(320)+v(321)
  v(936)=rho*v(341)
  v(464)=v(936)*xi(2)
  v(596)=v(464)*v(927)
  v(497)=rho*v(464)
  v(482)=v(464)*v(934)
  v(455)=v(936)*xi(1)
  v(591)=v(455)*v(927)
  v(492)=rho*v(455)
  v(477)=v(455)*v(934)
  v(446)=v(928)*v(936)
  v(586)=v(446)*v(927)
  v(487)=rho*v(446)
  v(472)=v(446)*v(934)
  v(311)=v(283)*vnew(1,1)
  v(307)=mixed(1,1)*v(283)-mixed(2,1)*v(284)-mixed(3,1)*v(285)
  v(302)=v(311)+v(312)+v(313)
  v(645)=v(341)*v(501)+v(302)*v(549)
  v(644)=v(341)*v(500)+v(302)*v(548)
  v(643)=v(341)*v(499)+v(302)*v(547)
  v(640)=v(341)*v(496)+v(302)*v(544)
  v(639)=v(341)*v(495)+v(302)*v(543)
  v(638)=v(341)*v(494)+v(302)*v(542)
  v(286)=v(287)+v(288)
  v(451)=-(bulk*v(286))
  v(588)=v(451)*v(927)
  v(489)=rho*v(451)
  v(633)=v(341)*v(489)+v(302)*v(537)
  v(474)=v(451)*v(934)
  v(415)=-(mu*v(286))
  v(539)=rho*v(415)
  v(635)=v(341)*v(491)+v(302)*v(539)
  v(452)=v(415)+v(451)
  v(589)=v(452)*v(927)
  v(490)=rho*v(452)
  v(634)=v(341)*v(490)+v(302)*v(538)
  v(475)=v(452)*v(934)
  v(434)=v(415)*v(934)
  v(390)=(-0.5d0)*v(286)
  v(396)=v(390)*v(930)
  v(387)=-(v(286)*v(929))
  v(322)=v(286)*vnew(1,1)
  v(339)=v(322)+v(323)+v(324)
  v(937)=rho*v(339)
  v(426)=v(937)*xi(2)
  v(612)=v(426)*v(927)
  v(546)=rho*v(426)
  v(441)=v(426)*v(934)
  v(419)=v(937)*xi(1)
  v(607)=v(419)*v(927)
  v(541)=rho*v(419)
  v(436)=v(419)*v(934)
  v(412)=v(928)*v(937)
  v(602)=v(412)*v(927)
  v(536)=rho*v(412)
  v(431)=v(412)*v(934)
  v(315)=v(286)*vnew(1,2)
  v(309)=mixed(1,2)*v(286)-mixed(2,2)*v(287)-mixed(3,2)*v(288)
  v(301)=v(315)+v(316)+v(317)
  v(630)=v(301)*v(501)+v(339)*v(549)
  v(629)=v(301)*v(500)+v(339)*v(548)
  v(628)=v(301)*v(499)+v(339)*v(547)
  v(625)=v(301)*v(496)+v(339)*v(544)
  v(624)=v(301)*v(495)+v(339)*v(543)
  v(623)=v(301)*v(494)+v(339)*v(542)
  v(620)=v(301)*v(491)+v(339)*v(539)
  v(619)=v(301)*v(490)+v(339)*v(538)
  v(618)=v(301)*v(489)+v(339)*v(537)
  IF(steady) THEN
    v(375)=0d0
    v(376)=0d0
    v(377)=0d0
    v(290)=0d0
    v(378)=0d0
    v(379)=0d0
    v(380)=0d0
    v(291)=0d0
  ELSE
    v(943)=acel(3,2)*xi(2)
    v(942)=acel(2,2)*xi(1)
    v(941)=acel(3,1)*xi(2)
    v(940)=acel(2,1)*xi(1)
    v(939)=deriv*xi(2)
    v(938)=deriv*xi(1)
    v(375)=deriv*v(928)
    v(376)=v(938)
    v(377)=v(939)
    v(290)=acel(1,1)*v(928)+v(940)+v(941)
    v(378)=v(375)
    v(379)=v(376)
    v(380)=v(377)
    v(291)=acel(1,2)*v(928)+v(942)+v(943)
  ENDIF
  v(294)=v(944)+v(945)+v(928)*vnew(1,1)
  v(582)=v(294)*v(549)
  v(581)=v(294)*v(548)
  v(908)=v(283)*v(581)
  v(580)=-v(386)+v(294)*v(547)
  v(579)=v(294)*v(546)
  v(577)=v(294)*v(544)
  v(576)=v(294)*v(543)
  v(911)=-(v(285)*v(576))
  v(847)=v(283)*v(576)
  v(575)=-v(384)+v(294)*v(542)
  v(574)=v(294)*v(541)
  v(572)=v(294)*v(539)
  v(570)=-v(382)+v(294)*v(537)
  v(569)=v(294)*v(536)
  v(534)=v(404)+v(294)*v(501)
  v(533)=v(294)*v(500)
  v(532)=v(294)*v(499)
  v(529)=v(401)+v(294)*v(496)
  v(528)=v(294)*v(495)
  v(527)=v(294)*v(494)
  v(524)=v(398)+v(294)*v(491)
  v(523)=v(294)*v(490)
  v(522)=v(294)*v(489)
  v(465)=-(v(285)*v(294))
  v(456)=-(v(284)*v(294))
  v(447)=v(283)*v(294)
  v(295)=v(946)+v(947)+v(928)*vnew(1,2)
  v(566)=v(404)+v(295)*v(549)
  v(565)=v(295)*v(548)
  v(564)=v(295)*v(547)
  v(560)=v(401)+v(295)*v(544)
  v(559)=v(295)*v(543)
  v(558)=v(295)*v(542)
  v(554)=v(398)+v(295)*v(539)
  v(553)=v(295)*v(538)
  v(552)=v(295)*v(537)
  v(518)=v(295)*v(501)
  v(517)=-v(386)+v(295)*v(500)
  v(516)=v(295)*v(499)
  v(898)=v(286)*v(516)
  v(513)=v(295)*v(497)
  v(512)=v(295)*v(496)
  v(511)=-v(384)+v(295)*v(495)
  v(510)=v(295)*v(494)
  v(901)=-(v(288)*v(510))
  v(835)=v(286)*v(510)
  v(507)=v(295)*v(492)
  v(506)=v(295)*v(491)
  v(505)=-v(382)+v(295)*v(490)
  v(502)=v(295)*v(487)
  v(466)=-(v(288)*v(295))
  v(948)=v(465)+v(466)
  v(468)=rho*(v(380)+v(948)+v(301)*xi(2))
  v(597)=v(468)*v(927)
  v(498)=rho*v(468)
  v(531)=v(403)+v(294)*v(498)
  v(483)=v(468)*v(934)
  v(457)=-(v(287)*v(295))
  v(949)=v(456)+v(457)
  v(459)=rho*(v(379)+v(949)+v(301)*xi(1))
  v(592)=v(459)*v(927)
  v(493)=rho*v(459)
  v(526)=v(400)+v(294)*v(493)
  v(478)=v(459)*v(934)
  v(448)=v(286)*v(295)
  v(950)=v(447)+v(448)
  v(450)=rho*(v(378)+v(301)*v(928)+v(950))
  v(587)=v(450)*v(927)
  v(488)=rho*v(450)
  v(521)=v(397)+v(294)*v(488)
  v(473)=v(450)*v(934)
  v(424)=rho*(v(377)+v(948)+v(302)*xi(2))
  v(611)=v(424)*v(927)
  v(545)=rho*v(424)
  v(561)=v(402)+v(295)*v(545)
  v(440)=v(424)*v(934)
  v(417)=rho*(v(376)+v(949)+v(302)*xi(1))
  v(606)=v(417)*v(927)
  v(540)=rho*v(417)
  v(555)=v(399)+v(295)*v(540)
  v(435)=v(417)*v(934)
  v(410)=rho*(v(375)+v(302)*v(928)+v(950))
  v(601)=v(410)*v(927)
  v(535)=rho*v(410)
  v(550)=v(396)+v(295)*v(535)
  v(430)=v(410)*v(934)
  v(296)=mixed(1,1)*v(928)+v(951)+v(952)
  v(350)=(v(296)-v(311)-v(312)-v(313))*v(929)
  v(297)=mixed(1,2)*v(928)+v(953)+v(954)
  v(354)=(v(297)-v(315)-v(316)-v(317))*v(929)
  v(351)=(-v(319)-v(320)-v(321)-v(322)-v(323)-v(324))/2d0+mixed(1,3)*v(928)+v(955)+v(956)
  v(353)=v(351)*v(930)
  v(332)=(v(296)+v(297))*v(931)
  v(308)=-(bulk*(mixed(1,2)*v(283)-mixed(2,2)*v(284)-mixed(3,2)*v(285)+v(307)))-mu*(mixed(1,3)*v(286)-mixed(2,3)*v(287)&
      &-mixed(3,3)*v(288)+v(307))+rho*(-f(1)+v(290)+v(294)*v(302)+v(295)*v(339))
  v(367)=v(308)*v(934)
  v(310)=-(mu*(mixed(1,3)*v(283)-mixed(2,3)*v(284)-mixed(3,3)*v(285)+v(309)))-bulk*(mixed(1,1)*v(286)-mixed(2,1)*v(287)&
      &-mixed(3,1)*v(288)+v(309))+rho*(-f(2)+v(291)+v(295)*v(301)+v(294)*v(341))
  v(368)=v(310)*v(934)
  v(328)=rho*v(310)
  v(642)=-(v(285)*v(328))+v(341)*v(498)+v(302)*v(546)
  v(637)=-(v(284)*v(328))+v(341)*v(493)+v(302)*v(541)
  v(632)=v(283)*v(328)+v(341)*v(488)+v(302)*v(536)
  v(627)=-(v(288)*v(328))+v(301)*v(498)+v(339)*v(546)
  v(622)=-(v(287)*v(328))+v(301)*v(493)+v(339)*v(541)
  v(617)=v(286)*v(328)+v(301)*v(488)+v(339)*v(536)
  v(519)=v(328)*v(928)
  v(520)=v(396)+v(294)*v(487)+v(519)
  v(514)=v(328)*xi(2)
  v(530)=v(402)+v(294)*v(497)+v(514)
  v(515)=-v(389)+v(295)*v(498)+v(514)
  v(508)=v(328)*xi(1)
  v(525)=v(399)+v(294)*v(492)+v(508)
  v(509)=-v(388)+v(295)*v(493)+v(508)
  v(503)=-v(387)+v(295)*v(488)+v(519)
  v(363)=v(295)*v(328)-v(354)
  v(362)=v(294)*v(328)+v(353)
  v(329)=rho*v(308)
  v(641)=-(v(285)*v(329))+v(341)*v(497)+v(302)*v(545)
  v(636)=-(v(284)*v(329))+v(341)*v(492)+v(302)*v(540)
  v(631)=v(283)*v(329)+v(341)*v(487)+v(302)*v(535)
  v(626)=-(v(288)*v(329))+v(301)*v(497)+v(339)*v(545)
  v(621)=-(v(287)*v(329))+v(301)*v(492)+v(339)*v(540)
  v(616)=v(286)*v(329)+v(301)*v(487)+v(339)*v(535)
  v(567)=v(329)*v(928)
  v(568)=-v(381)+v(294)*v(535)+v(567)
  v(562)=v(329)*xi(2)
  v(578)=-v(385)+v(294)*v(545)+v(562)
  v(563)=v(403)+v(295)*v(546)+v(562)
  v(556)=v(329)*xi(1)
  v(573)=-v(383)+v(294)*v(540)+v(556)
  v(557)=v(400)+v(295)*v(541)+v(556)
  v(551)=v(397)+v(295)*v(536)+v(567)
  v(360)=v(295)*v(329)+v(353)
  v(359)=v(294)*v(329)-v(350)
  v(331)=v(332)+v(354)
  v(335)=v(332)+v(350)
  v(336)=v(310)*v(927)
  v(338)=v(308)*v(927)
  v(340)=v(301)*v(328)+v(329)*v(339)
  v(342)=v(302)*v(329)+v(328)*v(341)
  b343=steady
  IF(b343) THEN
    v(646)=0d0
    v(647)=0d0
    v(648)=0d0
    v(649)=0d0
    v(650)=0d0
    v(651)=0d0
    v(652)=0d0
    v(653)=0d0
    v(654)=0d0
    v(655)=0d0
    v(656)=0d0
    v(657)=0d0
    v(658)=0d0
    v(659)=0d0
    v(660)=0d0
    v(344)=0d0
    v(661)=0d0
    v(662)=0d0
    v(663)=0d0
    v(664)=0d0
    v(665)=0d0
    v(666)=0d0
    v(667)=0d0
    v(668)=0d0
    v(669)=0d0
    v(670)=0d0
    v(671)=0d0
    v(672)=0d0
    v(673)=0d0
    v(674)=0d0
    v(675)=0d0
    v(345)=0d0
    v(676)=0d0
    v(677)=0d0
    v(678)=0d0
    v(679)=0d0
    v(680)=0d0
    v(681)=0d0
    v(682)=0d0
    v(683)=0d0
    v(684)=0d0
    v(685)=0d0
    v(686)=0d0
    v(687)=0d0
    v(688)=0d0
    v(689)=0d0
    v(690)=0d0
    v(346)=0d0
    v(691)=0d0
    v(692)=0d0
    v(693)=0d0
    v(694)=0d0
    v(695)=0d0
    v(696)=0d0
    v(697)=0d0
    v(698)=0d0
    v(699)=0d0
    v(700)=0d0
    v(701)=0d0
    v(702)=0d0
    v(703)=0d0
    v(704)=0d0
    v(705)=0d0
    v(347)=0d0
    v(706)=0d0
    v(707)=0d0
    v(708)=0d0
    v(709)=0d0
    v(710)=0d0
    v(711)=0d0
    v(712)=0d0
    v(713)=0d0
    v(714)=0d0
    v(715)=0d0
    v(716)=0d0
    v(717)=0d0
    v(718)=0d0
    v(719)=0d0
    v(720)=0d0
    v(348)=0d0
    v(721)=0d0
    v(722)=0d0
    v(723)=0d0
    v(724)=0d0
    v(725)=0d0
    v(726)=0d0
    v(727)=0d0
    v(728)=0d0
    v(729)=0d0
    v(730)=0d0
    v(731)=0d0
    v(732)=0d0
    v(733)=0d0
    v(734)=0d0
    v(735)=0d0
    v(349)=0d0
  ELSE
    v(721)=v(487)*xi(2)
    v(722)=v(488)*xi(2)
    v(723)=v(489)*xi(2)
    v(724)=v(490)*xi(2)
    v(725)=v(491)*xi(2)
    v(726)=v(492)*xi(2)
    v(727)=v(493)*xi(2)
    v(728)=v(494)*xi(2)
    v(729)=v(495)*xi(2)
    v(730)=v(496)*xi(2)
    v(731)=v(497)*xi(2)
    v(732)=v(498)*xi(2)
    v(733)=v(499)*xi(2)
    v(734)=v(500)*xi(2)
    v(735)=v(501)*xi(2)
    v(349)=v(514)
    v(691)=v(487)*xi(1)
    v(692)=v(488)*xi(1)
    v(693)=v(489)*xi(1)
    v(694)=v(490)*xi(1)
    v(695)=v(491)*xi(1)
    v(696)=v(492)*xi(1)
    v(697)=v(493)*xi(1)
    v(698)=v(494)*xi(1)
    v(699)=v(495)*xi(1)
    v(700)=v(496)*xi(1)
    v(701)=v(726)
    v(702)=v(498)*xi(1)
    v(703)=v(499)*xi(1)
    v(704)=v(500)*xi(1)
    v(705)=v(501)*xi(1)
    v(347)=v(508)
    v(661)=v(487)*v(928)
    v(662)=v(488)*v(928)
    v(663)=v(489)*v(928)
    v(664)=v(490)*v(928)
    v(665)=v(491)*v(928)
    v(666)=v(691)
    v(667)=v(493)*v(928)
    v(668)=v(494)*v(928)
    v(669)=v(495)*v(928)
    v(670)=v(496)*v(928)
    v(671)=v(721)
    v(672)=v(498)*v(928)
    v(673)=v(499)*v(928)
    v(674)=v(500)*v(928)
    v(675)=v(501)*v(928)
    v(345)=v(519)
    v(706)=v(535)*xi(2)
    v(707)=v(536)*xi(2)
    v(708)=v(537)*xi(2)
    v(709)=v(538)*xi(2)
    v(710)=v(539)*xi(2)
    v(711)=v(540)*xi(2)
    v(712)=v(541)*xi(2)
    v(713)=v(542)*xi(2)
    v(714)=v(543)*xi(2)
    v(715)=v(544)*xi(2)
    v(716)=v(545)*xi(2)
    v(717)=v(546)*xi(2)
    v(718)=v(547)*xi(2)
    v(719)=v(548)*xi(2)
    v(720)=v(549)*xi(2)
    v(348)=v(562)
    v(676)=v(535)*xi(1)
    v(677)=v(536)*xi(1)
    v(678)=v(537)*xi(1)
    v(679)=v(538)*xi(1)
    v(680)=v(539)*xi(1)
    v(681)=v(540)*xi(1)
    v(682)=v(541)*xi(1)
    v(683)=v(542)*xi(1)
    v(684)=v(543)*xi(1)
    v(685)=v(544)*xi(1)
    v(686)=v(545)*xi(1)
    v(687)=v(712)
    v(688)=v(547)*xi(1)
    v(689)=v(548)*xi(1)
    v(690)=v(549)*xi(1)
    v(346)=v(556)
    v(646)=v(535)*v(928)
    v(647)=v(536)*v(928)
    v(648)=v(537)*v(928)
    v(649)=v(538)*v(928)
    v(650)=v(539)*v(928)
    v(651)=v(540)*v(928)
    v(652)=v(677)
    v(653)=v(542)*v(928)
    v(654)=v(543)*v(928)
    v(655)=v(544)*v(928)
    v(656)=v(545)*v(928)
    v(657)=v(707)
    v(658)=v(547)*v(928)
    v(659)=v(548)*v(928)
    v(660)=v(549)*v(928)
    v(344)=v(567)
  ENDIF
  v(769)=v(413)*v(414)+v(286)*v(588)+v(406)*v(928)
  v(770)=(-(v(286)*v(432))-v(283)*v(474))/2d0
  v(773)=v(451)*v(460)-v(284)*v(603)+v(787)
  v(774)=v(413)*v(421)-v(287)*v(588)+v(406)*xi(1)
  v(775)=(v(287)*v(432)+v(284)*v(474))/2d0
  v(778)=v(451)*v(469)-v(285)*v(603)+v(792)
  v(779)=v(413)*v(428)-v(288)*v(588)+v(406)*xi(2)
  v(780)=(v(288)*v(432)+v(285)*v(474))/2d0
  v(788)=v(414)*v(421)-v(287)*v(589)+v(787)
  v(789)=(v(287)*v(433)+v(284)*v(475))/2d0
  v(793)=v(414)*v(428)-v(288)*v(589)+v(792)
  v(794)=(v(288)*v(433)+v(285)*v(475))/2d0
  v(800)=(v(287)*v(434)+v(284)*v(476))/2d0+v(382)*xi(1)
  v(803)=(v(288)*v(434)+v(285)*v(476))/2d0+v(382)*xi(2)
  v(840)=v(420)*v(421)-v(287)*v(593)+v(407)*xi(1)
  v(841)=(v(287)*v(437)+v(284)*v(479))/2d0
  v(844)=v(460)*v(469)-v(285)*v(608)+v(856)
  v(845)=v(420)*v(428)-v(288)*v(593)+v(407)*xi(2)
  v(846)=(v(288)*v(437)+v(285)*v(479))/2d0
  v(857)=v(421)*v(428)-v(288)*v(594)+v(856)
  v(858)=mu*(v(288)*v(421)+v(285)*v(461))
  v(866)=(v(288)*v(439)+v(285)*v(481))/2d0+v(384)*xi(2)
  v(906)=v(427)*v(428)-v(927)*v(957)+v(408)*xi(2)
  v(907)=mu*(v(288)*v(427)+v(285)*v(469))
  intforce(1)=deriv*v(344)+v(283)*v(359)+v(286)*v(360)+v(342)*v(928)
  intforce(2)=deriv*v(345)+v(283)*v(362)+v(286)*v(363)+v(340)*v(928)
  intforce(3)=v(283)*v(338)+v(310)*v(451)+v(335)*v(928)
  intforce(4)=v(286)*v(336)+v(308)*v(414)+v(331)*v(928)
  intforce(5)=(-(v(286)*v(367))-v(283)*v(368))/2d0+v(351)*v(382)
  intforce(6)=deriv*v(346)-v(284)*v(359)-v(287)*v(360)+v(342)*xi(1)
  intforce(7)=deriv*v(347)-v(284)*v(362)-v(287)*v(363)+v(340)*xi(1)
  intforce(8)=-(v(284)*v(338))+v(310)*v(460)+v(335)*xi(1)
  intforce(9)=-(v(287)*v(336))+v(308)*v(421)+v(331)*xi(1)
  intforce(10)=(v(287)*v(367)+v(284)*v(368))/2d0+v(351)*v(384)
  intforce(11)=deriv*v(348)-v(285)*v(359)-v(288)*v(360)+v(342)*xi(2)
  intforce(12)=deriv*v(349)-v(285)*v(362)-v(288)*v(363)+v(340)*xi(2)
  intforce(13)=-(v(285)*v(338))+v(310)*v(469)+v(335)*xi(2)
  intforce(14)=-(v(288)*v(336))+v(308)*v(428)+v(331)*xi(2)
  intforce(15)=(v(288)*v(367)+v(285)*v(368))/2d0+v(351)*v(386)
  intstiff(1,1)=v(286)*v(550)+v(283)*v(568)+deriv*v(646)+v(631)*v(928)
  intstiff(1,2)=v(286)*v(551)+v(283)*v(569)+deriv*v(647)+v(632)*v(928)
  intstiff(1,3)=v(286)*v(552)+v(283)*v(570)+deriv*v(648)+v(633)*v(928)
  intstiff(1,4)=v(447)*v(538)+v(286)*v(553)+deriv*v(649)+v(634)*v(928)
  intstiff(1,5)=v(286)*v(554)+v(283)*v(572)+deriv*v(650)+v(635)*v(928)
  intstiff(1,6)=v(286)*v(555)+v(283)*v(573)+deriv*v(651)+v(636)*v(928)
  intstiff(1,7)=v(286)*v(557)+v(283)*v(574)+deriv*v(652)+v(637)*v(928)
  intstiff(1,8)=v(286)*v(558)+v(283)*v(575)+deriv*v(653)+v(638)*v(928)
  intstiff(1,9)=v(286)*v(559)+deriv*v(654)+v(847)+v(639)*v(928)
  intstiff(1,10)=v(286)*v(560)+v(283)*v(577)+deriv*v(655)+v(640)*v(928)
  intstiff(1,11)=v(286)*v(561)+v(283)*v(578)+deriv*v(656)+v(641)*v(928)
  intstiff(1,12)=v(286)*v(563)+v(283)*v(579)+deriv*v(657)+v(642)*v(928)
  intstiff(1,13)=v(286)*v(564)+v(283)*v(580)+deriv*v(658)+v(643)*v(928)
  intstiff(1,14)=v(286)*v(565)+deriv*v(659)+v(908)+v(644)*v(928)
  intstiff(1,15)=v(286)*v(566)+v(283)*v(582)+deriv*v(660)+v(645)*v(928)
  intstiff(2,1)=v(286)*v(502)+v(283)*v(520)+deriv*v(661)+v(616)*v(928)
  intstiff(2,2)=v(286)*v(503)+v(283)*v(521)+deriv*v(662)+v(617)*v(928)
  intstiff(2,3)=v(448)*v(489)+v(283)*v(522)+deriv*v(663)+v(618)*v(928)
  intstiff(2,4)=v(286)*v(505)+v(283)*v(523)+deriv*v(664)+v(619)*v(928)
  intstiff(2,5)=v(286)*v(506)+v(283)*v(524)+deriv*v(665)+v(620)*v(928)
  intstiff(2,6)=v(286)*v(507)+v(283)*v(525)+deriv*v(666)+v(621)*v(928)
  intstiff(2,7)=v(286)*v(509)+v(283)*v(526)+deriv*v(667)+v(622)*v(928)
  intstiff(2,8)=v(283)*v(527)+deriv*v(668)+v(835)+v(623)*v(928)
  intstiff(2,9)=v(286)*v(511)+v(283)*v(528)+deriv*v(669)+v(624)*v(928)
  intstiff(2,10)=v(286)*v(512)+v(283)*v(529)+deriv*v(670)+v(625)*v(928)
  intstiff(2,11)=v(286)*v(513)+v(283)*v(530)+deriv*v(671)+v(626)*v(928)
  intstiff(2,12)=v(286)*v(515)+v(283)*v(531)+deriv*v(672)+v(627)*v(928)
  intstiff(2,13)=v(283)*v(532)+deriv*v(673)+v(898)+v(628)*v(928)
  intstiff(2,14)=v(286)*v(517)+v(283)*v(533)+deriv*v(674)+v(629)*v(928)
  intstiff(2,15)=v(286)*v(518)+v(283)*v(534)+deriv*v(675)+v(630)*v(928)
  intstiff(3,1)=v(446)*v(451)+v(283)*v(601)+v(381)*v(928)
  intstiff(3,2)=v(450)*v(451)+v(283)*v(602)
  intstiff(3,3)=(v(451)*v(451))+v(283)*v(603)+v(783)
  intstiff(3,4)=v(769)
  intstiff(3,5)=v(770)
  intstiff(3,6)=v(451)*v(455)+v(283)*v(606)+v(383)*v(928)
  intstiff(3,7)=v(451)*v(459)+v(283)*v(607)
  intstiff(3,8)=v(773)
  intstiff(3,9)=v(774)
  intstiff(3,10)=v(775)
  intstiff(3,11)=v(451)*v(464)+v(283)*v(611)+v(385)*v(928)
  intstiff(3,12)=v(451)*v(468)+v(283)*v(612)
  intstiff(3,13)=v(778)
  intstiff(3,14)=v(779)
  intstiff(3,15)=v(780)
  intstiff(4,1)=v(410)*v(414)+v(286)*v(586)
  intstiff(4,2)=v(412)*v(414)+v(286)*v(587)+v(387)*v(928)
  intstiff(4,3)=v(769)
  intstiff(4,4)=(v(414)*v(414))+v(286)*v(589)+v(783)
  intstiff(4,5)=v(770)
  intstiff(4,6)=v(414)*v(417)+v(286)*v(591)
  intstiff(4,7)=v(414)*v(419)+v(286)*v(592)+v(388)*v(928)
  intstiff(4,8)=v(774)
  intstiff(4,9)=v(788)
  intstiff(4,10)=v(789)
  intstiff(4,11)=v(414)*v(424)+v(286)*v(596)
  intstiff(4,12)=v(414)*v(426)+v(286)*v(597)+v(389)*v(928)
  intstiff(4,13)=v(779)
  intstiff(4,14)=v(793)
  intstiff(4,15)=v(794)
  intstiff(5,1)=v(382)*v(390)+(-(v(286)*v(430))-v(283)*v(472))/2d0
  intstiff(5,2)=v(382)*v(391)+(-(v(286)*v(431))-v(283)*v(473))/2d0
  intstiff(5,3)=v(770)
  intstiff(5,4)=v(770)
  intstiff(5,5)=(-(v(286)*v(434))-v(283)*v(476))/2d0+(v(928)*v(928))*v(929)
  intstiff(5,6)=v(382)*v(392)+(-(v(286)*v(435))-v(283)*v(477))/2d0
  intstiff(5,7)=v(382)*v(393)+(-(v(286)*v(436))-v(283)*v(478))/2d0
  intstiff(5,8)=v(789)
  intstiff(5,9)=v(775)
  intstiff(5,10)=v(800)
  intstiff(5,11)=v(382)*v(394)+(-(v(286)*v(440))-v(283)*v(482))/2d0
  intstiff(5,12)=v(382)*v(395)+(-(v(286)*v(441))-v(283)*v(483))/2d0
  intstiff(5,13)=v(794)
  intstiff(5,14)=v(780)
  intstiff(5,15)=v(803)
  intstiff(6,1)=-(v(287)*v(550))-v(284)*v(568)+deriv*v(676)+v(631)*xi(1)
  intstiff(6,2)=-(v(287)*v(551))-v(284)*v(569)+deriv*v(677)+v(632)*xi(1)
  intstiff(6,3)=-(v(287)*v(552))-v(284)*v(570)+deriv*v(678)+v(633)*xi(1)
  intstiff(6,4)=-(v(287)*v(553))+deriv*v(679)+v(847)+v(634)*xi(1)
  intstiff(6,5)=-(v(287)*v(554))-v(284)*v(572)+deriv*v(680)+v(635)*xi(1)
  intstiff(6,6)=-(v(287)*v(555))-v(284)*v(573)+deriv*v(681)+v(636)*xi(1)
  intstiff(6,7)=-(v(287)*v(557))-v(284)*v(574)+deriv*v(682)+v(637)*xi(1)
  intstiff(6,8)=-(v(287)*v(558))-v(284)*v(575)+deriv*v(683)+v(638)*xi(1)
  intstiff(6,9)=-(v(287)*v(559))-v(284)*v(576)+deriv*v(684)+v(639)*xi(1)
  intstiff(6,10)=-(v(287)*v(560))-v(284)*v(577)+deriv*v(685)+v(640)*xi(1)
  intstiff(6,11)=-(v(287)*v(561))-v(284)*v(578)+deriv*v(686)+v(641)*xi(1)
  intstiff(6,12)=-(v(287)*v(563))-v(284)*v(579)+deriv*v(687)+v(642)*xi(1)
  intstiff(6,13)=-(v(287)*v(564))-v(284)*v(580)+deriv*v(688)+v(643)*xi(1)
  intstiff(6,14)=-(v(287)*v(565))+deriv*v(689)+v(911)+v(644)*xi(1)
  intstiff(6,15)=-(v(287)*v(566))-v(284)*v(582)+deriv*v(690)+v(645)*xi(1)
  intstiff(7,1)=-(v(287)*v(502))-v(284)*v(520)+deriv*v(691)+v(616)*xi(1)
  intstiff(7,2)=-(v(287)*v(503))-v(284)*v(521)+deriv*v(692)+v(617)*xi(1)
  intstiff(7,3)=-(v(284)*v(522))+deriv*v(693)+v(835)+v(618)*xi(1)
  intstiff(7,4)=-(v(287)*v(505))-v(284)*v(523)+deriv*v(694)+v(619)*xi(1)
  intstiff(7,5)=-(v(287)*v(506))-v(284)*v(524)+deriv*v(695)+v(620)*xi(1)
  intstiff(7,6)=-(v(287)*v(507))-v(284)*v(525)+deriv*v(696)+v(621)*xi(1)
  intstiff(7,7)=-(v(287)*v(509))-v(284)*v(526)+deriv*v(697)+v(622)*xi(1)
  intstiff(7,8)=-(v(287)*v(510))-v(284)*v(527)+deriv*v(698)+v(623)*xi(1)
  intstiff(7,9)=-(v(287)*v(511))-v(284)*v(528)+deriv*v(699)+v(624)*xi(1)
  intstiff(7,10)=-(v(287)*v(512))-v(284)*v(529)+deriv*v(700)+v(625)*xi(1)
  intstiff(7,11)=-(v(287)*v(513))-v(284)*v(530)+deriv*v(701)+v(626)*xi(1)
  intstiff(7,12)=-(v(287)*v(515))-v(284)*v(531)+deriv*v(702)+v(627)*xi(1)
  intstiff(7,13)=-(v(284)*v(532))+deriv*v(703)+v(901)+v(628)*xi(1)
  intstiff(7,14)=-(v(287)*v(517))-v(284)*v(533)+deriv*v(704)+v(629)*xi(1)
  intstiff(7,15)=-(v(287)*v(518))-v(284)*v(534)+deriv*v(705)+v(630)*xi(1)
  intstiff(8,1)=v(446)*v(460)-v(284)*v(601)+v(381)*xi(1)
  intstiff(8,2)=v(450)*v(460)-v(284)*v(602)
  intstiff(8,3)=v(773)
  intstiff(8,4)=v(774)
  intstiff(8,5)=v(789)
  intstiff(8,6)=v(455)*v(460)-v(284)*v(606)+v(383)*xi(1)
  intstiff(8,7)=v(459)*v(460)-v(284)*v(607)
  intstiff(8,8)=(v(460)*v(460))-v(284)*v(608)+v(852)
  intstiff(8,9)=v(840)
  intstiff(8,10)=v(841)
  intstiff(8,11)=v(460)*v(464)-v(284)*v(611)+v(385)*xi(1)
  intstiff(8,12)=v(460)*v(468)-v(284)*v(612)
  intstiff(8,13)=v(844)
  intstiff(8,14)=v(845)
  intstiff(8,15)=v(846)
  intstiff(9,1)=v(410)*v(421)-v(287)*v(586)
  intstiff(9,2)=v(412)*v(421)-v(287)*v(587)+v(387)*xi(1)
  intstiff(9,3)=v(774)
  intstiff(9,4)=v(788)
  intstiff(9,5)=v(775)
  intstiff(9,6)=v(417)*v(421)-v(287)*v(591)
  intstiff(9,7)=v(419)*v(421)-v(287)*v(592)+v(388)*xi(1)
  intstiff(9,8)=v(840)
  intstiff(9,9)=(v(421)*v(421))-v(287)*v(594)+v(852)
  intstiff(9,10)=v(841)
  intstiff(9,11)=v(421)*v(424)-v(287)*v(596)
  intstiff(9,12)=v(421)*v(426)-v(287)*v(597)+v(389)*xi(1)
  intstiff(9,13)=v(845)
  intstiff(9,14)=v(857)
  intstiff(9,15)=v(858)
  intstiff(10,1)=v(384)*v(390)+(v(287)*v(430)+v(284)*v(472))/2d0
  intstiff(10,2)=v(384)*v(391)+(v(287)*v(431)+v(284)*v(473))/2d0
  intstiff(10,3)=v(775)
  intstiff(10,4)=v(789)
  intstiff(10,5)=v(800)
  intstiff(10,6)=v(384)*v(392)+(v(287)*v(435)+v(284)*v(477))/2d0
  intstiff(10,7)=v(384)*v(393)+(v(287)*v(436)+v(284)*v(478))/2d0
  intstiff(10,8)=v(841)
  intstiff(10,9)=v(841)
  intstiff(10,10)=(v(287)*v(439)+v(284)*v(481))/2d0+v(929)*xi(1)**2
  intstiff(10,11)=v(384)*v(394)+(v(287)*v(440)+v(284)*v(482))/2d0
  intstiff(10,12)=v(384)*v(395)+(v(287)*v(441)+v(284)*v(483))/2d0
  intstiff(10,13)=v(858)
  intstiff(10,14)=v(846)
  intstiff(10,15)=v(866)
  intstiff(11,1)=-(v(288)*v(550))-v(285)*v(568)+deriv*v(706)+v(631)*xi(2)
  intstiff(11,2)=-(v(288)*v(551))-v(285)*v(569)+deriv*v(707)+v(632)*xi(2)
  intstiff(11,3)=-(v(288)*v(552))-v(285)*v(570)+deriv*v(708)+v(633)*xi(2)
  intstiff(11,4)=-(v(288)*v(553))+deriv*v(709)+v(908)+v(634)*xi(2)
  intstiff(11,5)=-(v(288)*v(554))-v(285)*v(572)+deriv*v(710)+v(635)*xi(2)
  intstiff(11,6)=-(v(288)*v(555))-v(285)*v(573)+deriv*v(711)+v(636)*xi(2)
  intstiff(11,7)=-(v(288)*v(557))-v(285)*v(574)+deriv*v(712)+v(637)*xi(2)
  intstiff(11,8)=-(v(288)*v(558))-v(285)*v(575)+deriv*v(713)+v(638)*xi(2)
  intstiff(11,9)=-(v(288)*v(559))+deriv*v(714)+v(911)+v(639)*xi(2)
  intstiff(11,10)=-(v(288)*v(560))-v(285)*v(577)+deriv*v(715)+v(640)*xi(2)
  intstiff(11,11)=-(v(288)*v(561))-v(285)*v(578)+deriv*v(716)+v(641)*xi(2)
  intstiff(11,12)=-(v(288)*v(563))-v(285)*v(579)+deriv*v(717)+v(642)*xi(2)
  intstiff(11,13)=-(v(288)*v(564))-v(285)*v(580)+deriv*v(718)+v(643)*xi(2)
  intstiff(11,14)=-(v(288)*v(565))-v(285)*v(581)+deriv*v(719)+v(644)*xi(2)
  intstiff(11,15)=-(v(288)*v(566))-v(285)*v(582)+deriv*v(720)+v(645)*xi(2)
  intstiff(12,1)=-(v(288)*v(502))-v(285)*v(520)+deriv*v(721)+v(616)*xi(2)
  intstiff(12,2)=-(v(288)*v(503))-v(285)*v(521)+deriv*v(722)+v(617)*xi(2)
  intstiff(12,3)=-(v(285)*v(522))+deriv*v(723)+v(898)+v(618)*xi(2)
  intstiff(12,4)=-(v(288)*v(505))-v(285)*v(523)+deriv*v(724)+v(619)*xi(2)
  intstiff(12,5)=-(v(288)*v(506))-v(285)*v(524)+deriv*v(725)+v(620)*xi(2)
  intstiff(12,6)=-(v(288)*v(507))-v(285)*v(525)+deriv*v(726)+v(621)*xi(2)
  intstiff(12,7)=-(v(288)*v(509))-v(285)*v(526)+deriv*v(727)+v(622)*xi(2)
  intstiff(12,8)=-(v(285)*v(527))+deriv*v(728)+v(901)+v(623)*xi(2)
  intstiff(12,9)=-(v(288)*v(511))-v(285)*v(528)+deriv*v(729)+v(624)*xi(2)
  intstiff(12,10)=-(v(288)*v(512))-v(285)*v(529)+deriv*v(730)+v(625)*xi(2)
  intstiff(12,11)=-(v(288)*v(513))-v(285)*v(530)+deriv*v(731)+v(626)*xi(2)
  intstiff(12,12)=-(v(288)*v(515))-v(285)*v(531)+deriv*v(732)+v(627)*xi(2)
  intstiff(12,13)=-(v(288)*v(516))-v(285)*v(532)+deriv*v(733)+v(628)*xi(2)
  intstiff(12,14)=-(v(288)*v(517))-v(285)*v(533)+deriv*v(734)+v(629)*xi(2)
  intstiff(12,15)=-(v(288)*v(518))-v(285)*v(534)+deriv*v(735)+v(630)*xi(2)
  intstiff(13,1)=v(446)*v(469)-v(285)*v(601)+v(381)*xi(2)
  intstiff(13,2)=v(450)*v(469)-v(285)*v(602)
  intstiff(13,3)=v(778)
  intstiff(13,4)=v(779)
  intstiff(13,5)=v(794)
  intstiff(13,6)=v(455)*v(469)-v(285)*v(606)+v(383)*xi(2)
  intstiff(13,7)=v(459)*v(469)-v(285)*v(607)
  intstiff(13,8)=v(844)
  intstiff(13,9)=v(845)
  intstiff(13,10)=v(858)
  intstiff(13,11)=v(464)*v(469)-v(285)*v(611)+v(385)*xi(2)
  intstiff(13,12)=v(468)*v(469)-v(285)*v(612)
  intstiff(13,13)=v(916)-v(285)*v(427)*v(927)+bulk*v(957)
  intstiff(13,14)=v(906)
  intstiff(13,15)=v(907)
  intstiff(14,1)=v(410)*v(428)-v(288)*v(586)
  intstiff(14,2)=v(412)*v(428)-v(288)*v(587)+v(387)*xi(2)
  intstiff(14,3)=v(779)
  intstiff(14,4)=v(793)
  intstiff(14,5)=v(780)
  intstiff(14,6)=v(417)*v(428)-v(288)*v(591)
  intstiff(14,7)=v(419)*v(428)-v(288)*v(592)+v(388)*xi(2)
  intstiff(14,8)=v(845)
  intstiff(14,9)=v(857)
  intstiff(14,10)=v(846)
  intstiff(14,11)=v(424)*v(428)-v(288)*v(596)
  intstiff(14,12)=v(426)*v(428)-v(288)*v(597)+v(389)*xi(2)
  intstiff(14,13)=v(906)
  intstiff(14,14)=(v(428)*v(428))+v(916)-v(288)*v(470)*v(927)
  intstiff(14,15)=v(907)
  intstiff(15,1)=v(386)*v(390)+(v(288)*v(430)+v(285)*v(472))/2d0
  intstiff(15,2)=v(386)*v(391)+(v(288)*v(431)+v(285)*v(473))/2d0
  intstiff(15,3)=v(780)
  intstiff(15,4)=v(794)
  intstiff(15,5)=v(803)
  intstiff(15,6)=v(386)*v(392)+(v(288)*v(435)+v(285)*v(477))/2d0
  intstiff(15,7)=v(386)*v(393)+(v(288)*v(436)+v(285)*v(478))/2d0
  intstiff(15,8)=v(846)
  intstiff(15,9)=v(858)
  intstiff(15,10)=v(866)
  intstiff(15,11)=v(386)*v(394)+(v(288)*v(440)+v(285)*v(482))/2d0
  intstiff(15,12)=v(386)*v(395)+(v(288)*v(441)+v(285)*v(483))/2d0
  intstiff(15,13)=v(907)
  intstiff(15,14)=v(907)
  intstiff(15,15)=mu*(v(288)*v(429)+v(285)*v(471))+v(929)*xi(2)**2
END SUBROUTINE fluid2dleastsquares

!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           4 May 23 18:49:40  *
!**************************************************************
! User     : Full professional version
! Notebook : fluid2dmeshless
! Evaluation time                 : 966 s   Mode  : Optimal
! Number of formulae              : 1465    Method: Automatic
! Subroutine                      : fluid2dmeshless size: 42894
! Total size of Mathematica  code : 42894 subexpressions
! Total size of Fortran code      : 114248 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE fluid2dmeshless(steady,frozen,deriv,dtime,vol,h,rho,mu,f,ffor,der,der2,pnew,acel,vold,vnew,xi,intforce,intstiff)
  IMPLICIT NONE
  LOGICAL steady,frozen,b1513,b1528
  DOUBLE PRECISION v(4198),deriv,dtime,vol,h,rho,mu,f(2),ffor(12),der(2,12),der2(2,2,12),pnew(12),acel(12,2)&
      &,vold(12,2),vnew(12,2),xi(2),intforce(36),intstiff(36,36)
  v(4109)=-(f(2)*rho)
  v(4108)=-(f(1)*rho)
  v(4083)=der(2,11)*der(2,12)
  v(4082)=der(1,11)*der(1,12)
  v(4081)=der(2,10)*der(2,12)
  v(4080)=der(1,10)*der(1,12)
  v(4079)=der(2,10)*der(2,11)
  v(4078)=der(1,10)*der(1,11)
  v(4077)=der(2,12)*der(2,9)
  v(4076)=der(1,12)*der(1,9)
  v(4075)=der(2,11)*der(2,9)
  v(4074)=der(1,11)*der(1,9)
  v(4073)=der(2,10)*der(2,9)
  v(4072)=der(1,10)*der(1,9)
  v(4071)=der(2,12)*der(2,8)
  v(4070)=der(1,12)*der(1,8)
  v(4069)=der(2,11)*der(2,8)
  v(4068)=der(1,11)*der(1,8)
  v(4067)=der(2,10)*der(2,8)
  v(4066)=der(1,10)*der(1,8)
  v(4065)=der(2,8)*der(2,9)
  v(4064)=der(1,8)*der(1,9)
  v(4063)=der(2,12)*der(2,7)
  v(4062)=der(1,12)*der(1,7)
  v(4061)=der(2,11)*der(2,7)
  v(4060)=der(1,11)*der(1,7)
  v(4059)=der(2,10)*der(2,7)
  v(4058)=der(1,10)*der(1,7)
  v(4057)=der(2,7)*der(2,9)
  v(4056)=der(1,7)*der(1,9)
  v(4055)=der(2,7)*der(2,8)
  v(4054)=der(1,7)*der(1,8)
  v(4053)=der(2,12)*der(2,6)
  v(4052)=der(1,12)*der(1,6)
  v(4051)=der(2,11)*der(2,6)
  v(4050)=der(1,11)*der(1,6)
  v(4049)=der(2,10)*der(2,6)
  v(4048)=der(1,10)*der(1,6)
  v(4047)=der(2,6)*der(2,9)
  v(4046)=der(1,6)*der(1,9)
  v(4045)=der(2,6)*der(2,8)
  v(4044)=der(1,6)*der(1,8)
  v(4043)=der(2,6)*der(2,7)
  v(4042)=der(1,6)*der(1,7)
  v(4041)=der(2,12)*der(2,5)
  v(4040)=der(1,12)*der(1,5)
  v(4039)=der(2,11)*der(2,5)
  v(4038)=der(1,11)*der(1,5)
  v(4037)=der(2,10)*der(2,5)
  v(4036)=der(1,10)*der(1,5)
  v(4035)=der(2,5)*der(2,9)
  v(4034)=der(1,5)*der(1,9)
  v(4033)=der(2,5)*der(2,8)
  v(4032)=der(1,5)*der(1,8)
  v(4031)=der(2,5)*der(2,7)
  v(4030)=der(1,5)*der(1,7)
  v(4029)=der(2,5)*der(2,6)
  v(4028)=der(1,5)*der(1,6)
  v(4027)=der(2,12)*der(2,4)
  v(4026)=der(1,12)*der(1,4)
  v(4025)=der(2,11)*der(2,4)
  v(4024)=der(1,11)*der(1,4)
  v(4023)=der(2,10)*der(2,4)
  v(4022)=der(1,10)*der(1,4)
  v(4021)=der(2,4)*der(2,9)
  v(4020)=der(1,4)*der(1,9)
  v(4019)=der(2,4)*der(2,8)
  v(4018)=der(1,4)*der(1,8)
  v(4017)=der(2,4)*der(2,7)
  v(4016)=der(1,4)*der(1,7)
  v(4015)=der(2,4)*der(2,6)
  v(4014)=der(1,4)*der(1,6)
  v(4013)=der(2,4)*der(2,5)
  v(4012)=der(1,4)*der(1,5)
  v(4011)=der(2,12)*der(2,3)
  v(4010)=der(1,12)*der(1,3)
  v(4009)=der(2,11)*der(2,3)
  v(4008)=der(1,11)*der(1,3)
  v(4007)=der(2,10)*der(2,3)
  v(4006)=der(1,10)*der(1,3)
  v(4005)=der(2,3)*der(2,9)
  v(4004)=der(1,3)*der(1,9)
  v(4003)=der(2,3)*der(2,8)
  v(4002)=der(1,3)*der(1,8)
  v(4001)=der(2,3)*der(2,7)
  v(4000)=der(1,3)*der(1,7)
  v(3999)=der(2,3)*der(2,6)
  v(3998)=der(1,3)*der(1,6)
  v(3997)=der(2,3)*der(2,5)
  v(3996)=der(1,3)*der(1,5)
  v(3995)=der(2,3)*der(2,4)
  v(3994)=der(1,3)*der(1,4)
  v(3993)=der(2,12)*der(2,2)
  v(3992)=der(1,12)*der(1,2)
  v(3991)=der(2,11)*der(2,2)
  v(3990)=der(1,11)*der(1,2)
  v(3989)=der(2,10)*der(2,2)
  v(3988)=der(1,10)*der(1,2)
  v(3987)=der(2,2)*der(2,9)
  v(3986)=der(1,2)*der(1,9)
  v(3985)=der(2,2)*der(2,8)
  v(3984)=der(1,2)*der(1,8)
  v(3983)=der(2,2)*der(2,7)
  v(3982)=der(1,2)*der(1,7)
  v(3981)=der(2,2)*der(2,6)
  v(3980)=der(1,2)*der(1,6)
  v(3979)=der(2,2)*der(2,5)
  v(3978)=der(1,2)*der(1,5)
  v(3977)=der(2,2)*der(2,4)
  v(3976)=der(1,2)*der(1,4)
  v(3975)=der(2,2)*der(2,3)
  v(3974)=der(1,2)*der(1,3)
  v(3973)=der(2,1)*der(2,12)
  v(3972)=der(1,1)*der(1,12)
  v(3971)=der(2,1)*der(2,11)
  v(3970)=der(1,1)*der(1,11)
  v(3969)=der(2,1)*der(2,10)
  v(3968)=der(1,1)*der(1,10)
  v(3967)=der(2,1)*der(2,9)
  v(3966)=der(1,1)*der(1,9)
  v(3965)=der(2,1)*der(2,8)
  v(3964)=der(1,1)*der(1,8)
  v(3963)=der(2,1)*der(2,7)
  v(3962)=der(1,1)*der(1,7)
  v(3961)=der(2,1)*der(2,6)
  v(3960)=der(1,1)*der(1,6)
  v(3959)=der(2,1)*der(2,5)
  v(3958)=der(1,1)*der(1,5)
  v(3957)=der(2,1)*der(2,4)
  v(3956)=der(1,1)*der(1,4)
  v(3955)=der(2,1)*der(2,3)
  v(3954)=der(1,1)*der(1,3)
  v(3953)=der(2,1)*der(2,2)
  v(3952)=der(1,1)*der(1,2)
  v(3937)=1d0/h**2
  v(3936)=(16d0*mu**2)/(h**4*rho**2)
  v(3935)=4d0/dtime**2
  v(3934)=1d0/rho
  v(3933)=der(1,12)*pnew(12)
  v(3932)=der(1,11)*pnew(11)
  v(3931)=der(1,10)*pnew(10)
  v(3930)=der(1,9)*pnew(9)
  v(3929)=der(1,8)*pnew(8)
  v(3928)=der(1,7)*pnew(7)
  v(3927)=der(1,6)*pnew(6)
  v(3926)=der(1,5)*pnew(5)
  v(3925)=der(1,4)*pnew(4)
  v(3924)=der(1,3)*pnew(3)
  v(3923)=der(1,2)*pnew(2)
  v(3922)=der(1,1)*pnew(1)
  v(3921)=der(2,12)*pnew(12)
  v(3920)=der(2,11)*pnew(11)
  v(3919)=der(2,10)*pnew(10)
  v(3918)=der(2,9)*pnew(9)
  v(3917)=der(2,8)*pnew(8)
  v(3916)=der(2,7)*pnew(7)
  v(3915)=der(2,6)*pnew(6)
  v(3914)=der(2,5)*pnew(5)
  v(3913)=der(2,4)*pnew(4)
  v(3912)=der(2,3)*pnew(3)
  v(3911)=der(2,2)*pnew(2)
  v(3910)=der(2,1)*pnew(1)
  v(3893)=ffor(12)
  v(3892)=ffor(11)
  v(3891)=ffor(10)
  v(3890)=ffor(9)
  v(3889)=ffor(8)
  v(3888)=ffor(7)
  v(3887)=ffor(6)
  v(3886)=ffor(5)
  v(3885)=ffor(4)
  v(3884)=ffor(3)
  v(3883)=ffor(2)
  v(3882)=ffor(1)
  v(3881)=ffor(1)*pnew(1)+ffor(10)*pnew(10)+ffor(11)*pnew(11)+ffor(12)*pnew(12)+ffor(2)*pnew(2)+ffor(3)*pnew(3)+ffor(4&
      &)*pnew(4)+ffor(5)*pnew(5)+ffor(6)*pnew(6)+ffor(7)*pnew(7)+ffor(8)*pnew(8)+ffor(9)*pnew(9)
  v(3880)=der(2,10)*vnew(10,2)+der(2,11)*vnew(11,2)+der(2,1)*vnew(1,2)+der(2,12)*vnew(12,2)+der(2,2)*vnew(2,2)+der(2,3&
      &)*vnew(3,2)+der(2,4)*vnew(4,2)+der(2,5)*vnew(5,2)+der(2,6)*vnew(6,2)+der(2,7)*vnew(7,2)+der(2,8)*vnew(8,2)+der(2,9&
      &)*vnew(9,2)
  v(3879)=der(1,10)*vnew(10,1)+der(1,1)*vnew(1,1)+der(1,11)*vnew(11,1)+der(1,12)*vnew(12,1)+der(1,2)*vnew(2,1)+der(1,3&
      &)*vnew(3,1)+der(1,4)*vnew(4,1)+der(1,5)*vnew(5,1)+der(1,6)*vnew(6,1)+der(1,7)*vnew(7,1)+der(1,8)*vnew(8,1)+der(1,9&
      &)*vnew(9,1)
  v(3878)=ffor(10)*vold(10,2)+ffor(11)*vold(11,2)+ffor(1)*vold(1,2)+ffor(12)*vold(12,2)+ffor(2)*vold(2,2)+ffor(3)*vold(3&
      &,2)+ffor(4)*vold(4,2)+ffor(5)*vold(5,2)+ffor(6)*vold(6,2)+ffor(7)*vold(7,2)+ffor(8)*vold(8,2)+ffor(9)*vold(9,2)
  v(3877)=ffor(10)*vold(10,1)+ffor(1)*vold(1,1)+ffor(11)*vold(11,1)+ffor(12)*vold(12,1)+ffor(2)*vold(2,1)+ffor(3)*vold(3&
      &,1)+ffor(4)*vold(4,1)+ffor(5)*vold(5,1)+ffor(6)*vold(6,1)+ffor(7)*vold(7,1)+ffor(8)*vold(8,1)+ffor(9)*vold(9,1)
  v(3874)=der(1,10)*vnew(10,2)+der(1,11)*vnew(11,2)+der(1,1)*vnew(1,2)+der(1,12)*vnew(12,2)+der(1,2)*vnew(2,2)+der(1,3&
      &)*vnew(3,2)+der(1,4)*vnew(4,2)+der(1,5)*vnew(5,2)+der(1,6)*vnew(6,2)+der(1,7)*vnew(7,2)+der(1,8)*vnew(8,2)+der(1,9&
      &)*vnew(9,2)
  v(3908)=rho*v(3874)
  v(3873)=der(2,10)*vnew(10,1)+der(2,1)*vnew(1,1)+der(2,11)*vnew(11,1)+der(2,12)*vnew(12,1)+der(2,2)*vnew(2,1)+der(2,3&
      &)*vnew(3,1)+der(2,4)*vnew(4,1)+der(2,5)*vnew(5,1)+der(2,6)*vnew(6,1)+der(2,7)*vnew(7,1)+der(2,8)*vnew(8,1)+der(2,9&
      &)*vnew(9,1)
  v(3909)=rho*v(3873)
  v(3872)=der2(2,2,12)
  v(4107)=2d0*v(3872)
  v(3871)=der2(2,2,11)
  v(4106)=2d0*v(3871)
  v(3870)=der2(2,2,10)
  v(4105)=2d0*v(3870)
  v(3869)=der2(2,2,9)
  v(4104)=2d0*v(3869)
  v(3868)=der2(2,2,8)
  v(4103)=2d0*v(3868)
  v(3867)=der2(2,2,7)
  v(4102)=2d0*v(3867)
  v(3866)=der2(2,2,6)
  v(4101)=2d0*v(3866)
  v(3865)=der2(2,2,5)
  v(4100)=2d0*v(3865)
  v(3864)=der2(2,2,4)
  v(4099)=2d0*v(3864)
  v(3863)=der2(2,2,3)
  v(4098)=2d0*v(3863)
  v(3862)=der2(2,2,2)
  v(3861)=der2(2,2,1)
  v(3860)=der2(2,1,12)
  v(3859)=der2(2,1,11)
  v(3858)=der2(2,1,10)
  v(3857)=der2(2,1,9)
  v(3856)=der2(2,1,8)
  v(3855)=der2(2,1,7)
  v(3854)=der2(2,1,6)
  v(3853)=der2(2,1,5)
  v(3852)=der2(2,1,4)
  v(3851)=der2(2,1,3)
  v(3850)=der2(2,1,2)
  v(3849)=der2(2,1,1)
  v(3848)=der2(1,2,12)
  v(3847)=der2(1,2,11)
  v(3846)=der2(1,2,10)
  v(3845)=der2(1,2,9)
  v(3844)=der2(1,2,8)
  v(3843)=der2(1,2,7)
  v(3842)=der2(1,2,6)
  v(3841)=der2(1,2,5)
  v(3840)=der2(1,2,4)
  v(3839)=der2(1,2,3)
  v(3838)=der2(1,2,2)
  v(3837)=der2(1,2,1)
  v(3836)=der2(1,1,12)
  v(4093)=2d0*v(3836)
  v(3835)=der2(1,1,11)
  v(4092)=2d0*v(3835)
  v(3834)=der2(1,1,10)
  v(4091)=2d0*v(3834)
  v(3833)=der2(1,1,9)
  v(4090)=2d0*v(3833)
  v(3832)=der2(1,1,8)
  v(4089)=2d0*v(3832)
  v(3831)=der2(1,1,7)
  v(4088)=2d0*v(3831)
  v(3830)=der2(1,1,6)
  v(4087)=2d0*v(3830)
  v(3829)=der2(1,1,5)
  v(4086)=2d0*v(3829)
  v(3828)=der2(1,1,4)
  v(4085)=2d0*v(3828)
  v(3827)=der2(1,1,3)
  v(4084)=2d0*v(3827)
  v(3826)=der2(1,1,2)
  v(4097)=v(3826)+2d0*v(3862)
  v(4095)=2d0*v(3826)+v(3862)
  v(3825)=der2(1,1,1)
  v(4096)=v(3825)+2d0*v(3861)
  v(4094)=2d0*v(3825)+v(3861)
  v(3823)=der(2,12)/2d0
  v(3824)=v(3823)*vol
  v(3822)=der(2,12)*vol
  v(3821)=-(ffor(12)*v(3822))
  v(3820)=der(2,12)**2
  v(3818)=der(2,11)/2d0
  v(3819)=v(3818)*vol
  v(3816)=-(der(2,11)*vol)
  v(3815)=der(2,11)**2
  v(3814)=ffor(12)*v(3816)
  v(3812)=der(2,10)/2d0
  v(3813)=v(3812)*vol
  v(3810)=der(2,10)**2
  v(3809)=-(der(2,10)*vol)
  v(3808)=ffor(12)*v(3809)
  v(3806)=der(2,9)/2d0
  v(3807)=v(3806)*vol
  v(3804)=der(2,9)**2
  v(3803)=-(der(2,9)*vol)
  v(3802)=ffor(12)*v(3803)
  v(3800)=der(2,8)/2d0
  v(3801)=v(3800)*vol
  v(3798)=der(2,8)**2
  v(3797)=-(der(2,8)*vol)
  v(3796)=ffor(12)*v(3797)
  v(3794)=der(2,7)/2d0
  v(3795)=v(3794)*vol
  v(3792)=der(2,7)**2
  v(3791)=-(der(2,7)*vol)
  v(3790)=ffor(12)*v(3791)
  v(3788)=der(2,6)/2d0
  v(3789)=v(3788)*vol
  v(3786)=der(2,6)**2
  v(3785)=-(der(2,6)*vol)
  v(3784)=ffor(12)*v(3785)
  v(3782)=der(2,5)/2d0
  v(3783)=v(3782)*vol
  v(3780)=der(2,5)**2
  v(3779)=-(der(2,5)*vol)
  v(3778)=ffor(12)*v(3779)
  v(3775)=der(2,4)/2d0
  v(3776)=v(3775)*vol
  v(3773)=der(2,4)**2
  v(3772)=-(der(2,4)*vol)
  v(3771)=ffor(12)*v(3772)
  v(3769)=der(2,3)/2d0
  v(3770)=v(3769)*vol
  v(3767)=der(2,3)**2
  v(3766)=-(der(2,3)*vol)
  v(3765)=ffor(12)*v(3766)
  v(3764)=der(2,2)/2d0
  v(3762)=der(2,2)**2
  v(3761)=-(der(2,2)*vol)
  v(3760)=ffor(12)*v(3761)
  v(3758)=der(2,1)**2
  v(3757)=-(der(2,1)*vol)
  v(3756)=ffor(12)*v(3757)
  v(3755)=der(1,12)/2d0
  v(3754)=der(1,12)*vol
  v(3753)=-(ffor(12)*v(3754))
  v(3752)=der(1,12)**2
  v(3751)=der(1,11)/2d0
  v(3750)=-(der(1,11)*vol)
  v(3749)=der(1,11)**2
  v(3748)=ffor(12)*v(3750)
  v(3747)=der(1,10)/2d0
  v(3746)=der(1,10)**2
  v(3745)=-(der(1,10)*vol)
  v(3744)=ffor(12)*v(3745)
  v(3743)=der(1,9)/2d0
  v(3742)=der(1,9)**2
  v(3741)=-(der(1,9)*vol)
  v(3740)=ffor(12)*v(3741)
  v(3739)=der(1,8)/2d0
  v(3738)=der(1,8)**2
  v(3737)=-(der(1,8)*vol)
  v(3736)=ffor(12)*v(3737)
  v(3735)=der(1,7)/2d0
  v(3734)=der(1,7)**2
  v(3733)=-(der(1,7)*vol)
  v(3732)=ffor(12)*v(3733)
  v(3731)=der(1,6)/2d0
  v(3730)=der(1,6)**2
  v(3729)=-(der(1,6)*vol)
  v(3728)=ffor(12)*v(3729)
  v(3727)=der(1,5)/2d0
  v(3726)=der(1,5)**2
  v(3725)=-(der(1,5)*vol)
  v(3724)=ffor(12)*v(3725)
  v(3723)=der(1,4)/2d0
  v(3722)=der(1,4)**2
  v(3721)=-(der(1,4)*vol)
  v(3720)=ffor(12)*v(3721)
  v(3719)=der(1,3)/2d0
  v(3718)=der(1,3)**2
  v(3717)=-(der(1,3)*vol)
  v(3716)=ffor(12)*v(3717)
  v(3715)=der(1,2)/2d0
  v(3714)=2d0*mu
  v(3713)=der(1,2)**2
  v(3712)=-(der(1,2)*vol)
  v(3711)=ffor(12)*v(3712)
  v(3710)=der(1,1)/2d0
  v(3709)=der(1,1)*v(3714)
  v(3777)=v(3709)*vol
  v(3708)=der(1,1)**2
  v(3707)=-(der(1,1)*vol)
  v(3706)=ffor(12)*v(3707)
  v(3705)=deriv*ffor(12)
  v(3704)=deriv*ffor(11)
  v(3703)=deriv*ffor(10)
  v(3702)=deriv*ffor(9)
  v(3701)=deriv*ffor(8)
  v(3700)=deriv*ffor(7)
  v(3699)=deriv*ffor(6)
  v(3698)=deriv*ffor(5)
  v(3697)=deriv*ffor(4)
  v(3696)=deriv*ffor(3)
  v(3695)=deriv*ffor(2)
  v(3694)=rho*vol
  v(3693)=deriv*ffor(1)
  v(3692)=ffor(1)*v(3694)
  v(3691)=rho**2
  v(1790)=v(3694)*v(3883)
  v(1992)=v(3694)*v(3884)
  v(2130)=v(3694)*v(3885)
  v(2275)=v(3694)*v(3886)
  v(2427)=v(3694)*v(3887)
  v(2586)=v(3694)*v(3888)
  v(2752)=v(3694)*v(3889)
  v(2925)=v(3694)*v(3890)
  v(3105)=v(3694)*v(3891)
  v(3292)=v(3694)*v(3892)
  v(3486)=v(3694)*v(3893)
  v(3431)=ffor(11)*v(3707)
  v(3238)=ffor(10)*v(3707)
  v(3052)=ffor(9)*v(3707)
  v(2873)=ffor(8)*v(3707)
  v(2701)=ffor(7)*v(3707)
  v(2536)=ffor(6)*v(3707)
  v(2378)=ffor(5)*v(3707)
  v(2227)=ffor(4)*v(3707)
  v(2083)=ffor(3)*v(3707)
  v(1897)=ffor(2)*v(3707)
  v(1745)=v(3707)*v(3882)
  v(3435)=ffor(11)*v(3712)
  v(3242)=ffor(10)*v(3712)
  v(3056)=ffor(9)*v(3712)
  v(2877)=ffor(8)*v(3712)
  v(2705)=ffor(7)*v(3712)
  v(2540)=ffor(6)*v(3712)
  v(2382)=ffor(5)*v(3712)
  v(2231)=ffor(4)*v(3712)
  v(2087)=ffor(3)*v(3712)
  v(1905)=ffor(2)*v(3712)
  v(1806)=der(1,2)*v(3714)
  v(1792)=-(ffor(1)*v(3712))
  v(3439)=ffor(11)*v(3717)
  v(3246)=ffor(10)*v(3717)
  v(3060)=ffor(9)*v(3717)
  v(2881)=ffor(8)*v(3717)
  v(2709)=ffor(7)*v(3717)
  v(2544)=ffor(6)*v(3717)
  v(2386)=ffor(5)*v(3717)
  v(2235)=ffor(4)*v(3717)
  v(2091)=ffor(3)*v(3717)
  v(2012)=der(1,3)*v(3714)
  v(2003)=-(ffor(2)*v(3717))
  v(1994)=-(ffor(1)*v(3717))
  v(3443)=ffor(11)*v(3721)
  v(3250)=ffor(10)*v(3721)
  v(3064)=ffor(9)*v(3721)
  v(2885)=ffor(8)*v(3721)
  v(2713)=ffor(7)*v(3721)
  v(2548)=ffor(6)*v(3721)
  v(2390)=ffor(5)*v(3721)
  v(2239)=ffor(4)*v(3721)
  v(2156)=der(1,4)*v(3714)
  v(2147)=-(ffor(3)*v(3721))
  v(2141)=-(ffor(2)*v(3721))
  v(2132)=-(ffor(1)*v(3721))
  v(3447)=ffor(11)*v(3725)
  v(3254)=ffor(10)*v(3725)
  v(3068)=ffor(9)*v(3725)
  v(2889)=ffor(8)*v(3725)
  v(2717)=ffor(7)*v(3725)
  v(2552)=ffor(6)*v(3725)
  v(2394)=ffor(5)*v(3725)
  v(2307)=der(1,5)*v(3714)
  v(2298)=-(ffor(4)*v(3725))
  v(2292)=-(ffor(3)*v(3725))
  v(2286)=-(ffor(2)*v(3725))
  v(2277)=-(ffor(1)*v(3725))
  v(3451)=ffor(11)*v(3729)
  v(3258)=ffor(10)*v(3729)
  v(3072)=ffor(9)*v(3729)
  v(2893)=ffor(8)*v(3729)
  v(2721)=ffor(7)*v(3729)
  v(2556)=ffor(6)*v(3729)
  v(2465)=der(1,6)*v(3714)
  v(2456)=-(ffor(5)*v(3729))
  v(2450)=-(ffor(4)*v(3729))
  v(2444)=-(ffor(3)*v(3729))
  v(2438)=-(ffor(2)*v(3729))
  v(2429)=-(ffor(1)*v(3729))
  v(3455)=ffor(11)*v(3733)
  v(3262)=ffor(10)*v(3733)
  v(3076)=ffor(9)*v(3733)
  v(2897)=ffor(8)*v(3733)
  v(2725)=ffor(7)*v(3733)
  v(2630)=der(1,7)*v(3714)
  v(2621)=-(ffor(6)*v(3733))
  v(2615)=-(ffor(5)*v(3733))
  v(2609)=-(ffor(4)*v(3733))
  v(2603)=-(ffor(3)*v(3733))
  v(2597)=-(ffor(2)*v(3733))
  v(2588)=-(ffor(1)*v(3733))
  v(3459)=ffor(11)*v(3737)
  v(3266)=ffor(10)*v(3737)
  v(3080)=ffor(9)*v(3737)
  v(2901)=ffor(8)*v(3737)
  v(2802)=der(1,8)*v(3714)
  v(2793)=-(ffor(7)*v(3737))
  v(2787)=-(ffor(6)*v(3737))
  v(2781)=-(ffor(5)*v(3737))
  v(2775)=-(ffor(4)*v(3737))
  v(2769)=-(ffor(3)*v(3737))
  v(2763)=-(ffor(2)*v(3737))
  v(2754)=-(ffor(1)*v(3737))
  v(3463)=ffor(11)*v(3741)
  v(3270)=ffor(10)*v(3741)
  v(3084)=ffor(9)*v(3741)
  v(2981)=der(1,9)*v(3714)
  v(2972)=-(ffor(8)*v(3741))
  v(2966)=-(ffor(7)*v(3741))
  v(2960)=-(ffor(6)*v(3741))
  v(2954)=-(ffor(5)*v(3741))
  v(2948)=-(ffor(4)*v(3741))
  v(2942)=-(ffor(3)*v(3741))
  v(2936)=-(ffor(2)*v(3741))
  v(2927)=-(ffor(1)*v(3741))
  v(3467)=ffor(11)*v(3745)
  v(3274)=ffor(10)*v(3745)
  v(3167)=der(1,10)*v(3714)
  v(3158)=-(ffor(9)*v(3745))
  v(3152)=-(ffor(8)*v(3745))
  v(3146)=-(ffor(7)*v(3745))
  v(3140)=-(ffor(6)*v(3745))
  v(3134)=-(ffor(5)*v(3745))
  v(3128)=-(ffor(4)*v(3745))
  v(3122)=-(ffor(3)*v(3745))
  v(3116)=-(ffor(2)*v(3745))
  v(3107)=-(ffor(1)*v(3745))
  v(3471)=ffor(11)*v(3750)
  v(3425)=der(1,11)*v(3714)
  v(3351)=-(ffor(10)*v(3750))
  v(3345)=-(ffor(9)*v(3750))
  v(3339)=-(ffor(8)*v(3750))
  v(3333)=-(ffor(7)*v(3750))
  v(3327)=-(ffor(6)*v(3750))
  v(3321)=-(ffor(5)*v(3750))
  v(3315)=-(ffor(4)*v(3750))
  v(3309)=-(ffor(3)*v(3750))
  v(3303)=-(ffor(2)*v(3750))
  v(3294)=-(ffor(1)*v(3750))
  v(3681)=der(1,12)*v(3714)
  v(3551)=ffor(11)*v(3754)
  v(3545)=ffor(10)*v(3754)
  v(3539)=ffor(9)*v(3754)
  v(3533)=ffor(8)*v(3754)
  v(3527)=ffor(7)*v(3754)
  v(3521)=ffor(6)*v(3754)
  v(3515)=ffor(5)*v(3754)
  v(3509)=ffor(4)*v(3754)
  v(3503)=ffor(3)*v(3754)
  v(3497)=ffor(2)*v(3754)
  v(3488)=ffor(1)*v(3754)
  v(3433)=ffor(11)*v(3757)
  v(3240)=ffor(10)*v(3757)
  v(3054)=ffor(9)*v(3757)
  v(2875)=ffor(8)*v(3757)
  v(2703)=ffor(7)*v(3757)
  v(2538)=ffor(6)*v(3757)
  v(2380)=ffor(5)*v(3757)
  v(2229)=ffor(4)*v(3757)
  v(2085)=ffor(3)*v(3757)
  v(1901)=ffor(2)*v(3757)
  v(1747)=ffor(1)*v(3757)
  v(1610)=der(2,1)*v(3714)
  v(3759)=v(1610)*vol
  v(3557)=v(3755)*v(3759)
  v(3360)=v(3751)*v(3759)
  v(3171)=v(3747)*v(3759)
  v(2988)=v(3743)*v(3759)
  v(2812)=v(3739)*v(3759)
  v(2643)=v(3735)*v(3759)
  v(2481)=v(3731)*v(3759)
  v(2326)=v(3727)*v(3759)
  v(2178)=v(3723)*v(3759)
  v(2037)=v(3719)*v(3759)
  v(1843)=v(3715)*v(3759)
  v(1669)=v(3710)*v(3759)
  v(3437)=ffor(11)*v(3761)
  v(3244)=ffor(10)*v(3761)
  v(3058)=ffor(9)*v(3761)
  v(2879)=ffor(8)*v(3761)
  v(2707)=ffor(7)*v(3761)
  v(2542)=ffor(6)*v(3761)
  v(2384)=ffor(5)*v(3761)
  v(2233)=ffor(4)*v(3761)
  v(2089)=ffor(3)*v(3761)
  v(1909)=ffor(2)*v(3761)
  v(1848)=-(ffor(1)*v(3761))
  v(1846)=(der(2,2)*v(1610)+v(3709)*v(3715))*vol
  v(1797)=der(2,2)*v(3714)
  v(3763)=v(1797)*vol
  v(3563)=v(3755)*v(3763)
  v(3366)=v(3751)*v(3763)
  v(3177)=v(3747)*v(3763)
  v(2994)=v(3743)*v(3763)
  v(2818)=v(3739)*v(3763)
  v(2649)=v(3735)*v(3763)
  v(2487)=v(3731)*v(3763)
  v(2332)=v(3727)*v(3763)
  v(2184)=v(3723)*v(3763)
  v(2043)=v(3719)*v(3763)
  v(1850)=v(3715)*v(3763)
  v(1788)=v(3764)*v(3777)
  v(1785)=(der(1,2)*v(3709)+v(1610)*v(3764))*vol
  v(3441)=ffor(11)*v(3766)
  v(3248)=ffor(10)*v(3766)
  v(3062)=ffor(9)*v(3766)
  v(2883)=ffor(8)*v(3766)
  v(2711)=ffor(7)*v(3766)
  v(2546)=ffor(6)*v(3766)
  v(2388)=ffor(5)*v(3766)
  v(2237)=ffor(4)*v(3766)
  v(2093)=ffor(3)*v(3766)
  v(2050)=-(ffor(2)*v(3766))
  v(2047)=(der(2,3)*v(1797)+v(1806)*v(3719))*vol
  v(2041)=-(ffor(1)*v(3766))
  v(2039)=(der(2,3)*v(1610)+v(3709)*v(3719))*vol
  v(2006)=der(2,3)*v(3714)
  v(3768)=v(2006)*vol
  v(3572)=v(3755)*v(3768)
  v(3375)=v(3751)*v(3768)
  v(3186)=v(3747)*v(3768)
  v(3003)=v(3743)*v(3768)
  v(2827)=v(3739)*v(3768)
  v(2658)=v(3735)*v(3768)
  v(2496)=v(3731)*v(3768)
  v(2341)=v(3727)*v(3768)
  v(2193)=v(3723)*v(3768)
  v(2052)=v(3719)*v(3768)
  v(1999)=v(1806)*v(3770)
  v(1996)=(der(1,3)*v(1806)+v(1797)*v(3769))*vol
  v(1990)=v(3709)*v(3770)
  v(1986)=(der(1,3)*v(3709)+v(1610)*v(3769))*vol
  v(3445)=ffor(11)*v(3772)
  v(3252)=ffor(10)*v(3772)
  v(3066)=ffor(9)*v(3772)
  v(2887)=ffor(8)*v(3772)
  v(2715)=ffor(7)*v(3772)
  v(2550)=ffor(6)*v(3772)
  v(2392)=ffor(5)*v(3772)
  v(2241)=ffor(4)*v(3772)
  v(2197)=-(ffor(3)*v(3772))
  v(2195)=(der(2,4)*v(2006)+v(2012)*v(3723))*vol
  v(2191)=-(ffor(2)*v(3772))
  v(2188)=(der(2,4)*v(1797)+v(1806)*v(3723))*vol
  v(2182)=-(ffor(1)*v(3772))
  v(2180)=(der(2,4)*v(1610)+v(3709)*v(3723))*vol
  v(2150)=der(2,4)*v(3714)
  v(3774)=v(2150)*vol
  v(3578)=v(3755)*v(3774)
  v(3381)=v(3751)*v(3774)
  v(3192)=v(3747)*v(3774)
  v(3009)=v(3743)*v(3774)
  v(2833)=v(3739)*v(3774)
  v(2664)=v(3735)*v(3774)
  v(2502)=v(3731)*v(3774)
  v(2347)=v(3727)*v(3774)
  v(2199)=v(3723)*v(3774)
  v(2145)=v(2012)*v(3776)
  v(2143)=(der(1,4)*v(2012)+v(2006)*v(3775))*vol
  v(2137)=v(1806)*v(3776)
  v(2134)=(der(1,4)*v(1806)+v(1797)*v(3775))*vol
  v(2128)=v(3775)*v(3777)
  v(2125)=(der(1,4)*v(3709)+v(1610)*v(3775))*vol
  v(3449)=ffor(11)*v(3779)
  v(3256)=ffor(10)*v(3779)
  v(3070)=ffor(9)*v(3779)
  v(2891)=ffor(8)*v(3779)
  v(2719)=ffor(7)*v(3779)
  v(2554)=ffor(6)*v(3779)
  v(2396)=ffor(5)*v(3779)
  v(2351)=-(ffor(4)*v(3779))
  v(2349)=(der(2,5)*v(2150)+v(2156)*v(3727))*vol
  v(2345)=-(ffor(3)*v(3779))
  v(2343)=(der(2,5)*v(2006)+v(2012)*v(3727))*vol
  v(2339)=-(ffor(2)*v(3779))
  v(2336)=(der(2,5)*v(1797)+v(1806)*v(3727))*vol
  v(2330)=-(ffor(1)*v(3779))
  v(2328)=(der(2,5)*v(1610)+v(3709)*v(3727))*vol
  v(2301)=der(2,5)*v(3714)
  v(3781)=v(2301)*vol
  v(3584)=v(3755)*v(3781)
  v(3387)=v(3751)*v(3781)
  v(3198)=v(3747)*v(3781)
  v(3015)=v(3743)*v(3781)
  v(2839)=v(3739)*v(3781)
  v(2670)=v(3735)*v(3781)
  v(2508)=v(3731)*v(3781)
  v(2353)=v(3727)*v(3781)
  v(2296)=v(2156)*v(3783)
  v(2294)=(der(1,5)*v(2156)+v(2150)*v(3782))*vol
  v(2290)=v(2012)*v(3783)
  v(2288)=(der(1,5)*v(2012)+v(2006)*v(3782))*vol
  v(2282)=v(1806)*v(3783)
  v(2279)=(der(1,5)*v(1806)+v(1797)*v(3782))*vol
  v(2273)=v(3777)*v(3782)
  v(2270)=(der(1,5)*v(3709)+v(1610)*v(3782))*vol
  v(3453)=ffor(11)*v(3785)
  v(3260)=ffor(10)*v(3785)
  v(3074)=ffor(9)*v(3785)
  v(2895)=ffor(8)*v(3785)
  v(2723)=ffor(7)*v(3785)
  v(2558)=ffor(6)*v(3785)
  v(2512)=-(ffor(5)*v(3785))
  v(2510)=(der(2,6)*v(2301)+v(2307)*v(3731))*vol
  v(2506)=-(ffor(4)*v(3785))
  v(2504)=(der(2,6)*v(2150)+v(2156)*v(3731))*vol
  v(2500)=-(ffor(3)*v(3785))
  v(2498)=(der(2,6)*v(2006)+v(2012)*v(3731))*vol
  v(2494)=-(ffor(2)*v(3785))
  v(2491)=(der(2,6)*v(1797)+v(1806)*v(3731))*vol
  v(2485)=-(ffor(1)*v(3785))
  v(2483)=(der(2,6)*v(1610)+v(3709)*v(3731))*vol
  v(2459)=der(2,6)*v(3714)
  v(3787)=v(2459)*vol
  v(3590)=v(3755)*v(3787)
  v(3393)=v(3751)*v(3787)
  v(3204)=v(3747)*v(3787)
  v(3021)=v(3743)*v(3787)
  v(2845)=v(3739)*v(3787)
  v(2676)=v(3735)*v(3787)
  v(2514)=v(3731)*v(3787)
  v(2454)=v(2307)*v(3789)
  v(2452)=(der(1,6)*v(2307)+v(2301)*v(3788))*vol
  v(2448)=v(2156)*v(3789)
  v(2446)=(der(1,6)*v(2156)+v(2150)*v(3788))*vol
  v(2442)=v(2012)*v(3789)
  v(2440)=(der(1,6)*v(2012)+v(2006)*v(3788))*vol
  v(2434)=v(1806)*v(3789)
  v(2431)=(der(1,6)*v(1806)+v(1797)*v(3788))*vol
  v(2425)=v(3777)*v(3788)
  v(2422)=(der(1,6)*v(3709)+v(1610)*v(3788))*vol
  v(3457)=ffor(11)*v(3791)
  v(3264)=ffor(10)*v(3791)
  v(3078)=ffor(9)*v(3791)
  v(2899)=ffor(8)*v(3791)
  v(2727)=ffor(7)*v(3791)
  v(2680)=-(ffor(6)*v(3791))
  v(2678)=(der(2,7)*v(2459)+v(2465)*v(3735))*vol
  v(2674)=-(ffor(5)*v(3791))
  v(2672)=(der(2,7)*v(2301)+v(2307)*v(3735))*vol
  v(2668)=-(ffor(4)*v(3791))
  v(2666)=(der(2,7)*v(2150)+v(2156)*v(3735))*vol
  v(2662)=-(ffor(3)*v(3791))
  v(2660)=(der(2,7)*v(2006)+v(2012)*v(3735))*vol
  v(2656)=-(ffor(2)*v(3791))
  v(2653)=(der(2,7)*v(1797)+v(1806)*v(3735))*vol
  v(2647)=-(ffor(1)*v(3791))
  v(2645)=(der(2,7)*v(1610)+v(3709)*v(3735))*vol
  v(2624)=der(2,7)*v(3714)
  v(3793)=v(2624)*vol
  v(3596)=v(3755)*v(3793)
  v(3399)=v(3751)*v(3793)
  v(3210)=v(3747)*v(3793)
  v(3027)=v(3743)*v(3793)
  v(2851)=v(3739)*v(3793)
  v(2682)=v(3735)*v(3793)
  v(2619)=v(2465)*v(3795)
  v(2617)=(der(1,7)*v(2465)+v(2459)*v(3794))*vol
  v(2613)=v(2307)*v(3795)
  v(2611)=(der(1,7)*v(2307)+v(2301)*v(3794))*vol
  v(2607)=v(2156)*v(3795)
  v(2605)=(der(1,7)*v(2156)+v(2150)*v(3794))*vol
  v(2601)=v(2012)*v(3795)
  v(2599)=(der(1,7)*v(2012)+v(2006)*v(3794))*vol
  v(2593)=v(1806)*v(3795)
  v(2590)=(der(1,7)*v(1806)+v(1797)*v(3794))*vol
  v(2584)=v(3777)*v(3794)
  v(2581)=(der(1,7)*v(3709)+v(1610)*v(3794))*vol
  v(3461)=ffor(11)*v(3797)
  v(3268)=ffor(10)*v(3797)
  v(3082)=ffor(9)*v(3797)
  v(2903)=ffor(8)*v(3797)
  v(2855)=-(ffor(7)*v(3797))
  v(2853)=(der(2,8)*v(2624)+v(2630)*v(3739))*vol
  v(2849)=-(ffor(6)*v(3797))
  v(2847)=(der(2,8)*v(2459)+v(2465)*v(3739))*vol
  v(2843)=-(ffor(5)*v(3797))
  v(2841)=(der(2,8)*v(2301)+v(2307)*v(3739))*vol
  v(2837)=-(ffor(4)*v(3797))
  v(2835)=(der(2,8)*v(2150)+v(2156)*v(3739))*vol
  v(2831)=-(ffor(3)*v(3797))
  v(2829)=(der(2,8)*v(2006)+v(2012)*v(3739))*vol
  v(2825)=-(ffor(2)*v(3797))
  v(2822)=(der(2,8)*v(1797)+v(1806)*v(3739))*vol
  v(2816)=-(ffor(1)*v(3797))
  v(2814)=(der(2,8)*v(1610)+v(3709)*v(3739))*vol
  v(2796)=der(2,8)*v(3714)
  v(3799)=v(2796)*vol
  v(3602)=v(3755)*v(3799)
  v(3405)=v(3751)*v(3799)
  v(3216)=v(3747)*v(3799)
  v(3033)=v(3743)*v(3799)
  v(2857)=v(3739)*v(3799)
  v(2791)=v(2630)*v(3801)
  v(2789)=(der(1,8)*v(2630)+v(2624)*v(3800))*vol
  v(2785)=v(2465)*v(3801)
  v(2783)=(der(1,8)*v(2465)+v(2459)*v(3800))*vol
  v(2779)=v(2307)*v(3801)
  v(2777)=(der(1,8)*v(2307)+v(2301)*v(3800))*vol
  v(2773)=v(2156)*v(3801)
  v(2771)=(der(1,8)*v(2156)+v(2150)*v(3800))*vol
  v(2767)=v(2012)*v(3801)
  v(2765)=(der(1,8)*v(2012)+v(2006)*v(3800))*vol
  v(2759)=v(1806)*v(3801)
  v(2756)=(der(1,8)*v(1806)+v(1797)*v(3800))*vol
  v(2750)=v(3777)*v(3800)
  v(2747)=(der(1,8)*v(3709)+v(1610)*v(3800))*vol
  v(3465)=ffor(11)*v(3803)
  v(3272)=ffor(10)*v(3803)
  v(3086)=ffor(9)*v(3803)
  v(3037)=-(ffor(8)*v(3803))
  v(3035)=(der(2,9)*v(2796)+v(2802)*v(3743))*vol
  v(3031)=-(ffor(7)*v(3803))
  v(3029)=(der(2,9)*v(2624)+v(2630)*v(3743))*vol
  v(3025)=-(ffor(6)*v(3803))
  v(3023)=(der(2,9)*v(2459)+v(2465)*v(3743))*vol
  v(3019)=-(ffor(5)*v(3803))
  v(3017)=(der(2,9)*v(2301)+v(2307)*v(3743))*vol
  v(3013)=-(ffor(4)*v(3803))
  v(3011)=(der(2,9)*v(2150)+v(2156)*v(3743))*vol
  v(3007)=-(ffor(3)*v(3803))
  v(3005)=(der(2,9)*v(2006)+v(2012)*v(3743))*vol
  v(3001)=-(ffor(2)*v(3803))
  v(2998)=(der(2,9)*v(1797)+v(1806)*v(3743))*vol
  v(2992)=-(ffor(1)*v(3803))
  v(2990)=(der(2,9)*v(1610)+v(3709)*v(3743))*vol
  v(2975)=der(2,9)*v(3714)
  v(3805)=v(2975)*vol
  v(3608)=v(3755)*v(3805)
  v(3411)=v(3751)*v(3805)
  v(3222)=v(3747)*v(3805)
  v(3039)=v(3743)*v(3805)
  v(2970)=v(2802)*v(3807)
  v(2968)=(der(1,9)*v(2802)+v(2796)*v(3806))*vol
  v(2964)=v(2630)*v(3807)
  v(2962)=(der(1,9)*v(2630)+v(2624)*v(3806))*vol
  v(2958)=v(2465)*v(3807)
  v(2956)=(der(1,9)*v(2465)+v(2459)*v(3806))*vol
  v(2952)=v(2307)*v(3807)
  v(2950)=(der(1,9)*v(2307)+v(2301)*v(3806))*vol
  v(2946)=v(2156)*v(3807)
  v(2944)=(der(1,9)*v(2156)+v(2150)*v(3806))*vol
  v(2940)=v(2012)*v(3807)
  v(2938)=(der(1,9)*v(2012)+v(2006)*v(3806))*vol
  v(2932)=v(1806)*v(3807)
  v(2929)=(der(1,9)*v(1806)+v(1797)*v(3806))*vol
  v(2923)=v(3777)*v(3806)
  v(2920)=(der(1,9)*v(3709)+v(1610)*v(3806))*vol
  v(3469)=ffor(11)*v(3809)
  v(3276)=ffor(10)*v(3809)
  v(3226)=-(ffor(9)*v(3809))
  v(3224)=(der(2,10)*v(2975)+v(2981)*v(3747))*vol
  v(3220)=-(ffor(8)*v(3809))
  v(3218)=(der(2,10)*v(2796)+v(2802)*v(3747))*vol
  v(3214)=-(ffor(7)*v(3809))
  v(3212)=(der(2,10)*v(2624)+v(2630)*v(3747))*vol
  v(3208)=-(ffor(6)*v(3809))
  v(3206)=(der(2,10)*v(2459)+v(2465)*v(3747))*vol
  v(3202)=-(ffor(5)*v(3809))
  v(3200)=(der(2,10)*v(2301)+v(2307)*v(3747))*vol
  v(3196)=-(ffor(4)*v(3809))
  v(3194)=(der(2,10)*v(2150)+v(2156)*v(3747))*vol
  v(3190)=-(ffor(3)*v(3809))
  v(3188)=(der(2,10)*v(2006)+v(2012)*v(3747))*vol
  v(3184)=-(ffor(2)*v(3809))
  v(3181)=(der(2,10)*v(1797)+v(1806)*v(3747))*vol
  v(3175)=-(ffor(1)*v(3809))
  v(3173)=(der(2,10)*v(1610)+v(3709)*v(3747))*vol
  v(3161)=der(2,10)*v(3714)
  v(3811)=v(3161)*vol
  v(3614)=v(3755)*v(3811)
  v(3417)=v(3751)*v(3811)
  v(3228)=v(3747)*v(3811)
  v(3156)=v(2981)*v(3813)
  v(3154)=(der(1,10)*v(2981)+v(2975)*v(3812))*vol
  v(3150)=v(2802)*v(3813)
  v(3148)=(der(1,10)*v(2802)+v(2796)*v(3812))*vol
  v(3144)=v(2630)*v(3813)
  v(3142)=(der(1,10)*v(2630)+v(2624)*v(3812))*vol
  v(3138)=v(2465)*v(3813)
  v(3136)=(der(1,10)*v(2465)+v(2459)*v(3812))*vol
  v(3132)=v(2307)*v(3813)
  v(3130)=(der(1,10)*v(2307)+v(2301)*v(3812))*vol
  v(3126)=v(2156)*v(3813)
  v(3124)=(der(1,10)*v(2156)+v(2150)*v(3812))*vol
  v(3120)=v(2012)*v(3813)
  v(3118)=(der(1,10)*v(2012)+v(2006)*v(3812))*vol
  v(3112)=v(1806)*v(3813)
  v(3109)=(der(1,10)*v(1806)+v(1797)*v(3812))*vol
  v(3103)=v(3777)*v(3812)
  v(3100)=(der(1,10)*v(3709)+v(1610)*v(3812))*vol
  v(3473)=ffor(11)*v(3816)
  v(3421)=-(ffor(10)*v(3816))
  v(3419)=(der(2,11)*v(3161)+v(3167)*v(3751))*vol
  v(3415)=-(ffor(9)*v(3816))
  v(3413)=(der(2,11)*v(2975)+v(2981)*v(3751))*vol
  v(3409)=-(ffor(8)*v(3816))
  v(3407)=(der(2,11)*v(2796)+v(2802)*v(3751))*vol
  v(3403)=-(ffor(7)*v(3816))
  v(3401)=(der(2,11)*v(2624)+v(2630)*v(3751))*vol
  v(3397)=-(ffor(6)*v(3816))
  v(3395)=(der(2,11)*v(2459)+v(2465)*v(3751))*vol
  v(3391)=-(ffor(5)*v(3816))
  v(3389)=(der(2,11)*v(2301)+v(2307)*v(3751))*vol
  v(3385)=-(ffor(4)*v(3816))
  v(3383)=(der(2,11)*v(2150)+v(2156)*v(3751))*vol
  v(3379)=-(ffor(3)*v(3816))
  v(3377)=(der(2,11)*v(2006)+v(2012)*v(3751))*vol
  v(3373)=-(ffor(2)*v(3816))
  v(3370)=(der(2,11)*v(1797)+v(1806)*v(3751))*vol
  v(3364)=-(ffor(1)*v(3816))
  v(3362)=(der(2,11)*v(1610)+v(3709)*v(3751))*vol
  v(3354)=der(2,11)*v(3714)
  v(3817)=v(3354)*vol
  v(3620)=v(3755)*v(3817)
  v(3423)=v(3751)*v(3817)
  v(3349)=v(3167)*v(3819)
  v(3347)=(der(1,11)*v(3167)+v(3161)*v(3818))*vol
  v(3343)=v(2981)*v(3819)
  v(3341)=(der(1,11)*v(2981)+v(2975)*v(3818))*vol
  v(3337)=v(2802)*v(3819)
  v(3335)=(der(1,11)*v(2802)+v(2796)*v(3818))*vol
  v(3331)=v(2630)*v(3819)
  v(3329)=(der(1,11)*v(2630)+v(2624)*v(3818))*vol
  v(3325)=v(2465)*v(3819)
  v(3323)=(der(1,11)*v(2465)+v(2459)*v(3818))*vol
  v(3319)=v(2307)*v(3819)
  v(3317)=(der(1,11)*v(2307)+v(2301)*v(3818))*vol
  v(3313)=v(2156)*v(3819)
  v(3311)=(der(1,11)*v(2156)+v(2150)*v(3818))*vol
  v(3307)=v(2012)*v(3819)
  v(3305)=(der(1,11)*v(2012)+v(2006)*v(3818))*vol
  v(3299)=v(1806)*v(3819)
  v(3296)=(der(1,11)*v(1806)+v(1797)*v(3818))*vol
  v(3290)=v(3777)*v(3818)
  v(3287)=(der(1,11)*v(3709)+v(1610)*v(3818))*vol
  v(3624)=ffor(11)*v(3822)
  v(3622)=(der(2,12)*v(3354)+v(3425)*v(3755))*vol
  v(3618)=ffor(10)*v(3822)
  v(3616)=(der(2,12)*v(3161)+v(3167)*v(3755))*vol
  v(3612)=ffor(9)*v(3822)
  v(3610)=(der(2,12)*v(2975)+v(2981)*v(3755))*vol
  v(3606)=ffor(8)*v(3822)
  v(3604)=(der(2,12)*v(2796)+v(2802)*v(3755))*vol
  v(3600)=ffor(7)*v(3822)
  v(3598)=(der(2,12)*v(2624)+v(2630)*v(3755))*vol
  v(3594)=ffor(6)*v(3822)
  v(3592)=(der(2,12)*v(2459)+v(2465)*v(3755))*vol
  v(3588)=ffor(5)*v(3822)
  v(3586)=(der(2,12)*v(2301)+v(2307)*v(3755))*vol
  v(3582)=ffor(4)*v(3822)
  v(3580)=(der(2,12)*v(2150)+v(2156)*v(3755))*vol
  v(3576)=ffor(3)*v(3822)
  v(3574)=(der(2,12)*v(2006)+v(2012)*v(3755))*vol
  v(3570)=ffor(2)*v(3822)
  v(3567)=(der(2,12)*v(1797)+v(1806)*v(3755))*vol
  v(3561)=ffor(1)*v(3822)
  v(3559)=(der(2,12)*v(1610)+v(3709)*v(3755))*vol
  v(3554)=der(2,12)*v(3714)
  v(3626)=v(3554)*v(3755)*vol
  v(3549)=v(3425)*v(3824)
  v(3547)=(der(1,12)*v(3425)+v(3354)*v(3823))*vol
  v(3543)=v(3167)*v(3824)
  v(3541)=(der(1,12)*v(3167)+v(3161)*v(3823))*vol
  v(3537)=v(2981)*v(3824)
  v(3535)=(der(1,12)*v(2981)+v(2975)*v(3823))*vol
  v(3531)=v(2802)*v(3824)
  v(3529)=(der(1,12)*v(2802)+v(2796)*v(3823))*vol
  v(3525)=v(2630)*v(3824)
  v(3523)=(der(1,12)*v(2630)+v(2624)*v(3823))*vol
  v(3519)=v(2465)*v(3824)
  v(3517)=(der(1,12)*v(2465)+v(2459)*v(3823))*vol
  v(3513)=v(2307)*v(3824)
  v(3511)=(der(1,12)*v(2307)+v(2301)*v(3823))*vol
  v(3507)=v(2156)*v(3824)
  v(3505)=(der(1,12)*v(2156)+v(2150)*v(3823))*vol
  v(3501)=v(2012)*v(3824)
  v(3499)=(der(1,12)*v(2012)+v(2006)*v(3823))*vol
  v(3493)=v(1806)*v(3824)
  v(3490)=(der(1,12)*v(1806)+v(1797)*v(3823))*vol
  v(3484)=v(3777)*v(3823)
  v(3481)=(der(1,12)*v(3709)+v(1610)*v(3823))*vol
  IF(steady) THEN
    v(1532)=0d0
    v(1533)=0d0
    v(1534)=0d0
    v(1535)=0d0
    v(1536)=0d0
    v(1537)=0d0
    v(1538)=0d0
    v(1539)=0d0
    v(1540)=0d0
    v(1541)=0d0
    v(1542)=0d0
    v(1543)=0d0
    v(1514)=0d0
    v(1544)=0d0
    v(1545)=0d0
    v(1546)=0d0
    v(1547)=0d0
    v(1548)=0d0
    v(1549)=0d0
    v(1550)=0d0
    v(1551)=0d0
    v(1552)=0d0
    v(1553)=0d0
    v(1554)=0d0
    v(1555)=0d0
    v(1515)=0d0
  ELSE
    v(3876)=acel(1,2)*ffor(1)+acel(10,2)*ffor(10)+acel(11,2)*ffor(11)+acel(12,2)*ffor(12)+acel(2,2)*ffor(2)+acel(3,2)*ffor&
        & (3)+acel(4,2)*ffor(4)+acel(5,2)*ffor(5)+acel(6,2)*ffor(6)+acel(7,2)*ffor(7)+acel(8,2)*ffor(8)+acel(9,2)*ffor(9)
    v(3875)=acel(1,1)*ffor(1)+acel(10,1)*ffor(10)+acel(11,1)*ffor(11)+acel(12,1)*ffor(12)+acel(2,1)*ffor(2)+acel(3,1)*ffor&
        & (3)+acel(4,1)*ffor(4)+acel(5,1)*ffor(5)+acel(6,1)*ffor(6)+acel(7,1)*ffor(7)+acel(8,1)*ffor(8)+acel(9,1)*ffor(9)
    v(1532)=v(3693)
    v(1533)=v(3695)
    v(1534)=v(3696)
    v(1535)=v(3697)
    v(1536)=v(3698)
    v(1537)=v(3699)
    v(1538)=v(3700)
    v(1539)=v(3701)
    v(1540)=v(3702)
    v(1541)=v(3703)
    v(1542)=v(3704)
    v(1543)=v(3705)
    v(1514)=v(3875)
    v(1544)=v(3693)
    v(1545)=v(3695)
    v(1546)=v(3696)
    v(1547)=v(3697)
    v(1548)=v(3698)
    v(1549)=v(3699)
    v(1550)=v(3700)
    v(1551)=v(3701)
    v(1552)=v(3702)
    v(1553)=v(3703)
    v(1554)=v(3704)
    v(1555)=v(3705)
    v(1515)=v(3876)
  ENDIF
  v(1523)=(v(3873)+v(3874))/2d0
  IF(frozen) THEN
    v(1580)=0d0
    v(1581)=0d0
    v(1582)=0d0
    v(1583)=0d0
    v(1584)=0d0
    v(1585)=0d0
    v(1586)=0d0
    v(1587)=0d0
    v(1588)=0d0
    v(1589)=0d0
    v(1590)=0d0
    v(1591)=0d0
    v(1529)=v(3877)
    v(1592)=0d0
    v(1593)=0d0
    v(1594)=0d0
    v(1595)=0d0
    v(1596)=0d0
    v(1597)=0d0
    v(1598)=0d0
    v(1599)=0d0
    v(1600)=0d0
    v(1601)=0d0
    v(1602)=0d0
    v(1603)=0d0
    v(1530)=v(3878)
  ELSE
    v(3907)=ffor(10)*vnew(10,2)+ffor(11)*vnew(11,2)+ffor(1)*vnew(1,2)+ffor(12)*vnew(12,2)+ffor(2)*vnew(2,2)+ffor(3)*vnew(3&
        & ,2)+ffor(4)*vnew(4,2)+ffor(5)*vnew(5,2)+ffor(6)*vnew(6,2)+ffor(7)*vnew(7,2)+ffor(8)*vnew(8,2)+ffor(9)*vnew(9,2)
    v(3906)=ffor(12)
    v(3905)=ffor(11)
    v(3904)=ffor(10)
    v(3903)=ffor(9)
    v(3902)=ffor(8)
    v(3901)=ffor(7)
    v(3900)=ffor(6)
    v(3899)=ffor(5)
    v(3898)=ffor(4)
    v(3897)=ffor(3)
    v(3896)=ffor(2)
    v(3895)=ffor(1)
    v(3894)=v(3904)*vnew(10,1)+v(3895)*vnew(1,1)+v(3905)*vnew(11,1)+v(3906)*vnew(12,1)+v(3896)*vnew(2,1)+v(3897)*vnew(3,1)&
        & +v(3898)*vnew(4,1)+v(3899)*vnew(5,1)+v(3900)*vnew(6,1)+v(3901)*vnew(7,1)+v(3902)*vnew(8,1)+v(3903)*vnew(9,1)
    v(1580)=v(3882)
    v(1581)=v(3883)
    v(1582)=v(3884)
    v(1583)=v(3885)
    v(1584)=v(3886)
    v(1585)=v(3887)
    v(1586)=v(3888)
    v(1587)=v(3889)
    v(1588)=v(3890)
    v(1589)=v(3891)
    v(1590)=v(3892)
    v(1591)=v(3893)
    v(1529)=v(3894)
    v(1592)=v(3895)
    v(1593)=v(3896)
    v(1594)=v(3897)
    v(1595)=v(3898)
    v(1596)=v(3899)
    v(1597)=v(3900)
    v(1598)=v(3901)
    v(1599)=v(3902)
    v(1600)=v(3903)
    v(1601)=v(3904)
    v(1602)=v(3905)
    v(1603)=v(3906)
    v(1530)=v(3907)
  ENDIF
  v(1893)=v(1591)*v(3908)
  v(4162)=v(1893)*vol
  v(1979)=v(1893)-mu*v(3860)
  v(1889)=v(1590)*v(3908)
  v(4161)=v(1889)*vol
  v(1972)=v(1889)-mu*v(3859)
  v(1885)=v(1589)*v(3908)
  v(4160)=v(1885)*vol
  v(1965)=v(1885)-mu*v(3858)
  v(1881)=v(1588)*v(3908)
  v(4159)=v(1881)*vol
  v(1958)=v(1881)-mu*v(3857)
  v(1877)=v(1587)*v(3908)
  v(4158)=v(1877)*vol
  v(1951)=v(1877)-mu*v(3856)
  v(1873)=v(1586)*v(3908)
  v(4157)=v(1873)*vol
  v(1944)=v(1873)-mu*v(3855)
  v(1869)=v(1585)*v(3908)
  v(4156)=v(1869)*vol
  v(1937)=v(1869)-mu*v(3854)
  v(1865)=v(1584)*v(3908)
  v(4155)=v(1865)*vol
  v(1930)=v(1865)-mu*v(3853)
  v(1861)=v(1583)*v(3908)
  v(4154)=v(1861)*vol
  v(1923)=v(1861)-mu*v(3852)
  v(1857)=v(1582)*v(3908)
  v(4153)=v(1857)*vol
  v(1916)=v(1857)-mu*v(3851)
  v(1852)=v(1581)*v(3908)
  v(4152)=v(1852)*vol
  v(1906)=v(1852)-mu*v(3850)
  v(1844)=v(1580)*v(3908)
  v(4150)=v(1844)*vol
  v(1898)=v(1844)-mu*v(3849)
  v(1840)=v(1603)*v(3909)
  v(4149)=v(1840)*vol
  v(1982)=v(1840)-mu*v(3848)
  v(1836)=v(1602)*v(3909)
  v(4148)=v(1836)*vol
  v(1975)=v(1836)-mu*v(3847)
  v(1832)=v(1601)*v(3909)
  v(4147)=v(1832)*vol
  v(1968)=v(1832)-mu*v(3846)
  v(1828)=v(1600)*v(3909)
  v(4146)=v(1828)*vol
  v(1961)=v(1828)-mu*v(3845)
  v(1824)=v(1599)*v(3909)
  v(4145)=v(1824)*vol
  v(1954)=v(1824)-mu*v(3844)
  v(1820)=v(1598)*v(3909)
  v(4144)=v(1820)*vol
  v(1947)=v(1820)-mu*v(3843)
  v(1816)=v(1597)*v(3909)
  v(4143)=v(1816)*vol
  v(1940)=v(1816)-mu*v(3842)
  v(1812)=v(1596)*v(3909)
  v(4142)=v(1812)*vol
  v(1933)=v(1812)-mu*v(3841)
  v(1808)=v(1595)*v(3909)
  v(4141)=v(1808)*vol
  v(1926)=v(1808)-mu*v(3840)
  v(1803)=v(1594)*v(3909)
  v(4140)=v(1803)*vol
  v(1919)=v(1803)-mu*v(3839)
  v(1799)=v(1593)*v(3909)
  v(4138)=v(1799)*vol
  v(1910)=v(1799)-mu*v(3838)
  v(1902)=-(mu*v(3837))+v(1592)*v(3909)
  v(1741)=der(2,12)*v(1530)
  v(1735)=der(2,11)*v(1530)
  v(1729)=der(2,10)*v(1530)
  v(1723)=der(2,9)*v(1530)
  v(1717)=der(2,8)*v(1530)
  v(1711)=der(2,7)*v(1530)
  v(1705)=der(2,6)*v(1530)
  v(1699)=der(2,5)*v(1530)
  v(1693)=der(2,4)*v(1530)
  v(1687)=der(2,3)*v(1530)
  v(1681)=der(2,2)*v(1530)
  v(1608)=der(2,1)*v(1530)
  v(3684)=v(1515)+v(1529)*v(3874)+v(1530)*v(3880)
  v(3683)=v(1514)+v(1530)*v(3873)+v(1529)*v(3879)
  v(1740)=der(1,12)*v(1529)
  v(3485)=v(1740)+v(1741)+v(3705)
  v(1734)=der(1,11)*v(1529)
  v(3291)=v(1734)+v(1735)+v(3704)
  v(1728)=der(1,10)*v(1529)
  v(3104)=v(1728)+v(1729)+v(3703)
  v(1722)=der(1,9)*v(1529)
  v(2924)=v(1722)+v(1723)+v(3702)
  v(1716)=der(1,8)*v(1529)
  v(2751)=v(1716)+v(1717)+v(3701)
  v(1710)=der(1,7)*v(1529)
  v(2585)=v(1710)+v(1711)+v(3700)
  v(1704)=der(1,6)*v(1529)
  v(2426)=v(1704)+v(1705)+v(3699)
  v(1698)=der(1,5)*v(1529)
  v(2274)=v(1698)+v(1699)+v(3698)
  v(1692)=der(1,4)*v(1529)
  v(2129)=v(1692)+v(1693)+v(3697)
  v(1686)=der(1,3)*v(1529)
  v(1991)=v(1686)+v(1687)+v(3696)
  v(1680)=der(1,2)*v(1529)
  v(1793)=v(1680)+v(1681)+v(3695)
  v(1672)=rho*(-f(2)+v(3684))+v(3910)+v(3911)+v(3912)+v(3913)+v(3914)+v(3915)+v(3916)+v(3917)+v(3918)+v(3919)+v(3920)+v&
      &(3921)
  v(1618)=rho*(-f(1)+v(3683))+v(3922)+v(3923)+v(3924)+v(3925)+v(3926)+v(3927)+v(3928)+v(3929)+v(3930)+v(3931)+v(3932)+v&
      &(3933)
  v(1607)=der(1,1)*v(1529)
  v(1616)=v(1607)+v(1608)+v(3693)
  v(1531)=v(3934)/sqrt(v(3935)+v(3936)+4d0*(0.1d-6+v(3877)**2+v(3878)**2)*v(3937))
  v(3948)=v(1531)*vol
  v(1987)=v(3691)*v(3948)
  v(3947)=v(1987)*v(1991)
  v(4163)=v(1992)+v(3947)
  v(3946)=v(1987)*v(2129)
  v(4167)=v(2130)+v(3946)
  v(3945)=v(1987)*v(2274)
  v(4170)=v(2275)+v(3945)
  v(3944)=v(1987)*v(2426)
  v(4173)=v(2427)+v(3944)
  v(3943)=v(1987)*v(2585)
  v(4176)=v(2586)+v(3943)
  v(3942)=v(1987)*v(2751)
  v(4179)=v(2752)+v(3942)
  v(3941)=v(1987)*v(2924)
  v(4182)=v(2925)+v(3941)
  v(3940)=v(1987)*v(3104)
  v(4185)=v(3105)+v(3940)
  v(3939)=v(1987)*v(3291)
  v(4188)=v(3292)+v(3939)
  v(3938)=v(1987)*v(3485)
  v(4191)=v(3486)+v(3938)
  v(3565)=v(3874)*v(3938)
  v(3495)=v(3873)*v(3938)
  v(3368)=v(3874)*v(3939)
  v(3301)=v(3873)*v(3939)
  v(3179)=v(3874)*v(3940)
  v(3114)=v(3873)*v(3940)
  v(2996)=v(3874)*v(3941)
  v(2934)=v(3873)*v(3941)
  v(2820)=v(3874)*v(3942)
  v(2761)=v(3873)*v(3942)
  v(2651)=v(3874)*v(3943)
  v(2595)=v(3873)*v(3943)
  v(2489)=v(3874)*v(3944)
  v(2436)=v(3873)*v(3944)
  v(2334)=v(3874)*v(3945)
  v(2284)=v(3873)*v(3945)
  v(2186)=v(3874)*v(3946)
  v(2139)=v(3873)*v(3946)
  v(2045)=v(3874)*v(3947)
  v(2001)=v(3873)*v(3947)
  v(1789)=v(1793)*v(1987)
  v(4136)=v(1789)+v(1790)
  v(1622)=v(1616)*v(3948)
  v(3949)=v(1622)*v(3691)
  v(4110)=v(3692)+v(3949)
  v(1677)=v(3874)*v(3949)
  v(1634)=v(3873)*v(3949)
  v(1615)=rho*v(3948)
  v(4165)=der(1,2)*v(1615)
  v(4137)=v(1615)*v(1793)
  v(4135)=der(2,12)*v(1615)
  v(4134)=der(2,11)*v(1615)
  v(4133)=der(2,10)*v(1615)
  v(4132)=der(2,9)*v(1615)
  v(4131)=der(2,8)*v(1615)
  v(4130)=der(2,7)*v(1615)
  v(4129)=der(2,6)*v(1615)
  v(4128)=der(2,5)*v(1615)
  v(4127)=der(2,4)*v(1615)
  v(4126)=der(2,3)*v(1615)
  v(4125)=der(2,2)*v(1615)
  v(4124)=der(2,1)*v(1615)
  v(4122)=der(1,12)*v(1615)
  v(4121)=der(1,11)*v(1615)
  v(4120)=der(1,10)*v(1615)
  v(4119)=der(1,9)*v(1615)
  v(4118)=der(1,8)*v(1615)
  v(4117)=der(1,7)*v(1615)
  v(4116)=der(1,6)*v(1615)
  v(4115)=der(1,5)*v(1615)
  v(4114)=der(1,4)*v(1615)
  v(4113)=der(1,3)*v(1615)
  v(4112)=der(1,1)*v(1615)
  v(3951)=v(1615)*v(1618)
  v(3950)=v(1615)*v(1672)
  v(3568)=der(2,12)*v(3950)
  v(3564)=der(1,12)*v(3950)
  v(4193)=v(3564)+v(3565)
  v(3494)=der(2,12)*v(3951)
  v(4192)=v(3494)+v(3495)
  v(3491)=der(1,12)*v(3951)
  v(3371)=der(2,11)*v(3950)
  v(3367)=der(1,11)*v(3950)
  v(4190)=v(3367)+v(3368)
  v(3300)=der(2,11)*v(3951)
  v(4189)=v(3300)+v(3301)
  v(3297)=der(1,11)*v(3951)
  v(3182)=der(2,10)*v(3950)
  v(3178)=der(1,10)*v(3950)
  v(4187)=v(3178)+v(3179)
  v(3113)=der(2,10)*v(3951)
  v(4186)=v(3113)+v(3114)
  v(3110)=der(1,10)*v(3951)
  v(2999)=der(2,9)*v(3950)
  v(2995)=der(1,9)*v(3950)
  v(4184)=v(2995)+v(2996)
  v(2933)=der(2,9)*v(3951)
  v(4183)=v(2933)+v(2934)
  v(2930)=der(1,9)*v(3951)
  v(2823)=der(2,8)*v(3950)
  v(2819)=der(1,8)*v(3950)
  v(4181)=v(2819)+v(2820)
  v(2760)=der(2,8)*v(3951)
  v(4180)=v(2760)+v(2761)
  v(2757)=der(1,8)*v(3951)
  v(2654)=der(2,7)*v(3950)
  v(2650)=der(1,7)*v(3950)
  v(4178)=v(2650)+v(2651)
  v(2594)=der(2,7)*v(3951)
  v(4177)=v(2594)+v(2595)
  v(2591)=der(1,7)*v(3951)
  v(2492)=der(2,6)*v(3950)
  v(2488)=der(1,6)*v(3950)
  v(4175)=v(2488)+v(2489)
  v(2435)=der(2,6)*v(3951)
  v(4174)=v(2435)+v(2436)
  v(2432)=der(1,6)*v(3951)
  v(2337)=der(2,5)*v(3950)
  v(2333)=der(1,5)*v(3950)
  v(4172)=v(2333)+v(2334)
  v(2283)=der(2,5)*v(3951)
  v(4171)=v(2283)+v(2284)
  v(2280)=der(1,5)*v(3951)
  v(2189)=der(2,4)*v(3950)
  v(2185)=der(1,4)*v(3950)
  v(4169)=v(2185)+v(2186)
  v(2138)=der(2,4)*v(3951)
  v(4168)=v(2138)+v(2139)
  v(2135)=der(1,4)*v(3951)
  v(2048)=der(2,3)*v(3950)
  v(2044)=der(1,3)*v(3950)
  v(4166)=v(2044)+v(2045)
  v(2000)=der(2,3)*v(3951)
  v(4164)=v(2000)+v(2001)
  v(1997)=der(1,3)*v(3951)
  v(1854)=der(2,2)*v(3950)
  v(1851)=der(1,2)*v(3950)
  v(4151)=v(1851)+v(1789)*v(3874)
  v(1798)=der(2,2)*v(3951)
  v(4139)=v(1798)+v(1789)*v(3873)
  v(1795)=der(1,2)*v(3951)
  v(1679)=der(2,1)*v(3950)
  v(1676)=der(1,1)*v(3950)
  v(4123)=v(1676)+v(1677)+v(3692)*v(3874)
  v(1629)=der(2,1)*v(3951)
  v(4111)=v(1629)+v(1634)+v(3692)*v(3873)
  v(1625)=der(1,1)*v(3951)
  v(1605)=v(1532)+v(1616)-v(3693)+v(1580)*v(3879)
  v(1899)=rho*v(1605)-mu*v(4094)
  v(1619)=v(1533)+v(1793)-v(3695)+v(1581)*v(3879)
  v(1907)=rho*v(1619)-mu*v(4095)
  v(1626)=v(1534)+v(1991)-v(3696)+v(1582)*v(3879)
  v(1917)=rho*v(1626)-mu*(v(3863)+v(4084))
  v(1632)=v(1535)+v(2129)-v(3697)+v(1583)*v(3879)
  v(1924)=rho*v(1632)-mu*(v(3864)+v(4085))
  v(1637)=v(1536)+v(2274)-v(3698)+v(1584)*v(3879)
  v(1931)=rho*v(1637)-mu*(v(3865)+v(4086))
  v(1641)=v(1537)+v(2426)-v(3699)+v(1585)*v(3879)
  v(1938)=rho*v(1641)-mu*(v(3866)+v(4087))
  v(1645)=v(1538)+v(2585)-v(3700)+v(1586)*v(3879)
  v(1945)=rho*v(1645)-mu*(v(3867)+v(4088))
  v(1649)=v(1539)+v(2751)-v(3701)+v(1587)*v(3879)
  v(1952)=rho*v(1649)-mu*(v(3868)+v(4089))
  v(1653)=v(1540)+v(2924)-v(3702)+v(1588)*v(3879)
  v(1959)=rho*v(1653)-mu*(v(3869)+v(4090))
  v(1657)=v(1541)+v(3104)-v(3703)+v(1589)*v(3879)
  v(1966)=rho*v(1657)-mu*(v(3870)+v(4091))
  v(1661)=v(1542)+v(3291)-v(3704)+v(1590)*v(3879)
  v(1973)=rho*v(1661)-mu*(v(3871)+v(4092))
  v(1665)=v(1543)+v(3485)-v(3705)+v(1591)*v(3879)
  v(1980)=rho*v(1665)-mu*(v(3872)+v(4093))
  v(1673)=v(1544)+v(1616)-v(3693)+v(1592)*v(3880)
  v(1903)=rho*v(1673)-mu*v(4096)
  v(1682)=v(1545)+v(1793)-v(3695)+v(1593)*v(3880)
  v(1911)=rho*v(1682)-mu*v(4097)
  v(1688)=v(1546)+v(1991)-v(3696)+v(1594)*v(3880)
  v(1920)=rho*v(1688)-mu*(v(3827)+v(4098))
  v(1694)=v(1547)+v(2129)-v(3697)+v(1595)*v(3880)
  v(1927)=rho*v(1694)-mu*(v(3828)+v(4099))
  v(1700)=v(1548)+v(2274)-v(3698)+v(1596)*v(3880)
  v(1934)=rho*v(1700)-mu*(v(3829)+v(4100))
  v(1706)=v(1549)+v(2426)-v(3699)+v(1597)*v(3880)
  v(1941)=rho*v(1706)-mu*(v(3830)+v(4101))
  v(1712)=v(1550)+v(2585)-v(3700)+v(1598)*v(3880)
  v(1948)=rho*v(1712)-mu*(v(3831)+v(4102))
  v(1718)=v(1551)+v(2751)-v(3701)+v(1599)*v(3880)
  v(1955)=rho*v(1718)-mu*(v(3832)+v(4103))
  v(1724)=v(1552)+v(2924)-v(3702)+v(1600)*v(3880)
  v(1962)=rho*v(1724)-mu*(v(3833)+v(4104))
  v(1730)=v(1553)+v(3104)-v(3703)+v(1601)*v(3880)
  v(1969)=rho*v(1730)-mu*(v(3834)+v(4105))
  v(1736)=v(1554)+v(3291)-v(3704)+v(1602)*v(3880)
  v(1976)=rho*v(1736)-mu*(v(3835)+v(4106))
  v(1742)=v(1555)+v(3485)-v(3705)+v(1603)*v(3880)
  v(1983)=rho*v(1742)-mu*(v(3836)+v(4107))
  v(1754)=v(3948)*(v(3952)+v(3953))
  v(1757)=v(3948)*(v(3954)+v(3955))
  v(1760)=v(3948)*(v(3956)+v(3957))
  v(1763)=v(3948)*(v(3958)+v(3959))
  v(1766)=v(3948)*(v(3960)+v(3961))
  v(1769)=v(3948)*(v(3962)+v(3963))
  v(1772)=v(3948)*(v(3964)+v(3965))
  v(1775)=v(3948)*(v(3966)+v(3967))
  v(1778)=v(3948)*(v(3968)+v(3969))
  v(1781)=v(3948)*(v(3970)+v(3971))
  v(1784)=v(3948)*(v(3972)+v(3973))
  v(1922)=v(3948)*(v(3974)+v(3975))
  v(1929)=v(3948)*(v(3976)+v(3977))
  v(1936)=v(3948)*(v(3978)+v(3979))
  v(1943)=v(3948)*(v(3980)+v(3981))
  v(1950)=v(3948)*(v(3982)+v(3983))
  v(1957)=v(3948)*(v(3984)+v(3985))
  v(1964)=v(3948)*(v(3986)+v(3987))
  v(1971)=v(3948)*(v(3988)+v(3989))
  v(1978)=v(3948)*(v(3990)+v(3991))
  v(1985)=v(3948)*(v(3992)+v(3993))
  v(2100)=v(3948)*(v(3994)+v(3995))
  v(2103)=v(3948)*(v(3996)+v(3997))
  v(2106)=v(3948)*(v(3998)+v(3999))
  v(2109)=v(3948)*(v(4000)+v(4001))
  v(2112)=v(3948)*(v(4002)+v(4003))
  v(2115)=v(3948)*(v(4004)+v(4005))
  v(2118)=v(3948)*(v(4006)+v(4007))
  v(2121)=v(3948)*(v(4008)+v(4009))
  v(2124)=v(3948)*(v(4010)+v(4011))
  v(2248)=v(3948)*(v(4012)+v(4013))
  v(2251)=v(3948)*(v(4014)+v(4015))
  v(2254)=v(3948)*(v(4016)+v(4017))
  v(2257)=v(3948)*(v(4018)+v(4019))
  v(2260)=v(3948)*(v(4020)+v(4021))
  v(2263)=v(3948)*(v(4022)+v(4023))
  v(2266)=v(3948)*(v(4024)+v(4025))
  v(2269)=v(3948)*(v(4026)+v(4027))
  v(2403)=v(3948)*(v(4028)+v(4029))
  v(2406)=v(3948)*(v(4030)+v(4031))
  v(2409)=v(3948)*(v(4032)+v(4033))
  v(2412)=v(3948)*(v(4034)+v(4035))
  v(2415)=v(3948)*(v(4036)+v(4037))
  v(2418)=v(3948)*(v(4038)+v(4039))
  v(2421)=v(3948)*(v(4040)+v(4041))
  v(2565)=v(3948)*(v(4042)+v(4043))
  v(2568)=v(3948)*(v(4044)+v(4045))
  v(2571)=v(3948)*(v(4046)+v(4047))
  v(2574)=v(3948)*(v(4048)+v(4049))
  v(2577)=v(3948)*(v(4050)+v(4051))
  v(2580)=v(3948)*(v(4052)+v(4053))
  v(2734)=v(3948)*(v(4054)+v(4055))
  v(2737)=v(3948)*(v(4056)+v(4057))
  v(2740)=v(3948)*(v(4058)+v(4059))
  v(2743)=v(3948)*(v(4060)+v(4061))
  v(2746)=v(3948)*(v(4062)+v(4063))
  v(2910)=v(3948)*(v(4064)+v(4065))
  v(2913)=v(3948)*(v(4066)+v(4067))
  v(2916)=v(3948)*(v(4068)+v(4069))
  v(2919)=v(3948)*(v(4070)+v(4071))
  v(3093)=v(3948)*(v(4072)+v(4073))
  v(3096)=v(3948)*(v(4074)+v(4075))
  v(3099)=v(3948)*(v(4076)+v(4077))
  v(3283)=v(3948)*(v(4078)+v(4079))
  v(3286)=v(3948)*(v(4080)+v(4081))
  v(3480)=v(3948)*(v(4082)+v(4083))
  v(3682)=v(3714)*v(3879)-v(3881)
  v(3685)=v(3714)*v(3880)-v(3881)
  v(3686)=v(3879)+v(3880)
  v(3687)=v(1618)-mu*(v(3870)*vnew(10,1)+v(4091)*vnew(10,1)+v(3846)*vnew(10,2)+v(4094)*vnew(1,1)+v(3871)*vnew(11,1)+v&
      &(4092)*vnew(11,1)+v(3847)*vnew(11,2)+v(3837)*vnew(1,2)+v(3872)*vnew(12,1)+v(4093)*vnew(12,1)+v(3848)*vnew(12,2)+v(4095&
      &)*vnew(2,1)+v(3838)*vnew(2,2)+v(3863)*vnew(3,1)+v(4084)*vnew(3,1)+v(3839)*vnew(3,2)+v(3864)*vnew(4,1)+v(4085)*vnew(4,1)&
      &+v(3840)*vnew(4,2)+v(3865)*vnew(5,1)+v(4086)*vnew(5,1)+v(3841)*vnew(5,2)+v(3866)*vnew(6,1)+v(4087)*vnew(6,1)+v(3842&
      &)*vnew(6,2)+v(3867)*vnew(7,1)+v(4088)*vnew(7,1)+v(3843)*vnew(7,2)+v(3868)*vnew(8,1)+v(4089)*vnew(8,1)+v(3844)*vnew(8,2)&
      &+v(3869)*vnew(9,1)+v(4090)*vnew(9,1)+v(3845)*vnew(9,2))
  v(3688)=v(1672)-mu*(v(3858)*vnew(10,1)+v(3834)*vnew(10,2)+v(4105)*vnew(10,2)+v(3849)*vnew(1,1)+v(3859)*vnew(11,1)+v&
      &(3835)*vnew(11,2)+v(4106)*vnew(11,2)+v(4096)*vnew(1,2)+v(3860)*vnew(12,1)+v(3836)*vnew(12,2)+v(4107)*vnew(12,2)+v(3850&
      &)*vnew(2,1)+v(4097)*vnew(2,2)+v(3851)*vnew(3,1)+v(3827)*vnew(3,2)+v(4098)*vnew(3,2)+v(3852)*vnew(4,1)+v(3828)*vnew(4,2)&
      &+v(4099)*vnew(4,2)+v(3853)*vnew(5,1)+v(3829)*vnew(5,2)+v(4100)*vnew(5,2)+v(3854)*vnew(6,1)+v(3830)*vnew(6,2)+v(4101&
      &)*vnew(6,2)+v(3855)*vnew(7,1)+v(3831)*vnew(7,2)+v(4102)*vnew(7,2)+v(3856)*vnew(8,1)+v(3832)*vnew(8,2)+v(4103)*vnew(8,2)&
      &+v(3857)*vnew(9,1)+v(3833)*vnew(9,2)+v(4104)*vnew(9,2))
  intforce(1)=v(3683)*v(3692)+v(1616)*v(3951)+(v(1523)*v(1610)+der(1,1)*v(3682)+ffor(1)*v(4108))*vol
  intforce(2)=v(3684)*v(3692)+v(1616)*v(3950)+(der(2,1)*v(3685)+v(1523)*v(3709)+ffor(1)*v(4109))*vol
  intforce(3)=(ffor(1)*v(3686)+v(1531)*(der(1,1)*v(3687)+der(2,1)*v(3688)))*vol
  intforce(4)=v(1790)*v(3683)+v(1793)*v(3951)+(v(1523)*v(1797)+der(1,2)*v(3682)+ffor(2)*v(4108))*vol
  intforce(5)=v(1790)*v(3684)+v(1793)*v(3950)+(v(1523)*v(1806)+der(2,2)*v(3685)+ffor(2)*v(4109))*vol
  intforce(6)=(ffor(2)*v(3686)+v(1531)*(der(1,2)*v(3687)+der(2,2)*v(3688)))*vol
  intforce(7)=v(1992)*v(3683)+v(1991)*v(3951)+(v(1523)*v(2006)+der(1,3)*v(3682)+ffor(3)*v(4108))*vol
  intforce(8)=v(1992)*v(3684)+v(1991)*v(3950)+(v(1523)*v(2012)+der(2,3)*v(3685)+ffor(3)*v(4109))*vol
  intforce(9)=(ffor(3)*v(3686)+v(1531)*(der(1,3)*v(3687)+der(2,3)*v(3688)))*vol
  intforce(10)=v(2130)*v(3683)+v(2129)*v(3951)+(v(1523)*v(2150)+der(1,4)*v(3682)+ffor(4)*v(4108))*vol
  intforce(11)=v(2130)*v(3684)+v(2129)*v(3950)+(v(1523)*v(2156)+der(2,4)*v(3685)+ffor(4)*v(4109))*vol
  intforce(12)=(ffor(4)*v(3686)+v(1531)*(der(1,4)*v(3687)+der(2,4)*v(3688)))*vol
  intforce(13)=v(2275)*v(3683)+v(2274)*v(3951)+(v(1523)*v(2301)+der(1,5)*v(3682)+ffor(5)*v(4108))*vol
  intforce(14)=v(2275)*v(3684)+v(2274)*v(3950)+(v(1523)*v(2307)+der(2,5)*v(3685)+ffor(5)*v(4109))*vol
  intforce(15)=(ffor(5)*v(3686)+v(1531)*(der(1,5)*v(3687)+der(2,5)*v(3688)))*vol
  intforce(16)=v(2427)*v(3683)+v(2426)*v(3951)+(v(1523)*v(2459)+der(1,6)*v(3682)+ffor(6)*v(4108))*vol
  intforce(17)=v(2427)*v(3684)+v(2426)*v(3950)+(v(1523)*v(2465)+der(2,6)*v(3685)+ffor(6)*v(4109))*vol
  intforce(18)=(ffor(6)*v(3686)+v(1531)*(der(1,6)*v(3687)+der(2,6)*v(3688)))*vol
  intforce(19)=v(2586)*v(3683)+v(2585)*v(3951)+(v(1523)*v(2624)+der(1,7)*v(3682)+ffor(7)*v(4108))*vol
  intforce(20)=v(2586)*v(3684)+v(2585)*v(3950)+(v(1523)*v(2630)+der(2,7)*v(3685)+ffor(7)*v(4109))*vol
  intforce(21)=(ffor(7)*v(3686)+v(1531)*(der(1,7)*v(3687)+der(2,7)*v(3688)))*vol
  intforce(22)=v(2752)*v(3683)+v(2751)*v(3951)+(v(1523)*v(2796)+der(1,8)*v(3682)+ffor(8)*v(4108))*vol
  intforce(23)=v(2752)*v(3684)+v(2751)*v(3950)+(v(1523)*v(2802)+der(2,8)*v(3685)+ffor(8)*v(4109))*vol
  intforce(24)=(ffor(8)*v(3686)+v(1531)*(der(1,8)*v(3687)+der(2,8)*v(3688)))*vol
  intforce(25)=v(2925)*v(3683)+v(2924)*v(3951)+(v(1523)*v(2975)+der(1,9)*v(3682)+ffor(9)*v(4108))*vol
  intforce(26)=v(2925)*v(3684)+v(2924)*v(3950)+(v(1523)*v(2981)+der(2,9)*v(3685)+ffor(9)*v(4109))*vol
  intforce(27)=(ffor(9)*v(3686)+v(1531)*(der(1,9)*v(3687)+der(2,9)*v(3688)))*vol
  intforce(28)=v(3105)*v(3683)+v(3104)*v(3951)+(v(1523)*v(3161)+der(1,10)*v(3682)+ffor(10)*v(4108))*vol
  intforce(29)=v(3105)*v(3684)+v(3104)*v(3950)+(v(1523)*v(3167)+der(2,10)*v(3685)+ffor(10)*v(4109))*vol
  intforce(30)=(ffor(10)*v(3686)+v(1531)*(der(1,10)*v(3687)+der(2,10)*v(3688)))*vol
  intforce(31)=v(3292)*v(3683)+v(3291)*v(3951)+(v(1523)*v(3354)+der(1,11)*v(3682)+ffor(11)*v(4108))*vol
  intforce(32)=v(3292)*v(3684)+v(3291)*v(3950)+(v(1523)*v(3425)+der(2,11)*v(3685)+ffor(11)*v(4109))*vol
  intforce(33)=(ffor(11)*v(3686)+v(1531)*(der(1,11)*v(3687)+der(2,11)*v(3688)))*vol
  intforce(34)=v(3486)*v(3683)+v(3485)*v(3951)+(v(1523)*v(3554)+der(1,12)*v(3682)+ffor(12)*v(4108))*vol
  intforce(35)=v(3486)*v(3684)+v(3485)*v(3950)+(v(1523)*v(3681)+der(2,12)*v(3685)+ffor(12)*v(4109))*vol
  intforce(36)=(ffor(12)*v(3686)+v(1531)*(der(1,12)*v(3687)+der(2,12)*v(3688)))*vol
  intstiff(1,1)=v(1580)*v(1625)+v(1605)*v(4110)+((der(2,1)*v(1610))/2d0+v(3708)*v(3714))*vol
  intstiff(1,2)=v(1669)+v(1592)*v(4111)
  intstiff(1,3)=v(1745)+v(1616)*v(4112)
  intstiff(1,4)=v(1581)*v(1625)+v(1785)+v(1619)*v(4110)
  intstiff(1,5)=v(1843)+v(1593)*v(4111)
  intstiff(1,6)=der(1,2)*rho*v(1622)+v(1897)
  intstiff(1,7)=v(1582)*v(1625)+v(1986)+v(1626)*v(4110)
  intstiff(1,8)=v(2037)+v(1594)*v(4111)
  intstiff(1,9)=v(2083)+v(1616)*v(4113)
  intstiff(1,10)=v(1583)*v(1625)+v(2125)+v(1632)*v(4110)
  intstiff(1,11)=v(2178)+v(1595)*v(4111)
  intstiff(1,12)=v(2227)+v(1616)*v(4114)
  intstiff(1,13)=v(1584)*v(1625)+v(2270)+v(1637)*v(4110)
  intstiff(1,14)=v(2326)+v(1596)*v(4111)
  intstiff(1,15)=v(2378)+v(1616)*v(4115)
  intstiff(1,16)=v(1585)*v(1625)+v(2422)+v(1641)*v(4110)
  intstiff(1,17)=v(2481)+v(1597)*v(4111)
  intstiff(1,18)=v(2536)+v(1616)*v(4116)
  intstiff(1,19)=v(1586)*v(1625)+v(2581)+v(1645)*v(4110)
  intstiff(1,20)=v(2643)+v(1598)*v(4111)
  intstiff(1,21)=v(2701)+v(1616)*v(4117)
  intstiff(1,22)=v(1587)*v(1625)+v(2747)+v(1649)*v(4110)
  intstiff(1,23)=v(2812)+v(1599)*v(4111)
  intstiff(1,24)=v(2873)+v(1616)*v(4118)
  intstiff(1,25)=v(1588)*v(1625)+v(2920)+v(1653)*v(4110)
  intstiff(1,26)=v(2988)+v(1600)*v(4111)
  intstiff(1,27)=v(3052)+v(1616)*v(4119)
  intstiff(1,28)=v(1589)*v(1625)+v(3100)+v(1657)*v(4110)
  intstiff(1,29)=v(3171)+v(1601)*v(4111)
  intstiff(1,30)=v(3238)+v(1616)*v(4120)
  intstiff(1,31)=v(1590)*v(1625)+v(3287)+v(1661)*v(4110)
  intstiff(1,32)=v(3360)+v(1602)*v(4111)
  intstiff(1,33)=v(3431)+v(1616)*v(4121)
  intstiff(1,34)=v(1591)*v(1625)+v(3481)+v(1665)*v(4110)
  intstiff(1,35)=v(3557)+v(1603)*v(4111)
  intstiff(1,36)=v(3706)+v(1616)*v(4122)
  intstiff(2,1)=v(1669)+v(1580)*v(4123)
  intstiff(2,2)=v(1592)*v(1679)+v(1673)*v(4110)+(v(3709)*v(3710)+v(3714)*v(3758))*vol
  intstiff(2,3)=v(1747)+v(1616)*v(4124)
  intstiff(2,4)=v(1788)+v(1581)*v(4123)
  intstiff(2,5)=v(1593)*v(1679)+v(1846)+v(1682)*v(4110)
  intstiff(2,6)=v(1901)+v(1616)*v(4125)
  intstiff(2,7)=v(1990)+v(1582)*v(4123)
  intstiff(2,8)=v(1594)*v(1679)+v(2039)+v(1688)*v(4110)
  intstiff(2,9)=v(2085)+v(1616)*v(4126)
  intstiff(2,10)=v(2128)+v(1583)*v(4123)
  intstiff(2,11)=v(1595)*v(1679)+v(2180)+v(1694)*v(4110)
  intstiff(2,12)=v(2229)+v(1616)*v(4127)
  intstiff(2,13)=v(2273)+v(1584)*v(4123)
  intstiff(2,14)=v(1596)*v(1679)+v(2328)+v(1700)*v(4110)
  intstiff(2,15)=v(2380)+v(1616)*v(4128)
  intstiff(2,16)=v(2425)+v(1585)*v(4123)
  intstiff(2,17)=v(1597)*v(1679)+v(2483)+v(1706)*v(4110)
  intstiff(2,18)=v(2538)+v(1616)*v(4129)
  intstiff(2,19)=v(2584)+v(1586)*v(4123)
  intstiff(2,20)=v(1598)*v(1679)+v(2645)+v(1712)*v(4110)
  intstiff(2,21)=v(2703)+v(1616)*v(4130)
  intstiff(2,22)=v(2750)+v(1587)*v(4123)
  intstiff(2,23)=v(1599)*v(1679)+v(2814)+v(1718)*v(4110)
  intstiff(2,24)=v(2875)+v(1616)*v(4131)
  intstiff(2,25)=v(2923)+v(1588)*v(4123)
  intstiff(2,26)=v(1600)*v(1679)+v(2990)+v(1724)*v(4110)
  intstiff(2,27)=v(3054)+v(1616)*v(4132)
  intstiff(2,28)=v(3103)+v(1589)*v(4123)
  intstiff(2,29)=v(1601)*v(1679)+v(3173)+v(1730)*v(4110)
  intstiff(2,30)=v(3240)+v(1616)*v(4133)
  intstiff(2,31)=v(3290)+v(1590)*v(4123)
  intstiff(2,32)=v(1602)*v(1679)+v(3362)+v(1736)*v(4110)
  intstiff(2,33)=v(3433)+v(1616)*v(4134)
  intstiff(2,34)=v(3484)+v(1591)*v(4123)
  intstiff(2,35)=v(1603)*v(1679)+v(3559)+v(1742)*v(4110)
  intstiff(2,36)=v(3756)+v(1616)*v(4135)
  intstiff(3,1)=-v(1745)+(der(2,1)*v(1898)+der(1,1)*v(1899))*v(3948)
  intstiff(3,2)=-v(1747)+(der(1,1)*v(1902)+der(2,1)*v(1903))*v(3948)
  intstiff(3,3)=(v(3708)+v(3758))*v(3948)
  intstiff(3,4)=v(1792)+(der(2,1)*v(1906)+der(1,1)*v(1907))*v(3948)
  intstiff(3,5)=v(1848)+(der(1,1)*v(1910)+der(2,1)*v(1911))*v(3948)
  intstiff(3,6)=v(1754)
  intstiff(3,7)=v(1994)+(der(2,1)*v(1916)+der(1,1)*v(1917))*v(3948)
  intstiff(3,8)=v(2041)+(der(1,1)*v(1919)+der(2,1)*v(1920))*v(3948)
  intstiff(3,9)=v(1757)
  intstiff(3,10)=v(2132)+(der(2,1)*v(1923)+der(1,1)*v(1924))*v(3948)
  intstiff(3,11)=v(2182)+(der(1,1)*v(1926)+der(2,1)*v(1927))*v(3948)
  intstiff(3,12)=v(1760)
  intstiff(3,13)=v(2277)+(der(2,1)*v(1930)+der(1,1)*v(1931))*v(3948)
  intstiff(3,14)=v(2330)+(der(1,1)*v(1933)+der(2,1)*v(1934))*v(3948)
  intstiff(3,15)=v(1763)
  intstiff(3,16)=v(2429)+(der(2,1)*v(1937)+der(1,1)*v(1938))*v(3948)
  intstiff(3,17)=v(2485)+(der(1,1)*v(1940)+der(2,1)*v(1941))*v(3948)
  intstiff(3,18)=v(1766)
  intstiff(3,19)=v(2588)+(der(2,1)*v(1944)+der(1,1)*v(1945))*v(3948)
  intstiff(3,20)=v(2647)+(der(1,1)*v(1947)+der(2,1)*v(1948))*v(3948)
  intstiff(3,21)=v(1769)
  intstiff(3,22)=v(2754)+(der(2,1)*v(1951)+der(1,1)*v(1952))*v(3948)
  intstiff(3,23)=v(2816)+(der(1,1)*v(1954)+der(2,1)*v(1955))*v(3948)
  intstiff(3,24)=v(1772)
  intstiff(3,25)=v(2927)+(der(2,1)*v(1958)+der(1,1)*v(1959))*v(3948)
  intstiff(3,26)=v(2992)+(der(1,1)*v(1961)+der(2,1)*v(1962))*v(3948)
  intstiff(3,27)=v(1775)
  intstiff(3,28)=v(3107)+(der(2,1)*v(1965)+der(1,1)*v(1966))*v(3948)
  intstiff(3,29)=v(3175)+(der(1,1)*v(1968)+der(2,1)*v(1969))*v(3948)
  intstiff(3,30)=v(1778)
  intstiff(3,31)=v(3294)+(der(2,1)*v(1972)+der(1,1)*v(1973))*v(3948)
  intstiff(3,32)=v(3364)+(der(1,1)*v(1975)+der(2,1)*v(1976))*v(3948)
  intstiff(3,33)=v(1781)
  intstiff(3,34)=v(3488)+(der(2,1)*v(1979)+der(1,1)*v(1980))*v(3948)
  intstiff(3,35)=v(3561)+(der(1,1)*v(1982)+der(2,1)*v(1983))*v(3948)
  intstiff(3,36)=v(1784)
  intstiff(4,1)=v(1785)+v(1580)*v(1795)+v(1605)*v(4136)
  intstiff(4,2)=v(1788)+v(1592)*(v(1798)+v(3873)*v(4136))
  intstiff(4,3)=-v(1792)+der(1,1)*v(4137)
  intstiff(4,4)=v(1581)*v(1795)+v(1619)*v(4136)+(v(3713)*v(3714)+v(1797)*v(3764))*vol
  intstiff(4,5)=v(1850)+ffor(2)*v(4138)+v(1593)*v(4139)
  intstiff(4,6)=v(1905)+der(1,2)*v(4137)
  intstiff(4,7)=v(1582)*v(1795)+v(1996)+v(1626)*v(4136)
  intstiff(4,8)=v(2043)+v(1594)*v(4139)+ffor(2)*v(4140)
  intstiff(4,9)=v(2087)+v(1793)*v(4113)
  intstiff(4,10)=v(1583)*v(1795)+v(2134)+v(1632)*v(4136)
  intstiff(4,11)=v(2184)+v(1595)*v(4139)+ffor(2)*v(4141)
  intstiff(4,12)=v(2231)+v(1793)*v(4114)
  intstiff(4,13)=v(1584)*v(1795)+v(2279)+v(1637)*v(4136)
  intstiff(4,14)=v(2332)+v(1596)*v(4139)+ffor(2)*v(4142)
  intstiff(4,15)=v(2382)+v(1793)*v(4115)
  intstiff(4,16)=v(1585)*v(1795)+v(2431)+v(1641)*v(4136)
  intstiff(4,17)=v(2487)+v(1597)*v(4139)+ffor(2)*v(4143)
  intstiff(4,18)=v(2540)+v(1793)*v(4116)
  intstiff(4,19)=v(1586)*v(1795)+v(2590)+v(1645)*v(4136)
  intstiff(4,20)=v(2649)+v(1598)*v(4139)+ffor(2)*v(4144)
  intstiff(4,21)=v(2705)+v(1793)*v(4117)
  intstiff(4,22)=v(1587)*v(1795)+v(2756)+v(1649)*v(4136)
  intstiff(4,23)=v(2818)+v(1599)*v(4139)+ffor(2)*v(4145)
  intstiff(4,24)=v(2877)+v(1793)*v(4118)
  intstiff(4,25)=v(1588)*v(1795)+v(2929)+v(1653)*v(4136)
  intstiff(4,26)=v(2994)+v(1600)*v(4139)+ffor(2)*v(4146)
  intstiff(4,27)=v(3056)+v(1793)*v(4119)
  intstiff(4,28)=v(1589)*v(1795)+v(3109)+v(1657)*v(4136)
  intstiff(4,29)=v(3177)+v(1601)*v(4139)+ffor(2)*v(4147)
  intstiff(4,30)=v(3242)+v(1793)*v(4120)
  intstiff(4,31)=v(1590)*v(1795)+v(3296)+v(1661)*v(4136)
  intstiff(4,32)=v(3366)+v(1602)*v(4139)+ffor(2)*v(4148)
  intstiff(4,33)=v(3435)+v(1793)*v(4121)
  intstiff(4,34)=v(1591)*v(1795)+v(3490)+v(1665)*v(4136)
  intstiff(4,35)=v(3563)+v(1603)*v(4139)+ffor(2)*v(4149)
  intstiff(4,36)=v(3711)+v(1793)*v(4122)
  intstiff(5,1)=v(1843)+ffor(2)*v(4150)+v(1580)*v(4151)
  intstiff(5,2)=v(1846)+v(1592)*v(1854)+v(1673)*v(4136)
  intstiff(5,3)=-v(1848)+v(1793)*v(4124)
  intstiff(5,4)=v(1850)+v(1581)*v(4151)+ffor(2)*v(4152)
  intstiff(5,5)=v(1593)*v(1854)+v(1682)*v(4136)+(v(1806)*v(3715)+v(3714)*v(3762))*vol
  intstiff(5,6)=v(1909)+v(1793)*v(4125)
  intstiff(5,7)=v(1999)+v(1582)*v(4151)+ffor(2)*v(4153)
  intstiff(5,8)=v(1594)*v(1854)+v(2047)+v(1688)*v(4136)
  intstiff(5,9)=v(2089)+v(1793)*v(4126)
  intstiff(5,10)=v(2137)+v(1583)*v(4151)+ffor(2)*v(4154)
  intstiff(5,11)=v(1595)*v(1854)+v(2188)+v(1694)*v(4136)
  intstiff(5,12)=v(2233)+v(1793)*v(4127)
  intstiff(5,13)=v(2282)+v(1584)*v(4151)+ffor(2)*v(4155)
  intstiff(5,14)=v(1596)*v(1854)+v(2336)+v(1700)*v(4136)
  intstiff(5,15)=v(2384)+v(1793)*v(4128)
  intstiff(5,16)=v(2434)+v(1585)*v(4151)+ffor(2)*v(4156)
  intstiff(5,17)=v(1597)*v(1854)+v(2491)+v(1706)*v(4136)
  intstiff(5,18)=v(2542)+v(1793)*v(4129)
  intstiff(5,19)=v(2593)+v(1586)*v(4151)+ffor(2)*v(4157)
  intstiff(5,20)=v(1598)*v(1854)+v(2653)+v(1712)*v(4136)
  intstiff(5,21)=v(2707)+v(1793)*v(4130)
  intstiff(5,22)=v(2759)+v(1587)*v(4151)+ffor(2)*v(4158)
  intstiff(5,23)=v(1599)*v(1854)+v(2822)+v(1718)*v(4136)
  intstiff(5,24)=v(2879)+v(1793)*v(4131)
  intstiff(5,25)=v(2932)+v(1588)*v(4151)+ffor(2)*v(4159)
  intstiff(5,26)=v(1600)*v(1854)+v(2998)+v(1724)*v(4136)
  intstiff(5,27)=v(3058)+v(1793)*v(4132)
  intstiff(5,28)=v(3112)+v(1589)*v(4151)+ffor(2)*v(4160)
  intstiff(5,29)=v(1601)*v(1854)+v(3181)+v(1730)*v(4136)
  intstiff(5,30)=v(3244)+v(1793)*v(4133)
  intstiff(5,31)=v(3299)+v(1590)*v(4151)+ffor(2)*v(4161)
  intstiff(5,32)=v(1602)*v(1854)+v(3370)+v(1736)*v(4136)
  intstiff(5,33)=v(3437)+v(1793)*v(4134)
  intstiff(5,34)=v(3493)+v(1591)*v(4151)+ffor(2)*v(4162)
  intstiff(5,35)=v(1603)*v(1854)+v(3567)+v(1742)*v(4136)
  intstiff(5,36)=v(3760)+v(1793)*v(4135)
  intstiff(6,1)=-v(1897)+(der(2,2)*v(1898)+der(1,2)*v(1899))*v(3948)
  intstiff(6,2)=-v(1901)+(der(1,2)*v(1902)+der(2,2)*v(1903))*v(3948)
  intstiff(6,3)=v(1754)
  intstiff(6,4)=-v(1905)+(der(2,2)*v(1906)+der(1,2)*v(1907))*v(3948)
  intstiff(6,5)=-v(1909)+(der(1,2)*v(1910)+der(2,2)*v(1911))*v(3948)
  intstiff(6,6)=(v(3713)+v(3762))*v(3948)
  intstiff(6,7)=v(2003)+(der(2,2)*v(1916)+der(1,2)*v(1917))*v(3948)
  intstiff(6,8)=v(2050)+(der(1,2)*v(1919)+der(2,2)*v(1920))*v(3948)
  intstiff(6,9)=v(1922)
  intstiff(6,10)=v(2141)+(der(2,2)*v(1923)+der(1,2)*v(1924))*v(3948)
  intstiff(6,11)=v(2191)+(der(1,2)*v(1926)+der(2,2)*v(1927))*v(3948)
  intstiff(6,12)=v(1929)
  intstiff(6,13)=v(2286)+(der(2,2)*v(1930)+der(1,2)*v(1931))*v(3948)
  intstiff(6,14)=v(2339)+(der(1,2)*v(1933)+der(2,2)*v(1934))*v(3948)
  intstiff(6,15)=v(1936)
  intstiff(6,16)=v(2438)+(der(2,2)*v(1937)+der(1,2)*v(1938))*v(3948)
  intstiff(6,17)=v(2494)+(der(1,2)*v(1940)+der(2,2)*v(1941))*v(3948)
  intstiff(6,18)=v(1943)
  intstiff(6,19)=v(2597)+(der(2,2)*v(1944)+der(1,2)*v(1945))*v(3948)
  intstiff(6,20)=v(2656)+(der(1,2)*v(1947)+der(2,2)*v(1948))*v(3948)
  intstiff(6,21)=v(1950)
  intstiff(6,22)=v(2763)+(der(2,2)*v(1951)+der(1,2)*v(1952))*v(3948)
  intstiff(6,23)=v(2825)+(der(1,2)*v(1954)+der(2,2)*v(1955))*v(3948)
  intstiff(6,24)=v(1957)
  intstiff(6,25)=v(2936)+(der(2,2)*v(1958)+der(1,2)*v(1959))*v(3948)
  intstiff(6,26)=v(3001)+(der(1,2)*v(1961)+der(2,2)*v(1962))*v(3948)
  intstiff(6,27)=v(1964)
  intstiff(6,28)=v(3116)+(der(2,2)*v(1965)+der(1,2)*v(1966))*v(3948)
  intstiff(6,29)=v(3184)+(der(1,2)*v(1968)+der(2,2)*v(1969))*v(3948)
  intstiff(6,30)=v(1971)
  intstiff(6,31)=v(3303)+(der(2,2)*v(1972)+der(1,2)*v(1973))*v(3948)
  intstiff(6,32)=v(3373)+(der(1,2)*v(1975)+der(2,2)*v(1976))*v(3948)
  intstiff(6,33)=v(1978)
  intstiff(6,34)=v(3497)+(der(2,2)*v(1979)+der(1,2)*v(1980))*v(3948)
  intstiff(6,35)=v(3570)+(der(1,2)*v(1982)+der(2,2)*v(1983))*v(3948)
  intstiff(6,36)=v(1985)
  intstiff(7,1)=v(1986)+v(1580)*v(1997)+v(1605)*v(4163)
  intstiff(7,2)=v(1990)+v(1592)*(v(1992)*v(3873)+v(4164))
  intstiff(7,3)=-v(1994)+v(1991)*v(4112)
  intstiff(7,4)=v(1996)+v(1581)*v(1997)+v(1619)*v(4163)
  intstiff(7,5)=v(1999)+ffor(3)*v(4138)+v(1593)*v(4164)
  intstiff(7,6)=-v(2003)+v(1991)*v(4165)
  intstiff(7,7)=v(1582)*v(1997)+v(1626)*v(4163)+(v(3714)*v(3718)+v(2006)*v(3769))*vol
  intstiff(7,8)=v(2052)+ffor(3)*v(4140)+v(1594)*v(4164)
  intstiff(7,9)=v(2091)+v(1991)*v(4113)
  intstiff(7,10)=v(1583)*v(1997)+v(2143)+v(1632)*v(4163)
  intstiff(7,11)=v(2193)+ffor(3)*v(4141)+v(1595)*v(4164)
  intstiff(7,12)=v(2235)+v(1991)*v(4114)
  intstiff(7,13)=v(1584)*v(1997)+v(2288)+v(1637)*v(4163)
  intstiff(7,14)=v(2341)+ffor(3)*v(4142)+v(1596)*v(4164)
  intstiff(7,15)=v(2386)+v(1991)*v(4115)
  intstiff(7,16)=v(1585)*v(1997)+v(2440)+v(1641)*v(4163)
  intstiff(7,17)=v(2496)+ffor(3)*v(4143)+v(1597)*v(4164)
  intstiff(7,18)=v(2544)+v(1991)*v(4116)
  intstiff(7,19)=v(1586)*v(1997)+v(2599)+v(1645)*v(4163)
  intstiff(7,20)=v(2658)+ffor(3)*v(4144)+v(1598)*v(4164)
  intstiff(7,21)=v(2709)+v(1991)*v(4117)
  intstiff(7,22)=v(1587)*v(1997)+v(2765)+v(1649)*v(4163)
  intstiff(7,23)=v(2827)+ffor(3)*v(4145)+v(1599)*v(4164)
  intstiff(7,24)=v(2881)+v(1991)*v(4118)
  intstiff(7,25)=v(1588)*v(1997)+v(2938)+v(1653)*v(4163)
  intstiff(7,26)=v(3003)+ffor(3)*v(4146)+v(1600)*v(4164)
  intstiff(7,27)=v(3060)+v(1991)*v(4119)
  intstiff(7,28)=v(1589)*v(1997)+v(3118)+v(1657)*v(4163)
  intstiff(7,29)=v(3186)+ffor(3)*v(4147)+v(1601)*v(4164)
  intstiff(7,30)=v(3246)+v(1991)*v(4120)
  intstiff(7,31)=v(1590)*v(1997)+v(3305)+v(1661)*v(4163)
  intstiff(7,32)=v(3375)+ffor(3)*v(4148)+v(1602)*v(4164)
  intstiff(7,33)=v(3439)+v(1991)*v(4121)
  intstiff(7,34)=v(1591)*v(1997)+v(3499)+v(1665)*v(4163)
  intstiff(7,35)=v(3572)+ffor(3)*v(4149)+v(1603)*v(4164)
  intstiff(7,36)=v(3716)+v(1991)*v(4122)
  intstiff(8,1)=v(2037)+ffor(3)*v(4150)+v(1580)*v(4166)
  intstiff(8,2)=v(2039)+v(1592)*v(2048)+v(1673)*v(4163)
  intstiff(8,3)=-v(2041)+v(1991)*v(4124)
  intstiff(8,4)=v(2043)+ffor(3)*v(4152)+v(1581)*v(4166)
  intstiff(8,5)=v(2047)+v(1593)*v(2048)+v(1682)*v(4163)
  intstiff(8,6)=-v(2050)+v(1991)*v(4125)
  intstiff(8,7)=v(2052)+ffor(3)*v(4153)+v(1582)*v(4166)
  intstiff(8,8)=v(1594)*v(2048)+v(1688)*v(4163)+(v(2012)*v(3719)+v(3714)*v(3767))*vol
  intstiff(8,9)=v(2093)+v(1991)*v(4126)
  intstiff(8,10)=v(2145)+ffor(3)*v(4154)+v(1583)*v(4166)
  intstiff(8,11)=v(1595)*v(2048)+v(2195)+v(1694)*v(4163)
  intstiff(8,12)=v(2237)+v(1991)*v(4127)
  intstiff(8,13)=v(2290)+ffor(3)*v(4155)+v(1584)*v(4166)
  intstiff(8,14)=v(1596)*v(2048)+v(2343)+v(1700)*v(4163)
  intstiff(8,15)=v(2388)+v(1991)*v(4128)
  intstiff(8,16)=v(2442)+ffor(3)*v(4156)+v(1585)*v(4166)
  intstiff(8,17)=v(1597)*v(2048)+v(2498)+v(1706)*v(4163)
  intstiff(8,18)=v(2546)+v(1991)*v(4129)
  intstiff(8,19)=v(2601)+ffor(3)*v(4157)+v(1586)*v(4166)
  intstiff(8,20)=v(1598)*v(2048)+v(2660)+v(1712)*v(4163)
  intstiff(8,21)=v(2711)+v(1991)*v(4130)
  intstiff(8,22)=v(2767)+ffor(3)*v(4158)+v(1587)*v(4166)
  intstiff(8,23)=v(1599)*v(2048)+v(2829)+v(1718)*v(4163)
  intstiff(8,24)=v(2883)+v(1991)*v(4131)
  intstiff(8,25)=v(2940)+ffor(3)*v(4159)+v(1588)*v(4166)
  intstiff(8,26)=v(1600)*v(2048)+v(3005)+v(1724)*v(4163)
  intstiff(8,27)=v(3062)+v(1991)*v(4132)
  intstiff(8,28)=v(3120)+ffor(3)*v(4160)+v(1589)*v(4166)
  intstiff(8,29)=v(1601)*v(2048)+v(3188)+v(1730)*v(4163)
  intstiff(8,30)=v(3248)+v(1991)*v(4133)
  intstiff(8,31)=v(3307)+ffor(3)*v(4161)+v(1590)*v(4166)
  intstiff(8,32)=v(1602)*v(2048)+v(3377)+v(1736)*v(4163)
  intstiff(8,33)=v(3441)+v(1991)*v(4134)
  intstiff(8,34)=v(3501)+ffor(3)*v(4162)+v(1591)*v(4166)
  intstiff(8,35)=v(1603)*v(2048)+v(3574)+v(1742)*v(4163)
  intstiff(8,36)=v(3765)+v(1991)*v(4135)
  intstiff(9,1)=-v(2083)+(der(2,3)*v(1898)+der(1,3)*v(1899))*v(3948)
  intstiff(9,2)=-v(2085)+(der(1,3)*v(1902)+der(2,3)*v(1903))*v(3948)
  intstiff(9,3)=v(1757)
  intstiff(9,4)=-v(2087)+(der(2,3)*v(1906)+der(1,3)*v(1907))*v(3948)
  intstiff(9,5)=-v(2089)+(der(1,3)*v(1910)+der(2,3)*v(1911))*v(3948)
  intstiff(9,6)=v(1922)
  intstiff(9,7)=-v(2091)+(der(2,3)*v(1916)+der(1,3)*v(1917))*v(3948)
  intstiff(9,8)=-v(2093)+(der(1,3)*v(1919)+der(2,3)*v(1920))*v(3948)
  intstiff(9,9)=(v(3718)+v(3767))*v(3948)
  intstiff(9,10)=v(2147)+(der(2,3)*v(1923)+der(1,3)*v(1924))*v(3948)
  intstiff(9,11)=v(2197)+(der(1,3)*v(1926)+der(2,3)*v(1927))*v(3948)
  intstiff(9,12)=v(2100)
  intstiff(9,13)=v(2292)+(der(2,3)*v(1930)+der(1,3)*v(1931))*v(3948)
  intstiff(9,14)=v(2345)+(der(1,3)*v(1933)+der(2,3)*v(1934))*v(3948)
  intstiff(9,15)=v(2103)
  intstiff(9,16)=v(2444)+(der(2,3)*v(1937)+der(1,3)*v(1938))*v(3948)
  intstiff(9,17)=v(2500)+(der(1,3)*v(1940)+der(2,3)*v(1941))*v(3948)
  intstiff(9,18)=v(2106)
  intstiff(9,19)=v(2603)+(der(2,3)*v(1944)+der(1,3)*v(1945))*v(3948)
  intstiff(9,20)=v(2662)+(der(1,3)*v(1947)+der(2,3)*v(1948))*v(3948)
  intstiff(9,21)=v(2109)
  intstiff(9,22)=v(2769)+(der(2,3)*v(1951)+der(1,3)*v(1952))*v(3948)
  intstiff(9,23)=v(2831)+(der(1,3)*v(1954)+der(2,3)*v(1955))*v(3948)
  intstiff(9,24)=v(2112)
  intstiff(9,25)=v(2942)+(der(2,3)*v(1958)+der(1,3)*v(1959))*v(3948)
  intstiff(9,26)=v(3007)+(der(1,3)*v(1961)+der(2,3)*v(1962))*v(3948)
  intstiff(9,27)=v(2115)
  intstiff(9,28)=v(3122)+(der(2,3)*v(1965)+der(1,3)*v(1966))*v(3948)
  intstiff(9,29)=v(3190)+(der(1,3)*v(1968)+der(2,3)*v(1969))*v(3948)
  intstiff(9,30)=v(2118)
  intstiff(9,31)=v(3309)+(der(2,3)*v(1972)+der(1,3)*v(1973))*v(3948)
  intstiff(9,32)=v(3379)+(der(1,3)*v(1975)+der(2,3)*v(1976))*v(3948)
  intstiff(9,33)=v(2121)
  intstiff(9,34)=v(3503)+(der(2,3)*v(1979)+der(1,3)*v(1980))*v(3948)
  intstiff(9,35)=v(3576)+(der(1,3)*v(1982)+der(2,3)*v(1983))*v(3948)
  intstiff(9,36)=v(2124)
  intstiff(10,1)=v(2125)+v(1580)*v(2135)+v(1605)*v(4167)
  intstiff(10,2)=v(2128)+v(1592)*(v(2130)*v(3873)+v(4168))
  intstiff(10,3)=-v(2132)+v(2129)*v(4112)
  intstiff(10,4)=v(2134)+v(1581)*v(2135)+v(1619)*v(4167)
  intstiff(10,5)=v(2137)+ffor(4)*v(4138)+v(1593)*v(4168)
  intstiff(10,6)=-v(2141)+v(2129)*v(4165)
  intstiff(10,7)=v(1582)*v(2135)+v(2143)+v(1626)*v(4167)
  intstiff(10,8)=v(2145)+ffor(4)*v(4140)+v(1594)*v(4168)
  intstiff(10,9)=-v(2147)+v(2129)*v(4113)
  intstiff(10,10)=v(1583)*v(2135)+v(1632)*v(4167)+(v(3714)*v(3722)+v(2150)*v(3775))*vol
  intstiff(10,11)=v(2199)+ffor(4)*v(4141)+v(1595)*v(4168)
  intstiff(10,12)=v(2239)+v(2129)*v(4114)
  intstiff(10,13)=v(1584)*v(2135)+v(2294)+v(1637)*v(4167)
  intstiff(10,14)=v(2347)+ffor(4)*v(4142)+v(1596)*v(4168)
  intstiff(10,15)=v(2390)+v(2129)*v(4115)
  intstiff(10,16)=v(1585)*v(2135)+v(2446)+v(1641)*v(4167)
  intstiff(10,17)=v(2502)+ffor(4)*v(4143)+v(1597)*v(4168)
  intstiff(10,18)=v(2548)+v(2129)*v(4116)
  intstiff(10,19)=v(1586)*v(2135)+v(2605)+v(1645)*v(4167)
  intstiff(10,20)=v(2664)+ffor(4)*v(4144)+v(1598)*v(4168)
  intstiff(10,21)=v(2713)+v(2129)*v(4117)
  intstiff(10,22)=v(1587)*v(2135)+v(2771)+v(1649)*v(4167)
  intstiff(10,23)=v(2833)+ffor(4)*v(4145)+v(1599)*v(4168)
  intstiff(10,24)=v(2885)+v(2129)*v(4118)
  intstiff(10,25)=v(1588)*v(2135)+v(2944)+v(1653)*v(4167)
  intstiff(10,26)=v(3009)+ffor(4)*v(4146)+v(1600)*v(4168)
  intstiff(10,27)=v(3064)+v(2129)*v(4119)
  intstiff(10,28)=v(1589)*v(2135)+v(3124)+v(1657)*v(4167)
  intstiff(10,29)=v(3192)+ffor(4)*v(4147)+v(1601)*v(4168)
  intstiff(10,30)=v(3250)+v(2129)*v(4120)
  intstiff(10,31)=v(1590)*v(2135)+v(3311)+v(1661)*v(4167)
  intstiff(10,32)=v(3381)+ffor(4)*v(4148)+v(1602)*v(4168)
  intstiff(10,33)=v(3443)+v(2129)*v(4121)
  intstiff(10,34)=v(1591)*v(2135)+v(3505)+v(1665)*v(4167)
  intstiff(10,35)=v(3578)+ffor(4)*v(4149)+v(1603)*v(4168)
  intstiff(10,36)=v(3720)+v(2129)*v(4122)
  intstiff(11,1)=v(2178)+ffor(4)*v(4150)+v(1580)*v(4169)
  intstiff(11,2)=v(2180)+v(1592)*v(2189)+v(1673)*v(4167)
  intstiff(11,3)=-v(2182)+v(2129)*v(4124)
  intstiff(11,4)=v(2184)+ffor(4)*v(4152)+v(1581)*v(4169)
  intstiff(11,5)=v(2188)+v(1593)*v(2189)+v(1682)*v(4167)
  intstiff(11,6)=-v(2191)+v(2129)*v(4125)
  intstiff(11,7)=v(2193)+ffor(4)*v(4153)+v(1582)*v(4169)
  intstiff(11,8)=v(1594)*v(2189)+v(2195)+v(1688)*v(4167)
  intstiff(11,9)=-v(2197)+v(2129)*v(4126)
  intstiff(11,10)=v(2199)+ffor(4)*v(4154)+v(1583)*v(4169)
  intstiff(11,11)=v(1595)*v(2189)+v(1694)*v(4167)+(v(2156)*v(3723)+v(3714)*v(3773))*vol
  intstiff(11,12)=v(2241)+v(2129)*v(4127)
  intstiff(11,13)=v(2296)+ffor(4)*v(4155)+v(1584)*v(4169)
  intstiff(11,14)=v(1596)*v(2189)+v(2349)+v(1700)*v(4167)
  intstiff(11,15)=v(2392)+v(2129)*v(4128)
  intstiff(11,16)=v(2448)+ffor(4)*v(4156)+v(1585)*v(4169)
  intstiff(11,17)=v(1597)*v(2189)+v(2504)+v(1706)*v(4167)
  intstiff(11,18)=v(2550)+v(2129)*v(4129)
  intstiff(11,19)=v(2607)+ffor(4)*v(4157)+v(1586)*v(4169)
  intstiff(11,20)=v(1598)*v(2189)+v(2666)+v(1712)*v(4167)
  intstiff(11,21)=v(2715)+v(2129)*v(4130)
  intstiff(11,22)=v(2773)+ffor(4)*v(4158)+v(1587)*v(4169)
  intstiff(11,23)=v(1599)*v(2189)+v(2835)+v(1718)*v(4167)
  intstiff(11,24)=v(2887)+v(2129)*v(4131)
  intstiff(11,25)=v(2946)+ffor(4)*v(4159)+v(1588)*v(4169)
  intstiff(11,26)=v(1600)*v(2189)+v(3011)+v(1724)*v(4167)
  intstiff(11,27)=v(3066)+v(2129)*v(4132)
  intstiff(11,28)=v(3126)+ffor(4)*v(4160)+v(1589)*v(4169)
  intstiff(11,29)=v(1601)*v(2189)+v(3194)+v(1730)*v(4167)
  intstiff(11,30)=v(3252)+v(2129)*v(4133)
  intstiff(11,31)=v(3313)+ffor(4)*v(4161)+v(1590)*v(4169)
  intstiff(11,32)=v(1602)*v(2189)+v(3383)+v(1736)*v(4167)
  intstiff(11,33)=v(3445)+v(2129)*v(4134)
  intstiff(11,34)=v(3507)+ffor(4)*v(4162)+v(1591)*v(4169)
  intstiff(11,35)=v(1603)*v(2189)+v(3580)+v(1742)*v(4167)
  intstiff(11,36)=v(3771)+v(2129)*v(4135)
  intstiff(12,1)=-v(2227)+(der(2,4)*v(1898)+der(1,4)*v(1899))*v(3948)
  intstiff(12,2)=-v(2229)+(der(1,4)*v(1902)+der(2,4)*v(1903))*v(3948)
  intstiff(12,3)=v(1760)
  intstiff(12,4)=-v(2231)+(der(2,4)*v(1906)+der(1,4)*v(1907))*v(3948)
  intstiff(12,5)=-v(2233)+(der(1,4)*v(1910)+der(2,4)*v(1911))*v(3948)
  intstiff(12,6)=v(1929)
  intstiff(12,7)=-v(2235)+(der(2,4)*v(1916)+der(1,4)*v(1917))*v(3948)
  intstiff(12,8)=-v(2237)+(der(1,4)*v(1919)+der(2,4)*v(1920))*v(3948)
  intstiff(12,9)=v(2100)
  intstiff(12,10)=-v(2239)+(der(2,4)*v(1923)+der(1,4)*v(1924))*v(3948)
  intstiff(12,11)=-v(2241)+(der(1,4)*v(1926)+der(2,4)*v(1927))*v(3948)
  intstiff(12,12)=(v(3722)+v(3773))*v(3948)
  intstiff(12,13)=v(2298)+(der(2,4)*v(1930)+der(1,4)*v(1931))*v(3948)
  intstiff(12,14)=v(2351)+(der(1,4)*v(1933)+der(2,4)*v(1934))*v(3948)
  intstiff(12,15)=v(2248)
  intstiff(12,16)=v(2450)+(der(2,4)*v(1937)+der(1,4)*v(1938))*v(3948)
  intstiff(12,17)=v(2506)+(der(1,4)*v(1940)+der(2,4)*v(1941))*v(3948)
  intstiff(12,18)=v(2251)
  intstiff(12,19)=v(2609)+(der(2,4)*v(1944)+der(1,4)*v(1945))*v(3948)
  intstiff(12,20)=v(2668)+(der(1,4)*v(1947)+der(2,4)*v(1948))*v(3948)
  intstiff(12,21)=v(2254)
  intstiff(12,22)=v(2775)+(der(2,4)*v(1951)+der(1,4)*v(1952))*v(3948)
  intstiff(12,23)=v(2837)+(der(1,4)*v(1954)+der(2,4)*v(1955))*v(3948)
  intstiff(12,24)=v(2257)
  intstiff(12,25)=v(2948)+(der(2,4)*v(1958)+der(1,4)*v(1959))*v(3948)
  intstiff(12,26)=v(3013)+(der(1,4)*v(1961)+der(2,4)*v(1962))*v(3948)
  intstiff(12,27)=v(2260)
  intstiff(12,28)=v(3128)+(der(2,4)*v(1965)+der(1,4)*v(1966))*v(3948)
  intstiff(12,29)=v(3196)+(der(1,4)*v(1968)+der(2,4)*v(1969))*v(3948)
  intstiff(12,30)=v(2263)
  intstiff(12,31)=v(3315)+(der(2,4)*v(1972)+der(1,4)*v(1973))*v(3948)
  intstiff(12,32)=v(3385)+(der(1,4)*v(1975)+der(2,4)*v(1976))*v(3948)
  intstiff(12,33)=v(2266)
  intstiff(12,34)=v(3509)+(der(2,4)*v(1979)+der(1,4)*v(1980))*v(3948)
  intstiff(12,35)=v(3582)+(der(1,4)*v(1982)+der(2,4)*v(1983))*v(3948)
  intstiff(12,36)=v(2269)
  intstiff(13,1)=v(2270)+v(1580)*v(2280)+v(1605)*v(4170)
  intstiff(13,2)=v(2273)+v(1592)*(v(2275)*v(3873)+v(4171))
  intstiff(13,3)=-v(2277)+v(2274)*v(4112)
  intstiff(13,4)=v(2279)+v(1581)*v(2280)+v(1619)*v(4170)
  intstiff(13,5)=v(2282)+ffor(5)*v(4138)+v(1593)*v(4171)
  intstiff(13,6)=-v(2286)+v(2274)*v(4165)
  intstiff(13,7)=v(1582)*v(2280)+v(2288)+v(1626)*v(4170)
  intstiff(13,8)=v(2290)+ffor(5)*v(4140)+v(1594)*v(4171)
  intstiff(13,9)=-v(2292)+v(2274)*v(4113)
  intstiff(13,10)=v(1583)*v(2280)+v(2294)+v(1632)*v(4170)
  intstiff(13,11)=v(2296)+ffor(5)*v(4141)+v(1595)*v(4171)
  intstiff(13,12)=-v(2298)+v(2274)*v(4114)
  intstiff(13,13)=v(1584)*v(2280)+v(1637)*v(4170)+(v(3714)*v(3726)+v(2301)*v(3782))*vol
  intstiff(13,14)=v(2353)+ffor(5)*v(4142)+v(1596)*v(4171)
  intstiff(13,15)=v(2394)+v(2274)*v(4115)
  intstiff(13,16)=v(1585)*v(2280)+v(2452)+v(1641)*v(4170)
  intstiff(13,17)=v(2508)+ffor(5)*v(4143)+v(1597)*v(4171)
  intstiff(13,18)=v(2552)+v(2274)*v(4116)
  intstiff(13,19)=v(1586)*v(2280)+v(2611)+v(1645)*v(4170)
  intstiff(13,20)=v(2670)+ffor(5)*v(4144)+v(1598)*v(4171)
  intstiff(13,21)=v(2717)+v(2274)*v(4117)
  intstiff(13,22)=v(1587)*v(2280)+v(2777)+v(1649)*v(4170)
  intstiff(13,23)=v(2839)+ffor(5)*v(4145)+v(1599)*v(4171)
  intstiff(13,24)=v(2889)+v(2274)*v(4118)
  intstiff(13,25)=v(1588)*v(2280)+v(2950)+v(1653)*v(4170)
  intstiff(13,26)=v(3015)+ffor(5)*v(4146)+v(1600)*v(4171)
  intstiff(13,27)=v(3068)+v(2274)*v(4119)
  intstiff(13,28)=v(1589)*v(2280)+v(3130)+v(1657)*v(4170)
  intstiff(13,29)=v(3198)+ffor(5)*v(4147)+v(1601)*v(4171)
  intstiff(13,30)=v(3254)+v(2274)*v(4120)
  intstiff(13,31)=v(1590)*v(2280)+v(3317)+v(1661)*v(4170)
  intstiff(13,32)=v(3387)+ffor(5)*v(4148)+v(1602)*v(4171)
  intstiff(13,33)=v(3447)+v(2274)*v(4121)
  intstiff(13,34)=v(1591)*v(2280)+v(3511)+v(1665)*v(4170)
  intstiff(13,35)=v(3584)+ffor(5)*v(4149)+v(1603)*v(4171)
  intstiff(13,36)=v(3724)+v(2274)*v(4122)
  intstiff(14,1)=v(2326)+ffor(5)*v(4150)+v(1580)*v(4172)
  intstiff(14,2)=v(2328)+v(1592)*v(2337)+v(1673)*v(4170)
  intstiff(14,3)=-v(2330)+v(2274)*v(4124)
  intstiff(14,4)=v(2332)+ffor(5)*v(4152)+v(1581)*v(4172)
  intstiff(14,5)=v(2336)+v(1593)*v(2337)+v(1682)*v(4170)
  intstiff(14,6)=-v(2339)+v(2274)*v(4125)
  intstiff(14,7)=v(2341)+ffor(5)*v(4153)+v(1582)*v(4172)
  intstiff(14,8)=v(1594)*v(2337)+v(2343)+v(1688)*v(4170)
  intstiff(14,9)=-v(2345)+v(2274)*v(4126)
  intstiff(14,10)=v(2347)+ffor(5)*v(4154)+v(1583)*v(4172)
  intstiff(14,11)=v(1595)*v(2337)+v(2349)+v(1694)*v(4170)
  intstiff(14,12)=-v(2351)+v(2274)*v(4127)
  intstiff(14,13)=v(2353)+ffor(5)*v(4155)+v(1584)*v(4172)
  intstiff(14,14)=v(1596)*v(2337)+v(1700)*v(4170)+(v(2307)*v(3727)+v(3714)*v(3780))*vol
  intstiff(14,15)=v(2396)+v(2274)*v(4128)
  intstiff(14,16)=v(2454)+ffor(5)*v(4156)+v(1585)*v(4172)
  intstiff(14,17)=v(1597)*v(2337)+v(2510)+v(1706)*v(4170)
  intstiff(14,18)=v(2554)+v(2274)*v(4129)
  intstiff(14,19)=v(2613)+ffor(5)*v(4157)+v(1586)*v(4172)
  intstiff(14,20)=v(1598)*v(2337)+v(2672)+v(1712)*v(4170)
  intstiff(14,21)=v(2719)+v(2274)*v(4130)
  intstiff(14,22)=v(2779)+ffor(5)*v(4158)+v(1587)*v(4172)
  intstiff(14,23)=v(1599)*v(2337)+v(2841)+v(1718)*v(4170)
  intstiff(14,24)=v(2891)+v(2274)*v(4131)
  intstiff(14,25)=v(2952)+ffor(5)*v(4159)+v(1588)*v(4172)
  intstiff(14,26)=v(1600)*v(2337)+v(3017)+v(1724)*v(4170)
  intstiff(14,27)=v(3070)+v(2274)*v(4132)
  intstiff(14,28)=v(3132)+ffor(5)*v(4160)+v(1589)*v(4172)
  intstiff(14,29)=v(1601)*v(2337)+v(3200)+v(1730)*v(4170)
  intstiff(14,30)=v(3256)+v(2274)*v(4133)
  intstiff(14,31)=v(3319)+ffor(5)*v(4161)+v(1590)*v(4172)
  intstiff(14,32)=v(1602)*v(2337)+v(3389)+v(1736)*v(4170)
  intstiff(14,33)=v(3449)+v(2274)*v(4134)
  intstiff(14,34)=v(3513)+ffor(5)*v(4162)+v(1591)*v(4172)
  intstiff(14,35)=v(1603)*v(2337)+v(3586)+v(1742)*v(4170)
  intstiff(14,36)=v(3778)+v(2274)*v(4135)
  intstiff(15,1)=-v(2378)+(der(2,5)*v(1898)+der(1,5)*v(1899))*v(3948)
  intstiff(15,2)=-v(2380)+(der(1,5)*v(1902)+der(2,5)*v(1903))*v(3948)
  intstiff(15,3)=v(1763)
  intstiff(15,4)=-v(2382)+(der(2,5)*v(1906)+der(1,5)*v(1907))*v(3948)
  intstiff(15,5)=-v(2384)+(der(1,5)*v(1910)+der(2,5)*v(1911))*v(3948)
  intstiff(15,6)=v(1936)
  intstiff(15,7)=-v(2386)+(der(2,5)*v(1916)+der(1,5)*v(1917))*v(3948)
  intstiff(15,8)=-v(2388)+(der(1,5)*v(1919)+der(2,5)*v(1920))*v(3948)
  intstiff(15,9)=v(2103)
  intstiff(15,10)=-v(2390)+(der(2,5)*v(1923)+der(1,5)*v(1924))*v(3948)
  intstiff(15,11)=-v(2392)+(der(1,5)*v(1926)+der(2,5)*v(1927))*v(3948)
  intstiff(15,12)=v(2248)
  intstiff(15,13)=-v(2394)+(der(2,5)*v(1930)+der(1,5)*v(1931))*v(3948)
  intstiff(15,14)=-v(2396)+(der(1,5)*v(1933)+der(2,5)*v(1934))*v(3948)
  intstiff(15,15)=(v(3726)+v(3780))*v(3948)
  intstiff(15,16)=v(2456)+(der(2,5)*v(1937)+der(1,5)*v(1938))*v(3948)
  intstiff(15,17)=v(2512)+(der(1,5)*v(1940)+der(2,5)*v(1941))*v(3948)
  intstiff(15,18)=v(2403)
  intstiff(15,19)=v(2615)+(der(2,5)*v(1944)+der(1,5)*v(1945))*v(3948)
  intstiff(15,20)=v(2674)+(der(1,5)*v(1947)+der(2,5)*v(1948))*v(3948)
  intstiff(15,21)=v(2406)
  intstiff(15,22)=v(2781)+(der(2,5)*v(1951)+der(1,5)*v(1952))*v(3948)
  intstiff(15,23)=v(2843)+(der(1,5)*v(1954)+der(2,5)*v(1955))*v(3948)
  intstiff(15,24)=v(2409)
  intstiff(15,25)=v(2954)+(der(2,5)*v(1958)+der(1,5)*v(1959))*v(3948)
  intstiff(15,26)=v(3019)+(der(1,5)*v(1961)+der(2,5)*v(1962))*v(3948)
  intstiff(15,27)=v(2412)
  intstiff(15,28)=v(3134)+(der(2,5)*v(1965)+der(1,5)*v(1966))*v(3948)
  intstiff(15,29)=v(3202)+(der(1,5)*v(1968)+der(2,5)*v(1969))*v(3948)
  intstiff(15,30)=v(2415)
  intstiff(15,31)=v(3321)+(der(2,5)*v(1972)+der(1,5)*v(1973))*v(3948)
  intstiff(15,32)=v(3391)+(der(1,5)*v(1975)+der(2,5)*v(1976))*v(3948)
  intstiff(15,33)=v(2418)
  intstiff(15,34)=v(3515)+(der(2,5)*v(1979)+der(1,5)*v(1980))*v(3948)
  intstiff(15,35)=v(3588)+(der(1,5)*v(1982)+der(2,5)*v(1983))*v(3948)
  intstiff(15,36)=v(2421)
  intstiff(16,1)=v(2422)+v(1580)*v(2432)+v(1605)*v(4173)
  intstiff(16,2)=v(2425)+v(1592)*(v(2427)*v(3873)+v(4174))
  intstiff(16,3)=-v(2429)+v(2426)*v(4112)
  intstiff(16,4)=v(2431)+v(1581)*v(2432)+v(1619)*v(4173)
  intstiff(16,5)=v(2434)+ffor(6)*v(4138)+v(1593)*v(4174)
  intstiff(16,6)=-v(2438)+v(2426)*v(4165)
  intstiff(16,7)=v(1582)*v(2432)+v(2440)+v(1626)*v(4173)
  intstiff(16,8)=v(2442)+ffor(6)*v(4140)+v(1594)*v(4174)
  intstiff(16,9)=-v(2444)+v(2426)*v(4113)
  intstiff(16,10)=v(1583)*v(2432)+v(2446)+v(1632)*v(4173)
  intstiff(16,11)=v(2448)+ffor(6)*v(4141)+v(1595)*v(4174)
  intstiff(16,12)=-v(2450)+v(2426)*v(4114)
  intstiff(16,13)=v(1584)*v(2432)+v(2452)+v(1637)*v(4173)
  intstiff(16,14)=v(2454)+ffor(6)*v(4142)+v(1596)*v(4174)
  intstiff(16,15)=-v(2456)+v(2426)*v(4115)
  intstiff(16,16)=v(1585)*v(2432)+v(1641)*v(4173)+(v(3714)*v(3730)+v(2459)*v(3788))*vol
  intstiff(16,17)=v(2514)+ffor(6)*v(4143)+v(1597)*v(4174)
  intstiff(16,18)=v(2556)+v(2426)*v(4116)
  intstiff(16,19)=v(1586)*v(2432)+v(2617)+v(1645)*v(4173)
  intstiff(16,20)=v(2676)+ffor(6)*v(4144)+v(1598)*v(4174)
  intstiff(16,21)=v(2721)+v(2426)*v(4117)
  intstiff(16,22)=v(1587)*v(2432)+v(2783)+v(1649)*v(4173)
  intstiff(16,23)=v(2845)+ffor(6)*v(4145)+v(1599)*v(4174)
  intstiff(16,24)=v(2893)+v(2426)*v(4118)
  intstiff(16,25)=v(1588)*v(2432)+v(2956)+v(1653)*v(4173)
  intstiff(16,26)=v(3021)+ffor(6)*v(4146)+v(1600)*v(4174)
  intstiff(16,27)=v(3072)+v(2426)*v(4119)
  intstiff(16,28)=v(1589)*v(2432)+v(3136)+v(1657)*v(4173)
  intstiff(16,29)=v(3204)+ffor(6)*v(4147)+v(1601)*v(4174)
  intstiff(16,30)=v(3258)+v(2426)*v(4120)
  intstiff(16,31)=v(1590)*v(2432)+v(3323)+v(1661)*v(4173)
  intstiff(16,32)=v(3393)+ffor(6)*v(4148)+v(1602)*v(4174)
  intstiff(16,33)=v(3451)+v(2426)*v(4121)
  intstiff(16,34)=v(1591)*v(2432)+v(3517)+v(1665)*v(4173)
  intstiff(16,35)=v(3590)+ffor(6)*v(4149)+v(1603)*v(4174)
  intstiff(16,36)=v(3728)+v(2426)*v(4122)
  intstiff(17,1)=v(2481)+ffor(6)*v(4150)+v(1580)*v(4175)
  intstiff(17,2)=v(2483)+v(1592)*v(2492)+v(1673)*v(4173)
  intstiff(17,3)=-v(2485)+v(2426)*v(4124)
  intstiff(17,4)=v(2487)+ffor(6)*v(4152)+v(1581)*v(4175)
  intstiff(17,5)=v(2491)+v(1593)*v(2492)+v(1682)*v(4173)
  intstiff(17,6)=-v(2494)+v(2426)*v(4125)
  intstiff(17,7)=v(2496)+ffor(6)*v(4153)+v(1582)*v(4175)
  intstiff(17,8)=v(1594)*v(2492)+v(2498)+v(1688)*v(4173)
  intstiff(17,9)=-v(2500)+v(2426)*v(4126)
  intstiff(17,10)=v(2502)+ffor(6)*v(4154)+v(1583)*v(4175)
  intstiff(17,11)=v(1595)*v(2492)+v(2504)+v(1694)*v(4173)
  intstiff(17,12)=-v(2506)+v(2426)*v(4127)
  intstiff(17,13)=v(2508)+ffor(6)*v(4155)+v(1584)*v(4175)
  intstiff(17,14)=v(1596)*v(2492)+v(2510)+v(1700)*v(4173)
  intstiff(17,15)=-v(2512)+v(2426)*v(4128)
  intstiff(17,16)=v(2514)+ffor(6)*v(4156)+v(1585)*v(4175)
  intstiff(17,17)=v(1597)*v(2492)+v(1706)*v(4173)+(v(2465)*v(3731)+v(3714)*v(3786))*vol
  intstiff(17,18)=v(2558)+v(2426)*v(4129)
  intstiff(17,19)=v(2619)+ffor(6)*v(4157)+v(1586)*v(4175)
  intstiff(17,20)=v(1598)*v(2492)+v(2678)+v(1712)*v(4173)
  intstiff(17,21)=v(2723)+v(2426)*v(4130)
  intstiff(17,22)=v(2785)+ffor(6)*v(4158)+v(1587)*v(4175)
  intstiff(17,23)=v(1599)*v(2492)+v(2847)+v(1718)*v(4173)
  intstiff(17,24)=v(2895)+v(2426)*v(4131)
  intstiff(17,25)=v(2958)+ffor(6)*v(4159)+v(1588)*v(4175)
  intstiff(17,26)=v(1600)*v(2492)+v(3023)+v(1724)*v(4173)
  intstiff(17,27)=v(3074)+v(2426)*v(4132)
  intstiff(17,28)=v(3138)+ffor(6)*v(4160)+v(1589)*v(4175)
  intstiff(17,29)=v(1601)*v(2492)+v(3206)+v(1730)*v(4173)
  intstiff(17,30)=v(3260)+v(2426)*v(4133)
  intstiff(17,31)=v(3325)+ffor(6)*v(4161)+v(1590)*v(4175)
  intstiff(17,32)=v(1602)*v(2492)+v(3395)+v(1736)*v(4173)
  intstiff(17,33)=v(3453)+v(2426)*v(4134)
  intstiff(17,34)=v(3519)+ffor(6)*v(4162)+v(1591)*v(4175)
  intstiff(17,35)=v(1603)*v(2492)+v(3592)+v(1742)*v(4173)
  intstiff(17,36)=v(3784)+v(2426)*v(4135)
  intstiff(18,1)=-v(2536)+(der(2,6)*v(1898)+der(1,6)*v(1899))*v(3948)
  intstiff(18,2)=-v(2538)+(der(1,6)*v(1902)+der(2,6)*v(1903))*v(3948)
  intstiff(18,3)=v(1766)
  intstiff(18,4)=-v(2540)+(der(2,6)*v(1906)+der(1,6)*v(1907))*v(3948)
  intstiff(18,5)=-v(2542)+(der(1,6)*v(1910)+der(2,6)*v(1911))*v(3948)
  intstiff(18,6)=v(1943)
  intstiff(18,7)=-v(2544)+(der(2,6)*v(1916)+der(1,6)*v(1917))*v(3948)
  intstiff(18,8)=-v(2546)+(der(1,6)*v(1919)+der(2,6)*v(1920))*v(3948)
  intstiff(18,9)=v(2106)
  intstiff(18,10)=-v(2548)+(der(2,6)*v(1923)+der(1,6)*v(1924))*v(3948)
  intstiff(18,11)=-v(2550)+(der(1,6)*v(1926)+der(2,6)*v(1927))*v(3948)
  intstiff(18,12)=v(2251)
  intstiff(18,13)=-v(2552)+(der(2,6)*v(1930)+der(1,6)*v(1931))*v(3948)
  intstiff(18,14)=-v(2554)+(der(1,6)*v(1933)+der(2,6)*v(1934))*v(3948)
  intstiff(18,15)=v(2403)
  intstiff(18,16)=-v(2556)+(der(2,6)*v(1937)+der(1,6)*v(1938))*v(3948)
  intstiff(18,17)=-v(2558)+(der(1,6)*v(1940)+der(2,6)*v(1941))*v(3948)
  intstiff(18,18)=(v(3730)+v(3786))*v(3948)
  intstiff(18,19)=v(2621)+(der(2,6)*v(1944)+der(1,6)*v(1945))*v(3948)
  intstiff(18,20)=v(2680)+(der(1,6)*v(1947)+der(2,6)*v(1948))*v(3948)
  intstiff(18,21)=v(2565)
  intstiff(18,22)=v(2787)+(der(2,6)*v(1951)+der(1,6)*v(1952))*v(3948)
  intstiff(18,23)=v(2849)+(der(1,6)*v(1954)+der(2,6)*v(1955))*v(3948)
  intstiff(18,24)=v(2568)
  intstiff(18,25)=v(2960)+(der(2,6)*v(1958)+der(1,6)*v(1959))*v(3948)
  intstiff(18,26)=v(3025)+(der(1,6)*v(1961)+der(2,6)*v(1962))*v(3948)
  intstiff(18,27)=v(2571)
  intstiff(18,28)=v(3140)+(der(2,6)*v(1965)+der(1,6)*v(1966))*v(3948)
  intstiff(18,29)=v(3208)+(der(1,6)*v(1968)+der(2,6)*v(1969))*v(3948)
  intstiff(18,30)=v(2574)
  intstiff(18,31)=v(3327)+(der(2,6)*v(1972)+der(1,6)*v(1973))*v(3948)
  intstiff(18,32)=v(3397)+(der(1,6)*v(1975)+der(2,6)*v(1976))*v(3948)
  intstiff(18,33)=v(2577)
  intstiff(18,34)=v(3521)+(der(2,6)*v(1979)+der(1,6)*v(1980))*v(3948)
  intstiff(18,35)=v(3594)+(der(1,6)*v(1982)+der(2,6)*v(1983))*v(3948)
  intstiff(18,36)=v(2580)
  intstiff(19,1)=v(2581)+v(1580)*v(2591)+v(1605)*v(4176)
  intstiff(19,2)=v(2584)+v(1592)*(v(2586)*v(3873)+v(4177))
  intstiff(19,3)=-v(2588)+v(2585)*v(4112)
  intstiff(19,4)=v(2590)+v(1581)*v(2591)+v(1619)*v(4176)
  intstiff(19,5)=v(2593)+ffor(7)*v(4138)+v(1593)*v(4177)
  intstiff(19,6)=-v(2597)+v(2585)*v(4165)
  intstiff(19,7)=v(1582)*v(2591)+v(2599)+v(1626)*v(4176)
  intstiff(19,8)=v(2601)+ffor(7)*v(4140)+v(1594)*v(4177)
  intstiff(19,9)=-v(2603)+v(2585)*v(4113)
  intstiff(19,10)=v(1583)*v(2591)+v(2605)+v(1632)*v(4176)
  intstiff(19,11)=v(2607)+ffor(7)*v(4141)+v(1595)*v(4177)
  intstiff(19,12)=-v(2609)+v(2585)*v(4114)
  intstiff(19,13)=v(1584)*v(2591)+v(2611)+v(1637)*v(4176)
  intstiff(19,14)=v(2613)+ffor(7)*v(4142)+v(1596)*v(4177)
  intstiff(19,15)=-v(2615)+v(2585)*v(4115)
  intstiff(19,16)=v(1585)*v(2591)+v(2617)+v(1641)*v(4176)
  intstiff(19,17)=v(2619)+ffor(7)*v(4143)+v(1597)*v(4177)
  intstiff(19,18)=-v(2621)+v(2585)*v(4116)
  intstiff(19,19)=v(1586)*v(2591)+v(1645)*v(4176)+(v(3714)*v(3734)+v(2624)*v(3794))*vol
  intstiff(19,20)=v(2682)+ffor(7)*v(4144)+v(1598)*v(4177)
  intstiff(19,21)=v(2725)+v(2585)*v(4117)
  intstiff(19,22)=v(1587)*v(2591)+v(2789)+v(1649)*v(4176)
  intstiff(19,23)=v(2851)+ffor(7)*v(4145)+v(1599)*v(4177)
  intstiff(19,24)=v(2897)+v(2585)*v(4118)
  intstiff(19,25)=v(1588)*v(2591)+v(2962)+v(1653)*v(4176)
  intstiff(19,26)=v(3027)+ffor(7)*v(4146)+v(1600)*v(4177)
  intstiff(19,27)=v(3076)+v(2585)*v(4119)
  intstiff(19,28)=v(1589)*v(2591)+v(3142)+v(1657)*v(4176)
  intstiff(19,29)=v(3210)+ffor(7)*v(4147)+v(1601)*v(4177)
  intstiff(19,30)=v(3262)+v(2585)*v(4120)
  intstiff(19,31)=v(1590)*v(2591)+v(3329)+v(1661)*v(4176)
  intstiff(19,32)=v(3399)+ffor(7)*v(4148)+v(1602)*v(4177)
  intstiff(19,33)=v(3455)+v(2585)*v(4121)
  intstiff(19,34)=v(1591)*v(2591)+v(3523)+v(1665)*v(4176)
  intstiff(19,35)=v(3596)+ffor(7)*v(4149)+v(1603)*v(4177)
  intstiff(19,36)=v(3732)+v(2585)*v(4122)
  intstiff(20,1)=v(2643)+ffor(7)*v(4150)+v(1580)*v(4178)
  intstiff(20,2)=v(2645)+v(1592)*v(2654)+v(1673)*v(4176)
  intstiff(20,3)=-v(2647)+v(2585)*v(4124)
  intstiff(20,4)=v(2649)+ffor(7)*v(4152)+v(1581)*v(4178)
  intstiff(20,5)=v(2653)+v(1593)*v(2654)+v(1682)*v(4176)
  intstiff(20,6)=-v(2656)+v(2585)*v(4125)
  intstiff(20,7)=v(2658)+ffor(7)*v(4153)+v(1582)*v(4178)
  intstiff(20,8)=v(1594)*v(2654)+v(2660)+v(1688)*v(4176)
  intstiff(20,9)=-v(2662)+v(2585)*v(4126)
  intstiff(20,10)=v(2664)+ffor(7)*v(4154)+v(1583)*v(4178)
  intstiff(20,11)=v(1595)*v(2654)+v(2666)+v(1694)*v(4176)
  intstiff(20,12)=-v(2668)+v(2585)*v(4127)
  intstiff(20,13)=v(2670)+ffor(7)*v(4155)+v(1584)*v(4178)
  intstiff(20,14)=v(1596)*v(2654)+v(2672)+v(1700)*v(4176)
  intstiff(20,15)=-v(2674)+v(2585)*v(4128)
  intstiff(20,16)=v(2676)+ffor(7)*v(4156)+v(1585)*v(4178)
  intstiff(20,17)=v(1597)*v(2654)+v(2678)+v(1706)*v(4176)
  intstiff(20,18)=-v(2680)+v(2585)*v(4129)
  intstiff(20,19)=v(2682)+ffor(7)*v(4157)+v(1586)*v(4178)
  intstiff(20,20)=v(1598)*v(2654)+v(1712)*v(4176)+(v(2630)*v(3735)+v(3714)*v(3792))*vol
  intstiff(20,21)=v(2727)+v(2585)*v(4130)
  intstiff(20,22)=v(2791)+ffor(7)*v(4158)+v(1587)*v(4178)
  intstiff(20,23)=v(1599)*v(2654)+v(2853)+v(1718)*v(4176)
  intstiff(20,24)=v(2899)+v(2585)*v(4131)
  intstiff(20,25)=v(2964)+ffor(7)*v(4159)+v(1588)*v(4178)
  intstiff(20,26)=v(1600)*v(2654)+v(3029)+v(1724)*v(4176)
  intstiff(20,27)=v(3078)+v(2585)*v(4132)
  intstiff(20,28)=v(3144)+ffor(7)*v(4160)+v(1589)*v(4178)
  intstiff(20,29)=v(1601)*v(2654)+v(3212)+v(1730)*v(4176)
  intstiff(20,30)=v(3264)+v(2585)*v(4133)
  intstiff(20,31)=v(3331)+ffor(7)*v(4161)+v(1590)*v(4178)
  intstiff(20,32)=v(1602)*v(2654)+v(3401)+v(1736)*v(4176)
  intstiff(20,33)=v(3457)+v(2585)*v(4134)
  intstiff(20,34)=v(3525)+ffor(7)*v(4162)+v(1591)*v(4178)
  intstiff(20,35)=v(1603)*v(2654)+v(3598)+v(1742)*v(4176)
  intstiff(20,36)=v(3790)+v(2585)*v(4135)
  intstiff(21,1)=-v(2701)+(der(2,7)*v(1898)+der(1,7)*v(1899))*v(3948)
  intstiff(21,2)=-v(2703)+(der(1,7)*v(1902)+der(2,7)*v(1903))*v(3948)
  intstiff(21,3)=v(1769)
  intstiff(21,4)=-v(2705)+(der(2,7)*v(1906)+der(1,7)*v(1907))*v(3948)
  intstiff(21,5)=-v(2707)+(der(1,7)*v(1910)+der(2,7)*v(1911))*v(3948)
  intstiff(21,6)=v(1950)
  intstiff(21,7)=-v(2709)+(der(2,7)*v(1916)+der(1,7)*v(1917))*v(3948)
  intstiff(21,8)=-v(2711)+(der(1,7)*v(1919)+der(2,7)*v(1920))*v(3948)
  intstiff(21,9)=v(2109)
  intstiff(21,10)=-v(2713)+(der(2,7)*v(1923)+der(1,7)*v(1924))*v(3948)
  intstiff(21,11)=-v(2715)+(der(1,7)*v(1926)+der(2,7)*v(1927))*v(3948)
  intstiff(21,12)=v(2254)
  intstiff(21,13)=-v(2717)+(der(2,7)*v(1930)+der(1,7)*v(1931))*v(3948)
  intstiff(21,14)=-v(2719)+(der(1,7)*v(1933)+der(2,7)*v(1934))*v(3948)
  intstiff(21,15)=v(2406)
  intstiff(21,16)=-v(2721)+(der(2,7)*v(1937)+der(1,7)*v(1938))*v(3948)
  intstiff(21,17)=-v(2723)+(der(1,7)*v(1940)+der(2,7)*v(1941))*v(3948)
  intstiff(21,18)=v(2565)
  intstiff(21,19)=-v(2725)+(der(2,7)*v(1944)+der(1,7)*v(1945))*v(3948)
  intstiff(21,20)=-v(2727)+(der(1,7)*v(1947)+der(2,7)*v(1948))*v(3948)
  intstiff(21,21)=(v(3734)+v(3792))*v(3948)
  intstiff(21,22)=v(2793)+(der(2,7)*v(1951)+der(1,7)*v(1952))*v(3948)
  intstiff(21,23)=v(2855)+(der(1,7)*v(1954)+der(2,7)*v(1955))*v(3948)
  intstiff(21,24)=v(2734)
  intstiff(21,25)=v(2966)+(der(2,7)*v(1958)+der(1,7)*v(1959))*v(3948)
  intstiff(21,26)=v(3031)+(der(1,7)*v(1961)+der(2,7)*v(1962))*v(3948)
  intstiff(21,27)=v(2737)
  intstiff(21,28)=v(3146)+(der(2,7)*v(1965)+der(1,7)*v(1966))*v(3948)
  intstiff(21,29)=v(3214)+(der(1,7)*v(1968)+der(2,7)*v(1969))*v(3948)
  intstiff(21,30)=v(2740)
  intstiff(21,31)=v(3333)+(der(2,7)*v(1972)+der(1,7)*v(1973))*v(3948)
  intstiff(21,32)=v(3403)+(der(1,7)*v(1975)+der(2,7)*v(1976))*v(3948)
  intstiff(21,33)=v(2743)
  intstiff(21,34)=v(3527)+(der(2,7)*v(1979)+der(1,7)*v(1980))*v(3948)
  intstiff(21,35)=v(3600)+(der(1,7)*v(1982)+der(2,7)*v(1983))*v(3948)
  intstiff(21,36)=v(2746)
  intstiff(22,1)=v(2747)+v(1580)*v(2757)+v(1605)*v(4179)
  intstiff(22,2)=v(2750)+v(1592)*(v(2752)*v(3873)+v(4180))
  intstiff(22,3)=-v(2754)+v(2751)*v(4112)
  intstiff(22,4)=v(2756)+v(1581)*v(2757)+v(1619)*v(4179)
  intstiff(22,5)=v(2759)+ffor(8)*v(4138)+v(1593)*v(4180)
  intstiff(22,6)=-v(2763)+v(2751)*v(4165)
  intstiff(22,7)=v(1582)*v(2757)+v(2765)+v(1626)*v(4179)
  intstiff(22,8)=v(2767)+ffor(8)*v(4140)+v(1594)*v(4180)
  intstiff(22,9)=-v(2769)+v(2751)*v(4113)
  intstiff(22,10)=v(1583)*v(2757)+v(2771)+v(1632)*v(4179)
  intstiff(22,11)=v(2773)+ffor(8)*v(4141)+v(1595)*v(4180)
  intstiff(22,12)=-v(2775)+v(2751)*v(4114)
  intstiff(22,13)=v(1584)*v(2757)+v(2777)+v(1637)*v(4179)
  intstiff(22,14)=v(2779)+ffor(8)*v(4142)+v(1596)*v(4180)
  intstiff(22,15)=-v(2781)+v(2751)*v(4115)
  intstiff(22,16)=v(1585)*v(2757)+v(2783)+v(1641)*v(4179)
  intstiff(22,17)=v(2785)+ffor(8)*v(4143)+v(1597)*v(4180)
  intstiff(22,18)=-v(2787)+v(2751)*v(4116)
  intstiff(22,19)=v(1586)*v(2757)+v(2789)+v(1645)*v(4179)
  intstiff(22,20)=v(2791)+ffor(8)*v(4144)+v(1598)*v(4180)
  intstiff(22,21)=-v(2793)+v(2751)*v(4117)
  intstiff(22,22)=v(1587)*v(2757)+v(1649)*v(4179)+(v(3714)*v(3738)+v(2796)*v(3800))*vol
  intstiff(22,23)=v(2857)+ffor(8)*v(4145)+v(1599)*v(4180)
  intstiff(22,24)=v(2901)+v(2751)*v(4118)
  intstiff(22,25)=v(1588)*v(2757)+v(2968)+v(1653)*v(4179)
  intstiff(22,26)=v(3033)+ffor(8)*v(4146)+v(1600)*v(4180)
  intstiff(22,27)=v(3080)+v(2751)*v(4119)
  intstiff(22,28)=v(1589)*v(2757)+v(3148)+v(1657)*v(4179)
  intstiff(22,29)=v(3216)+ffor(8)*v(4147)+v(1601)*v(4180)
  intstiff(22,30)=v(3266)+v(2751)*v(4120)
  intstiff(22,31)=v(1590)*v(2757)+v(3335)+v(1661)*v(4179)
  intstiff(22,32)=v(3405)+ffor(8)*v(4148)+v(1602)*v(4180)
  intstiff(22,33)=v(3459)+v(2751)*v(4121)
  intstiff(22,34)=v(1591)*v(2757)+v(3529)+v(1665)*v(4179)
  intstiff(22,35)=v(3602)+ffor(8)*v(4149)+v(1603)*v(4180)
  intstiff(22,36)=v(3736)+v(2751)*v(4122)
  intstiff(23,1)=v(2812)+ffor(8)*v(4150)+v(1580)*v(4181)
  intstiff(23,2)=v(2814)+v(1592)*v(2823)+v(1673)*v(4179)
  intstiff(23,3)=-v(2816)+v(2751)*v(4124)
  intstiff(23,4)=v(2818)+ffor(8)*v(4152)+v(1581)*v(4181)
  intstiff(23,5)=v(2822)+v(1593)*v(2823)+v(1682)*v(4179)
  intstiff(23,6)=-v(2825)+v(2751)*v(4125)
  intstiff(23,7)=v(2827)+ffor(8)*v(4153)+v(1582)*v(4181)
  intstiff(23,8)=v(1594)*v(2823)+v(2829)+v(1688)*v(4179)
  intstiff(23,9)=-v(2831)+v(2751)*v(4126)
  intstiff(23,10)=v(2833)+ffor(8)*v(4154)+v(1583)*v(4181)
  intstiff(23,11)=v(1595)*v(2823)+v(2835)+v(1694)*v(4179)
  intstiff(23,12)=-v(2837)+v(2751)*v(4127)
  intstiff(23,13)=v(2839)+ffor(8)*v(4155)+v(1584)*v(4181)
  intstiff(23,14)=v(1596)*v(2823)+v(2841)+v(1700)*v(4179)
  intstiff(23,15)=-v(2843)+v(2751)*v(4128)
  intstiff(23,16)=v(2845)+ffor(8)*v(4156)+v(1585)*v(4181)
  intstiff(23,17)=v(1597)*v(2823)+v(2847)+v(1706)*v(4179)
  intstiff(23,18)=-v(2849)+v(2751)*v(4129)
  intstiff(23,19)=v(2851)+ffor(8)*v(4157)+v(1586)*v(4181)
  intstiff(23,20)=v(1598)*v(2823)+v(2853)+v(1712)*v(4179)
  intstiff(23,21)=-v(2855)+v(2751)*v(4130)
  intstiff(23,22)=v(2857)+ffor(8)*v(4158)+v(1587)*v(4181)
  intstiff(23,23)=v(1599)*v(2823)+v(1718)*v(4179)+(v(2802)*v(3739)+v(3714)*v(3798))*vol
  intstiff(23,24)=v(2903)+v(2751)*v(4131)
  intstiff(23,25)=v(2970)+ffor(8)*v(4159)+v(1588)*v(4181)
  intstiff(23,26)=v(1600)*v(2823)+v(3035)+v(1724)*v(4179)
  intstiff(23,27)=v(3082)+v(2751)*v(4132)
  intstiff(23,28)=v(3150)+ffor(8)*v(4160)+v(1589)*v(4181)
  intstiff(23,29)=v(1601)*v(2823)+v(3218)+v(1730)*v(4179)
  intstiff(23,30)=v(3268)+v(2751)*v(4133)
  intstiff(23,31)=v(3337)+ffor(8)*v(4161)+v(1590)*v(4181)
  intstiff(23,32)=v(1602)*v(2823)+v(3407)+v(1736)*v(4179)
  intstiff(23,33)=v(3461)+v(2751)*v(4134)
  intstiff(23,34)=v(3531)+ffor(8)*v(4162)+v(1591)*v(4181)
  intstiff(23,35)=v(1603)*v(2823)+v(3604)+v(1742)*v(4179)
  intstiff(23,36)=v(3796)+v(2751)*v(4135)
  intstiff(24,1)=-v(2873)+(der(2,8)*v(1898)+der(1,8)*v(1899))*v(3948)
  intstiff(24,2)=-v(2875)+(der(1,8)*v(1902)+der(2,8)*v(1903))*v(3948)
  intstiff(24,3)=v(1772)
  intstiff(24,4)=-v(2877)+(der(2,8)*v(1906)+der(1,8)*v(1907))*v(3948)
  intstiff(24,5)=-v(2879)+(der(1,8)*v(1910)+der(2,8)*v(1911))*v(3948)
  intstiff(24,6)=v(1957)
  intstiff(24,7)=-v(2881)+(der(2,8)*v(1916)+der(1,8)*v(1917))*v(3948)
  intstiff(24,8)=-v(2883)+(der(1,8)*v(1919)+der(2,8)*v(1920))*v(3948)
  intstiff(24,9)=v(2112)
  intstiff(24,10)=-v(2885)+(der(2,8)*v(1923)+der(1,8)*v(1924))*v(3948)
  intstiff(24,11)=-v(2887)+(der(1,8)*v(1926)+der(2,8)*v(1927))*v(3948)
  intstiff(24,12)=v(2257)
  intstiff(24,13)=-v(2889)+(der(2,8)*v(1930)+der(1,8)*v(1931))*v(3948)
  intstiff(24,14)=-v(2891)+(der(1,8)*v(1933)+der(2,8)*v(1934))*v(3948)
  intstiff(24,15)=v(2409)
  intstiff(24,16)=-v(2893)+(der(2,8)*v(1937)+der(1,8)*v(1938))*v(3948)
  intstiff(24,17)=-v(2895)+(der(1,8)*v(1940)+der(2,8)*v(1941))*v(3948)
  intstiff(24,18)=v(2568)
  intstiff(24,19)=-v(2897)+(der(2,8)*v(1944)+der(1,8)*v(1945))*v(3948)
  intstiff(24,20)=-v(2899)+(der(1,8)*v(1947)+der(2,8)*v(1948))*v(3948)
  intstiff(24,21)=v(2734)
  intstiff(24,22)=-v(2901)+(der(2,8)*v(1951)+der(1,8)*v(1952))*v(3948)
  intstiff(24,23)=-v(2903)+(der(1,8)*v(1954)+der(2,8)*v(1955))*v(3948)
  intstiff(24,24)=(v(3738)+v(3798))*v(3948)
  intstiff(24,25)=v(2972)+(der(2,8)*v(1958)+der(1,8)*v(1959))*v(3948)
  intstiff(24,26)=v(3037)+(der(1,8)*v(1961)+der(2,8)*v(1962))*v(3948)
  intstiff(24,27)=v(2910)
  intstiff(24,28)=v(3152)+(der(2,8)*v(1965)+der(1,8)*v(1966))*v(3948)
  intstiff(24,29)=v(3220)+(der(1,8)*v(1968)+der(2,8)*v(1969))*v(3948)
  intstiff(24,30)=v(2913)
  intstiff(24,31)=v(3339)+(der(2,8)*v(1972)+der(1,8)*v(1973))*v(3948)
  intstiff(24,32)=v(3409)+(der(1,8)*v(1975)+der(2,8)*v(1976))*v(3948)
  intstiff(24,33)=v(2916)
  intstiff(24,34)=v(3533)+(der(2,8)*v(1979)+der(1,8)*v(1980))*v(3948)
  intstiff(24,35)=v(3606)+(der(1,8)*v(1982)+der(2,8)*v(1983))*v(3948)
  intstiff(24,36)=v(2919)
  intstiff(25,1)=v(2920)+v(1580)*v(2930)+v(1605)*v(4182)
  intstiff(25,2)=v(2923)+v(1592)*(v(2925)*v(3873)+v(4183))
  intstiff(25,3)=-v(2927)+v(2924)*v(4112)
  intstiff(25,4)=v(2929)+v(1581)*v(2930)+v(1619)*v(4182)
  intstiff(25,5)=v(2932)+ffor(9)*v(4138)+v(1593)*v(4183)
  intstiff(25,6)=-v(2936)+v(2924)*v(4165)
  intstiff(25,7)=v(1582)*v(2930)+v(2938)+v(1626)*v(4182)
  intstiff(25,8)=v(2940)+ffor(9)*v(4140)+v(1594)*v(4183)
  intstiff(25,9)=-v(2942)+v(2924)*v(4113)
  intstiff(25,10)=v(1583)*v(2930)+v(2944)+v(1632)*v(4182)
  intstiff(25,11)=v(2946)+ffor(9)*v(4141)+v(1595)*v(4183)
  intstiff(25,12)=-v(2948)+v(2924)*v(4114)
  intstiff(25,13)=v(1584)*v(2930)+v(2950)+v(1637)*v(4182)
  intstiff(25,14)=v(2952)+ffor(9)*v(4142)+v(1596)*v(4183)
  intstiff(25,15)=-v(2954)+v(2924)*v(4115)
  intstiff(25,16)=v(1585)*v(2930)+v(2956)+v(1641)*v(4182)
  intstiff(25,17)=v(2958)+ffor(9)*v(4143)+v(1597)*v(4183)
  intstiff(25,18)=-v(2960)+v(2924)*v(4116)
  intstiff(25,19)=v(1586)*v(2930)+v(2962)+v(1645)*v(4182)
  intstiff(25,20)=v(2964)+ffor(9)*v(4144)+v(1598)*v(4183)
  intstiff(25,21)=-v(2966)+v(2924)*v(4117)
  intstiff(25,22)=v(1587)*v(2930)+v(2968)+v(1649)*v(4182)
  intstiff(25,23)=v(2970)+ffor(9)*v(4145)+v(1599)*v(4183)
  intstiff(25,24)=-v(2972)+v(2924)*v(4118)
  intstiff(25,25)=v(1588)*v(2930)+v(1653)*v(4182)+(v(3714)*v(3742)+v(2975)*v(3806))*vol
  intstiff(25,26)=v(3039)+ffor(9)*v(4146)+v(1600)*v(4183)
  intstiff(25,27)=v(3084)+v(2924)*v(4119)
  intstiff(25,28)=v(1589)*v(2930)+v(3154)+v(1657)*v(4182)
  intstiff(25,29)=v(3222)+ffor(9)*v(4147)+v(1601)*v(4183)
  intstiff(25,30)=v(3270)+v(2924)*v(4120)
  intstiff(25,31)=v(1590)*v(2930)+v(3341)+v(1661)*v(4182)
  intstiff(25,32)=v(3411)+ffor(9)*v(4148)+v(1602)*v(4183)
  intstiff(25,33)=v(3463)+v(2924)*v(4121)
  intstiff(25,34)=v(1591)*v(2930)+v(3535)+v(1665)*v(4182)
  intstiff(25,35)=v(3608)+ffor(9)*v(4149)+v(1603)*v(4183)
  intstiff(25,36)=v(3740)+v(2924)*v(4122)
  intstiff(26,1)=v(2988)+ffor(9)*v(4150)+v(1580)*v(4184)
  intstiff(26,2)=v(2990)+v(1592)*v(2999)+v(1673)*v(4182)
  intstiff(26,3)=-v(2992)+v(2924)*v(4124)
  intstiff(26,4)=v(2994)+ffor(9)*v(4152)+v(1581)*v(4184)
  intstiff(26,5)=v(2998)+v(1593)*v(2999)+v(1682)*v(4182)
  intstiff(26,6)=-v(3001)+v(2924)*v(4125)
  intstiff(26,7)=v(3003)+ffor(9)*v(4153)+v(1582)*v(4184)
  intstiff(26,8)=v(1594)*v(2999)+v(3005)+v(1688)*v(4182)
  intstiff(26,9)=-v(3007)+v(2924)*v(4126)
  intstiff(26,10)=v(3009)+ffor(9)*v(4154)+v(1583)*v(4184)
  intstiff(26,11)=v(1595)*v(2999)+v(3011)+v(1694)*v(4182)
  intstiff(26,12)=-v(3013)+v(2924)*v(4127)
  intstiff(26,13)=v(3015)+ffor(9)*v(4155)+v(1584)*v(4184)
  intstiff(26,14)=v(1596)*v(2999)+v(3017)+v(1700)*v(4182)
  intstiff(26,15)=-v(3019)+v(2924)*v(4128)
  intstiff(26,16)=v(3021)+ffor(9)*v(4156)+v(1585)*v(4184)
  intstiff(26,17)=v(1597)*v(2999)+v(3023)+v(1706)*v(4182)
  intstiff(26,18)=-v(3025)+v(2924)*v(4129)
  intstiff(26,19)=v(3027)+ffor(9)*v(4157)+v(1586)*v(4184)
  intstiff(26,20)=v(1598)*v(2999)+v(3029)+v(1712)*v(4182)
  intstiff(26,21)=-v(3031)+v(2924)*v(4130)
  intstiff(26,22)=v(3033)+ffor(9)*v(4158)+v(1587)*v(4184)
  intstiff(26,23)=v(1599)*v(2999)+v(3035)+v(1718)*v(4182)
  intstiff(26,24)=-v(3037)+v(2924)*v(4131)
  intstiff(26,25)=v(3039)+ffor(9)*v(4159)+v(1588)*v(4184)
  intstiff(26,26)=v(1600)*v(2999)+v(1724)*v(4182)+(v(2981)*v(3743)+v(3714)*v(3804))*vol
  intstiff(26,27)=v(3086)+v(2924)*v(4132)
  intstiff(26,28)=v(3156)+ffor(9)*v(4160)+v(1589)*v(4184)
  intstiff(26,29)=v(1601)*v(2999)+v(3224)+v(1730)*v(4182)
  intstiff(26,30)=v(3272)+v(2924)*v(4133)
  intstiff(26,31)=v(3343)+ffor(9)*v(4161)+v(1590)*v(4184)
  intstiff(26,32)=v(1602)*v(2999)+v(3413)+v(1736)*v(4182)
  intstiff(26,33)=v(3465)+v(2924)*v(4134)
  intstiff(26,34)=v(3537)+ffor(9)*v(4162)+v(1591)*v(4184)
  intstiff(26,35)=v(1603)*v(2999)+v(3610)+v(1742)*v(4182)
  intstiff(26,36)=v(3802)+v(2924)*v(4135)
  intstiff(27,1)=-v(3052)+(der(2,9)*v(1898)+der(1,9)*v(1899))*v(3948)
  intstiff(27,2)=-v(3054)+(der(1,9)*v(1902)+der(2,9)*v(1903))*v(3948)
  intstiff(27,3)=v(1775)
  intstiff(27,4)=-v(3056)+(der(2,9)*v(1906)+der(1,9)*v(1907))*v(3948)
  intstiff(27,5)=-v(3058)+(der(1,9)*v(1910)+der(2,9)*v(1911))*v(3948)
  intstiff(27,6)=v(1964)
  intstiff(27,7)=-v(3060)+(der(2,9)*v(1916)+der(1,9)*v(1917))*v(3948)
  intstiff(27,8)=-v(3062)+(der(1,9)*v(1919)+der(2,9)*v(1920))*v(3948)
  intstiff(27,9)=v(2115)
  intstiff(27,10)=-v(3064)+(der(2,9)*v(1923)+der(1,9)*v(1924))*v(3948)
  intstiff(27,11)=-v(3066)+(der(1,9)*v(1926)+der(2,9)*v(1927))*v(3948)
  intstiff(27,12)=v(2260)
  intstiff(27,13)=-v(3068)+(der(2,9)*v(1930)+der(1,9)*v(1931))*v(3948)
  intstiff(27,14)=-v(3070)+(der(1,9)*v(1933)+der(2,9)*v(1934))*v(3948)
  intstiff(27,15)=v(2412)
  intstiff(27,16)=-v(3072)+(der(2,9)*v(1937)+der(1,9)*v(1938))*v(3948)
  intstiff(27,17)=-v(3074)+(der(1,9)*v(1940)+der(2,9)*v(1941))*v(3948)
  intstiff(27,18)=v(2571)
  intstiff(27,19)=-v(3076)+(der(2,9)*v(1944)+der(1,9)*v(1945))*v(3948)
  intstiff(27,20)=-v(3078)+(der(1,9)*v(1947)+der(2,9)*v(1948))*v(3948)
  intstiff(27,21)=v(2737)
  intstiff(27,22)=-v(3080)+(der(2,9)*v(1951)+der(1,9)*v(1952))*v(3948)
  intstiff(27,23)=-v(3082)+(der(1,9)*v(1954)+der(2,9)*v(1955))*v(3948)
  intstiff(27,24)=v(2910)
  intstiff(27,25)=-v(3084)+(der(2,9)*v(1958)+der(1,9)*v(1959))*v(3948)
  intstiff(27,26)=-v(3086)+(der(1,9)*v(1961)+der(2,9)*v(1962))*v(3948)
  intstiff(27,27)=(v(3742)+v(3804))*v(3948)
  intstiff(27,28)=v(3158)+(der(2,9)*v(1965)+der(1,9)*v(1966))*v(3948)
  intstiff(27,29)=v(3226)+(der(1,9)*v(1968)+der(2,9)*v(1969))*v(3948)
  intstiff(27,30)=v(3093)
  intstiff(27,31)=v(3345)+(der(2,9)*v(1972)+der(1,9)*v(1973))*v(3948)
  intstiff(27,32)=v(3415)+(der(1,9)*v(1975)+der(2,9)*v(1976))*v(3948)
  intstiff(27,33)=v(3096)
  intstiff(27,34)=v(3539)+(der(2,9)*v(1979)+der(1,9)*v(1980))*v(3948)
  intstiff(27,35)=v(3612)+(der(1,9)*v(1982)+der(2,9)*v(1983))*v(3948)
  intstiff(27,36)=v(3099)
  intstiff(28,1)=v(3100)+v(1580)*v(3110)+v(1605)*v(4185)
  intstiff(28,2)=v(3103)+v(1592)*(v(3105)*v(3873)+v(4186))
  intstiff(28,3)=-v(3107)+v(3104)*v(4112)
  intstiff(28,4)=v(3109)+v(1581)*v(3110)+v(1619)*v(4185)
  intstiff(28,5)=v(3112)+ffor(10)*v(4138)+v(1593)*v(4186)
  intstiff(28,6)=-v(3116)+v(3104)*v(4165)
  intstiff(28,7)=v(1582)*v(3110)+v(3118)+v(1626)*v(4185)
  intstiff(28,8)=v(3120)+ffor(10)*v(4140)+v(1594)*v(4186)
  intstiff(28,9)=-v(3122)+v(3104)*v(4113)
  intstiff(28,10)=v(1583)*v(3110)+v(3124)+v(1632)*v(4185)
  intstiff(28,11)=v(3126)+ffor(10)*v(4141)+v(1595)*v(4186)
  intstiff(28,12)=-v(3128)+v(3104)*v(4114)
  intstiff(28,13)=v(1584)*v(3110)+v(3130)+v(1637)*v(4185)
  intstiff(28,14)=v(3132)+ffor(10)*v(4142)+v(1596)*v(4186)
  intstiff(28,15)=-v(3134)+v(3104)*v(4115)
  intstiff(28,16)=v(1585)*v(3110)+v(3136)+v(1641)*v(4185)
  intstiff(28,17)=v(3138)+ffor(10)*v(4143)+v(1597)*v(4186)
  intstiff(28,18)=-v(3140)+v(3104)*v(4116)
  intstiff(28,19)=v(1586)*v(3110)+v(3142)+v(1645)*v(4185)
  intstiff(28,20)=v(3144)+ffor(10)*v(4144)+v(1598)*v(4186)
  intstiff(28,21)=-v(3146)+v(3104)*v(4117)
  intstiff(28,22)=v(1587)*v(3110)+v(3148)+v(1649)*v(4185)
  intstiff(28,23)=v(3150)+ffor(10)*v(4145)+v(1599)*v(4186)
  intstiff(28,24)=-v(3152)+v(3104)*v(4118)
  intstiff(28,25)=v(1588)*v(3110)+v(3154)+v(1653)*v(4185)
  intstiff(28,26)=v(3156)+ffor(10)*v(4146)+v(1600)*v(4186)
  intstiff(28,27)=-v(3158)+v(3104)*v(4119)
  intstiff(28,28)=v(1589)*v(3110)+v(1657)*v(4185)+(v(3714)*v(3746)+v(3161)*v(3812))*vol
  intstiff(28,29)=v(3228)+ffor(10)*v(4147)+v(1601)*v(4186)
  intstiff(28,30)=v(3274)+v(3104)*v(4120)
  intstiff(28,31)=v(1590)*v(3110)+v(3347)+v(1661)*v(4185)
  intstiff(28,32)=v(3417)+ffor(10)*v(4148)+v(1602)*v(4186)
  intstiff(28,33)=v(3467)+v(3104)*v(4121)
  intstiff(28,34)=v(1591)*v(3110)+v(3541)+v(1665)*v(4185)
  intstiff(28,35)=v(3614)+ffor(10)*v(4149)+v(1603)*v(4186)
  intstiff(28,36)=v(3744)+v(3104)*v(4122)
  intstiff(29,1)=v(3171)+ffor(10)*v(4150)+v(1580)*v(4187)
  intstiff(29,2)=v(3173)+v(1592)*v(3182)+v(1673)*v(4185)
  intstiff(29,3)=-v(3175)+v(3104)*v(4124)
  intstiff(29,4)=v(3177)+ffor(10)*v(4152)+v(1581)*v(4187)
  intstiff(29,5)=v(3181)+v(1593)*v(3182)+v(1682)*v(4185)
  intstiff(29,6)=-v(3184)+v(3104)*v(4125)
  intstiff(29,7)=v(3186)+ffor(10)*v(4153)+v(1582)*v(4187)
  intstiff(29,8)=v(1594)*v(3182)+v(3188)+v(1688)*v(4185)
  intstiff(29,9)=-v(3190)+v(3104)*v(4126)
  intstiff(29,10)=v(3192)+ffor(10)*v(4154)+v(1583)*v(4187)
  intstiff(29,11)=v(1595)*v(3182)+v(3194)+v(1694)*v(4185)
  intstiff(29,12)=-v(3196)+v(3104)*v(4127)
  intstiff(29,13)=v(3198)+ffor(10)*v(4155)+v(1584)*v(4187)
  intstiff(29,14)=v(1596)*v(3182)+v(3200)+v(1700)*v(4185)
  intstiff(29,15)=-v(3202)+v(3104)*v(4128)
  intstiff(29,16)=v(3204)+ffor(10)*v(4156)+v(1585)*v(4187)
  intstiff(29,17)=v(1597)*v(3182)+v(3206)+v(1706)*v(4185)
  intstiff(29,18)=-v(3208)+v(3104)*v(4129)
  intstiff(29,19)=v(3210)+ffor(10)*v(4157)+v(1586)*v(4187)
  intstiff(29,20)=v(1598)*v(3182)+v(3212)+v(1712)*v(4185)
  intstiff(29,21)=-v(3214)+v(3104)*v(4130)
  intstiff(29,22)=v(3216)+ffor(10)*v(4158)+v(1587)*v(4187)
  intstiff(29,23)=v(1599)*v(3182)+v(3218)+v(1718)*v(4185)
  intstiff(29,24)=-v(3220)+v(3104)*v(4131)
  intstiff(29,25)=v(3222)+ffor(10)*v(4159)+v(1588)*v(4187)
  intstiff(29,26)=v(1600)*v(3182)+v(3224)+v(1724)*v(4185)
  intstiff(29,27)=-v(3226)+v(3104)*v(4132)
  intstiff(29,28)=v(3228)+ffor(10)*v(4160)+v(1589)*v(4187)
  intstiff(29,29)=v(1601)*v(3182)+v(1730)*v(4185)+(v(3167)*v(3747)+v(3714)*v(3810))*vol
  intstiff(29,30)=v(3276)+v(3104)*v(4133)
  intstiff(29,31)=v(3349)+ffor(10)*v(4161)+v(1590)*v(4187)
  intstiff(29,32)=v(1602)*v(3182)+v(3419)+v(1736)*v(4185)
  intstiff(29,33)=v(3469)+v(3104)*v(4134)
  intstiff(29,34)=v(3543)+ffor(10)*v(4162)+v(1591)*v(4187)
  intstiff(29,35)=v(1603)*v(3182)+v(3616)+v(1742)*v(4185)
  intstiff(29,36)=v(3808)+v(3104)*v(4135)
  intstiff(30,1)=-v(3238)+(der(2,10)*v(1898)+der(1,10)*v(1899))*v(3948)
  intstiff(30,2)=-v(3240)+(der(1,10)*v(1902)+der(2,10)*v(1903))*v(3948)
  intstiff(30,3)=v(1778)
  intstiff(30,4)=-v(3242)+(der(2,10)*v(1906)+der(1,10)*v(1907))*v(3948)
  intstiff(30,5)=-v(3244)+(der(1,10)*v(1910)+der(2,10)*v(1911))*v(3948)
  intstiff(30,6)=v(1971)
  intstiff(30,7)=-v(3246)+(der(2,10)*v(1916)+der(1,10)*v(1917))*v(3948)
  intstiff(30,8)=-v(3248)+(der(1,10)*v(1919)+der(2,10)*v(1920))*v(3948)
  intstiff(30,9)=v(2118)
  intstiff(30,10)=-v(3250)+(der(2,10)*v(1923)+der(1,10)*v(1924))*v(3948)
  intstiff(30,11)=-v(3252)+(der(1,10)*v(1926)+der(2,10)*v(1927))*v(3948)
  intstiff(30,12)=v(2263)
  intstiff(30,13)=-v(3254)+(der(2,10)*v(1930)+der(1,10)*v(1931))*v(3948)
  intstiff(30,14)=-v(3256)+(der(1,10)*v(1933)+der(2,10)*v(1934))*v(3948)
  intstiff(30,15)=v(2415)
  intstiff(30,16)=-v(3258)+(der(2,10)*v(1937)+der(1,10)*v(1938))*v(3948)
  intstiff(30,17)=-v(3260)+(der(1,10)*v(1940)+der(2,10)*v(1941))*v(3948)
  intstiff(30,18)=v(2574)
  intstiff(30,19)=-v(3262)+(der(2,10)*v(1944)+der(1,10)*v(1945))*v(3948)
  intstiff(30,20)=-v(3264)+(der(1,10)*v(1947)+der(2,10)*v(1948))*v(3948)
  intstiff(30,21)=v(2740)
  intstiff(30,22)=-v(3266)+(der(2,10)*v(1951)+der(1,10)*v(1952))*v(3948)
  intstiff(30,23)=-v(3268)+(der(1,10)*v(1954)+der(2,10)*v(1955))*v(3948)
  intstiff(30,24)=v(2913)
  intstiff(30,25)=-v(3270)+(der(2,10)*v(1958)+der(1,10)*v(1959))*v(3948)
  intstiff(30,26)=-v(3272)+(der(1,10)*v(1961)+der(2,10)*v(1962))*v(3948)
  intstiff(30,27)=v(3093)
  intstiff(30,28)=-v(3274)+(der(2,10)*v(1965)+der(1,10)*v(1966))*v(3948)
  intstiff(30,29)=-v(3276)+(der(1,10)*v(1968)+der(2,10)*v(1969))*v(3948)
  intstiff(30,30)=(v(3746)+v(3810))*v(3948)
  intstiff(30,31)=v(3351)+(der(2,10)*v(1972)+der(1,10)*v(1973))*v(3948)
  intstiff(30,32)=v(3421)+(der(1,10)*v(1975)+der(2,10)*v(1976))*v(3948)
  intstiff(30,33)=v(3283)
  intstiff(30,34)=v(3545)+(der(2,10)*v(1979)+der(1,10)*v(1980))*v(3948)
  intstiff(30,35)=v(3618)+(der(1,10)*v(1982)+der(2,10)*v(1983))*v(3948)
  intstiff(30,36)=v(3286)
  intstiff(31,1)=v(3287)+v(1580)*v(3297)+v(1605)*v(4188)
  intstiff(31,2)=v(3290)+v(1592)*(v(3292)*v(3873)+v(4189))
  intstiff(31,3)=-v(3294)+v(3291)*v(4112)
  intstiff(31,4)=v(3296)+v(1581)*v(3297)+v(1619)*v(4188)
  intstiff(31,5)=v(3299)+ffor(11)*v(4138)+v(1593)*v(4189)
  intstiff(31,6)=-v(3303)+v(3291)*v(4165)
  intstiff(31,7)=v(1582)*v(3297)+v(3305)+v(1626)*v(4188)
  intstiff(31,8)=v(3307)+ffor(11)*v(4140)+v(1594)*v(4189)
  intstiff(31,9)=-v(3309)+v(3291)*v(4113)
  intstiff(31,10)=v(1583)*v(3297)+v(3311)+v(1632)*v(4188)
  intstiff(31,11)=v(3313)+ffor(11)*v(4141)+v(1595)*v(4189)
  intstiff(31,12)=-v(3315)+v(3291)*v(4114)
  intstiff(31,13)=v(1584)*v(3297)+v(3317)+v(1637)*v(4188)
  intstiff(31,14)=v(3319)+ffor(11)*v(4142)+v(1596)*v(4189)
  intstiff(31,15)=-v(3321)+v(3291)*v(4115)
  intstiff(31,16)=v(1585)*v(3297)+v(3323)+v(1641)*v(4188)
  intstiff(31,17)=v(3325)+ffor(11)*v(4143)+v(1597)*v(4189)
  intstiff(31,18)=-v(3327)+v(3291)*v(4116)
  intstiff(31,19)=v(1586)*v(3297)+v(3329)+v(1645)*v(4188)
  intstiff(31,20)=v(3331)+ffor(11)*v(4144)+v(1598)*v(4189)
  intstiff(31,21)=-v(3333)+v(3291)*v(4117)
  intstiff(31,22)=v(1587)*v(3297)+v(3335)+v(1649)*v(4188)
  intstiff(31,23)=v(3337)+ffor(11)*v(4145)+v(1599)*v(4189)
  intstiff(31,24)=-v(3339)+v(3291)*v(4118)
  intstiff(31,25)=v(1588)*v(3297)+v(3341)+v(1653)*v(4188)
  intstiff(31,26)=v(3343)+ffor(11)*v(4146)+v(1600)*v(4189)
  intstiff(31,27)=-v(3345)+v(3291)*v(4119)
  intstiff(31,28)=v(1589)*v(3297)+v(3347)+v(1657)*v(4188)
  intstiff(31,29)=v(3349)+ffor(11)*v(4147)+v(1601)*v(4189)
  intstiff(31,30)=-v(3351)+v(3291)*v(4120)
  intstiff(31,31)=v(1590)*v(3297)+v(1661)*v(4188)+(v(3714)*v(3749)+v(3354)*v(3818))*vol
  intstiff(31,32)=v(3423)+ffor(11)*v(4148)+v(1602)*v(4189)
  intstiff(31,33)=v(3471)+v(3291)*v(4121)
  intstiff(31,34)=v(1591)*v(3297)+v(3547)+v(1665)*v(4188)
  intstiff(31,35)=v(3620)+ffor(11)*v(4149)+v(1603)*v(4189)
  intstiff(31,36)=v(3748)+v(3291)*v(4122)
  intstiff(32,1)=v(3360)+ffor(11)*v(4150)+v(1580)*v(4190)
  intstiff(32,2)=v(3362)+v(1592)*v(3371)+v(1673)*v(4188)
  intstiff(32,3)=-v(3364)+v(3291)*v(4124)
  intstiff(32,4)=v(3366)+ffor(11)*v(4152)+v(1581)*v(4190)
  intstiff(32,5)=v(3370)+v(1593)*v(3371)+v(1682)*v(4188)
  intstiff(32,6)=-v(3373)+v(3291)*v(4125)
  intstiff(32,7)=v(3375)+ffor(11)*v(4153)+v(1582)*v(4190)
  intstiff(32,8)=v(1594)*v(3371)+v(3377)+v(1688)*v(4188)
  intstiff(32,9)=-v(3379)+v(3291)*v(4126)
  intstiff(32,10)=v(3381)+ffor(11)*v(4154)+v(1583)*v(4190)
  intstiff(32,11)=v(1595)*v(3371)+v(3383)+v(1694)*v(4188)
  intstiff(32,12)=-v(3385)+v(3291)*v(4127)
  intstiff(32,13)=v(3387)+ffor(11)*v(4155)+v(1584)*v(4190)
  intstiff(32,14)=v(1596)*v(3371)+v(3389)+v(1700)*v(4188)
  intstiff(32,15)=-v(3391)+v(3291)*v(4128)
  intstiff(32,16)=v(3393)+ffor(11)*v(4156)+v(1585)*v(4190)
  intstiff(32,17)=v(1597)*v(3371)+v(3395)+v(1706)*v(4188)
  intstiff(32,18)=-v(3397)+v(3291)*v(4129)
  intstiff(32,19)=v(3399)+ffor(11)*v(4157)+v(1586)*v(4190)
  intstiff(32,20)=v(1598)*v(3371)+v(3401)+v(1712)*v(4188)
  intstiff(32,21)=-v(3403)+v(3291)*v(4130)
  intstiff(32,22)=v(3405)+ffor(11)*v(4158)+v(1587)*v(4190)
  intstiff(32,23)=v(1599)*v(3371)+v(3407)+v(1718)*v(4188)
  intstiff(32,24)=-v(3409)+v(3291)*v(4131)
  intstiff(32,25)=v(3411)+ffor(11)*v(4159)+v(1588)*v(4190)
  intstiff(32,26)=v(1600)*v(3371)+v(3413)+v(1724)*v(4188)
  intstiff(32,27)=-v(3415)+v(3291)*v(4132)
  intstiff(32,28)=v(3417)+ffor(11)*v(4160)+v(1589)*v(4190)
  intstiff(32,29)=v(1601)*v(3371)+v(3419)+v(1730)*v(4188)
  intstiff(32,30)=-v(3421)+v(3291)*v(4133)
  intstiff(32,31)=v(3423)+ffor(11)*v(4161)+v(1590)*v(4190)
  intstiff(32,32)=v(1602)*v(3371)+v(1736)*v(4188)+(v(3425)*v(3751)+v(3714)*v(3815))*vol
  intstiff(32,33)=v(3473)+v(3291)*v(4134)
  intstiff(32,34)=v(3549)+ffor(11)*v(4162)+v(1591)*v(4190)
  intstiff(32,35)=v(1603)*v(3371)+v(3622)+v(1742)*v(4188)
  intstiff(32,36)=v(3814)+v(3291)*v(4135)
  intstiff(33,1)=-v(3431)+(der(2,11)*v(1898)+der(1,11)*v(1899))*v(3948)
  intstiff(33,2)=-v(3433)+(der(1,11)*v(1902)+der(2,11)*v(1903))*v(3948)
  intstiff(33,3)=v(1781)
  intstiff(33,4)=-v(3435)+(der(2,11)*v(1906)+der(1,11)*v(1907))*v(3948)
  intstiff(33,5)=-v(3437)+(der(1,11)*v(1910)+der(2,11)*v(1911))*v(3948)
  intstiff(33,6)=v(1978)
  intstiff(33,7)=-v(3439)+(der(2,11)*v(1916)+der(1,11)*v(1917))*v(3948)
  intstiff(33,8)=-v(3441)+(der(1,11)*v(1919)+der(2,11)*v(1920))*v(3948)
  intstiff(33,9)=v(2121)
  intstiff(33,10)=-v(3443)+(der(2,11)*v(1923)+der(1,11)*v(1924))*v(3948)
  intstiff(33,11)=-v(3445)+(der(1,11)*v(1926)+der(2,11)*v(1927))*v(3948)
  intstiff(33,12)=v(2266)
  intstiff(33,13)=-v(3447)+(der(2,11)*v(1930)+der(1,11)*v(1931))*v(3948)
  intstiff(33,14)=-v(3449)+(der(1,11)*v(1933)+der(2,11)*v(1934))*v(3948)
  intstiff(33,15)=v(2418)
  intstiff(33,16)=-v(3451)+(der(2,11)*v(1937)+der(1,11)*v(1938))*v(3948)
  intstiff(33,17)=-v(3453)+(der(1,11)*v(1940)+der(2,11)*v(1941))*v(3948)
  intstiff(33,18)=v(2577)
  intstiff(33,19)=-v(3455)+(der(2,11)*v(1944)+der(1,11)*v(1945))*v(3948)
  intstiff(33,20)=-v(3457)+(der(1,11)*v(1947)+der(2,11)*v(1948))*v(3948)
  intstiff(33,21)=v(2743)
  intstiff(33,22)=-v(3459)+(der(2,11)*v(1951)+der(1,11)*v(1952))*v(3948)
  intstiff(33,23)=-v(3461)+(der(1,11)*v(1954)+der(2,11)*v(1955))*v(3948)
  intstiff(33,24)=v(2916)
  intstiff(33,25)=-v(3463)+(der(2,11)*v(1958)+der(1,11)*v(1959))*v(3948)
  intstiff(33,26)=-v(3465)+(der(1,11)*v(1961)+der(2,11)*v(1962))*v(3948)
  intstiff(33,27)=v(3096)
  intstiff(33,28)=-v(3467)+(der(2,11)*v(1965)+der(1,11)*v(1966))*v(3948)
  intstiff(33,29)=-v(3469)+(der(1,11)*v(1968)+der(2,11)*v(1969))*v(3948)
  intstiff(33,30)=v(3283)
  intstiff(33,31)=-v(3471)+(der(2,11)*v(1972)+der(1,11)*v(1973))*v(3948)
  intstiff(33,32)=-v(3473)+(der(1,11)*v(1975)+der(2,11)*v(1976))*v(3948)
  intstiff(33,33)=(v(3749)+v(3815))*v(3948)
  intstiff(33,34)=v(3551)+(der(2,11)*v(1979)+der(1,11)*v(1980))*v(3948)
  intstiff(33,35)=v(3624)+(der(1,11)*v(1982)+der(2,11)*v(1983))*v(3948)
  intstiff(33,36)=v(3480)
  intstiff(34,1)=v(3481)+v(1580)*v(3491)+v(1605)*v(4191)
  intstiff(34,2)=v(3484)+v(1592)*(v(3486)*v(3873)+v(4192))
  intstiff(34,3)=-v(3488)+v(3485)*v(4112)
  intstiff(34,4)=v(3490)+v(1581)*v(3491)+v(1619)*v(4191)
  intstiff(34,5)=v(3493)+ffor(12)*v(4138)+v(1593)*v(4192)
  intstiff(34,6)=-v(3497)+v(3485)*v(4165)
  intstiff(34,7)=v(1582)*v(3491)+v(3499)+v(1626)*v(4191)
  intstiff(34,8)=v(3501)+ffor(12)*v(4140)+v(1594)*v(4192)
  intstiff(34,9)=-v(3503)+v(3485)*v(4113)
  intstiff(34,10)=v(1583)*v(3491)+v(3505)+v(1632)*v(4191)
  intstiff(34,11)=v(3507)+ffor(12)*v(4141)+v(1595)*v(4192)
  intstiff(34,12)=-v(3509)+v(3485)*v(4114)
  intstiff(34,13)=v(1584)*v(3491)+v(3511)+v(1637)*v(4191)
  intstiff(34,14)=v(3513)+ffor(12)*v(4142)+v(1596)*v(4192)
  intstiff(34,15)=-v(3515)+v(3485)*v(4115)
  intstiff(34,16)=v(1585)*v(3491)+v(3517)+v(1641)*v(4191)
  intstiff(34,17)=v(3519)+ffor(12)*v(4143)+v(1597)*v(4192)
  intstiff(34,18)=-v(3521)+v(3485)*v(4116)
  intstiff(34,19)=v(1586)*v(3491)+v(3523)+v(1645)*v(4191)
  intstiff(34,20)=v(3525)+ffor(12)*v(4144)+v(1598)*v(4192)
  intstiff(34,21)=-v(3527)+v(3485)*v(4117)
  intstiff(34,22)=v(1587)*v(3491)+v(3529)+v(1649)*v(4191)
  intstiff(34,23)=v(3531)+ffor(12)*v(4145)+v(1599)*v(4192)
  intstiff(34,24)=-v(3533)+v(3485)*v(4118)
  intstiff(34,25)=v(1588)*v(3491)+v(3535)+v(1653)*v(4191)
  intstiff(34,26)=v(3537)+ffor(12)*v(4146)+v(1600)*v(4192)
  intstiff(34,27)=-v(3539)+v(3485)*v(4119)
  intstiff(34,28)=v(1589)*v(3491)+v(3541)+v(1657)*v(4191)
  intstiff(34,29)=v(3543)+ffor(12)*v(4147)+v(1601)*v(4192)
  intstiff(34,30)=-v(3545)+v(3485)*v(4120)
  intstiff(34,31)=v(1590)*v(3491)+v(3547)+v(1661)*v(4191)
  intstiff(34,32)=v(3549)+ffor(12)*v(4148)+v(1602)*v(4192)
  intstiff(34,33)=-v(3551)+v(3485)*v(4121)
  intstiff(34,34)=v(1591)*v(3491)+v(1665)*v(4191)+(v(3714)*v(3752)+v(3554)*v(3823))*vol
  intstiff(34,35)=v(3626)+ffor(12)*v(4149)+v(1603)*v(4192)
  intstiff(34,36)=v(3753)+v(3485)*v(4122)
  intstiff(35,1)=v(3557)+ffor(12)*v(4150)+v(1580)*v(4193)
  intstiff(35,2)=v(3559)+v(1592)*v(3568)+v(1673)*v(4191)
  intstiff(35,3)=-v(3561)+v(3485)*v(4124)
  intstiff(35,4)=v(3563)+ffor(12)*v(4152)+v(1581)*v(4193)
  intstiff(35,5)=v(3567)+v(1593)*v(3568)+v(1682)*v(4191)
  intstiff(35,6)=-v(3570)+v(3485)*v(4125)
  intstiff(35,7)=v(3572)+ffor(12)*v(4153)+v(1582)*v(4193)
  intstiff(35,8)=v(1594)*v(3568)+v(3574)+v(1688)*v(4191)
  intstiff(35,9)=-v(3576)+v(3485)*v(4126)
  intstiff(35,10)=v(3578)+ffor(12)*v(4154)+v(1583)*v(4193)
  intstiff(35,11)=v(1595)*v(3568)+v(3580)+v(1694)*v(4191)
  intstiff(35,12)=-v(3582)+v(3485)*v(4127)
  intstiff(35,13)=v(3584)+ffor(12)*v(4155)+v(1584)*v(4193)
  intstiff(35,14)=v(1596)*v(3568)+v(3586)+v(1700)*v(4191)
  intstiff(35,15)=-v(3588)+v(3485)*v(4128)
  intstiff(35,16)=v(3590)+ffor(12)*v(4156)+v(1585)*v(4193)
  intstiff(35,17)=v(1597)*v(3568)+v(3592)+v(1706)*v(4191)
  intstiff(35,18)=-v(3594)+v(3485)*v(4129)
  intstiff(35,19)=v(3596)+ffor(12)*v(4157)+v(1586)*v(4193)
  intstiff(35,20)=v(1598)*v(3568)+v(3598)+v(1712)*v(4191)
  intstiff(35,21)=-v(3600)+v(3485)*v(4130)
  intstiff(35,22)=v(3602)+ffor(12)*v(4158)+v(1587)*v(4193)
  intstiff(35,23)=v(1599)*v(3568)+v(3604)+v(1718)*v(4191)
  intstiff(35,24)=-v(3606)+v(3485)*v(4131)
  intstiff(35,25)=v(3608)+ffor(12)*v(4159)+v(1588)*v(4193)
  intstiff(35,26)=v(1600)*v(3568)+v(3610)+v(1724)*v(4191)
  intstiff(35,27)=-v(3612)+v(3485)*v(4132)
  intstiff(35,28)=v(3614)+ffor(12)*v(4160)+v(1589)*v(4193)
  intstiff(35,29)=v(1601)*v(3568)+v(3616)+v(1730)*v(4191)
  intstiff(35,30)=-v(3618)+v(3485)*v(4133)
  intstiff(35,31)=v(3620)+ffor(12)*v(4161)+v(1590)*v(4193)
  intstiff(35,32)=v(1602)*v(3568)+v(3622)+v(1736)*v(4191)
  intstiff(35,33)=-v(3624)+v(3485)*v(4134)
  intstiff(35,34)=v(3626)+ffor(12)*v(4162)+v(1591)*v(4193)
  intstiff(35,35)=v(1603)*v(3568)+v(1742)*v(4191)+(v(3681)*v(3755)+v(3714)*v(3820))*vol
  intstiff(35,36)=v(3821)+v(3485)*v(4135)
  intstiff(36,1)=-v(3706)+(der(2,12)*v(1898)+der(1,12)*v(1899))*v(3948)
  intstiff(36,2)=-v(3756)+(der(1,12)*v(1902)+der(2,12)*v(1903))*v(3948)
  intstiff(36,3)=v(1784)
  intstiff(36,4)=-v(3711)+(der(2,12)*v(1906)+der(1,12)*v(1907))*v(3948)
  intstiff(36,5)=-v(3760)+(der(1,12)*v(1910)+der(2,12)*v(1911))*v(3948)
  intstiff(36,6)=v(1985)
  intstiff(36,7)=-v(3716)+(der(2,12)*v(1916)+der(1,12)*v(1917))*v(3948)
  intstiff(36,8)=-v(3765)+(der(1,12)*v(1919)+der(2,12)*v(1920))*v(3948)
  intstiff(36,9)=v(2124)
  intstiff(36,10)=-v(3720)+(der(2,12)*v(1923)+der(1,12)*v(1924))*v(3948)
  intstiff(36,11)=-v(3771)+(der(1,12)*v(1926)+der(2,12)*v(1927))*v(3948)
  intstiff(36,12)=v(2269)
  intstiff(36,13)=-v(3724)+(der(2,12)*v(1930)+der(1,12)*v(1931))*v(3948)
  intstiff(36,14)=-v(3778)+(der(1,12)*v(1933)+der(2,12)*v(1934))*v(3948)
  intstiff(36,15)=v(2421)
  intstiff(36,16)=-v(3728)+(der(2,12)*v(1937)+der(1,12)*v(1938))*v(3948)
  intstiff(36,17)=-v(3784)+(der(1,12)*v(1940)+der(2,12)*v(1941))*v(3948)
  intstiff(36,18)=v(2580)
  intstiff(36,19)=-v(3732)+(der(2,12)*v(1944)+der(1,12)*v(1945))*v(3948)
  intstiff(36,20)=-v(3790)+(der(1,12)*v(1947)+der(2,12)*v(1948))*v(3948)
  intstiff(36,21)=v(2746)
  intstiff(36,22)=-v(3736)+(der(2,12)*v(1951)+der(1,12)*v(1952))*v(3948)
  intstiff(36,23)=-v(3796)+(der(1,12)*v(1954)+der(2,12)*v(1955))*v(3948)
  intstiff(36,24)=v(2919)
  intstiff(36,25)=-v(3740)+(der(2,12)*v(1958)+der(1,12)*v(1959))*v(3948)
  intstiff(36,26)=-v(3802)+(der(1,12)*v(1961)+der(2,12)*v(1962))*v(3948)
  intstiff(36,27)=v(3099)
  intstiff(36,28)=-v(3744)+(der(2,12)*v(1965)+der(1,12)*v(1966))*v(3948)
  intstiff(36,29)=-v(3808)+(der(1,12)*v(1968)+der(2,12)*v(1969))*v(3948)
  intstiff(36,30)=v(3286)
  intstiff(36,31)=-v(3748)+(der(2,12)*v(1972)+der(1,12)*v(1973))*v(3948)
  intstiff(36,32)=-v(3814)+(der(1,12)*v(1975)+der(2,12)*v(1976))*v(3948)
  intstiff(36,33)=v(3480)
  intstiff(36,34)=-v(3753)+(der(2,12)*v(1979)+der(1,12)*v(1980))*v(3948)
  intstiff(36,35)=-v(3821)+(der(1,12)*v(1982)+der(2,12)*v(1983))*v(3948)
  intstiff(36,36)=(v(3752)+v(3820))*v(3948)
END SUBROUTINE fluid2dmeshless
!------------------------
!*** check for new paper
!------------------------
SUBROUTINE ELM_TRIFLUIDEXPL(IELEM)
  INCLUDE 'simpar.inc'
  REAL(8)::MU,H,RHO,MUREAL
  LOGICAL::STEADYSTATE
  INTEGER,PARAMETER::MGAUS=6
  INTEGER,PARAMETER::MVTOT=6
  INTEGER,DIMENSION(MVTOT)::LNODS,LTYPS
  REAL(8),DIMENSION(3,2)::RNO,VNEW,VOLD,v0,VMIXED,ACC
  REAL(8),DIMENSION(3,3)::MIXED
  REAL(8),DIMENSION(3)::FFOR,PNEW,DIST,NUNEW,LAGR,lagrold,pold
  REAL(8),DIMENSION(2,3)::DERI
  REAL(8),DIMENSION(2,2)::JAC,velgrad
  REAL(8),DIMENSION(2)::XI,F
  REAL(8),DIMENSION(MVTOT)::INTFORCE,intforce0
  REAL(8),DIMENSION(MVTOT,MVTOT)::INTSTIFF
  REAL(8),DIMENSION(2*MGAUS)::POSPG
  REAL(8),DIMENSION(MGAUS)::PESPG
  REAL(8),DIMENSION(MVTOT)::EFOR
  REAL(8),DIMENSION(6)::FORCE
  REAL(8),DIMENSION(6,6)::KERNELMASS
  INTEGER,PARAMETER::IPRESS=7
  INTEGER::INVISCID=0
  REAL(8)::FROZEN=0.0d00
  CL=MAPS(1,ELMA(IELEM))
  H=AVERAGEMESHLENGTH()
  RHO=MAPS(3,ELMA(IELEM))
  MU=MAPS(4,ELMA(IELEM))
  F(1)=MAPS(5,ELMA(IELEM))
  F(2)=MAPS(6,ELMA(IELEM))
  BULK=10.0D00*MU
  uinf=0.0d00
  ITEMP=0
  DO IN=1,3
    INO=ELNO(ELNI(IELEM)-1+IN)
    DO ID=1,2
      ITEMP=ITEMP+1
      VOLD(IN,ID)=nodof(ID,INO,1)
      VNEW(IN,ID)=nodof(ID,INO,2)
      LNODS(ITEMP)=INO
      LTYPS(ITEMP)=ID
    END DO
!    ITEMP=ITEMP+1
    POLD(IN)=NODOF(IPRESS,INO,1)
    PNEW(IN)=NODOF(IPRESS,INO,2)
    DO IDI=1,2        
      RNO(IN,IDI)=NOCO(IDI,INO)
    END DO
    CALL DISPVELGRAD(INO,2,VELGRAD)
    PNEW(IN)=PNEW(IN)-(VELGRAD(1,1)+VELGRAD(2,2))*BULK
    NODOF(IPRESS,INO,1)=POLD(IN)
    NODOF(IPRESS,INO,2)=PNEW(IN)
  ENDDO
!-----------------------------------------
!*** INITIALIZATION OF RELEVANT QUANTITIES
!-----------------------------------------
  NGAUS=3
  CALL GAUSSL(-NGAUS,PESPG,POSPG)

!--------------------
!*** QUADRATURE CYCLE
!--------------------
  DO IGAUSINPUT=1,NGAUS
!-----------------------------
!*** PARENT-DOMAIN COORDINATES
!-----------------------------
    XI(1)=POSPG(2*IGAUSINPUT-1)
    XI(2)=POSPG(2*IGAUSINPUT)
    FFOR(1)=1.0D00-XI(1)-XI(2)
    FFOR(2)=XI(1)
    FFOR(3)=XI(2)
    DS=DOTPROD(3,FFOR,DIST)
    DERI(1,1)=-1.0D00
    DERI(2,1)=-1.0D00
    DERI(1,2)=1.0D00
    DERI(2,2)=0.0D00
    DERI(1,3)=0.0D00
    DERI(2,3)=1.0D00
    CALL MATRJAC(JAC,RNO,DERI,2,3)
    SQRTM=DETM23(2,JAC)
!---------------------
!*** QUADRATURE WEIGHT
!---------------------
    W=PESPG(IGAUSINPUT)
    VOL=W*ABS(SQRTM)
    VOLMESH=VOLMESH+VOL   
    h=1.0d-2
!    CALL rk4force(dtime,vol,h,rho,mu,rno,pnew,vold,vnew,xi,force)
    DO i=1,6
      forexpl(ltyps(i),lnods(i))=forexpl(ltyps(i),lnods(i))+force(i)
    END DO
    CALL KERNELMASSFLUID(RHO,VOL,RNO,XI,KERNELMASS)
    DO i=1,6
      DO j=1,6
        masexpl(ltyps(i),lnods(i))=masexpl(ltyps(i),lnods(i))+abs(kernelmass(i,j))
      END DO
    END DO
  END DO
END SUBROUTINE ELM_TRIFLUIDEXPL

SUBROUTINE rk4force(dtime,vol,h,rho,mu,rno,pnew,vold,vnew,xi,force)
  IMPLICIT REAL(8)(a-h,o-z)
  REAL(8),DIMENSION(3,2)::rno,vnew,vold
  REAL(8),DIMENSION(3)::pnew
  REAL(8),DIMENSION(2)::Xi
  REAL(8),DIMENSION(6)::force,force1,force2,force3,force4
  REAL(8),DIMENSION(3,2)::force1M,force2M,force3M,force4M
!  CALL RIGHTHANDSIDEFLUID(VOL,H,RHO,MU,RNO,PNEW,VOLD,VNEW,XI,FORCE1)
  DO IN=1,3
    DO ID=1,2
      FORCE1M(IN,ID)=FORCE1(IN*2-2+ID)
    END DO
  END DO
!  CALL RIGHTHANDSIDEFLUID(VOL,H,RHO,MU,RNO,PNEW,VOLD,VNEW+0.5D00*DTIME*FORCE1M,XI,FORCE2)
  DO IN=1,3
    DO ID=1,2
      FORCE2M(IN,ID)=FORCE2(IN*2-2+ID)
    END DO
  END DO
!  CALL RIGHTHANDSIDEFLUID(VOL,H,RHO,MU,RNO,PNEW,VOLD,VNEW+0.5D00*DTIME*FORCE2M,XI,FORCE3)
  DO IN=1,3
    DO ID=1,2
      FORCE3M(IN,ID)=FORCE3(IN*2-2+ID)
    END DO
  END DO
!  CALL RIGHTHANDSIDEFLUID(VOL,H,RHO,MU,RNO,PNEW,VOLD,VNEW+DTIME*FORCE3M,XI,FORCE4)
  force=(force1+2.0d00*force2+2.0d00*force3+force4)/6.0D00  
END SUBROUTINE rk4force
!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           25 May 23 20:18:10 *
!**************************************************************
! User     : Full professional version
! Notebook : righthandsidefluid
! Evaluation time                 : 4 s     Mode  : Optimal
! Number of formulae              : 50      Method: Automatic
! Subroutine                      : righthandsidefluid size: 1036
! Total size of Mathematica  code : 1036 subexpressions
! Total size of Fortran code      : 2131 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE righthandsidefluid(vol,h,rho,mu,rno,pnew,vold,vnew,xi,force)
  IMPLICIT NONE
  DOUBLE PRECISION v(103),vol,h,rho,mu,rno(3,2),pnew(3),vold(3,2),vnew(3,2),xi(2),force(6)
  v(96)=1d0/h**2
  v(95)=(16d0*mu**2)/(h**4*rho**2)
  v(94)=2d0*mu
  v(93)=pnew(3)*xi(2)
  v(92)=pnew(2)*xi(1)
  v(91)=vold(3,2)*xi(2)
  v(90)=vold(2,2)*xi(1)
  v(89)=vold(3,1)*xi(2)
  v(88)=vold(2,1)*xi(1)
  v(87)=vnew(3,2)*xi(2)
  v(86)=vnew(2,2)*xi(1)
  v(85)=vnew(3,1)*xi(2)
  v(84)=vnew(2,1)*xi(1)
  v(83)=rno(1,2)-rno(2,2)
  v(82)=-rno(1,1)+rno(2,1)
  v(81)=1d0/(-(rno(1,2)*rno(2,1))+rno(1,1)*rno(2,2)+rno(3,2)*v(82)+rno(3,1)*v(83))
  v(80)=1d0-xi(1)-xi(2)
  v(79)=-(rho*vol)
  v(78)=v(79)*xi(1)
  v(74)=v(79)*xi(2)
  v(58)=v(79)*v(80)
  v(40)=-(v(81)*v(82))
  v(39)=-((rno(1,1)-rno(3,1))*v(81))
  v(37)=-(v(81)*v(83))
  v(36)=(rno(1,2)-rno(3,2))*v(81)
  v(35)=v(36)+v(37)
  v(59)=v(35)*vnew(1,2)-v(36)*vnew(2,2)-v(37)*vnew(3,2)
  v(38)=v(39)+v(40)
  v(55)=v(38)*vnew(1,1)-v(39)*vnew(2,1)-v(40)*vnew(3,1)
  v(41)=v(84)+v(85)+v(80)*vnew(1,1)
  v(43)=v(86)+v(87)+v(80)*vnew(1,2)
  v(75)=-(v(37)*v(41))-v(40)*v(43)
  v(70)=-(v(36)*v(41))-v(39)*v(43)
  v(44)=v(88)+v(89)+v(80)*vold(1,1)
  v(45)=v(90)+v(91)+v(80)*vold(1,2)
  v(49)=pnew(1)*v(80)+v(92)+v(93)
  v(50)=v(35)*vnew(1,1)-v(36)*vnew(2,1)-v(37)*vnew(3,1)
  v(64)=-v(49)+v(50)*v(94)
  v(61)=mu*(v(55)+v(59))
  v(52)=v(38)*vnew(1,2)-v(39)*vnew(2,2)-v(40)*vnew(3,2)
  v(69)=-v(49)+v(52)*v(94)
  v(65)=-(vol/sqrt(v(95)+4d0*(0.1d-7+v(41)**2+v(43)**2)*v(96)))
  v(62)=(v(35)*v(41)+v(38)*v(43))*v(65)
  v(56)=v(44)*v(50)+v(45)*v(55)
  v(66)=pnew(1)*v(35)-pnew(2)*v(36)-pnew(3)*v(37)+rho*v(56)
  v(97)=v(65)*v(66)
  v(60)=v(45)*v(52)+v(44)*v(59)
  v(71)=pnew(1)*v(38)-pnew(2)*v(39)-pnew(3)*v(40)+rho*v(60)
  v(98)=v(65)*v(71)
  force(1)=v(56)*v(58)+v(62)*v(66)-(v(38)*v(61)+v(35)*v(64))*vol
  force(2)=v(58)*v(60)+v(62)*v(71)-(v(35)*v(61)+v(38)*v(69))*vol
  force(3)=v(56)*v(78)+v(70)*v(97)-(-(v(39)*v(61))-v(36)*v(64))*vol
  force(4)=v(60)*v(78)+v(70)*v(98)-(-(v(36)*v(61))-v(39)*v(69))*vol
  force(5)=v(56)*v(74)+v(75)*v(97)-(-(v(40)*v(61))-v(37)*v(64))*vol
  force(6)=v(60)*v(74)+v(75)*v(98)-(-(v(37)*v(61))-v(40)*v(69))*vol
END SUBROUTINE righthandsidefluid


SUBROUTINE kernelmassfluid(rho,vol,rno,xi,kernelmass)
  IMPLICIT NONE
  INTEGER i01,i02
  DOUBLE PRECISION v(80),rho,vol,rno(3,2),xi(2),kernelmass(6,6)
  v(75)=xi(2)**2
  v(74)=xi(1)**2
  v(73)=rho*vol
  v(72)=1d0-xi(1)-xi(2)
  v(65)=v(72)*v(73)
  v(63)=(v(72)*v(72))*v(73)
  v(64)=v(65)*xi(1)
  v(66)=v(65)*xi(2)
  v(67)=v(73)*v(74)
  v(68)=v(73)*xi(1)*xi(2)
  v(69)=v(73)*v(75)
  kernelmass(1,1)=v(63)
  kernelmass(1,2)=0d0
  kernelmass(1,3)=v(64)
  kernelmass(1,4)=0d0
  kernelmass(1,5)=v(66)
  kernelmass(1,6)=0d0
  kernelmass(2,2)=v(63)
  kernelmass(2,3)=0d0
  kernelmass(2,4)=v(64)
  kernelmass(2,5)=0d0
  kernelmass(2,6)=v(66)
  kernelmass(3,3)=v(67)
  kernelmass(3,4)=0d0
  kernelmass(3,5)=v(68)
  kernelmass(3,6)=0d0
  kernelmass(4,4)=v(67)
  kernelmass(4,5)=0d0
  kernelmass(4,6)=v(68)
  kernelmass(5,5)=v(69)
  kernelmass(5,6)=0d0
  kernelmass(6,6)=v(69)
  DO i01=2,6
    DO i02=1,i01-1
      kernelmass(i01,i02)=kernelmass(i02,i01)
    ENDDO
  ENDDO
END SUBROUTINE kernelmassfluid

!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           26 May 23 08:22:26 *
!**************************************************************
! User     : Full professional version
! Notebook : fluid2d
! Evaluation time                 : 11 s    Mode  : Optimal
! Number of formulae              : 282     Method: Automatic
! Subroutine                      : fluid2d size: 5306
! Total size of Mathematica  code : 5306 subexpressions
! Total size of Fortran code      : 13402 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE fluid2d(steady,frozen,stabpress,deriv,dtime,vol,h,rho,mu,f,rno,pnew,acel,vold,vnew,xi,intforce,intstiff)
  IMPLICIT NONE
  LOGICAL steady,b138
  DOUBLE PRECISION v(507),frozen,stabpress,deriv,dtime,vol,h,rho,mu,f(2),rno(3,2),pnew(3),acel(3,2),vold(3,2)&
      &,vnew(3,2),xi(2),intforce(9),intstiff(9,9)
  v(466)=f(2)*rho
  v(465)=f(1)*rho
  v(455)=stabpress*vol
  v(451)=vold(3,2)*xi(2)
  v(450)=vold(2,2)*xi(1)
  v(449)=vold(3,1)*xi(2)
  v(448)=vold(2,1)*xi(1)
  v(447)=pnew(3)*xi(2)
  v(446)=pnew(2)*xi(1)
  v(445)=1d0/rho
  v(444)=(4d0*mu**2)/(h**4*rho**2)
  v(443)=1d0/dtime**2
  v(439)=vnew(3,2)*xi(2)
  v(438)=vnew(2,2)*xi(1)
  v(437)=vnew(3,1)*xi(2)
  v(436)=vnew(2,1)*xi(1)
  v(424)=rno(1,2)-rno(2,2)
  v(423)=(-2d0)*mu
  v(420)=-rno(1,1)+rno(2,1)
  v(419)=1d0/(-(rno(1,2)*rno(2,1))+rno(1,1)*rno(2,2)+rno(3,2)*v(420)+rno(3,1)*v(424))
  v(418)=(-1d0)+xi(1)+xi(2)
  v(417)=-(deriv*v(418))
  v(416)=deriv*xi(2)
  v(415)=rho*vol
  v(414)=deriv*xi(1)
  v(413)=v(415)*xi(1)
  v(412)=rho**2
  v(411)=1d0/h**2
  v(410)=1d0-frozen
  v(183)=v(410)*xi(1)
  v(350)=v(415)*xi(2)
  v(184)=v(410)*xi(2)
  v(227)=-(v(415)*v(418))
  v(182)=-(v(410)*v(418))
  v(137)=-(v(419)*v(420))
  v(421)=v(137)*vol
  v(399)=v(421)*xi(2)
  v(380)=-(v(421)*xi(1))
  v(371)=v(418)*v(421)
  v(360)=v(137)*v(423)
  v(189)=(-0.5d0)*v(137)
  v(429)=-(v(189)*vol)
  v(136)=-((rno(1,1)-rno(3,1))*v(419))
  v(422)=v(136)*vol
  v(395)=v(422)*xi(2)
  v(328)=v(422)*xi(1)
  v(308)=v(418)*v(422)
  v(293)=v(136)*v(423)
  v(187)=(-0.5d0)*v(136)
  v(134)=-(v(419)*v(424))
  v(425)=v(134)*vol
  v(403)=v(134)*v(423)
  v(397)=v(425)*xi(2)
  v(356)=-(v(425)*xi(1))
  v(345)=v(418)*v(425)
  v(190)=(-0.5d0)*v(134)
  v(426)=v(190)*vol
  v(383)=v(360)*v(426)
  v(374)=v(293)*v(426)
  v(133)=(rno(1,2)-rno(3,2))*v(419)
  v(427)=v(133)*vol
  v(393)=v(427)*xi(2)
  v(326)=v(427)*xi(1)
  v(314)=-(v(133)*v(423))
  v(378)=-((v(137)*v(293)+v(190)*v(314))*vol)
  v(353)=v(314)*v(429)
  v(349)=(v(189)*v(293)+v(134)*v(314))*vol
  v(287)=v(418)*v(427)
  v(188)=(-0.5d0)*v(133)
  v(431)=v(188)*vol
  v(311)=v(293)*v(431)
  v(132)=v(133)+v(134)
  v(428)=-(v(132)*vol)
  v(388)=v(428)*xi(2)
  v(321)=v(428)*xi(1)
  v(261)=-(v(418)*v(428))
  v(238)=v(132)*v(423)
  v(341)=v(238)*v(429)
  v(283)=-(v(187)*v(238)*vol)
  v(186)=v(132)/2d0
  v(160)=v(132)*vnew(1,2)-v(133)*vnew(2,2)-v(134)*vnew(3,2)
  v(205)=v(160)*v(184)
  v(375)=v(205)*v(413)
  v(365)=v(205)*v(227)
  v(201)=v(160)*v(183)
  v(302)=v(201)*v(227)
  v(197)=v(160)*v(182)
  v(159)=v(132)*vnew(1,1)-v(133)*vnew(2,1)-v(134)*vnew(3,1)
  v(135)=v(136)+v(137)
  v(430)=-(v(135)*vol)
  v(390)=v(430)*xi(2)
  v(323)=v(430)*xi(1)
  v(265)=-(v(418)*v(430))
  v(226)=-(v(135)*v(423))
  v(369)=-((v(137)*v(226)+v(190)*v(238))*vol)
  v(364)=v(226)*v(426)
  v(335)=(v(189)*v(226)+v(134)*v(238))*vol
  v(306)=-((v(136)*v(226)+v(188)*v(238))*vol)
  v(301)=v(226)*v(431)
  v(277)=(v(187)*v(226)+v(133)*v(238))*vol
  v(245)=v(186)*v(226)*vol
  v(163)=v(135)*vnew(1,2)-v(136)*vnew(2,2)-v(137)*vnew(3,2)
  v(161)=v(135)*vnew(1,1)-v(136)*vnew(2,1)-v(137)*vnew(3,1)
  v(196)=v(161)*v(184)
  v(354)=v(196)*v(413)
  v(342)=v(196)*v(227)
  v(194)=v(161)*v(183)
  v(284)=v(194)*v(227)
  v(192)=v(161)*v(182)
  IF(steady) THEN
    v(168)=0d0
    v(169)=0d0
    v(170)=0d0
    v(139)=0d0
    v(171)=0d0
    v(172)=0d0
    v(173)=0d0
    v(140)=0d0
  ELSE
    v(435)=acel(3,2)*xi(2)
    v(434)=acel(2,2)*xi(1)
    v(433)=acel(3,1)*xi(2)
    v(432)=acel(2,1)*xi(1)
    v(168)=v(417)
    v(169)=v(414)
    v(170)=v(416)
    v(139)=-(acel(1,1)*v(418))+v(432)+v(433)
    v(171)=v(417)
    v(172)=v(414)
    v(173)=v(416)
    v(140)=-(acel(1,2)*v(418))+v(434)+v(435)
  ENDIF
  v(143)=v(436)+v(437)-v(418)*vnew(1,1)
  v(144)=v(438)+v(439)-v(418)*vnew(1,2)
  v(174)=sqrt(0.1d-7+v(143)**2+v(144)**2)
  v(442)=-(v(418)/v(174))
  v(441)=xi(1)/v(174)
  v(440)=xi(2)/v(174)
  v(181)=v(144)*v(440)
  v(180)=v(143)*v(440)
  v(179)=v(144)*v(441)
  v(178)=v(143)*v(441)
  v(177)=v(144)*v(442)
  v(175)=v(143)*v(442)
  v(210)=4d0*((v(174)*v(174))*v(411)+v(443)+v(444))
  v(212)=((-4d0)*v(174)*v(411)*v(445))/v(210)**0.15d1
  v(217)=v(181)*v(212)
  v(216)=v(180)*v(212)
  v(215)=v(179)*v(212)
  v(214)=v(178)*v(212)
  v(213)=v(177)*v(212)
  v(211)=v(175)*v(212)
  v(151)=-(pnew(1)*v(418))+v(446)+v(447)
  v(152)=v(143)*v(410)+frozen*(v(448)+v(449)-v(418)*vold(1,1))
  v(206)=-(v(134)*v(152))
  v(202)=-(v(133)*v(152))
  v(198)=v(132)*v(152)
  v(154)=v(144)*v(410)+frozen*(v(450)+v(451)-v(418)*vold(1,2))
  v(207)=-(v(137)*v(154))
  v(452)=v(206)+v(207)
  v(208)=v(173)+v(163)*v(184)+v(452)
  v(203)=-(v(136)*v(154))
  v(453)=v(202)+v(203)
  v(204)=v(172)+v(163)*v(183)+v(453)
  v(199)=v(135)*v(154)
  v(454)=v(198)+v(199)
  v(200)=v(171)+v(163)*v(182)+v(454)
  v(195)=v(170)+v(159)*v(184)+v(452)
  v(193)=v(169)+v(159)*v(183)+v(453)
  v(191)=v(168)+v(159)*v(182)+v(454)
  v(162)=(v(160)+v(161))/2d0
  v(164)=v(139)+v(152)*v(159)+v(154)*v(161)
  v(262)=pnew(1)*v(132)-pnew(2)*v(133)-pnew(3)*v(134)+rho*(-f(1)+v(164))
  v(464)=rho*v(262)
  v(165)=v(140)+v(152)*v(160)+v(154)*v(163)
  v(263)=pnew(1)*v(135)-pnew(2)*v(136)-pnew(3)*v(137)+rho*(-f(2)+v(165))
  v(407)=v(132)*v(262)+v(135)*v(263)
  v(406)=-(v(133)*v(262))-v(136)*v(263)
  v(405)=-(v(134)*v(262))-v(137)*v(263)
  v(391)=v(405)*v(455)
  v(324)=v(406)*v(455)
  v(267)=v(407)*v(455)
  v(166)=v(159)+v(163)
  v(467)=v(166)*vol
  v(167)=v(445)/sqrt(v(210))
  v(463)=v(167)*vol
  v(266)=v(167)*v(455)
  v(494)=rho*v(266)
  v(218)=(h*v(415))/2d0
  v(469)=v(174)*v(218)
  v(460)=v(132)*v(218)
  v(459)=v(135)*v(218)
  v(458)=v(133)*v(218)
  v(457)=v(136)*v(218)
  v(456)=v(137)*v(218)
  v(382)=v(134)*v(174)*v(456)
  v(502)=v(382)+v(383)
  v(368)=-(v(166)*v(456))
  v(340)=-(v(134)*v(166)*v(218))
  v(318)=v(174)*v(457)
  v(377)=v(137)*v(318)
  v(500)=v(377)+v(378)
  v(352)=v(134)*v(318)
  v(499)=v(352)+v(353)
  v(305)=-(v(166)*v(457))
  v(296)=v(174)*v(458)
  v(373)=v(137)*v(296)
  v(498)=v(373)+v(374)
  v(348)=v(134)*v(296)
  v(497)=v(348)+v(349)
  v(310)=v(136)*v(296)
  v(496)=v(310)+v(311)
  v(282)=-(v(166)*v(458))
  v(254)=-(v(174)*v(459))
  v(367)=v(137)*v(254)
  v(492)=v(367)+v(369)
  v(339)=v(134)*v(254)
  v(490)=v(339)+v(341)
  v(304)=v(136)*v(254)
  v(488)=v(304)+v(306)
  v(281)=v(133)*v(254)
  v(486)=v(281)+v(283)
  v(247)=v(166)*v(459)
  v(232)=v(174)*v(460)
  v(363)=-(v(137)*v(232))
  v(482)=v(363)+v(364)
  v(334)=-(v(134)*v(232))
  v(480)=v(334)+v(335)
  v(300)=-(v(136)*v(232))
  v(478)=v(300)+v(301)
  v(276)=-(v(133)*v(232))
  v(476)=v(276)+v(277)
  v(243)=v(135)*v(232)
  v(472)=v(243)+v(245)
  v(225)=v(166)*v(460)
  v(219)=(v(132)*v(132))
  v(221)=v(262)*v(415)
  v(483)=v(217)*v(221)
  v(481)=v(216)*v(221)
  v(479)=v(215)*v(221)
  v(477)=v(214)*v(221)
  v(473)=v(213)*v(221)
  v(470)=v(211)*v(221)
  v(461)=v(167)*v(221)
  v(240)=v(184)*v(461)
  v(235)=v(183)*v(461)
  v(224)=v(182)*v(461)
  v(222)=v(417)+v(454)
  v(230)=v(222)*v(463)
  v(475)=rho*v(230)
  v(228)=v(230)*v(412)
  v(471)=v(227)+v(228)
  v(244)=v(263)*v(415)
  v(493)=v(217)*v(244)
  v(491)=v(216)*v(244)
  v(489)=v(215)*v(244)
  v(487)=v(214)*v(244)
  v(485)=v(213)*v(244)
  v(484)=v(211)*v(244)
  v(462)=v(167)*v(244)
  v(258)=v(184)*v(462)
  v(253)=v(183)*v(462)
  v(249)=v(182)*v(462)
  v(248)=(v(135)*v(135))
  v(272)=-((v(132)*v(133)+v(135)*v(136))*v(266))
  v(275)=-((v(132)*v(134)+v(135)*v(137))*v(266))
  v(279)=v(414)+v(453)
  v(288)=v(279)*v(463)
  v(468)=rho*v(288)
  v(285)=v(288)*v(412)
  v(495)=v(285)+v(413)
  v(290)=(v(133)*v(133))
  v(313)=(v(136)*v(136))
  v(333)=(v(133)*v(134)+v(136)*v(137))*v(266)
  v(337)=v(416)+v(452)
  v(346)=v(337)*v(463)
  v(474)=rho*v(346)
  v(343)=v(346)*v(412)
  v(501)=v(343)+v(350)
  v(358)=(v(134)*v(134))
  v(385)=(v(137)*v(137))
  v(402)=-v(151)-v(159)*v(423)
  v(404)=-v(151)-v(163)*v(423)
  intforce(1)=v(174)*v(225)+v(164)*v(227)+v(230)*v(464)+(v(162)*v(226)+v(132)*v(402)+v(418)*v(465))*vol
  intforce(2)=v(165)*v(227)+v(174)*v(247)+v(222)*v(462)+(-(v(162)*v(238))+v(135)*v(404)+v(418)*v(466))*vol
  intforce(3)=v(266)*v(407)-v(418)*v(467)
  intforce(4)=v(174)*v(282)+v(164)*v(413)+v(262)*v(468)+vol*(v(162)*v(293)-v(133)*v(402)-v(465)*xi(1))
  intforce(5)=v(174)*v(305)+v(165)*v(413)+v(263)*v(468)+vol*(-(v(162)*v(314))-v(136)*v(404)-v(466)*xi(1))
  intforce(6)=v(266)*v(406)+v(467)*xi(1)
  intforce(7)=v(174)*v(340)+v(164)*v(350)+v(346)*v(464)+vol*(v(162)*v(360)-v(134)*v(402)-v(465)*xi(2))
  intforce(8)=v(165)*v(350)+v(174)*v(368)+v(263)*v(474)+vol*(v(162)*v(403)-v(137)*v(404)-v(466)*xi(2))
  intforce(9)=v(266)*v(405)+v(467)*xi(2)
  intstiff(1,1)=v(132)*v(224)+v(175)*v(225)+v(219)*v(469)+v(222)*v(470)+v(191)*v(471)+((v(135)*v(226))/2d0-v(219)*v(423)&
      &)*vol
  intstiff(1,2)=v(135)*v(224)+v(177)*v(225)+v(192)*v(471)+v(472)+v(222)*v(473)
  intstiff(1,3)=v(261)+v(132)*v(475)
  intstiff(1,4)=v(178)*v(225)+v(132)*v(235)+v(193)*v(471)+v(476)+v(222)*v(477)
  intstiff(1,5)=v(179)*v(225)+v(194)*v(228)+v(135)*v(235)+v(284)+v(478)+v(222)*v(479)
  intstiff(1,6)=v(321)-v(133)*v(475)
  intstiff(1,7)=v(180)*v(225)+v(132)*v(240)+v(195)*v(471)+v(480)+v(222)*v(481)
  intstiff(1,8)=v(181)*v(225)+v(196)*v(228)+v(135)*v(240)+v(342)+v(482)+v(222)*v(483)
  intstiff(1,9)=v(388)-v(134)*v(475)
  intstiff(2,1)=v(175)*v(247)+v(132)*v(249)+v(197)*v(471)+v(472)+v(222)*v(484)
  intstiff(2,2)=v(177)*v(247)+v(135)*v(249)+v(248)*v(469)+v(200)*v(471)+v(222)*v(485)+(-(v(186)*v(238))-v(248)*v(423)&
      &)*vol
  intstiff(2,3)=v(265)+v(135)*v(475)
  intstiff(2,4)=v(201)*v(228)+v(178)*v(247)+v(132)*v(253)+v(302)+v(486)+v(222)*v(487)
  intstiff(2,5)=v(179)*v(247)+v(135)*v(253)+v(204)*v(471)+v(488)+v(222)*v(489)
  intstiff(2,6)=v(323)-v(136)*v(475)
  intstiff(2,7)=v(205)*v(228)+v(180)*v(247)+v(132)*v(258)+v(365)+v(490)+v(222)*v(491)
  intstiff(2,8)=v(181)*v(247)+v(135)*v(258)+v(208)*v(471)+v(492)+v(222)*v(493)
  intstiff(2,9)=v(390)-v(137)*v(475)
  intstiff(3,1)=-v(261)+v(211)*v(267)+(v(132)*v(191)+v(135)*v(197))*v(494)
  intstiff(3,2)=-v(265)+v(213)*v(267)+(v(132)*v(192)+v(135)*v(200))*v(494)
  intstiff(3,3)=(v(219)+v(248))*v(266)
  intstiff(3,4)=v(214)*v(267)+v(287)+(v(132)*v(193)+v(135)*v(201))*v(494)
  intstiff(3,5)=v(215)*v(267)+v(308)+(v(132)*v(194)+v(135)*v(204))*v(494)
  intstiff(3,6)=v(272)
  intstiff(3,7)=v(216)*v(267)+v(345)+(v(132)*v(195)+v(135)*v(205))*v(494)
  intstiff(3,8)=v(217)*v(267)+v(371)+(v(132)*v(196)+v(135)*v(208))*v(494)
  intstiff(3,9)=v(275)
  intstiff(4,1)=-(v(133)*v(224))+v(175)*v(282)+v(279)*v(470)+v(476)+v(191)*v(495)
  intstiff(4,2)=-(v(136)*v(224))+v(177)*v(282)+v(284)+v(192)*v(285)+v(279)*v(473)+v(486)
  intstiff(4,3)=-v(287)+v(132)*v(468)
  intstiff(4,4)=-(v(133)*v(235))+v(178)*v(282)+v(290)*v(469)+v(279)*v(477)+v(193)*v(495)+(v(187)*v(293)-v(290)*v(423)&
      &)*vol
  intstiff(4,5)=-(v(136)*v(235))+v(179)*v(282)+v(279)*v(479)+v(194)*v(495)+v(496)
  intstiff(4,6)=v(326)-v(133)*v(468)
  intstiff(4,7)=-(v(133)*v(240))+v(180)*v(282)+v(279)*v(481)+v(195)*v(495)+v(497)
  intstiff(4,8)=-(v(136)*v(240))+v(181)*v(282)+v(196)*v(285)+v(354)+v(279)*v(483)+v(498)
  intstiff(4,9)=v(393)-v(134)*v(468)
  intstiff(5,1)=-(v(133)*v(249))+v(197)*v(285)+v(302)+v(175)*v(305)+v(478)+v(279)*v(484)
  intstiff(5,2)=-(v(136)*v(249))+v(177)*v(305)+v(279)*v(485)+v(488)+v(200)*v(495)
  intstiff(5,3)=-v(308)+v(135)*v(468)
  intstiff(5,4)=-(v(133)*v(253))+v(178)*v(305)+v(279)*v(487)+v(201)*v(495)+v(496)
  intstiff(5,5)=-(v(136)*v(253))+v(179)*v(305)+v(313)*v(469)+v(279)*v(489)+v(204)*v(495)+(-(v(188)*v(314))-v(313)*v(423)&
      &)*vol
  intstiff(5,6)=v(328)-v(136)*v(468)
  intstiff(5,7)=-(v(133)*v(258))+v(205)*v(285)+v(180)*v(305)+v(375)+v(279)*v(491)+v(499)
  intstiff(5,8)=-(v(136)*v(258))+v(181)*v(305)+v(279)*v(493)+v(208)*v(495)+v(500)
  intstiff(5,9)=v(395)-v(137)*v(468)
  intstiff(6,1)=-v(321)+v(211)*v(324)+(-(v(133)*v(191))-v(136)*v(197))*v(494)
  intstiff(6,2)=-v(323)+v(213)*v(324)+(-(v(133)*v(192))-v(136)*v(200))*v(494)
  intstiff(6,3)=v(272)
  intstiff(6,4)=v(214)*v(324)-v(326)+(-(v(133)*v(193))-v(136)*v(201))*v(494)
  intstiff(6,5)=v(215)*v(324)-v(328)+(-(v(133)*v(194))-v(136)*v(204))*v(494)
  intstiff(6,6)=v(266)*(v(290)+v(313))
  intstiff(6,7)=v(216)*v(324)+v(356)+(-(v(133)*v(195))-v(136)*v(205))*v(494)
  intstiff(6,8)=v(217)*v(324)+v(380)+(-(v(133)*v(196))-v(136)*v(208))*v(494)
  intstiff(6,9)=v(333)
  intstiff(7,1)=-(v(134)*v(224))+v(175)*v(340)+v(337)*v(470)+v(480)+v(191)*v(501)
  intstiff(7,2)=-(v(137)*v(224))+v(177)*v(340)+v(342)+v(192)*v(343)+v(337)*v(473)+v(490)
  intstiff(7,3)=-v(345)+v(132)*v(474)
  intstiff(7,4)=-(v(134)*v(235))+v(178)*v(340)+v(337)*v(477)+v(497)+v(193)*v(501)
  intstiff(7,5)=-(v(137)*v(235))+v(179)*v(340)+v(194)*v(343)+v(354)+v(337)*v(479)+v(499)
  intstiff(7,6)=-v(356)-v(133)*v(474)
  intstiff(7,7)=-(v(134)*v(240))+v(180)*v(340)+v(358)*v(469)+v(337)*v(481)+v(195)*v(501)+(v(189)*v(360)-v(358)*v(423)&
      &)*vol
  intstiff(7,8)=-(v(137)*v(240))+v(181)*v(340)+v(337)*v(483)+v(196)*v(501)+v(502)
  intstiff(7,9)=v(397)-v(134)*v(474)
  intstiff(8,1)=-(v(134)*v(249))+v(197)*v(343)+v(365)+v(175)*v(368)+v(482)+v(337)*v(484)
  intstiff(8,2)=-(v(137)*v(249))+v(177)*v(368)+v(337)*v(485)+v(492)+v(200)*v(501)
  intstiff(8,3)=-v(371)+v(135)*v(474)
  intstiff(8,4)=-(v(134)*v(253))+v(201)*v(343)+v(178)*v(368)+v(375)+v(337)*v(487)+v(498)
  intstiff(8,5)=-(v(137)*v(253))+v(179)*v(368)+v(337)*v(489)+v(500)+v(204)*v(501)
  intstiff(8,6)=-v(380)-v(136)*v(474)
  intstiff(8,7)=-(v(134)*v(258))+v(180)*v(368)+v(337)*v(491)+v(205)*v(501)+v(502)
  intstiff(8,8)=-(v(137)*v(258))+v(181)*v(368)+v(385)*v(469)+v(337)*v(493)+v(208)*v(501)+(v(190)*v(403)-v(385)*v(423)&
      &)*vol
  intstiff(8,9)=v(399)-v(137)*v(474)
  intstiff(9,1)=-v(388)+v(211)*v(391)+(-(v(134)*v(191))-v(137)*v(197))*v(494)
  intstiff(9,2)=-v(390)+v(213)*v(391)+(-(v(134)*v(192))-v(137)*v(200))*v(494)
  intstiff(9,3)=v(275)
  intstiff(9,4)=v(214)*v(391)-v(393)+(-(v(134)*v(193))-v(137)*v(201))*v(494)
  intstiff(9,5)=v(215)*v(391)-v(395)+(-(v(134)*v(194))-v(137)*v(204))*v(494)
  intstiff(9,6)=v(333)
  intstiff(9,7)=v(216)*v(391)-v(397)+(-(v(134)*v(195))-v(137)*v(205))*v(494)
  intstiff(9,8)=v(217)*v(391)-v(399)+(-(v(134)*v(196))-v(137)*v(208))*v(494)
  intstiff(9,9)=v(266)*(v(358)+v(385))
END SUBROUTINE fluid2d

!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!*           Co. J. Korelc  2013           13 Jun 23 19:02:14 *
!**************************************************************
! User     : Full professional version
! Notebook : fluid2dbubble
! Evaluation time                 : 12 s    Mode  : Optimal
! Number of formulae              : 282     Method: Automatic
! Subroutine                      : fluid2dbubble size: 5462
! Total size of Mathematica  code : 5462 subexpressions
! Total size of Fortran code      : 14357 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE fluid2dbubble(steady,frozen,stabpress,deriv,dtime,vol,h,rho,mu,f,rno,pnew,acel,vold,vnew,xi,intforce&
&,intstiff)
IMPLICIT NONE
LOGICAL steady,b196
DOUBLE PRECISION v(574),frozen,stabpress,deriv,dtime,vol,h,rho,mu,f(2),rno(3,2),pnew(3),acel(4,2),vold(4,2)&
&,vnew(4,2),xi(2),intforce(11),intstiff(11,11)
v(541)=f(2)*rho
v(540)=f(1)*rho
v(531)=vold(3,2)*xi(2)
v(530)=vold(2,2)*xi(1)
v(529)=vold(3,1)*xi(2)
v(528)=vold(2,1)*xi(1)
v(527)=pnew(3)*xi(2)
v(526)=pnew(2)*xi(1)
v(520)=1d0/rho
v(519)=(4d0*mu**2)/(h**4*rho**2)
v(518)=1d0/dtime**2
v(517)=vnew(3,2)*xi(2)
v(516)=vnew(2,2)*xi(1)
v(515)=vnew(3,1)*xi(2)
v(514)=vnew(2,1)*xi(1)
v(505)=xi(1)*xi(2)
v(502)=vol*xi(1)
v(500)=(-2d0)*mu
v(499)=vol*xi(2)
v(498)=rno(1,1)*rno(2,2)
v(497)=-(rno(1,2)*rno(2,1))
v(496)=deriv*xi(2)
v(495)=rho*vol
v(494)=(-1d0)+xi(1)+xi(2)
v(506)=-(v(494)*xi(2))
v(504)=v(494)*vol
v(493)=deriv*xi(1)
v(492)=v(495)*xi(1)
v(491)=-rno(1,2)+rno(3,2)
v(490)=rno(1,1)-rno(3,1)
v(489)=rno(1,2)-rno(2,2)
v(488)=-rno(1,1)+rno(2,1)
v(487)=rho**2
v(486)=1d0/h**2
v(485)=1d0-frozen
v(231)=v(485)*xi(1)
v(430)=v(493)*v(506)
v(391)=v(495)*xi(2)
v(287)=-(deriv*v(494))
v(232)=v(485)*xi(2)
v(179)=1d0/(rno(3,2)*v(488)+rno(3,1)*v(489)+v(497)+v(498))
v(190)=-(v(179)*v(488))
v(564)=-(rho*v(190))
v(427)=v(190)*v(499)
v(398)=v(190)*v(500)
v(238)=(-0.5d0)*v(190)
v(503)=-(v(238)*vol)
v(189)=-(v(179)*v(490))
v(561)=-(rho*v(189))
v(425)=v(189)*v(499)
v(375)=v(189)*v(502)
v(348)=v(189)*v(500)
v(236)=(-0.5d0)*v(189)
v(182)=-(v(179)*v(489))
v(553)=-(rho*v(182))
v(426)=v(182)*v(499)
v(417)=v(182)*v(500)
v(239)=(-0.5d0)*v(182)
v(501)=v(239)*vol
v(415)=v(398)*v(501)
v(409)=v(348)*v(501)
v(181)=-(v(179)*v(491))
v(550)=-(rho*v(181))
v(424)=v(181)*v(499)
v(374)=v(181)*v(502)
v(354)=-(v(181)*v(500))
v(412)=-((v(190)*v(348)+v(239)*v(354))*vol)
v(393)=v(354)*v(503)
v(390)=(v(238)*v(348)+v(182)*v(354))*vol
v(237)=(-0.5d0)*v(181)
v(508)=v(237)*vol
v(363)=v(348)*v(508)
v(180)=v(181)+v(182)
v(547)=rho*v(180)
v(422)=-(v(180)*v(499))
v(372)=-(v(180)*v(502))
v(303)=v(180)*v(500)
v(384)=v(303)*v(503)
v(340)=-(v(236)*v(303)*vol)
v(235)=v(180)/2d0
v(328)=v(180)*v(504)
v(293)=-(rho*v(504))
v(442)=v(293)*v(505)
v(230)=-(v(485)*v(494))
v(200)=-(v(494)*v(505))
v(233)=v(200)*v(485)
v(194)=-v(505)+v(506)
v(192)=-v(505)-v(494)*xi(1)
v(187)=v(179)*(v(192)*v(489)+v(194)*v(491))
v(479)=-(v(187)*v(500))
v(241)=v(187)/2d0
v(507)=v(241)*vol
v(469)=v(398)*v(507)
v(463)=v(348)*v(507)
v(218)=v(180)*vnew(1,2)-v(181)*vnew(2,2)-v(182)*vnew(3,2)+v(187)*vnew(4,2)
v(262)=v(218)*v(233)
v(470)=v(262)*v(391)
v(464)=v(262)*v(492)
v(458)=v(262)*v(293)
v(258)=v(218)*v(232)
v(410)=v(258)*v(492)
v(404)=v(258)*v(293)
v(254)=v(218)*v(231)
v(358)=v(254)*v(293)
v(250)=v(218)*v(230)
v(188)=v(189)+v(190)
v(558)=rho*v(188)
v(423)=-(v(188)*v(499))
v(373)=-(v(188)*v(502))
v(329)=v(188)*v(504)
v(292)=-(v(188)*v(500))
v(457)=v(292)*v(507)
v(406)=-((v(190)*v(292)+v(239)*v(303))*vol)
v(403)=v(292)*v(501)
v(381)=(v(238)*v(292)+v(182)*v(303))*vol
v(360)=-((v(189)*v(292)+v(237)*v(303))*vol)
v(357)=v(292)*v(508)
v(337)=(v(236)*v(292)+v(181)*v(303))*vol
v(312)=v(235)*v(292)*vol
v(195)=v(179)*(v(192)*v(488)+v(194)*v(490))
v(472)=(v(195)*v(398)+v(241)*v(417))*vol
v(466)=(v(195)*v(348)-v(241)*v(354))*vol
v(460)=(v(195)*v(292)-v(241)*v(303))*vol
v(455)=-(v(195)*v(500))
v(475)=v(455)*v(507)
v(240)=v(195)/2d0
v(509)=v(240)*vol
v(450)=v(417)*v(509)
v(448)=(v(240)*v(398)+v(187)*v(417))*vol
v(444)=-(v(354)*v(509))
v(441)=(v(240)*v(348)-v(187)*v(354))*vol
v(435)=-(v(303)*v(509))
v(431)=(v(240)*v(292)-v(187)*v(303))*vol
v(216)=v(188)*vnew(1,1)-v(189)*vnew(2,1)-v(190)*vnew(3,1)+v(195)*vnew(4,1)
v(249)=v(216)*v(233)
v(451)=v(249)*v(391)
v(445)=v(249)*v(492)
v(436)=v(249)*v(293)
v(247)=v(216)*v(232)
v(394)=v(247)*v(492)
v(385)=v(247)*v(293)
v(245)=v(216)*v(231)
v(341)=v(245)*v(293)
v(243)=v(216)*v(230)
IF(steady) THEN
 v(222)=0d0
 v(223)=0d0
 v(224)=0d0
 v(225)=0d0
 v(197)=0d0
 v(226)=0d0
 v(227)=0d0
 v(228)=0d0
 v(229)=0d0
 v(198)=0d0
ELSE
 v(513)=acel(3,2)*xi(2)
 v(512)=acel(2,2)*xi(1)
 v(511)=acel(3,1)*xi(2)
 v(510)=acel(2,1)*xi(1)
 v(222)=v(287)
 v(223)=v(493)
 v(224)=v(496)
 v(225)=v(430)
 v(197)=acel(4,1)*v(200)-acel(1,1)*v(494)+v(510)+v(511)
 v(226)=v(287)
 v(227)=v(493)
 v(228)=v(496)
 v(229)=v(430)
 v(198)=acel(4,2)*v(200)-acel(1,2)*v(494)+v(512)+v(513)
ENDIF
v(201)=v(514)+v(515)-v(494)*vnew(1,1)+v(200)*vnew(4,1)
v(202)=v(516)+v(517)-v(494)*vnew(1,2)+v(200)*vnew(4,2)
v(266)=sqrt(0.1d-5+v(201)**2+v(202)**2)
v(269)=4d0*((v(266)*v(266))*v(486)+v(518)+v(519))
v(273)=((-4d0)*v(266)*v(486)*v(520))/v(269)**0.15d1
v(522)=v(273)/v(266)
v(525)=-(v(494)*v(522))
v(524)=v(522)*xi(1)
v(523)=v(522)*xi(2)
v(521)=v(200)*v(522)
v(286)=v(202)*v(521)
v(284)=v(201)*v(521)
v(282)=v(202)*v(523)
v(280)=v(201)*v(523)
v(278)=v(202)*v(524)
v(276)=v(201)*v(524)
v(274)=v(202)*v(525)
v(270)=v(201)*v(525)
v(209)=-(pnew(1)*v(494))+v(526)+v(527)
v(210)=v(201)*v(485)+frozen*(v(528)+v(529)-v(494)*vold(1,1)+v(200)*vold(4,1))
v(263)=v(187)*v(210)
v(259)=-(v(182)*v(210))
v(255)=-(v(181)*v(210))
v(251)=v(180)*v(210)
v(212)=v(202)*v(485)+frozen*(v(530)+v(531)-v(494)*vold(1,2)+v(200)*vold(4,2))
v(264)=v(195)*v(212)
v(532)=v(263)+v(264)
v(260)=-(v(190)*v(212))
v(533)=v(259)+v(260)
v(256)=-(v(189)*v(212))
v(534)=v(255)+v(256)
v(252)=v(188)*v(212)
v(535)=v(251)+v(252)
v(213)=v(180)*vnew(1,1)-v(181)*vnew(2,1)-v(182)*vnew(3,1)+v(187)*vnew(4,1)
v(248)=v(225)+v(213)*v(233)+v(532)
v(246)=v(224)+v(213)*v(232)+v(533)
v(244)=v(223)+v(213)*v(231)+v(534)
v(242)=v(222)+v(213)*v(230)+v(535)
v(214)=(v(216)+v(218))/2d0
v(215)=v(188)*vnew(1,2)-v(189)*vnew(2,2)-v(190)*vnew(3,2)+v(195)*vnew(4,2)
v(265)=v(229)+v(215)*v(233)+v(532)
v(261)=v(228)+v(215)*v(232)+v(533)
v(257)=v(227)+v(215)*v(231)+v(534)
v(253)=v(226)+v(215)*v(230)+v(535)
v(217)=v(197)+v(210)*v(213)+v(212)*v(216)
v(481)=pnew(1)*v(180)-pnew(2)*v(181)-pnew(3)*v(182)+rho*(-f(1)+v(217))
v(539)=rho*v(481)
v(219)=v(198)+v(212)*v(215)+v(210)*v(218)
v(480)=pnew(1)*v(188)-pnew(2)*v(189)-pnew(3)*v(190)+rho*(-f(2)+v(219))
v(543)=rho*v(480)
v(220)=v(213)+v(215)
v(221)=v(520)/sqrt(v(269))
v(538)=v(221)*vol
v(288)=v(481)*v(495)
v(555)=v(286)*v(288)
v(554)=v(284)*v(288)
v(552)=v(282)*v(288)
v(551)=v(280)*v(288)
v(549)=v(278)*v(288)
v(548)=v(276)*v(288)
v(546)=v(274)*v(288)
v(544)=v(270)*v(288)
v(536)=v(221)*v(288)
v(309)=v(233)*v(536)
v(305)=v(232)*v(536)
v(300)=v(231)*v(536)
v(291)=v(230)*v(536)
v(289)=v(287)+v(535)
v(296)=v(289)*v(538)
v(294)=v(296)*v(487)
v(545)=v(293)+v(294)
v(311)=v(480)*v(495)
v(566)=v(286)*v(311)
v(565)=v(284)*v(311)
v(563)=v(282)*v(311)
v(562)=v(280)*v(311)
v(560)=v(278)*v(311)
v(559)=v(276)*v(311)
v(557)=v(274)*v(311)
v(556)=v(270)*v(311)
v(537)=v(221)*v(311)
v(326)=v(233)*v(537)
v(322)=v(232)*v(537)
v(318)=v(231)*v(537)
v(314)=v(230)*v(537)
v(330)=v(181)*v(504)
v(331)=v(189)*v(504)
v(332)=v(182)*v(504)
v(333)=v(190)*v(504)
v(334)=-(v(187)*v(504))
v(335)=-(v(195)*v(504))
v(338)=v(493)+v(534)
v(344)=v(338)*v(538)
v(542)=rho*v(344)
v(342)=v(344)*v(487)
v(567)=v(342)+v(492)
v(376)=-(v(182)*v(502))
v(377)=-(v(190)*v(502))
v(378)=v(187)*v(502)
v(379)=v(195)*v(502)
v(382)=v(496)+v(533)
v(388)=v(382)*v(538)
v(386)=v(388)*v(487)
v(568)=v(386)+v(391)
v(428)=v(187)*v(499)
v(429)=v(195)*v(499)
v(433)=v(430)+v(532)
v(439)=v(433)*v(538)
v(437)=v(439)*v(487)
v(569)=v(437)+v(442)
v(478)=-v(209)-v(213)*v(500)
v(482)=-v(209)-v(215)*v(500)
intforce(1)=v(217)*v(293)+v(296)*v(539)+(v(214)*v(292)+v(180)*v(478)+v(494)*v(540))*vol
intforce(2)=v(219)*v(293)+v(289)*v(537)+(-(v(214)*v(303))+v(188)*v(482)+v(494)*v(541))*vol
intforce(3)=-(v(220)*v(504))
intforce(4)=v(217)*v(492)+v(481)*v(542)+vol*(v(214)*v(348)-v(181)*v(478)-v(540)*xi(1))
intforce(5)=v(219)*v(492)+v(480)*v(542)+vol*(-(v(214)*v(354))-v(189)*v(482)-v(541)*xi(1))
intforce(6)=v(220)*v(502)
intforce(7)=v(217)*v(391)+v(388)*v(539)+vol*(v(214)*v(398)-v(182)*v(478)-v(540)*xi(2))
intforce(8)=v(219)*v(391)+v(388)*v(543)+vol*(v(214)*v(417)-v(190)*v(482)-v(541)*xi(2))
intforce(9)=v(220)*v(499)
intforce(10)=v(217)*v(442)+v(439)*v(539)+(v(214)*v(455)+v(187)*v(478))*vol
intforce(11)=v(219)*v(442)+v(439)*v(543)+(v(214)*v(479)+v(195)*v(482))*vol
intstiff(1,1)=v(180)*v(291)+v(289)*v(544)+v(242)*v(545)+((v(188)*v(292))/2d0-(v(180)*v(180))*v(500))*vol
intstiff(1,2)=v(188)*v(291)+v(312)+v(243)*v(545)+v(289)*v(546)
intstiff(1,3)=v(328)+v(296)*v(547)
intstiff(1,4)=v(180)*v(300)+v(337)+v(244)*v(545)+v(289)*v(548)
intstiff(1,5)=v(245)*v(294)+v(188)*v(300)+v(341)+v(357)+v(289)*v(549)
intstiff(1,6)=v(372)+v(296)*v(550)
intstiff(1,7)=v(180)*v(305)+v(381)+v(246)*v(545)+v(289)*v(551)
intstiff(1,8)=v(247)*v(294)+v(188)*v(305)+v(385)+v(403)+v(289)*v(552)
intstiff(1,9)=v(422)+v(296)*v(553)
intstiff(1,10)=v(180)*v(309)+v(431)+v(248)*v(545)+v(289)*v(554)
intstiff(1,11)=v(249)*v(294)+v(188)*v(309)+v(436)+v(457)+v(289)*v(555)
intstiff(2,1)=v(312)+v(180)*v(314)+v(250)*v(545)+v(289)*v(556)
intstiff(2,2)=v(188)*v(314)+v(253)*v(545)+v(289)*v(557)+(-(v(235)*v(303))-(v(188)*v(188))*v(500))*vol
intstiff(2,3)=v(329)+v(296)*v(558)
intstiff(2,4)=v(254)*v(294)+v(180)*v(318)+v(340)+v(358)+v(289)*v(559)
intstiff(2,5)=v(188)*v(318)+v(360)+v(257)*v(545)+v(289)*v(560)
intstiff(2,6)=v(373)+v(296)*v(561)
intstiff(2,7)=v(258)*v(294)+v(180)*v(322)+v(384)+v(404)+v(289)*v(562)
intstiff(2,8)=v(188)*v(322)+v(406)+v(261)*v(545)+v(289)*v(563)
intstiff(2,9)=v(423)+v(296)*v(564)
intstiff(2,10)=v(262)*v(294)+v(180)*v(326)+v(435)+v(458)+v(289)*v(565)
intstiff(2,11)=v(188)*v(326)+v(460)+v(265)*v(545)+v(289)*v(566)
intstiff(3,1)=-v(328)
intstiff(3,2)=-v(329)
intstiff(3,3)=0d0
intstiff(3,4)=v(330)
intstiff(3,5)=v(331)
intstiff(3,6)=0d0
intstiff(3,7)=v(332)
intstiff(3,8)=v(333)
intstiff(3,9)=0d0
intstiff(3,10)=v(334)
intstiff(3,11)=v(335)
intstiff(4,1)=-(v(181)*v(291))+v(337)+v(338)*v(544)+v(242)*v(567)
intstiff(4,2)=-(v(189)*v(291))+v(340)+v(341)+v(243)*v(342)+v(338)*v(546)
intstiff(4,3)=-v(330)+v(180)*v(542)
intstiff(4,4)=-(v(181)*v(300))+v(338)*v(548)+v(244)*v(567)+(v(236)*v(348)-(v(181)*v(181))*v(500))*vol
intstiff(4,5)=-(v(189)*v(300))+v(363)+v(338)*v(549)+v(245)*v(567)
intstiff(4,6)=v(374)-v(181)*v(542)
intstiff(4,7)=-(v(181)*v(305))+v(390)+v(338)*v(551)+v(246)*v(567)
intstiff(4,8)=-(v(189)*v(305))+v(247)*v(342)+v(394)+v(409)+v(338)*v(552)
intstiff(4,9)=v(424)-v(182)*v(542)
intstiff(4,10)=-(v(181)*v(309))+v(441)+v(338)*v(554)+v(248)*v(567)
intstiff(4,11)=-(v(189)*v(309))+v(249)*v(342)+v(445)+v(463)+v(338)*v(555)
intstiff(5,1)=-(v(181)*v(314))+v(250)*v(342)+v(357)+v(358)+v(338)*v(556)
intstiff(5,2)=-(v(189)*v(314))+v(360)+v(338)*v(557)+v(253)*v(567)
intstiff(5,3)=-v(331)+v(188)*v(542)
intstiff(5,4)=-(v(181)*v(318))+v(363)+v(338)*v(559)+v(254)*v(567)
intstiff(5,5)=-(v(189)*v(318))+v(338)*v(560)+v(257)*v(567)+(-(v(237)*v(354))-(v(189)*v(189))*v(500))*vol
intstiff(5,6)=v(375)-v(189)*v(542)
intstiff(5,7)=-(v(181)*v(322))+v(258)*v(342)+v(393)+v(410)+v(338)*v(562)
intstiff(5,8)=-(v(189)*v(322))+v(412)+v(338)*v(563)+v(261)*v(567)
intstiff(5,9)=v(425)-v(190)*v(542)
intstiff(5,10)=-(v(181)*v(326))+v(262)*v(342)+v(444)+v(464)+v(338)*v(565)
intstiff(5,11)=-(v(189)*v(326))+v(466)+v(338)*v(566)+v(265)*v(567)
intstiff(6,1)=-v(372)
intstiff(6,2)=-v(373)
intstiff(6,3)=0d0
intstiff(6,4)=-v(374)
intstiff(6,5)=-v(375)
intstiff(6,6)=0d0
intstiff(6,7)=v(376)
intstiff(6,8)=v(377)
intstiff(6,9)=0d0
intstiff(6,10)=v(378)
intstiff(6,11)=v(379)
intstiff(7,1)=-(v(182)*v(291))+v(381)+v(382)*v(544)+v(242)*v(568)
intstiff(7,2)=-(v(190)*v(291))+v(384)+v(385)+v(243)*v(386)+v(382)*v(546)
intstiff(7,3)=-v(332)+v(388)*v(547)
intstiff(7,4)=-(v(182)*v(300))+v(390)+v(382)*v(548)+v(244)*v(568)
intstiff(7,5)=-(v(190)*v(300))+v(245)*v(386)+v(393)+v(394)+v(382)*v(549)
intstiff(7,6)=-v(376)+v(388)*v(550)
intstiff(7,7)=-(v(182)*v(305))+v(382)*v(551)+v(246)*v(568)+(v(238)*v(398)-(v(182)*v(182))*v(500))*vol
intstiff(7,8)=-(v(190)*v(305))+v(415)+v(382)*v(552)+v(247)*v(568)
intstiff(7,9)=v(426)+v(388)*v(553)
intstiff(7,10)=-(v(182)*v(309))+v(448)+v(382)*v(554)+v(248)*v(568)
intstiff(7,11)=-(v(190)*v(309))+v(249)*v(386)+v(451)+v(469)+v(382)*v(555)
intstiff(8,1)=-(v(182)*v(314))+v(250)*v(386)+v(403)+v(404)+v(382)*v(556)
intstiff(8,2)=-(v(190)*v(314))+v(406)+v(382)*v(557)+v(253)*v(568)
intstiff(8,3)=-v(333)+v(388)*v(558)
intstiff(8,4)=-(v(182)*v(318))+v(254)*v(386)+v(409)+v(410)+v(382)*v(559)
intstiff(8,5)=-(v(190)*v(318))+v(412)+v(382)*v(560)+v(257)*v(568)
intstiff(8,6)=-v(377)+v(388)*v(561)
intstiff(8,7)=-(v(182)*v(322))+v(415)+v(382)*v(562)+v(258)*v(568)
intstiff(8,8)=-(v(190)*v(322))+v(382)*v(563)+v(261)*v(568)+(v(239)*v(417)-(v(190)*v(190))*v(500))*vol
intstiff(8,9)=v(427)+v(388)*v(564)
intstiff(8,10)=-(v(182)*v(326))+v(262)*v(386)+v(450)+v(470)+v(382)*v(565)
intstiff(8,11)=-(v(190)*v(326))+v(472)+v(382)*v(566)+v(265)*v(568)
intstiff(9,1)=-v(422)
intstiff(9,2)=-v(423)
intstiff(9,3)=0d0
intstiff(9,4)=-v(424)
intstiff(9,5)=-v(425)
intstiff(9,6)=0d0
intstiff(9,7)=-v(426)
intstiff(9,8)=-v(427)
intstiff(9,9)=0d0
intstiff(9,10)=v(428)
intstiff(9,11)=v(429)
intstiff(10,1)=v(187)*v(291)+v(431)+v(433)*v(544)+v(242)*v(569)
intstiff(10,2)=v(195)*v(291)+v(435)+v(436)+v(243)*v(437)+v(433)*v(546)
intstiff(10,3)=-v(334)+v(439)*v(547)
intstiff(10,4)=v(187)*v(300)+v(441)+v(433)*v(548)+v(244)*v(569)
intstiff(10,5)=v(195)*v(300)+v(245)*v(437)+v(444)+v(445)+v(433)*v(549)
intstiff(10,6)=-v(378)+v(439)*v(550)
intstiff(10,7)=v(187)*v(305)+v(448)+v(433)*v(551)+v(246)*v(569)
intstiff(10,8)=v(195)*v(305)+v(247)*v(437)+v(450)+v(451)+v(433)*v(552)
intstiff(10,9)=-v(428)+v(439)*v(553)
intstiff(10,10)=v(187)*v(309)+v(433)*v(554)+v(248)*v(569)+(v(240)*v(455)-(v(187)*v(187))*v(500))*vol
intstiff(10,11)=v(195)*v(309)+v(475)+v(433)*v(555)+v(249)*v(569)
intstiff(11,1)=v(187)*v(314)+v(250)*v(437)+v(457)+v(458)+v(433)*v(556)
intstiff(11,2)=v(195)*v(314)+v(460)+v(433)*v(557)+v(253)*v(569)
intstiff(11,3)=-v(335)+v(439)*v(558)
intstiff(11,4)=v(187)*v(318)+v(254)*v(437)+v(463)+v(464)+v(433)*v(559)
intstiff(11,5)=v(195)*v(318)+v(466)+v(433)*v(560)+v(257)*v(569)
intstiff(11,6)=-v(379)+v(439)*v(561)
intstiff(11,7)=v(187)*v(322)+v(258)*v(437)+v(469)+v(470)+v(433)*v(562)
intstiff(11,8)=v(195)*v(322)+v(472)+v(433)*v(563)+v(261)*v(569)
intstiff(11,9)=-v(429)+v(439)*v(564)
intstiff(11,10)=v(187)*v(326)+v(475)+v(433)*v(565)+v(262)*v(569)
intstiff(11,11)=v(195)*v(326)+v(433)*v(566)+v(265)*v(569)+(v(241)*v(479)-(v(195)*v(195))*v(500))*vol
END


