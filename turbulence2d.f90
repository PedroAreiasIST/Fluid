!**************************************************************
!* AceGen    6.808 Linux (6 Sep 16)                           *
!**************************************************************
! User     : Full professional version
! Notebook : turbulence2d
! Evaluation time                 : 5 s     Mode  : Optimal
! Number of formulae              : 96      Method: Automatic
! Subroutine                      : turbulence2d size: 1873
! Total size of Mathematica  code : 1873 subexpressions
! Total size of Fortran code      : 4712 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE turbulence2d(dtime,vol,h,d,rho,mufixed,rno,pnew,vnew,xi,nuold,nunew,intforce,intstiff)
IMPLICIT NONE
DOUBLE PRECISION v(174),dtime,vol,h,d,rho,mufixed,rno(3,2),pnew(3),vnew(3,2),xi(2),nuold(3),nunew(3),intforce&
&(3),intstiff(3,3)
v(152)=1d0/h**2
v(151)=(16d0*mufixed**2)/(h**4*rho**2)
v(149)=d**2
v(148)=nunew(3)*xi(2)
v(147)=nunew(2)*xi(1)
v(146)=nuold(3)*xi(2)
v(145)=nuold(2)*xi(1)
v(144)=1d0/dtime
v(143)=v(144)*xi(2)
v(142)=vnew(3,2)*xi(2)
v(141)=vnew(2,2)*xi(1)
v(140)=vnew(3,1)*xi(2)
v(139)=vnew(2,1)*xi(1)
v(138)=rno(1,2)-rno(2,2)
v(137)=-rno(1,1)+rno(2,1)
v(136)=1d0/(-(rno(1,2)*rno(2,1))+rno(1,1)*rno(2,2)+rno(3,2)*v(137)+rno(3,1)*v(138))
v(135)=mufixed/rho
v(134)=1d0-xi(1)-xi(2)
v(133)=1d0/d**2
v(49)=-(v(136)*v(137))
v(48)=-((rno(1,1)-rno(3,1))*v(136))
v(46)=-(v(136)*v(138))
v(45)=(rno(1,2)-rno(3,2))*v(136)
v(44)=v(45)+v(46)
v(75)=nunew(1)*v(44)-nunew(2)*v(45)-nunew(3)*v(46)
v(158)=v(46)*v(75)
v(156)=v(45)*v(75)
v(153)=v(44)*v(75)
v(47)=v(48)+v(49)
v(76)=nunew(1)*v(47)-nunew(2)*v(48)-nunew(3)*v(49)
v(159)=v(49)*v(76)
v(157)=v(48)*v(76)
v(154)=v(47)*v(76)
v(112)=v(158)+v(159)
v(99)=v(156)+v(157)
v(83)=-v(153)-v(154)
v(50)=v(139)+v(140)+v(134)*vnew(1,1)
v(52)=v(141)+v(142)+v(134)*vnew(1,2)
v(74)=v(143)-v(46)*v(50)-v(49)*v(52)
v(72)=-(v(45)*v(50))-v(48)*v(52)+v(144)*xi(1)
v(70)=v(134)*v(144)+v(44)*v(50)+v(47)*v(52)
v(53)=nuold(1)*v(134)+v(145)+v(146)
v(54)=nunew(1)*v(134)+v(147)+v(148)
v(85)=v(135)+v(54)
v(113)=-((v(45)*v(46)+v(48)*v(49))*v(85))
v(108)=(v(44)*v(46)+v(47)*v(49))*v(85)
v(93)=(v(44)*v(45)+v(47)*v(48))*v(85)
v(56)=dabs(v(47)*vnew(1,1)-v(44)*vnew(1,2)-v(48)*vnew(2,1)+v(45)*vnew(2,2)-v(49)*vnew(3,1)+v(46)*vnew(3,2))
v(57)=v(53)/v(135)
v(58)=v(57)**3
v(62)=v(144)*(-v(53)+v(54))+v(50)*v(75)+v(52)*v(76)
v(63)=MAX(0.3d0*v(56),0.5948839976204641d1*v(133)*v(53)*(1d0-v(57)/(1d0+(v(57)*v(58))/(0.3579109999999999d3+v(58))))&
&+sqrt(2d0*v(56)**2))
v(155)=(-0.136d0)*v(63)
v(129)=v(155)*v(54)
v(64)=MIN(v(53)/(0.1d-8+0.16809999999999997d0*v(149)*v(63)),10d0)
v(66)=0.7d0*v(64)+0.3d0*v(64)**6
v(67)=0.20051747451504215d1*v(66)*(1/(64d0+v(66)**6))**0.16666666666666666d0
v(161)=v(133)*v(67)
v(86)=0.6488955344398533d1*v(161)*v(54)
v(150)=v(86)*vol
v(114)=v(150)*xi(1)*xi(2)
v(90)=v(134)*v(150)
v(109)=v(90)*xi(2)
v(94)=v(90)*xi(1)
v(68)=1d0/sqrt(v(151)+4d0*v(152)*(1.d-6+v(50)**2+v(52)**2))
v(160)=v(68)*vol
v(77)=2d0*(v(153)+v(154))
v(165)=0.622d0*v(77)
v(79)=v(134)*v(86)
v(80)=v(160)*v(70)
v(81)=v(134)*v(155)
v(97)=v(70)+v(81)
v(95)=v(79)+v(97)
v(164)=(-0.9339339339339339d0)*v(77)+v(95)
v(84)=(-2d0)*(v(156)+v(157))
v(167)=0.622d0*v(84)
v(87)=v(155)*xi(1)
v(102)=v(72)+v(87)
v(101)=v(102)+v(86)*xi(1)
v(166)=v(101)-0.9339339339339339d0*v(84)
v(89)=(-2d0)*(v(158)+v(159))
v(169)=0.622d0*v(89)
v(91)=v(155)*xi(2)
v(106)=v(74)+v(91)
v(105)=v(106)+v(86)*xi(2)
v(168)=v(105)-0.9339339339339339d0*v(89)
v(96)=v(160)*v(72)
v(110)=v(160)*v(74)
v(126)=(v(75)*v(75))+(v(76)*v(76))
v(163)=0.622d0*v(126)
v(127)=v(129)+v(62)
v(128)=0.32444776721992663d1*v(161)*(v(54)*v(54))
v(130)=v(127)+v(128)
v(162)=(-0.9339339339339339d0)*v(126)+v(130)
intforce(1)=intforce(1)+v(162)*v(80)+(v(130)*v(134)-0.15015015015015015d1*(v(134)*v(163)+v(83)*v(85)))*vol
intforce(2)=intforce(2)+v(162)*v(96)+vol*(v(130)*xi(1)-0.15015015015015015d1*(v(85)*v(99)+v(163)*xi(1)))
intforce(3)=intforce(3)+v(110)*v(162)+vol*(v(130)*xi(2)-0.15015015015015015d1*(v(112)*v(85)+v(163)*xi(2)))
intstiff(1,1)=intstiff(1,1)+v(164)*v(80)+((-0.15015015015015015d1)*(v(134)*(v(165)+v(83))+(-(v(44)*v(44))-(v(47)*v(47))&
&)*v(85))+v(134)*v(95))*vol
intstiff(1,2)=intstiff(1,2)+v(166)*v(80)+v(94)+vol*(v(102)*v(134)-0.15015015015015015d1*(v(134)*v(167)+v(93)+v(83)*xi(1&
&)))
intstiff(1,3)=intstiff(1,3)+v(109)+v(168)*v(80)+vol*(v(106)*v(134)-0.15015015015015015d1*(v(108)+v(134)*v(169)+v(83)*xi&
&(2)))
intstiff(2,1)=intstiff(2,1)+v(94)+v(164)*v(96)+vol*(v(97)*xi(1)-0.15015015015015015d1*(v(93)+v(134)*v(99)+v(165)*xi(1))&
&)
intstiff(2,2)=intstiff(2,2)+v(166)*v(96)+vol*(v(102)*xi(1)+v(86)*xi(1)**2-0.15015015015015015d1*((-(v(45)*v(45))-(v(48&
&)*v(48)))*v(85)+(v(167)+v(99))*xi(1)))
intstiff(2,3)=intstiff(2,3)+v(114)+v(168)*v(96)+vol*(v(106)*xi(1)-0.15015015015015015d1*(v(113)+v(169)*xi(1)+v(99)*xi(2&
&)))
intstiff(3,1)=intstiff(3,1)+v(109)+v(110)*v(164)+vol*(v(97)*xi(2)-0.15015015015015015d1*(v(108)+v(112)*v(134)+v(165)*xi&
&(2)))
intstiff(3,2)=intstiff(3,2)+v(114)+v(110)*v(166)+vol*(v(102)*xi(2)-0.15015015015015015d1*(v(113)+v(112)*xi(1)+v(167)*xi&
&(2)))
intstiff(3,3)=intstiff(3,3)+v(110)*v(168)+vol*(v(106)*xi(2)+v(86)*xi(2)**2-0.15015015015015015d1*((-(v(46)*v(46))-(v(49&
&)*v(49)))*v(85)+(v(112)+v(169))*xi(2)))
END
